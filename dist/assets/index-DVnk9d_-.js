function zV(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in t)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(t,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var Fo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ft(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function jV(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),n}var hD={exports:{}},Fy={},dD={exports:{}},je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yh=Symbol.for("react.element"),WV=Symbol.for("react.portal"),VV=Symbol.for("react.fragment"),UV=Symbol.for("react.strict_mode"),GV=Symbol.for("react.profiler"),HV=Symbol.for("react.provider"),KV=Symbol.for("react.context"),qV=Symbol.for("react.forward_ref"),XV=Symbol.for("react.suspense"),YV=Symbol.for("react.memo"),QV=Symbol.for("react.lazy"),ET=Symbol.iterator;function ZV(t){return t===null||typeof t!="object"?null:(t=ET&&t[ET]||t["@@iterator"],typeof t=="function"?t:null)}var pD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mD=Object.assign,gD={};function fc(t,e,n){this.props=t,this.context=e,this.refs=gD,this.updater=n||pD}fc.prototype.isReactComponent={};fc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function yD(){}yD.prototype=fc.prototype;function RS(t,e,n){this.props=t,this.context=e,this.refs=gD,this.updater=n||pD}var PS=RS.prototype=new yD;PS.constructor=RS;mD(PS,fc.prototype);PS.isPureReactComponent=!0;var NT=Array.isArray,vD=Object.prototype.hasOwnProperty,MS={current:null},xD={key:!0,ref:!0,__self:!0,__source:!0};function bD(t,e,n){var r,o={},i=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(i=""+e.key),e)vD.call(e,r)&&!xD.hasOwnProperty(r)&&(o[r]=e[r]);var a=arguments.length-2;if(a===1)o.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];o.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)o[r]===void 0&&(o[r]=a[r]);return{$$typeof:Yh,type:t,key:i,ref:s,props:o,_owner:MS.current}}function JV(t,e){return{$$typeof:Yh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function FS(t){return typeof t=="object"&&t!==null&&t.$$typeof===Yh}function eU(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var AT=/\/+/g;function px(t,e){return typeof t=="object"&&t!==null&&t.key!=null?eU(""+t.key):e.toString(36)}function $m(t,e,n,r,o){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Yh:case WV:s=!0}}if(s)return s=t,o=o(s),t=r===""?"."+px(s,0):r,NT(o)?(n="",t!=null&&(n=t.replace(AT,"$&/")+"/"),$m(o,e,n,"",function(u){return u})):o!=null&&(FS(o)&&(o=JV(o,n+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(AT,"$&/")+"/")+t)),e.push(o)),1;if(s=0,r=r===""?".":r+":",NT(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+px(i,a);s+=$m(i,e,n,l,o)}else if(l=ZV(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+px(i,a++),s+=$m(i,e,n,l,o);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function _p(t,e,n){if(t==null)return t;var r=[],o=0;return $m(t,r,"","",function(i){return e.call(n,i,o++)}),r}function tU(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var cr={current:null},Cm={transition:null},nU={ReactCurrentDispatcher:cr,ReactCurrentBatchConfig:Cm,ReactCurrentOwner:MS};function wD(){throw Error("act(...) is not supported in production builds of React.")}je.Children={map:_p,forEach:function(t,e,n){_p(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _p(t,function(){e++}),e},toArray:function(t){return _p(t,function(e){return e})||[]},only:function(t){if(!FS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};je.Component=fc;je.Fragment=VV;je.Profiler=GV;je.PureComponent=RS;je.StrictMode=UV;je.Suspense=XV;je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nU;je.act=wD;je.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=mD({},t.props),o=t.key,i=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,s=MS.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)vD.call(e,l)&&!xD.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Yh,type:t.type,key:o,ref:i,props:r,_owner:s}};je.createContext=function(t){return t={$$typeof:KV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:HV,_context:t},t.Consumer=t};je.createElement=bD;je.createFactory=function(t){var e=bD.bind(null,t);return e.type=t,e};je.createRef=function(){return{current:null}};je.forwardRef=function(t){return{$$typeof:qV,render:t}};je.isValidElement=FS;je.lazy=function(t){return{$$typeof:QV,_payload:{_status:-1,_result:t},_init:tU}};je.memo=function(t,e){return{$$typeof:YV,type:t,compare:e===void 0?null:e}};je.startTransition=function(t){var e=Cm.transition;Cm.transition={};try{t()}finally{Cm.transition=e}};je.unstable_act=wD;je.useCallback=function(t,e){return cr.current.useCallback(t,e)};je.useContext=function(t){return cr.current.useContext(t)};je.useDebugValue=function(){};je.useDeferredValue=function(t){return cr.current.useDeferredValue(t)};je.useEffect=function(t,e){return cr.current.useEffect(t,e)};je.useId=function(){return cr.current.useId()};je.useImperativeHandle=function(t,e,n){return cr.current.useImperativeHandle(t,e,n)};je.useInsertionEffect=function(t,e){return cr.current.useInsertionEffect(t,e)};je.useLayoutEffect=function(t,e){return cr.current.useLayoutEffect(t,e)};je.useMemo=function(t,e){return cr.current.useMemo(t,e)};je.useReducer=function(t,e,n){return cr.current.useReducer(t,e,n)};je.useRef=function(t){return cr.current.useRef(t)};je.useState=function(t){return cr.current.useState(t)};je.useSyncExternalStore=function(t,e,n){return cr.current.useSyncExternalStore(t,e,n)};je.useTransition=function(){return cr.current.useTransition()};je.version="18.3.1";dD.exports=je;var se=dD.exports;const W=ft(se);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rU=se,oU=Symbol.for("react.element"),iU=Symbol.for("react.fragment"),sU=Object.prototype.hasOwnProperty,aU=rU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lU={key:!0,ref:!0,__self:!0,__source:!0};function SD(t,e,n){var r,o={},i=null,s=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)sU.call(e,r)&&!lU.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:oU,type:t,key:i,ref:s,props:o,_owner:aU.current}}Fy.Fragment=iU;Fy.jsx=SD;Fy.jsxs=SD;hD.exports=Fy;var oe=hD.exports,$D={exports:{}},Wr={},CD={exports:{}},kD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(A,P){var z=A.length;A.push(P);e:for(;0<z;){var U=z-1>>>1,H=A[U];if(0<o(H,P))A[U]=P,A[z]=H,z=U;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var P=A[0],z=A.pop();if(z!==P){A[0]=z;e:for(var U=0,H=A.length,X=H>>>1;U<X;){var ne=2*(U+1)-1,re=A[ne],le=ne+1,ye=A[le];if(0>o(re,z))le<H&&0>o(ye,re)?(A[U]=ye,A[le]=z,U=le):(A[U]=re,A[ne]=z,U=ne);else if(le<H&&0>o(ye,z))A[U]=ye,A[le]=z,U=le;else break e}}return P}function o(A,P){var z=A.sortIndex-P.sortIndex;return z!==0?z:A.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],u=[],c=1,f=null,h=3,d=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(A){for(var P=n(u);P!==null;){if(P.callback===null)r(u);else if(P.startTime<=A)r(u),P.sortIndex=P.expirationTime,e(l,P);else break;P=n(u)}}function b(A){if(m=!1,x(A),!p)if(n(l)!==null)p=!0,R(w);else{var P=n(u);P!==null&&F(b,P.startTime-A)}}function w(A,P){p=!1,m&&(m=!1,y(C),C=-1),d=!0;var z=h;try{for(x(P),f=n(l);f!==null&&(!(f.expirationTime>P)||A&&!T());){var U=f.callback;if(typeof U=="function"){f.callback=null,h=f.priorityLevel;var H=U(f.expirationTime<=P);P=t.unstable_now(),typeof H=="function"?f.callback=H:f===n(l)&&r(l),x(P)}else r(l);f=n(l)}if(f!==null)var X=!0;else{var ne=n(u);ne!==null&&F(b,ne.startTime-P),X=!1}return X}finally{f=null,h=z,d=!1}}var S=!1,$=null,C=-1,k=5,I=-1;function T(){return!(t.unstable_now()-I<k)}function N(){if($!==null){var A=t.unstable_now();I=A;var P=!0;try{P=$(!0,A)}finally{P?_():(S=!1,$=null)}}else S=!1}var _;if(typeof v=="function")_=function(){v(N)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,O=D.port2;D.port1.onmessage=N,_=function(){O.postMessage(null)}}else _=function(){g(N,0)};function R(A){$=A,S||(S=!0,_())}function F(A,P){C=g(function(){A(t.unstable_now())},P)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(A){A.callback=null},t.unstable_continueExecution=function(){p||d||(p=!0,R(w))},t.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<A?Math.floor(1e3/A):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(A){switch(h){case 1:case 2:case 3:var P=3;break;default:P=h}var z=h;h=P;try{return A()}finally{h=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(A,P){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var z=h;h=A;try{return P()}finally{h=z}},t.unstable_scheduleCallback=function(A,P,z){var U=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?U+z:U):z=U,A){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=z+H,A={id:c++,callback:P,priorityLevel:A,startTime:z,expirationTime:H,sortIndex:-1},z>U?(A.sortIndex=z,e(u,A),n(l)===null&&A===n(u)&&(m?(y(C),C=-1):m=!0,F(b,z-U))):(A.sortIndex=H,e(l,A),p||d||(p=!0,R(w))),A},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(A){var P=h;return function(){var z=h;h=P;try{return A.apply(this,arguments)}finally{h=z}}}})(kD);CD.exports=kD;var uU=CD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cU=se,Br=uU;function ue(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ID=new Set,zf={};function dl(t,e){$u(t,e),$u(t+"Capture",e)}function $u(t,e){for(zf[t]=e,t=0;t<e.length;t++)ID.add(e[t])}var Ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Db=Object.prototype.hasOwnProperty,fU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,OT={},_T={};function hU(t){return Db.call(_T,t)?!0:Db.call(OT,t)?!1:fU.test(t)?_T[t]=!0:(OT[t]=!0,!1)}function dU(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function pU(t,e,n,r){if(e===null||typeof e>"u"||dU(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fr(t,e,n,r,o,i,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=s}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){An[t]=new fr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];An[e]=new fr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){An[t]=new fr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){An[t]=new fr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){An[t]=new fr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){An[t]=new fr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){An[t]=new fr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){An[t]=new fr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){An[t]=new fr(t,5,!1,t.toLowerCase(),null,!1,!1)});var LS=/[\-:]([a-z])/g;function BS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(LS,BS);An[e]=new fr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(LS,BS);An[e]=new fr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(LS,BS);An[e]=new fr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){An[t]=new fr(t,1,!1,t.toLowerCase(),null,!1,!1)});An.xlinkHref=new fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){An[t]=new fr(t,1,!1,t.toLowerCase(),null,!0,!0)});function zS(t,e,n,r){var o=An.hasOwnProperty(e)?An[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(pU(e,n,o,r)&&(n=null),r||o===null?hU(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ns=cU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Dp=Symbol.for("react.element"),Gl=Symbol.for("react.portal"),Hl=Symbol.for("react.fragment"),jS=Symbol.for("react.strict_mode"),Rb=Symbol.for("react.profiler"),TD=Symbol.for("react.provider"),ED=Symbol.for("react.context"),WS=Symbol.for("react.forward_ref"),Pb=Symbol.for("react.suspense"),Mb=Symbol.for("react.suspense_list"),VS=Symbol.for("react.memo"),ps=Symbol.for("react.lazy"),ND=Symbol.for("react.offscreen"),DT=Symbol.iterator;function Uc(t){return t===null||typeof t!="object"?null:(t=DT&&t[DT]||t["@@iterator"],typeof t=="function"?t:null)}var Mt=Object.assign,mx;function df(t){if(mx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);mx=e&&e[1]||""}return`
`+mx+t}var gx=!1;function yx(t,e){if(!t||gx)return"";gx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var o=u.stack.split(`
`),i=r.stack.split(`
`),s=o.length-1,a=i.length-1;1<=s&&0<=a&&o[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==i[a]){if(s!==1||a!==1)do if(s--,a--,0>a||o[s]!==i[a]){var l=`
`+o[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{gx=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?df(t):""}function mU(t){switch(t.tag){case 5:return df(t.type);case 16:return df("Lazy");case 13:return df("Suspense");case 19:return df("SuspenseList");case 0:case 2:case 15:return t=yx(t.type,!1),t;case 11:return t=yx(t.type.render,!1),t;case 1:return t=yx(t.type,!0),t;default:return""}}function Fb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Hl:return"Fragment";case Gl:return"Portal";case Rb:return"Profiler";case jS:return"StrictMode";case Pb:return"Suspense";case Mb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ED:return(t.displayName||"Context")+".Consumer";case TD:return(t._context.displayName||"Context")+".Provider";case WS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case VS:return e=t.displayName||null,e!==null?e:Fb(t.type)||"Memo";case ps:e=t._payload,t=t._init;try{return Fb(t(e))}catch{}}return null}function gU(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fb(e);case 8:return e===jS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ws(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function AD(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yU(t){var e=AD(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(s){r=""+s,i.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Rp(t){t._valueTracker||(t._valueTracker=yU(t))}function OD(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=AD(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Bm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Lb(t,e){var n=e.checked;return Mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function RT(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ws(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _D(t,e){e=e.checked,e!=null&&zS(t,"checked",e,!1)}function Bb(t,e){_D(t,e);var n=Ws(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?zb(t,e.type,n):e.hasOwnProperty("defaultValue")&&zb(t,e.type,Ws(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function PT(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function zb(t,e,n){(e!=="number"||Bm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var pf=Array.isArray;function au(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ws(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function jb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ue(91));return Mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function MT(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ue(92));if(pf(n)){if(1<n.length)throw Error(ue(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ws(n)}}function DD(t,e){var n=Ws(e.value),r=Ws(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function FT(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function RD(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?RD(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Pp,PD=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Pp=Pp||document.createElement("div"),Pp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Pp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function jf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Cf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vU=["Webkit","ms","Moz","O"];Object.keys(Cf).forEach(function(t){vU.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Cf[e]=Cf[t]})});function MD(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Cf.hasOwnProperty(t)&&Cf[t]?(""+e).trim():e+"px"}function FD(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=MD(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var xU=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vb(t,e){if(e){if(xU[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ue(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ue(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ue(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ue(62))}}function Ub(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gb=null;function US(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hb=null,lu=null,uu=null;function LT(t){if(t=Jh(t)){if(typeof Hb!="function")throw Error(ue(280));var e=t.stateNode;e&&(e=Wy(e),Hb(t.stateNode,t.type,e))}}function LD(t){lu?uu?uu.push(t):uu=[t]:lu=t}function BD(){if(lu){var t=lu,e=uu;if(uu=lu=null,LT(t),e)for(t=0;t<e.length;t++)LT(e[t])}}function zD(t,e){return t(e)}function jD(){}var vx=!1;function WD(t,e,n){if(vx)return t(e,n);vx=!0;try{return zD(t,e,n)}finally{vx=!1,(lu!==null||uu!==null)&&(jD(),BD())}}function Wf(t,e){var n=t.stateNode;if(n===null)return null;var r=Wy(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ue(231,e,typeof n));return n}var Kb=!1;if(Ui)try{var Gc={};Object.defineProperty(Gc,"passive",{get:function(){Kb=!0}}),window.addEventListener("test",Gc,Gc),window.removeEventListener("test",Gc,Gc)}catch{Kb=!1}function bU(t,e,n,r,o,i,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var kf=!1,zm=null,jm=!1,qb=null,wU={onError:function(t){kf=!0,zm=t}};function SU(t,e,n,r,o,i,s,a,l){kf=!1,zm=null,bU.apply(wU,arguments)}function $U(t,e,n,r,o,i,s,a,l){if(SU.apply(this,arguments),kf){if(kf){var u=zm;kf=!1,zm=null}else throw Error(ue(198));jm||(jm=!0,qb=u)}}function pl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function VD(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function BT(t){if(pl(t)!==t)throw Error(ue(188))}function CU(t){var e=t.alternate;if(!e){if(e=pl(t),e===null)throw Error(ue(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return BT(o),t;if(i===r)return BT(o),e;i=i.sibling}throw Error(ue(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s){for(a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s)throw Error(ue(189))}}if(n.alternate!==r)throw Error(ue(190))}if(n.tag!==3)throw Error(ue(188));return n.stateNode.current===n?t:e}function UD(t){return t=CU(t),t!==null?GD(t):null}function GD(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=GD(t);if(e!==null)return e;t=t.sibling}return null}var HD=Br.unstable_scheduleCallback,zT=Br.unstable_cancelCallback,kU=Br.unstable_shouldYield,IU=Br.unstable_requestPaint,Gt=Br.unstable_now,TU=Br.unstable_getCurrentPriorityLevel,GS=Br.unstable_ImmediatePriority,KD=Br.unstable_UserBlockingPriority,Wm=Br.unstable_NormalPriority,EU=Br.unstable_LowPriority,qD=Br.unstable_IdlePriority,Ly=null,ui=null;function NU(t){if(ui&&typeof ui.onCommitFiberRoot=="function")try{ui.onCommitFiberRoot(Ly,t,void 0,(t.current.flags&128)===128)}catch{}}var zo=Math.clz32?Math.clz32:_U,AU=Math.log,OU=Math.LN2;function _U(t){return t>>>=0,t===0?32:31-(AU(t)/OU|0)|0}var Mp=64,Fp=4194304;function mf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vm(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,i=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~o;a!==0?r=mf(a):(i&=s,i!==0&&(r=mf(i)))}else s=n&~o,s!==0?r=mf(s):i!==0&&(r=mf(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,i=e&-e,o>=i||o===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-zo(e),o=1<<n,r|=t[n],e&=~o;return r}function DU(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RU(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,i=t.pendingLanes;0<i;){var s=31-zo(i),a=1<<s,l=o[s];l===-1?(!(a&n)||a&r)&&(o[s]=DU(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Xb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function XD(){var t=Mp;return Mp<<=1,!(Mp&4194240)&&(Mp=64),t}function xx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Qh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-zo(e),t[e]=n}function PU(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-zo(n),i=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~i}}function HS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-zo(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var st=0;function YD(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var QD,KS,ZD,JD,eR,Yb=!1,Lp=[],Es=null,Ns=null,As=null,Vf=new Map,Uf=new Map,vs=[],MU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jT(t,e){switch(t){case"focusin":case"focusout":Es=null;break;case"dragenter":case"dragleave":Ns=null;break;case"mouseover":case"mouseout":As=null;break;case"pointerover":case"pointerout":Vf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uf.delete(e.pointerId)}}function Hc(t,e,n,r,o,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},e!==null&&(e=Jh(e),e!==null&&KS(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function FU(t,e,n,r,o){switch(e){case"focusin":return Es=Hc(Es,t,e,n,r,o),!0;case"dragenter":return Ns=Hc(Ns,t,e,n,r,o),!0;case"mouseover":return As=Hc(As,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return Vf.set(i,Hc(Vf.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Uf.set(i,Hc(Uf.get(i)||null,t,e,n,r,o)),!0}return!1}function tR(t){var e=Ta(t.target);if(e!==null){var n=pl(e);if(n!==null){if(e=n.tag,e===13){if(e=VD(n),e!==null){t.blockedOn=e,eR(t.priority,function(){ZD(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function km(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Qb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Gb=r,n.target.dispatchEvent(r),Gb=null}else return e=Jh(n),e!==null&&KS(e),t.blockedOn=n,!1;e.shift()}return!0}function WT(t,e,n){km(t)&&n.delete(e)}function LU(){Yb=!1,Es!==null&&km(Es)&&(Es=null),Ns!==null&&km(Ns)&&(Ns=null),As!==null&&km(As)&&(As=null),Vf.forEach(WT),Uf.forEach(WT)}function Kc(t,e){t.blockedOn===e&&(t.blockedOn=null,Yb||(Yb=!0,Br.unstable_scheduleCallback(Br.unstable_NormalPriority,LU)))}function Gf(t){function e(o){return Kc(o,t)}if(0<Lp.length){Kc(Lp[0],t);for(var n=1;n<Lp.length;n++){var r=Lp[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Es!==null&&Kc(Es,t),Ns!==null&&Kc(Ns,t),As!==null&&Kc(As,t),Vf.forEach(e),Uf.forEach(e),n=0;n<vs.length;n++)r=vs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<vs.length&&(n=vs[0],n.blockedOn===null);)tR(n),n.blockedOn===null&&vs.shift()}var cu=ns.ReactCurrentBatchConfig,Um=!0;function BU(t,e,n,r){var o=st,i=cu.transition;cu.transition=null;try{st=1,qS(t,e,n,r)}finally{st=o,cu.transition=i}}function zU(t,e,n,r){var o=st,i=cu.transition;cu.transition=null;try{st=4,qS(t,e,n,r)}finally{st=o,cu.transition=i}}function qS(t,e,n,r){if(Um){var o=Qb(t,e,n,r);if(o===null)Nx(t,e,r,Gm,n),jT(t,r);else if(FU(o,t,e,n,r))r.stopPropagation();else if(jT(t,r),e&4&&-1<MU.indexOf(t)){for(;o!==null;){var i=Jh(o);if(i!==null&&QD(i),i=Qb(t,e,n,r),i===null&&Nx(t,e,r,Gm,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else Nx(t,e,r,null,n)}}var Gm=null;function Qb(t,e,n,r){if(Gm=null,t=US(r),t=Ta(t),t!==null)if(e=pl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=VD(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Gm=t,null}function nR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(TU()){case GS:return 1;case KD:return 4;case Wm:case EU:return 16;case qD:return 536870912;default:return 16}default:return 16}}var ws=null,XS=null,Im=null;function rR(){if(Im)return Im;var t,e=XS,n=e.length,r,o="value"in ws?ws.value:ws.textContent,i=o.length;for(t=0;t<n&&e[t]===o[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===o[i-r];r++);return Im=o.slice(t,1<r?1-r:void 0)}function Tm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Bp(){return!0}function VT(){return!1}function Vr(t){function e(n,r,o,i,s){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Bp:VT,this.isPropagationStopped=VT,this}return Mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Bp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Bp)},persist:function(){},isPersistent:Bp}),e}var hc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},YS=Vr(hc),Zh=Mt({},hc,{view:0,detail:0}),jU=Vr(Zh),bx,wx,qc,By=Mt({},Zh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:QS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==qc&&(qc&&t.type==="mousemove"?(bx=t.screenX-qc.screenX,wx=t.screenY-qc.screenY):wx=bx=0,qc=t),bx)},movementY:function(t){return"movementY"in t?t.movementY:wx}}),UT=Vr(By),WU=Mt({},By,{dataTransfer:0}),VU=Vr(WU),UU=Mt({},Zh,{relatedTarget:0}),Sx=Vr(UU),GU=Mt({},hc,{animationName:0,elapsedTime:0,pseudoElement:0}),HU=Vr(GU),KU=Mt({},hc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),qU=Vr(KU),XU=Mt({},hc,{data:0}),GT=Vr(XU),YU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function JU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ZU[t])?!!e[t]:!1}function QS(){return JU}var eG=Mt({},Zh,{key:function(t){if(t.key){var e=YU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Tm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?QU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:QS,charCode:function(t){return t.type==="keypress"?Tm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Tm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),tG=Vr(eG),nG=Mt({},By,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),HT=Vr(nG),rG=Mt({},Zh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:QS}),oG=Vr(rG),iG=Mt({},hc,{propertyName:0,elapsedTime:0,pseudoElement:0}),sG=Vr(iG),aG=Mt({},By,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),lG=Vr(aG),uG=[9,13,27,32],ZS=Ui&&"CompositionEvent"in window,If=null;Ui&&"documentMode"in document&&(If=document.documentMode);var cG=Ui&&"TextEvent"in window&&!If,oR=Ui&&(!ZS||If&&8<If&&11>=If),KT=" ",qT=!1;function iR(t,e){switch(t){case"keyup":return uG.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Kl=!1;function fG(t,e){switch(t){case"compositionend":return sR(e);case"keypress":return e.which!==32?null:(qT=!0,KT);case"textInput":return t=e.data,t===KT&&qT?null:t;default:return null}}function hG(t,e){if(Kl)return t==="compositionend"||!ZS&&iR(t,e)?(t=rR(),Im=XS=ws=null,Kl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return oR&&e.locale!=="ko"?null:e.data;default:return null}}var dG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function XT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!dG[t.type]:e==="textarea"}function aR(t,e,n,r){LD(r),e=Hm(e,"onChange"),0<e.length&&(n=new YS("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Tf=null,Hf=null;function pG(t){vR(t,0)}function zy(t){var e=Yl(t);if(OD(e))return t}function mG(t,e){if(t==="change")return e}var lR=!1;if(Ui){var $x;if(Ui){var Cx="oninput"in document;if(!Cx){var YT=document.createElement("div");YT.setAttribute("oninput","return;"),Cx=typeof YT.oninput=="function"}$x=Cx}else $x=!1;lR=$x&&(!document.documentMode||9<document.documentMode)}function QT(){Tf&&(Tf.detachEvent("onpropertychange",uR),Hf=Tf=null)}function uR(t){if(t.propertyName==="value"&&zy(Hf)){var e=[];aR(e,Hf,t,US(t)),WD(pG,e)}}function gG(t,e,n){t==="focusin"?(QT(),Tf=e,Hf=n,Tf.attachEvent("onpropertychange",uR)):t==="focusout"&&QT()}function yG(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return zy(Hf)}function vG(t,e){if(t==="click")return zy(e)}function xG(t,e){if(t==="input"||t==="change")return zy(e)}function bG(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Go=typeof Object.is=="function"?Object.is:bG;function Kf(t,e){if(Go(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Db.call(e,o)||!Go(t[o],e[o]))return!1}return!0}function ZT(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function JT(t,e){var n=ZT(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ZT(n)}}function cR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?cR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function fR(){for(var t=window,e=Bm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Bm(t.document)}return e}function JS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function wG(t){var e=fR(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&cR(n.ownerDocument.documentElement,n)){if(r!==null&&JS(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!t.extend&&i>r&&(o=r,r=i,i=o),o=JT(n,i);var s=JT(n,r);o&&s&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var SG=Ui&&"documentMode"in document&&11>=document.documentMode,ql=null,Zb=null,Ef=null,Jb=!1;function e2(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jb||ql==null||ql!==Bm(r)||(r=ql,"selectionStart"in r&&JS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ef&&Kf(Ef,r)||(Ef=r,r=Hm(Zb,"onSelect"),0<r.length&&(e=new YS("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ql)))}function zp(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Xl={animationend:zp("Animation","AnimationEnd"),animationiteration:zp("Animation","AnimationIteration"),animationstart:zp("Animation","AnimationStart"),transitionend:zp("Transition","TransitionEnd")},kx={},hR={};Ui&&(hR=document.createElement("div").style,"AnimationEvent"in window||(delete Xl.animationend.animation,delete Xl.animationiteration.animation,delete Xl.animationstart.animation),"TransitionEvent"in window||delete Xl.transitionend.transition);function jy(t){if(kx[t])return kx[t];if(!Xl[t])return t;var e=Xl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in hR)return kx[t]=e[n];return t}var dR=jy("animationend"),pR=jy("animationiteration"),mR=jy("animationstart"),gR=jy("transitionend"),yR=new Map,t2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ys(t,e){yR.set(t,e),dl(e,[t])}for(var Ix=0;Ix<t2.length;Ix++){var Tx=t2[Ix],$G=Tx.toLowerCase(),CG=Tx[0].toUpperCase()+Tx.slice(1);Ys($G,"on"+CG)}Ys(dR,"onAnimationEnd");Ys(pR,"onAnimationIteration");Ys(mR,"onAnimationStart");Ys("dblclick","onDoubleClick");Ys("focusin","onFocus");Ys("focusout","onBlur");Ys(gR,"onTransitionEnd");$u("onMouseEnter",["mouseout","mouseover"]);$u("onMouseLeave",["mouseout","mouseover"]);$u("onPointerEnter",["pointerout","pointerover"]);$u("onPointerLeave",["pointerout","pointerover"]);dl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dl("onBeforeInput",["compositionend","keypress","textInput","paste"]);dl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kG=new Set("cancel close invalid load scroll toggle".split(" ").concat(gf));function n2(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,$U(r,e,void 0,t),t.currentTarget=null}function vR(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&o.isPropagationStopped())break e;n2(o,a,u),i=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&o.isPropagationStopped())break e;n2(o,a,u),i=l}}}if(jm)throw t=qb,jm=!1,qb=null,t}function St(t,e){var n=e[o1];n===void 0&&(n=e[o1]=new Set);var r=t+"__bubble";n.has(r)||(xR(e,t,2,!1),n.add(r))}function Ex(t,e,n){var r=0;e&&(r|=4),xR(n,t,r,e)}var jp="_reactListening"+Math.random().toString(36).slice(2);function qf(t){if(!t[jp]){t[jp]=!0,ID.forEach(function(n){n!=="selectionchange"&&(kG.has(n)||Ex(n,!1,t),Ex(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[jp]||(e[jp]=!0,Ex("selectionchange",!1,e))}}function xR(t,e,n,r){switch(nR(e)){case 1:var o=BU;break;case 4:o=zU;break;default:o=qS}n=o.bind(null,e,n,t),o=void 0,!Kb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function Nx(t,e,n,r,o){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===o||a.nodeType===8&&a.parentNode===o)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===o||l.nodeType===8&&l.parentNode===o))return;s=s.return}for(;a!==null;){if(s=Ta(a),s===null)return;if(l=s.tag,l===5||l===6){r=i=s;continue e}a=a.parentNode}}r=r.return}WD(function(){var u=i,c=US(n),f=[];e:{var h=yR.get(t);if(h!==void 0){var d=YS,p=t;switch(t){case"keypress":if(Tm(n)===0)break e;case"keydown":case"keyup":d=tG;break;case"focusin":p="focus",d=Sx;break;case"focusout":p="blur",d=Sx;break;case"beforeblur":case"afterblur":d=Sx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=UT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=VU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=oG;break;case dR:case pR:case mR:d=HU;break;case gR:d=sG;break;case"scroll":d=jU;break;case"wheel":d=lG;break;case"copy":case"cut":case"paste":d=qU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=HT}var m=(e&4)!==0,g=!m&&t==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var v=u,x;v!==null;){x=v;var b=x.stateNode;if(x.tag===5&&b!==null&&(x=b,y!==null&&(b=Wf(v,y),b!=null&&m.push(Xf(v,b,x)))),g)break;v=v.return}0<m.length&&(h=new d(h,p,null,n,c),f.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",h&&n!==Gb&&(p=n.relatedTarget||n.fromElement)&&(Ta(p)||p[Gi]))break e;if((d||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,d?(p=n.relatedTarget||n.toElement,d=u,p=p?Ta(p):null,p!==null&&(g=pl(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(d=null,p=u),d!==p)){if(m=UT,b="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=HT,b="onPointerLeave",y="onPointerEnter",v="pointer"),g=d==null?h:Yl(d),x=p==null?h:Yl(p),h=new m(b,v+"leave",d,n,c),h.target=g,h.relatedTarget=x,b=null,Ta(c)===u&&(m=new m(y,v+"enter",p,n,c),m.target=x,m.relatedTarget=g,b=m),g=b,d&&p)t:{for(m=d,y=p,v=0,x=m;x;x=Rl(x))v++;for(x=0,b=y;b;b=Rl(b))x++;for(;0<v-x;)m=Rl(m),v--;for(;0<x-v;)y=Rl(y),x--;for(;v--;){if(m===y||y!==null&&m===y.alternate)break t;m=Rl(m),y=Rl(y)}m=null}else m=null;d!==null&&r2(f,h,d,m,!1),p!==null&&g!==null&&r2(f,g,p,m,!0)}}e:{if(h=u?Yl(u):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var w=mG;else if(XT(h))if(lR)w=xG;else{w=yG;var S=gG}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=vG);if(w&&(w=w(t,u))){aR(f,w,n,c);break e}S&&S(t,h,u),t==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&zb(h,"number",h.value)}switch(S=u?Yl(u):window,t){case"focusin":(XT(S)||S.contentEditable==="true")&&(ql=S,Zb=u,Ef=null);break;case"focusout":Ef=Zb=ql=null;break;case"mousedown":Jb=!0;break;case"contextmenu":case"mouseup":case"dragend":Jb=!1,e2(f,n,c);break;case"selectionchange":if(SG)break;case"keydown":case"keyup":e2(f,n,c)}var $;if(ZS)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Kl?iR(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(oR&&n.locale!=="ko"&&(Kl||C!=="onCompositionStart"?C==="onCompositionEnd"&&Kl&&($=rR()):(ws=c,XS="value"in ws?ws.value:ws.textContent,Kl=!0)),S=Hm(u,C),0<S.length&&(C=new GT(C,t,null,n,c),f.push({event:C,listeners:S}),$?C.data=$:($=sR(n),$!==null&&(C.data=$)))),($=cG?fG(t,n):hG(t,n))&&(u=Hm(u,"onBeforeInput"),0<u.length&&(c=new GT("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:u}),c.data=$))}vR(f,e)})}function Xf(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hm(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Wf(t,n),i!=null&&r.unshift(Xf(t,i,o)),i=Wf(t,e),i!=null&&r.push(Xf(t,i,o))),t=t.return}return r}function Rl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function r2(t,e,n,r,o){for(var i=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,o?(l=Wf(n,i),l!=null&&s.unshift(Xf(n,l,a))):o||(l=Wf(n,i),l!=null&&s.push(Xf(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var IG=/\r\n?/g,TG=/\u0000|\uFFFD/g;function o2(t){return(typeof t=="string"?t:""+t).replace(IG,`
`).replace(TG,"")}function Wp(t,e,n){if(e=o2(e),o2(t)!==e&&n)throw Error(ue(425))}function Km(){}var e1=null,t1=null;function n1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var r1=typeof setTimeout=="function"?setTimeout:void 0,EG=typeof clearTimeout=="function"?clearTimeout:void 0,i2=typeof Promise=="function"?Promise:void 0,NG=typeof queueMicrotask=="function"?queueMicrotask:typeof i2<"u"?function(t){return i2.resolve(null).then(t).catch(AG)}:r1;function AG(t){setTimeout(function(){throw t})}function Ax(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),Gf(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Gf(e)}function Os(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function s2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var dc=Math.random().toString(36).slice(2),si="__reactFiber$"+dc,Yf="__reactProps$"+dc,Gi="__reactContainer$"+dc,o1="__reactEvents$"+dc,OG="__reactListeners$"+dc,_G="__reactHandles$"+dc;function Ta(t){var e=t[si];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Gi]||n[si]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=s2(t);t!==null;){if(n=t[si])return n;t=s2(t)}return e}t=n,n=t.parentNode}return null}function Jh(t){return t=t[si]||t[Gi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ue(33))}function Wy(t){return t[Yf]||null}var i1=[],Ql=-1;function Qs(t){return{current:t}}function kt(t){0>Ql||(t.current=i1[Ql],i1[Ql]=null,Ql--)}function vt(t,e){Ql++,i1[Ql]=t.current,t.current=e}var Vs={},Qn=Qs(Vs),br=Qs(!1),Ua=Vs;function Cu(t,e){var n=t.type.contextTypes;if(!n)return Vs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function wr(t){return t=t.childContextTypes,t!=null}function qm(){kt(br),kt(Qn)}function a2(t,e,n){if(Qn.current!==Vs)throw Error(ue(168));vt(Qn,e),vt(br,n)}function bR(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(ue(108,gU(t)||"Unknown",o));return Mt({},n,r)}function Xm(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vs,Ua=Qn.current,vt(Qn,t),vt(br,br.current),!0}function l2(t,e,n){var r=t.stateNode;if(!r)throw Error(ue(169));n?(t=bR(t,e,Ua),r.__reactInternalMemoizedMergedChildContext=t,kt(br),kt(Qn),vt(Qn,t)):kt(br),vt(br,n)}var Ei=null,Vy=!1,Ox=!1;function wR(t){Ei===null?Ei=[t]:Ei.push(t)}function DG(t){Vy=!0,wR(t)}function Zs(){if(!Ox&&Ei!==null){Ox=!0;var t=0,e=st;try{var n=Ei;for(st=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ei=null,Vy=!1}catch(o){throw Ei!==null&&(Ei=Ei.slice(t+1)),HD(GS,Zs),o}finally{st=e,Ox=!1}}return null}var Zl=[],Jl=0,Ym=null,Qm=0,Jr=[],eo=0,Ga=null,Oi=1,_i="";function va(t,e){Zl[Jl++]=Qm,Zl[Jl++]=Ym,Ym=t,Qm=e}function SR(t,e,n){Jr[eo++]=Oi,Jr[eo++]=_i,Jr[eo++]=Ga,Ga=t;var r=Oi;t=_i;var o=32-zo(r)-1;r&=~(1<<o),n+=1;var i=32-zo(e)+o;if(30<i){var s=o-o%5;i=(r&(1<<s)-1).toString(32),r>>=s,o-=s,Oi=1<<32-zo(e)+o|n<<o|r,_i=i+t}else Oi=1<<i|n<<o|r,_i=t}function e$(t){t.return!==null&&(va(t,1),SR(t,1,0))}function t$(t){for(;t===Ym;)Ym=Zl[--Jl],Zl[Jl]=null,Qm=Zl[--Jl],Zl[Jl]=null;for(;t===Ga;)Ga=Jr[--eo],Jr[eo]=null,_i=Jr[--eo],Jr[eo]=null,Oi=Jr[--eo],Jr[eo]=null}var Fr=null,Pr=null,Et=!1,_o=null;function $R(t,e){var n=no(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function u2(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Fr=t,Pr=Os(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Fr=t,Pr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ga!==null?{id:Oi,overflow:_i}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=no(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Fr=t,Pr=null,!0):!1;default:return!1}}function s1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function a1(t){if(Et){var e=Pr;if(e){var n=e;if(!u2(t,e)){if(s1(t))throw Error(ue(418));e=Os(n.nextSibling);var r=Fr;e&&u2(t,e)?$R(r,n):(t.flags=t.flags&-4097|2,Et=!1,Fr=t)}}else{if(s1(t))throw Error(ue(418));t.flags=t.flags&-4097|2,Et=!1,Fr=t}}}function c2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Fr=t}function Vp(t){if(t!==Fr)return!1;if(!Et)return c2(t),Et=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!n1(t.type,t.memoizedProps)),e&&(e=Pr)){if(s1(t))throw CR(),Error(ue(418));for(;e;)$R(t,e),e=Os(e.nextSibling)}if(c2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ue(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Pr=Os(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Pr=null}}else Pr=Fr?Os(t.stateNode.nextSibling):null;return!0}function CR(){for(var t=Pr;t;)t=Os(t.nextSibling)}function ku(){Pr=Fr=null,Et=!1}function n$(t){_o===null?_o=[t]:_o.push(t)}var RG=ns.ReactCurrentBatchConfig;function Xc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ue(309));var r=n.stateNode}if(!r)throw Error(ue(147,t));var o=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(s){var a=o.refs;s===null?delete a[i]:a[i]=s},e._stringRef=i,e)}if(typeof t!="string")throw Error(ue(284));if(!n._owner)throw Error(ue(290,t))}return t}function Up(t,e){throw t=Object.prototype.toString.call(e),Error(ue(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function f2(t){var e=t._init;return e(t._payload)}function kR(t){function e(y,v){if(t){var x=y.deletions;x===null?(y.deletions=[v],y.flags|=16):x.push(v)}}function n(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function r(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function o(y,v){return y=Ps(y,v),y.index=0,y.sibling=null,y}function i(y,v,x){return y.index=x,t?(x=y.alternate,x!==null?(x=x.index,x<v?(y.flags|=2,v):x):(y.flags|=2,v)):(y.flags|=1048576,v)}function s(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,v,x,b){return v===null||v.tag!==6?(v=Lx(x,y.mode,b),v.return=y,v):(v=o(v,x),v.return=y,v)}function l(y,v,x,b){var w=x.type;return w===Hl?c(y,v,x.props.children,b,x.key):v!==null&&(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===ps&&f2(w)===v.type)?(b=o(v,x.props),b.ref=Xc(y,v,x),b.return=y,b):(b=Rm(x.type,x.key,x.props,null,y.mode,b),b.ref=Xc(y,v,x),b.return=y,b)}function u(y,v,x,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=Bx(x,y.mode,b),v.return=y,v):(v=o(v,x.children||[]),v.return=y,v)}function c(y,v,x,b,w){return v===null||v.tag!==7?(v=La(x,y.mode,b,w),v.return=y,v):(v=o(v,x),v.return=y,v)}function f(y,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Lx(""+v,y.mode,x),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Dp:return x=Rm(v.type,v.key,v.props,null,y.mode,x),x.ref=Xc(y,null,v),x.return=y,x;case Gl:return v=Bx(v,y.mode,x),v.return=y,v;case ps:var b=v._init;return f(y,b(v._payload),x)}if(pf(v)||Uc(v))return v=La(v,y.mode,x,null),v.return=y,v;Up(y,v)}return null}function h(y,v,x,b){var w=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return w!==null?null:a(y,v,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Dp:return x.key===w?l(y,v,x,b):null;case Gl:return x.key===w?u(y,v,x,b):null;case ps:return w=x._init,h(y,v,w(x._payload),b)}if(pf(x)||Uc(x))return w!==null?null:c(y,v,x,b,null);Up(y,x)}return null}function d(y,v,x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(x)||null,a(v,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Dp:return y=y.get(b.key===null?x:b.key)||null,l(v,y,b,w);case Gl:return y=y.get(b.key===null?x:b.key)||null,u(v,y,b,w);case ps:var S=b._init;return d(y,v,x,S(b._payload),w)}if(pf(b)||Uc(b))return y=y.get(x)||null,c(v,y,b,w,null);Up(v,b)}return null}function p(y,v,x,b){for(var w=null,S=null,$=v,C=v=0,k=null;$!==null&&C<x.length;C++){$.index>C?(k=$,$=null):k=$.sibling;var I=h(y,$,x[C],b);if(I===null){$===null&&($=k);break}t&&$&&I.alternate===null&&e(y,$),v=i(I,v,C),S===null?w=I:S.sibling=I,S=I,$=k}if(C===x.length)return n(y,$),Et&&va(y,C),w;if($===null){for(;C<x.length;C++)$=f(y,x[C],b),$!==null&&(v=i($,v,C),S===null?w=$:S.sibling=$,S=$);return Et&&va(y,C),w}for($=r(y,$);C<x.length;C++)k=d($,y,C,x[C],b),k!==null&&(t&&k.alternate!==null&&$.delete(k.key===null?C:k.key),v=i(k,v,C),S===null?w=k:S.sibling=k,S=k);return t&&$.forEach(function(T){return e(y,T)}),Et&&va(y,C),w}function m(y,v,x,b){var w=Uc(x);if(typeof w!="function")throw Error(ue(150));if(x=w.call(x),x==null)throw Error(ue(151));for(var S=w=null,$=v,C=v=0,k=null,I=x.next();$!==null&&!I.done;C++,I=x.next()){$.index>C?(k=$,$=null):k=$.sibling;var T=h(y,$,I.value,b);if(T===null){$===null&&($=k);break}t&&$&&T.alternate===null&&e(y,$),v=i(T,v,C),S===null?w=T:S.sibling=T,S=T,$=k}if(I.done)return n(y,$),Et&&va(y,C),w;if($===null){for(;!I.done;C++,I=x.next())I=f(y,I.value,b),I!==null&&(v=i(I,v,C),S===null?w=I:S.sibling=I,S=I);return Et&&va(y,C),w}for($=r(y,$);!I.done;C++,I=x.next())I=d($,y,C,I.value,b),I!==null&&(t&&I.alternate!==null&&$.delete(I.key===null?C:I.key),v=i(I,v,C),S===null?w=I:S.sibling=I,S=I);return t&&$.forEach(function(N){return e(y,N)}),Et&&va(y,C),w}function g(y,v,x,b){if(typeof x=="object"&&x!==null&&x.type===Hl&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Dp:e:{for(var w=x.key,S=v;S!==null;){if(S.key===w){if(w=x.type,w===Hl){if(S.tag===7){n(y,S.sibling),v=o(S,x.props.children),v.return=y,y=v;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===ps&&f2(w)===S.type){n(y,S.sibling),v=o(S,x.props),v.ref=Xc(y,S,x),v.return=y,y=v;break e}n(y,S);break}else e(y,S);S=S.sibling}x.type===Hl?(v=La(x.props.children,y.mode,b,x.key),v.return=y,y=v):(b=Rm(x.type,x.key,x.props,null,y.mode,b),b.ref=Xc(y,v,x),b.return=y,y=b)}return s(y);case Gl:e:{for(S=x.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){n(y,v.sibling),v=o(v,x.children||[]),v.return=y,y=v;break e}else{n(y,v);break}else e(y,v);v=v.sibling}v=Bx(x,y.mode,b),v.return=y,y=v}return s(y);case ps:return S=x._init,g(y,v,S(x._payload),b)}if(pf(x))return p(y,v,x,b);if(Uc(x))return m(y,v,x,b);Up(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(n(y,v.sibling),v=o(v,x),v.return=y,y=v):(n(y,v),v=Lx(x,y.mode,b),v.return=y,y=v),s(y)):n(y,v)}return g}var Iu=kR(!0),IR=kR(!1),Zm=Qs(null),Jm=null,eu=null,r$=null;function o$(){r$=eu=Jm=null}function i$(t){var e=Zm.current;kt(Zm),t._currentValue=e}function l1(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function fu(t,e){Jm=t,r$=eu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(gr=!0),t.firstContext=null)}function ho(t){var e=t._currentValue;if(r$!==t)if(t={context:t,memoizedValue:e,next:null},eu===null){if(Jm===null)throw Error(ue(308));eu=t,Jm.dependencies={lanes:0,firstContext:t}}else eu=eu.next=t;return e}var Ea=null;function s$(t){Ea===null?Ea=[t]:Ea.push(t)}function TR(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,s$(e)):(n.next=o.next,o.next=n),e.interleaved=n,Hi(t,r)}function Hi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ms=!1;function a$(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ER(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Fi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _s(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ye&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,Hi(t,n)}return o=r.interleaved,o===null?(e.next=e,s$(r)):(e.next=o.next,o.next=e),r.interleaved=e,Hi(t,n)}function Em(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,HS(t,n)}}function h2(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=s:i=i.next=s,n=n.next}while(n!==null);i===null?o=i=e:i=i.next=e}else o=i=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function eg(t,e,n,r){var o=t.updateQueue;ms=!1;var i=o.firstBaseUpdate,s=o.lastBaseUpdate,a=o.shared.pending;if(a!==null){o.shared.pending=null;var l=a,u=l.next;l.next=null,s===null?i=u:s.next=u,s=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(i!==null){var f=o.baseState;s=0,c=u=l=null,a=i;do{var h=a.lane,d=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,d=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(d,f,h):p,h==null)break e;f=Mt({},f,h);break e;case 2:ms=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=o.effects,h===null?o.effects=[a]:h.push(a))}else d={eventTime:d,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=d,l=f):c=c.next=d,s|=h;if(a=a.next,a===null){if(a=o.shared.pending,a===null)break;h=a,a=h.next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}while(!0);if(c===null&&(l=f),o.baseState=l,o.firstBaseUpdate=u,o.lastBaseUpdate=c,e=o.shared.interleaved,e!==null){o=e;do s|=o.lane,o=o.next;while(o!==e)}else i===null&&(o.shared.lanes=0);Ka|=s,t.lanes=s,t.memoizedState=f}}function d2(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(ue(191,o));o.call(r)}}}var ed={},ci=Qs(ed),Qf=Qs(ed),Zf=Qs(ed);function Na(t){if(t===ed)throw Error(ue(174));return t}function l$(t,e){switch(vt(Zf,e),vt(Qf,t),vt(ci,ed),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Wb(e,t)}kt(ci),vt(ci,e)}function Tu(){kt(ci),kt(Qf),kt(Zf)}function NR(t){Na(Zf.current);var e=Na(ci.current),n=Wb(e,t.type);e!==n&&(vt(Qf,t),vt(ci,n))}function u$(t){Qf.current===t&&(kt(ci),kt(Qf))}var Rt=Qs(0);function tg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _x=[];function c$(){for(var t=0;t<_x.length;t++)_x[t]._workInProgressVersionPrimary=null;_x.length=0}var Nm=ns.ReactCurrentDispatcher,Dx=ns.ReactCurrentBatchConfig,Ha=0,Pt=null,un=null,vn=null,ng=!1,Nf=!1,Jf=0,PG=0;function zn(){throw Error(ue(321))}function f$(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Go(t[n],e[n]))return!1;return!0}function h$(t,e,n,r,o,i){if(Ha=i,Pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Nm.current=t===null||t.memoizedState===null?BG:zG,t=n(r,o),Nf){i=0;do{if(Nf=!1,Jf=0,25<=i)throw Error(ue(301));i+=1,vn=un=null,e.updateQueue=null,Nm.current=jG,t=n(r,o)}while(Nf)}if(Nm.current=rg,e=un!==null&&un.next!==null,Ha=0,vn=un=Pt=null,ng=!1,e)throw Error(ue(300));return t}function d$(){var t=Jf!==0;return Jf=0,t}function ei(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?Pt.memoizedState=vn=t:vn=vn.next=t,vn}function po(){if(un===null){var t=Pt.alternate;t=t!==null?t.memoizedState:null}else t=un.next;var e=vn===null?Pt.memoizedState:vn.next;if(e!==null)vn=e,un=t;else{if(t===null)throw Error(ue(310));un=t,t={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},vn===null?Pt.memoizedState=vn=t:vn=vn.next=t}return vn}function eh(t,e){return typeof e=="function"?e(t):e}function Rx(t){var e=po(),n=e.queue;if(n===null)throw Error(ue(311));n.lastRenderedReducer=t;var r=un,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var a=s=null,l=null,u=i;do{var c=u.lane;if((Ha&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,s=r):l=l.next=f,Pt.lanes|=c,Ka|=c}u=u.next}while(u!==null&&u!==i);l===null?s=r:l.next=a,Go(r,e.memoizedState)||(gr=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do i=o.lane,Pt.lanes|=i,Ka|=i,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Px(t){var e=po(),n=e.queue;if(n===null)throw Error(ue(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(o!==null){n.pending=null;var s=o=o.next;do i=t(i,s.action),s=s.next;while(s!==o);Go(i,e.memoizedState)||(gr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function AR(){}function OR(t,e){var n=Pt,r=po(),o=e(),i=!Go(r.memoizedState,o);if(i&&(r.memoizedState=o,gr=!0),r=r.queue,p$(RR.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||vn!==null&&vn.memoizedState.tag&1){if(n.flags|=2048,th(9,DR.bind(null,n,r,o,e),void 0,null),bn===null)throw Error(ue(349));Ha&30||_R(n,e,o)}return o}function _R(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Pt.updateQueue,e===null?(e={lastEffect:null,stores:null},Pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function DR(t,e,n,r){e.value=n,e.getSnapshot=r,PR(e)&&MR(t)}function RR(t,e,n){return n(function(){PR(e)&&MR(t)})}function PR(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Go(t,n)}catch{return!0}}function MR(t){var e=Hi(t,1);e!==null&&jo(e,t,1,-1)}function p2(t){var e=ei();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eh,lastRenderedState:t},e.queue=t,t=t.dispatch=LG.bind(null,Pt,t),[e.memoizedState,t]}function th(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Pt.updateQueue,e===null?(e={lastEffect:null,stores:null},Pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function FR(){return po().memoizedState}function Am(t,e,n,r){var o=ei();Pt.flags|=t,o.memoizedState=th(1|e,n,void 0,r===void 0?null:r)}function Uy(t,e,n,r){var o=po();r=r===void 0?null:r;var i=void 0;if(un!==null){var s=un.memoizedState;if(i=s.destroy,r!==null&&f$(r,s.deps)){o.memoizedState=th(e,n,i,r);return}}Pt.flags|=t,o.memoizedState=th(1|e,n,i,r)}function m2(t,e){return Am(8390656,8,t,e)}function p$(t,e){return Uy(2048,8,t,e)}function LR(t,e){return Uy(4,2,t,e)}function BR(t,e){return Uy(4,4,t,e)}function zR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function jR(t,e,n){return n=n!=null?n.concat([t]):null,Uy(4,4,zR.bind(null,e,t),n)}function m$(){}function WR(t,e){var n=po();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&f$(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function VR(t,e){var n=po();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&f$(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function UR(t,e,n){return Ha&21?(Go(n,e)||(n=XD(),Pt.lanes|=n,Ka|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,gr=!0),t.memoizedState=n)}function MG(t,e){var n=st;st=n!==0&&4>n?n:4,t(!0);var r=Dx.transition;Dx.transition={};try{t(!1),e()}finally{st=n,Dx.transition=r}}function GR(){return po().memoizedState}function FG(t,e,n){var r=Rs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},HR(t))KR(e,n);else if(n=TR(t,e,n,r),n!==null){var o=sr();jo(n,t,r,o),qR(n,e,r)}}function LG(t,e,n){var r=Rs(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(HR(t))KR(e,o);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var s=e.lastRenderedState,a=i(s,n);if(o.hasEagerState=!0,o.eagerState=a,Go(a,s)){var l=e.interleaved;l===null?(o.next=o,s$(e)):(o.next=l.next,l.next=o),e.interleaved=o;return}}catch{}finally{}n=TR(t,e,o,r),n!==null&&(o=sr(),jo(n,t,r,o),qR(n,e,r))}}function HR(t){var e=t.alternate;return t===Pt||e!==null&&e===Pt}function KR(t,e){Nf=ng=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function qR(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,HS(t,n)}}var rg={readContext:ho,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},BG={readContext:ho,useCallback:function(t,e){return ei().memoizedState=[t,e===void 0?null:e],t},useContext:ho,useEffect:m2,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Am(4194308,4,zR.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Am(4194308,4,t,e)},useInsertionEffect:function(t,e){return Am(4,2,t,e)},useMemo:function(t,e){var n=ei();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ei();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=FG.bind(null,Pt,t),[r.memoizedState,t]},useRef:function(t){var e=ei();return t={current:t},e.memoizedState=t},useState:p2,useDebugValue:m$,useDeferredValue:function(t){return ei().memoizedState=t},useTransition:function(){var t=p2(!1),e=t[0];return t=MG.bind(null,t[1]),ei().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Pt,o=ei();if(Et){if(n===void 0)throw Error(ue(407));n=n()}else{if(n=e(),bn===null)throw Error(ue(349));Ha&30||_R(r,e,n)}o.memoizedState=n;var i={value:n,getSnapshot:e};return o.queue=i,m2(RR.bind(null,r,i,t),[t]),r.flags|=2048,th(9,DR.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=ei(),e=bn.identifierPrefix;if(Et){var n=_i,r=Oi;n=(r&~(1<<32-zo(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Jf++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=PG++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zG={readContext:ho,useCallback:WR,useContext:ho,useEffect:p$,useImperativeHandle:jR,useInsertionEffect:LR,useLayoutEffect:BR,useMemo:VR,useReducer:Rx,useRef:FR,useState:function(){return Rx(eh)},useDebugValue:m$,useDeferredValue:function(t){var e=po();return UR(e,un.memoizedState,t)},useTransition:function(){var t=Rx(eh)[0],e=po().memoizedState;return[t,e]},useMutableSource:AR,useSyncExternalStore:OR,useId:GR,unstable_isNewReconciler:!1},jG={readContext:ho,useCallback:WR,useContext:ho,useEffect:p$,useImperativeHandle:jR,useInsertionEffect:LR,useLayoutEffect:BR,useMemo:VR,useReducer:Px,useRef:FR,useState:function(){return Px(eh)},useDebugValue:m$,useDeferredValue:function(t){var e=po();return un===null?e.memoizedState=t:UR(e,un.memoizedState,t)},useTransition:function(){var t=Px(eh)[0],e=po().memoizedState;return[t,e]},useMutableSource:AR,useSyncExternalStore:OR,useId:GR,unstable_isNewReconciler:!1};function Eo(t,e){if(t&&t.defaultProps){e=Mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function u1(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Gy={isMounted:function(t){return(t=t._reactInternals)?pl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=sr(),o=Rs(t),i=Fi(r,o);i.payload=e,n!=null&&(i.callback=n),e=_s(t,i,o),e!==null&&(jo(e,t,o,r),Em(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=sr(),o=Rs(t),i=Fi(r,o);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=_s(t,i,o),e!==null&&(jo(e,t,o,r),Em(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=sr(),r=Rs(t),o=Fi(n,r);o.tag=2,e!=null&&(o.callback=e),e=_s(t,o,r),e!==null&&(jo(e,t,r,n),Em(e,t,r))}};function g2(t,e,n,r,o,i,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,s):e.prototype&&e.prototype.isPureReactComponent?!Kf(n,r)||!Kf(o,i):!0}function XR(t,e,n){var r=!1,o=Vs,i=e.contextType;return typeof i=="object"&&i!==null?i=ho(i):(o=wr(e)?Ua:Qn.current,r=e.contextTypes,i=(r=r!=null)?Cu(t,o):Vs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gy,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function y2(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Gy.enqueueReplaceState(e,e.state,null)}function c1(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},a$(t);var i=e.contextType;typeof i=="object"&&i!==null?o.context=ho(i):(i=wr(e)?Ua:Qn.current,o.context=Cu(t,i)),o.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(u1(t,e,i,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&Gy.enqueueReplaceState(o,o.state,null),eg(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function Eu(t,e){try{var n="",r=e;do n+=mU(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:o,digest:null}}function Mx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function f1(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WG=typeof WeakMap=="function"?WeakMap:Map;function YR(t,e,n){n=Fi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ig||(ig=!0,w1=r),f1(t,e)},n}function QR(t,e,n){n=Fi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){f1(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){f1(t,e),typeof r!="function"&&(Ds===null?Ds=new Set([this]):Ds.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function v2(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WG;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=nH.bind(null,t,e,n),e.then(t,t))}function x2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function b2(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Fi(-1,1),e.tag=2,_s(n,e,1))),n.lanes|=1),t)}var VG=ns.ReactCurrentOwner,gr=!1;function tr(t,e,n,r){e.child=t===null?IR(e,null,n,r):Iu(e,t.child,n,r)}function w2(t,e,n,r,o){n=n.render;var i=e.ref;return fu(e,o),r=h$(t,e,n,r,i,o),n=d$(),t!==null&&!gr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,Ki(t,e,o)):(Et&&n&&e$(e),e.flags|=1,tr(t,e,r,o),e.child)}function S2(t,e,n,r,o){if(t===null){var i=n.type;return typeof i=="function"&&!$$(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,ZR(t,e,i,r,o)):(t=Rm(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&o)){var s=i.memoizedProps;if(n=n.compare,n=n!==null?n:Kf,n(s,r)&&t.ref===e.ref)return Ki(t,e,o)}return e.flags|=1,t=Ps(i,r),t.ref=e.ref,t.return=e,e.child=t}function ZR(t,e,n,r,o){if(t!==null){var i=t.memoizedProps;if(Kf(i,r)&&t.ref===e.ref)if(gr=!1,e.pendingProps=r=i,(t.lanes&o)!==0)t.flags&131072&&(gr=!0);else return e.lanes=t.lanes,Ki(t,e,o)}return h1(t,e,n,r,o)}function JR(t,e,n){var r=e.pendingProps,o=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(nu,Or),Or|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,vt(nu,Or),Or|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,vt(nu,Or),Or|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,vt(nu,Or),Or|=r;return tr(t,e,o,n),e.child}function eP(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function h1(t,e,n,r,o){var i=wr(n)?Ua:Qn.current;return i=Cu(e,i),fu(e,o),n=h$(t,e,n,r,i,o),r=d$(),t!==null&&!gr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,Ki(t,e,o)):(Et&&r&&e$(e),e.flags|=1,tr(t,e,n,o),e.child)}function $2(t,e,n,r,o){if(wr(n)){var i=!0;Xm(e)}else i=!1;if(fu(e,o),e.stateNode===null)Om(t,e),XR(e,n,r),c1(e,n,r,o),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=ho(u):(u=wr(n)?Ua:Qn.current,u=Cu(e,u));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==u)&&y2(e,s,r,u),ms=!1;var h=e.memoizedState;s.state=h,eg(e,r,s,o),l=e.memoizedState,a!==r||h!==l||br.current||ms?(typeof c=="function"&&(u1(e,n,c,r),l=e.memoizedState),(a=ms||g2(e,n,a,r,h,l,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,ER(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Eo(e.type,a),s.props=u,f=e.pendingProps,h=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=ho(l):(l=wr(n)?Ua:Qn.current,l=Cu(e,l));var d=n.getDerivedStateFromProps;(c=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==f||h!==l)&&y2(e,s,r,l),ms=!1,h=e.memoizedState,s.state=h,eg(e,r,s,o);var p=e.memoizedState;a!==f||h!==p||br.current||ms?(typeof d=="function"&&(u1(e,n,d,r),p=e.memoizedState),(u=ms||g2(e,n,u,r,h,p,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return d1(t,e,n,r,i,o)}function d1(t,e,n,r,o,i){eP(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return o&&l2(e,n,!1),Ki(t,e,i);r=e.stateNode,VG.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Iu(e,t.child,null,i),e.child=Iu(e,null,a,i)):tr(t,e,a,i),e.memoizedState=r.state,o&&l2(e,n,!0),e.child}function tP(t){var e=t.stateNode;e.pendingContext?a2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&a2(t,e.context,!1),l$(t,e.containerInfo)}function C2(t,e,n,r,o){return ku(),n$(o),e.flags|=256,tr(t,e,n,r),e.child}var p1={dehydrated:null,treeContext:null,retryLane:0};function m1(t){return{baseLanes:t,cachePool:null,transitions:null}}function nP(t,e,n){var r=e.pendingProps,o=Rt.current,i=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(o&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),vt(Rt,o&1),t===null)return a1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,i?(r=e.mode,i=e.child,s={mode:"hidden",children:s},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=qy(s,r,0,null),t=La(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=m1(n),e.memoizedState=p1,t):g$(e,s));if(o=t.memoizedState,o!==null&&(a=o.dehydrated,a!==null))return UG(t,e,s,r,a,o,n);if(i){i=r.fallback,s=e.mode,o=t.child,a=o.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ps(o,l),r.subtreeFlags=o.subtreeFlags&14680064),a!==null?i=Ps(a,i):(i=La(i,s,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,s=t.child.memoizedState,s=s===null?m1(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=t.childLanes&~n,e.memoizedState=p1,r}return i=t.child,t=i.sibling,r=Ps(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function g$(t,e){return e=qy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Gp(t,e,n,r){return r!==null&&n$(r),Iu(e,t.child,null,n),t=g$(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function UG(t,e,n,r,o,i,s){if(n)return e.flags&256?(e.flags&=-257,r=Mx(Error(ue(422))),Gp(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,o=e.mode,r=qy({mode:"visible",children:r.children},o,0,null),i=La(i,o,s,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Iu(e,t.child,null,s),e.child.memoizedState=m1(s),e.memoizedState=p1,i);if(!(e.mode&1))return Gp(t,e,s,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(ue(419)),r=Mx(i,r,void 0),Gp(t,e,s,r)}if(a=(s&t.childLanes)!==0,gr||a){if(r=bn,r!==null){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|s)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,Hi(t,o),jo(r,t,o,-1))}return S$(),r=Mx(Error(ue(421))),Gp(t,e,s,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=rH.bind(null,t),o._reactRetry=e,null):(t=i.treeContext,Pr=Os(o.nextSibling),Fr=e,Et=!0,_o=null,t!==null&&(Jr[eo++]=Oi,Jr[eo++]=_i,Jr[eo++]=Ga,Oi=t.id,_i=t.overflow,Ga=e),e=g$(e,r.children),e.flags|=4096,e)}function k2(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),l1(t.return,e,n)}function Fx(t,e,n,r,o){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function rP(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(tr(t,e,r.children,n),r=Rt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&k2(t,n,e);else if(t.tag===19)k2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(vt(Rt,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&tg(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),Fx(e,!1,o,n,i);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&tg(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}Fx(e,!0,n,null,i);break;case"together":Fx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Om(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ki(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ka|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ue(153));if(e.child!==null){for(t=e.child,n=Ps(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ps(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function GG(t,e,n){switch(e.tag){case 3:tP(e),ku();break;case 5:NR(e);break;case 1:wr(e.type)&&Xm(e);break;case 4:l$(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;vt(Zm,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(vt(Rt,Rt.current&1),e.flags|=128,null):n&e.child.childLanes?nP(t,e,n):(vt(Rt,Rt.current&1),t=Ki(t,e,n),t!==null?t.sibling:null);vt(Rt,Rt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return rP(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),vt(Rt,Rt.current),r)break;return null;case 22:case 23:return e.lanes=0,JR(t,e,n)}return Ki(t,e,n)}var oP,g1,iP,sP;oP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};g1=function(){};iP=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,Na(ci.current);var i=null;switch(n){case"input":o=Lb(t,o),r=Lb(t,r),i=[];break;case"select":o=Mt({},o,{value:void 0}),r=Mt({},r,{value:void 0}),i=[];break;case"textarea":o=jb(t,o),r=jb(t,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Km)}Vb(n,r);var s;n=null;for(u in o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&o[u]!=null)if(u==="style"){var a=o[u];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(zf.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(a=o!=null?o[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(zf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&St("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};sP=function(t,e,n,r){n!==r&&(e.flags|=4)};function Yc(t,e){if(!Et)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function jn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function HG(t,e,n){var r=e.pendingProps;switch(t$(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jn(e),null;case 1:return wr(e.type)&&qm(),jn(e),null;case 3:return r=e.stateNode,Tu(),kt(br),kt(Qn),c$(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Vp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,_o!==null&&(C1(_o),_o=null))),g1(t,e),jn(e),null;case 5:u$(e);var o=Na(Zf.current);if(n=e.type,t!==null&&e.stateNode!=null)iP(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ue(166));return jn(e),null}if(t=Na(ci.current),Vp(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[si]=e,r[Yf]=i,t=(e.mode&1)!==0,n){case"dialog":St("cancel",r),St("close",r);break;case"iframe":case"object":case"embed":St("load",r);break;case"video":case"audio":for(o=0;o<gf.length;o++)St(gf[o],r);break;case"source":St("error",r);break;case"img":case"image":case"link":St("error",r),St("load",r);break;case"details":St("toggle",r);break;case"input":RT(r,i),St("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},St("invalid",r);break;case"textarea":MT(r,i),St("invalid",r)}Vb(n,i),o=null;for(var s in i)if(i.hasOwnProperty(s)){var a=i[s];s==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Wp(r.textContent,a,t),o=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Wp(r.textContent,a,t),o=["children",""+a]):zf.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&St("scroll",r)}switch(n){case"input":Rp(r),PT(r,i,!0);break;case"textarea":Rp(r),FT(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Km)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=RD(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[si]=e,t[Yf]=r,oP(t,e,!1,!1),e.stateNode=t;e:{switch(s=Ub(n,r),n){case"dialog":St("cancel",t),St("close",t),o=r;break;case"iframe":case"object":case"embed":St("load",t),o=r;break;case"video":case"audio":for(o=0;o<gf.length;o++)St(gf[o],t);o=r;break;case"source":St("error",t),o=r;break;case"img":case"image":case"link":St("error",t),St("load",t),o=r;break;case"details":St("toggle",t),o=r;break;case"input":RT(t,r),o=Lb(t,r),St("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=Mt({},r,{value:void 0}),St("invalid",t);break;case"textarea":MT(t,r),o=jb(t,r),St("invalid",t);break;default:o=r}Vb(n,o),a=o;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?FD(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&PD(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&jf(t,l):typeof l=="number"&&jf(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(zf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&St("scroll",t):l!=null&&zS(t,i,l,s))}switch(n){case"input":Rp(t),PT(t,r,!1);break;case"textarea":Rp(t),FT(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ws(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?au(t,!!r.multiple,i,!1):r.defaultValue!=null&&au(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Km)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return jn(e),null;case 6:if(t&&e.stateNode!=null)sP(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ue(166));if(n=Na(Zf.current),Na(ci.current),Vp(e)){if(r=e.stateNode,n=e.memoizedProps,r[si]=e,(i=r.nodeValue!==n)&&(t=Fr,t!==null))switch(t.tag){case 3:Wp(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Wp(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[si]=e,e.stateNode=r}return jn(e),null;case 13:if(kt(Rt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Et&&Pr!==null&&e.mode&1&&!(e.flags&128))CR(),ku(),e.flags|=98560,i=!1;else if(i=Vp(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(ue(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ue(317));i[si]=e}else ku(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;jn(e),i=!1}else _o!==null&&(C1(_o),_o=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Rt.current&1?hn===0&&(hn=3):S$())),e.updateQueue!==null&&(e.flags|=4),jn(e),null);case 4:return Tu(),g1(t,e),t===null&&qf(e.stateNode.containerInfo),jn(e),null;case 10:return i$(e.type._context),jn(e),null;case 17:return wr(e.type)&&qm(),jn(e),null;case 19:if(kt(Rt),i=e.memoizedState,i===null)return jn(e),null;if(r=(e.flags&128)!==0,s=i.rendering,s===null)if(r)Yc(i,!1);else{if(hn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=tg(t),s!==null){for(e.flags|=128,Yc(i,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,t=s.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return vt(Rt,Rt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Gt()>Nu&&(e.flags|=128,r=!0,Yc(i,!1),e.lanes=4194304)}else{if(!r)if(t=tg(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Yc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!Et)return jn(e),null}else 2*Gt()-i.renderingStartTime>Nu&&n!==1073741824&&(e.flags|=128,r=!0,Yc(i,!1),e.lanes=4194304);i.isBackwards?(s.sibling=e.child,e.child=s):(n=i.last,n!==null?n.sibling=s:e.child=s,i.last=s)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Gt(),e.sibling=null,n=Rt.current,vt(Rt,r?n&1|2:n&1),e):(jn(e),null);case 22:case 23:return w$(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Or&1073741824&&(jn(e),e.subtreeFlags&6&&(e.flags|=8192)):jn(e),null;case 24:return null;case 25:return null}throw Error(ue(156,e.tag))}function KG(t,e){switch(t$(e),e.tag){case 1:return wr(e.type)&&qm(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Tu(),kt(br),kt(Qn),c$(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return u$(e),null;case 13:if(kt(Rt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ue(340));ku()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return kt(Rt),null;case 4:return Tu(),null;case 10:return i$(e.type._context),null;case 22:case 23:return w$(),null;case 24:return null;default:return null}}var Hp=!1,Gn=!1,qG=typeof WeakSet=="function"?WeakSet:Set,xe=null;function tu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ft(t,e,r)}else n.current=null}function y1(t,e,n){try{n()}catch(r){Ft(t,e,r)}}var I2=!1;function XG(t,e){if(e1=Um,t=fR(),JS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,u=0,c=0,f=t,h=null;t:for(;;){for(var d;f!==n||o!==0&&f.nodeType!==3||(a=s+o),f!==i||r!==0&&f.nodeType!==3||(l=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===t)break t;if(h===n&&++u===o&&(a=s),h===i&&++c===r&&(l=s),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(t1={focusedElem:t,selectionRange:n},Um=!1,xe=e;xe!==null;)if(e=xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,xe=t;else for(;xe!==null;){e=xe;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:Eo(e.type,m),g);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ue(163))}}catch(b){Ft(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,xe=t;break}xe=e.return}return p=I2,I2=!1,p}function Af(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var i=o.destroy;o.destroy=void 0,i!==void 0&&y1(e,n,i)}o=o.next}while(o!==r)}}function Hy(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function v1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function aP(t){var e=t.alternate;e!==null&&(t.alternate=null,aP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[si],delete e[Yf],delete e[o1],delete e[OG],delete e[_G])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function lP(t){return t.tag===5||t.tag===3||t.tag===4}function T2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function x1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Km));else if(r!==4&&(t=t.child,t!==null))for(x1(t,e,n),t=t.sibling;t!==null;)x1(t,e,n),t=t.sibling}function b1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(b1(t,e,n),t=t.sibling;t!==null;)b1(t,e,n),t=t.sibling}var Tn=null,No=!1;function ds(t,e,n){for(n=n.child;n!==null;)uP(t,e,n),n=n.sibling}function uP(t,e,n){if(ui&&typeof ui.onCommitFiberUnmount=="function")try{ui.onCommitFiberUnmount(Ly,n)}catch{}switch(n.tag){case 5:Gn||tu(n,e);case 6:var r=Tn,o=No;Tn=null,ds(t,e,n),Tn=r,No=o,Tn!==null&&(No?(t=Tn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Tn.removeChild(n.stateNode));break;case 18:Tn!==null&&(No?(t=Tn,n=n.stateNode,t.nodeType===8?Ax(t.parentNode,n):t.nodeType===1&&Ax(t,n),Gf(t)):Ax(Tn,n.stateNode));break;case 4:r=Tn,o=No,Tn=n.stateNode.containerInfo,No=!0,ds(t,e,n),Tn=r,No=o;break;case 0:case 11:case 14:case 15:if(!Gn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&y1(n,e,s),o=o.next}while(o!==r)}ds(t,e,n);break;case 1:if(!Gn&&(tu(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ft(n,e,a)}ds(t,e,n);break;case 21:ds(t,e,n);break;case 22:n.mode&1?(Gn=(r=Gn)||n.memoizedState!==null,ds(t,e,n),Gn=r):ds(t,e,n);break;default:ds(t,e,n)}}function E2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new qG),e.forEach(function(r){var o=oH.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Co(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:Tn=a.stateNode,No=!1;break e;case 3:Tn=a.stateNode.containerInfo,No=!0;break e;case 4:Tn=a.stateNode.containerInfo,No=!0;break e}a=a.return}if(Tn===null)throw Error(ue(160));uP(i,s,o),Tn=null,No=!1;var l=o.alternate;l!==null&&(l.return=null),o.return=null}catch(u){Ft(o,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)cP(e,t),e=e.sibling}function cP(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Co(e,t),Jo(t),r&4){try{Af(3,t,t.return),Hy(3,t)}catch(m){Ft(t,t.return,m)}try{Af(5,t,t.return)}catch(m){Ft(t,t.return,m)}}break;case 1:Co(e,t),Jo(t),r&512&&n!==null&&tu(n,n.return);break;case 5:if(Co(e,t),Jo(t),r&512&&n!==null&&tu(n,n.return),t.flags&32){var o=t.stateNode;try{jf(o,"")}catch(m){Ft(t,t.return,m)}}if(r&4&&(o=t.stateNode,o!=null)){var i=t.memoizedProps,s=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&_D(o,i),Ub(a,s);var u=Ub(a,i);for(s=0;s<l.length;s+=2){var c=l[s],f=l[s+1];c==="style"?FD(o,f):c==="dangerouslySetInnerHTML"?PD(o,f):c==="children"?jf(o,f):zS(o,c,f,u)}switch(a){case"input":Bb(o,i);break;case"textarea":DD(o,i);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var d=i.value;d!=null?au(o,!!i.multiple,d,!1):h!==!!i.multiple&&(i.defaultValue!=null?au(o,!!i.multiple,i.defaultValue,!0):au(o,!!i.multiple,i.multiple?[]:"",!1))}o[Yf]=i}catch(m){Ft(t,t.return,m)}}break;case 6:if(Co(e,t),Jo(t),r&4){if(t.stateNode===null)throw Error(ue(162));o=t.stateNode,i=t.memoizedProps;try{o.nodeValue=i}catch(m){Ft(t,t.return,m)}}break;case 3:if(Co(e,t),Jo(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Gf(e.containerInfo)}catch(m){Ft(t,t.return,m)}break;case 4:Co(e,t),Jo(t);break;case 13:Co(e,t),Jo(t),o=t.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(x$=Gt())),r&4&&E2(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Gn=(u=Gn)||c,Co(e,t),Gn=u):Co(e,t),Jo(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(xe=t,c=t.child;c!==null;){for(f=xe=c;xe!==null;){switch(h=xe,d=h.child,h.tag){case 0:case 11:case 14:case 15:Af(4,h,h.return);break;case 1:tu(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Ft(r,n,m)}}break;case 5:tu(h,h.return);break;case 22:if(h.memoizedState!==null){A2(f);continue}}d!==null?(d.return=h,xe=d):A2(f)}c=c.sibling}e:for(c=null,f=t;;){if(f.tag===5){if(c===null){c=f;try{o=f.stateNode,u?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=MD("display",s))}catch(m){Ft(t,t.return,m)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){Ft(t,t.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Co(e,t),Jo(t),r&4&&E2(t);break;case 21:break;default:Co(e,t),Jo(t)}}function Jo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(lP(n)){var r=n;break e}n=n.return}throw Error(ue(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(jf(o,""),r.flags&=-33);var i=T2(t);b1(t,i,o);break;case 3:case 4:var s=r.stateNode.containerInfo,a=T2(t);x1(t,a,s);break;default:throw Error(ue(161))}}catch(l){Ft(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function YG(t,e,n){xe=t,fP(t)}function fP(t,e,n){for(var r=(t.mode&1)!==0;xe!==null;){var o=xe,i=o.child;if(o.tag===22&&r){var s=o.memoizedState!==null||Hp;if(!s){var a=o.alternate,l=a!==null&&a.memoizedState!==null||Gn;a=Hp;var u=Gn;if(Hp=s,(Gn=l)&&!u)for(xe=o;xe!==null;)s=xe,l=s.child,s.tag===22&&s.memoizedState!==null?O2(o):l!==null?(l.return=s,xe=l):O2(o);for(;i!==null;)xe=i,fP(i),i=i.sibling;xe=o,Hp=a,Gn=u}N2(t)}else o.subtreeFlags&8772&&i!==null?(i.return=o,xe=i):N2(t)}}function N2(t){for(;xe!==null;){var e=xe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gn||Hy(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Gn)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:Eo(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&d2(e,i,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}d2(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Gf(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ue(163))}Gn||e.flags&512&&v1(e)}catch(h){Ft(e,e.return,h)}}if(e===t){xe=null;break}if(n=e.sibling,n!==null){n.return=e.return,xe=n;break}xe=e.return}}function A2(t){for(;xe!==null;){var e=xe;if(e===t){xe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,xe=n;break}xe=e.return}}function O2(t){for(;xe!==null;){var e=xe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Hy(4,e)}catch(l){Ft(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(l){Ft(e,o,l)}}var i=e.return;try{v1(e)}catch(l){Ft(e,i,l)}break;case 5:var s=e.return;try{v1(e)}catch(l){Ft(e,s,l)}}}catch(l){Ft(e,e.return,l)}if(e===t){xe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,xe=a;break}xe=e.return}}var QG=Math.ceil,og=ns.ReactCurrentDispatcher,y$=ns.ReactCurrentOwner,uo=ns.ReactCurrentBatchConfig,Ye=0,bn=null,Zt=null,Nn=0,Or=0,nu=Qs(0),hn=0,nh=null,Ka=0,Ky=0,v$=0,Of=null,pr=null,x$=0,Nu=1/0,Ti=null,ig=!1,w1=null,Ds=null,Kp=!1,Ss=null,sg=0,_f=0,S1=null,_m=-1,Dm=0;function sr(){return Ye&6?Gt():_m!==-1?_m:_m=Gt()}function Rs(t){return t.mode&1?Ye&2&&Nn!==0?Nn&-Nn:RG.transition!==null?(Dm===0&&(Dm=XD()),Dm):(t=st,t!==0||(t=window.event,t=t===void 0?16:nR(t.type)),t):1}function jo(t,e,n,r){if(50<_f)throw _f=0,S1=null,Error(ue(185));Qh(t,n,r),(!(Ye&2)||t!==bn)&&(t===bn&&(!(Ye&2)&&(Ky|=n),hn===4&&xs(t,Nn)),Sr(t,r),n===1&&Ye===0&&!(e.mode&1)&&(Nu=Gt()+500,Vy&&Zs()))}function Sr(t,e){var n=t.callbackNode;RU(t,e);var r=Vm(t,t===bn?Nn:0);if(r===0)n!==null&&zT(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&zT(n),e===1)t.tag===0?DG(_2.bind(null,t)):wR(_2.bind(null,t)),NG(function(){!(Ye&6)&&Zs()}),n=null;else{switch(YD(r)){case 1:n=GS;break;case 4:n=KD;break;case 16:n=Wm;break;case 536870912:n=qD;break;default:n=Wm}n=xP(n,hP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function hP(t,e){if(_m=-1,Dm=0,Ye&6)throw Error(ue(327));var n=t.callbackNode;if(hu()&&t.callbackNode!==n)return null;var r=Vm(t,t===bn?Nn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ag(t,r);else{e=r;var o=Ye;Ye|=2;var i=pP();(bn!==t||Nn!==e)&&(Ti=null,Nu=Gt()+500,Fa(t,e));do try{eH();break}catch(a){dP(t,a)}while(!0);o$(),og.current=i,Ye=o,Zt!==null?e=0:(bn=null,Nn=0,e=hn)}if(e!==0){if(e===2&&(o=Xb(t),o!==0&&(r=o,e=$1(t,o))),e===1)throw n=nh,Fa(t,0),xs(t,r),Sr(t,Gt()),n;if(e===6)xs(t,r);else{if(o=t.current.alternate,!(r&30)&&!ZG(o)&&(e=ag(t,r),e===2&&(i=Xb(t),i!==0&&(r=i,e=$1(t,i))),e===1))throw n=nh,Fa(t,0),xs(t,r),Sr(t,Gt()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(ue(345));case 2:xa(t,pr,Ti);break;case 3:if(xs(t,r),(r&130023424)===r&&(e=x$+500-Gt(),10<e)){if(Vm(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){sr(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=r1(xa.bind(null,t,pr,Ti),e);break}xa(t,pr,Ti);break;case 4:if(xs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var s=31-zo(r);i=1<<s,s=e[s],s>o&&(o=s),r&=~i}if(r=o,r=Gt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*QG(r/1960))-r,10<r){t.timeoutHandle=r1(xa.bind(null,t,pr,Ti),r);break}xa(t,pr,Ti);break;case 5:xa(t,pr,Ti);break;default:throw Error(ue(329))}}}return Sr(t,Gt()),t.callbackNode===n?hP.bind(null,t):null}function $1(t,e){var n=Of;return t.current.memoizedState.isDehydrated&&(Fa(t,e).flags|=256),t=ag(t,e),t!==2&&(e=pr,pr=n,e!==null&&C1(e)),t}function C1(t){pr===null?pr=t:pr.push.apply(pr,t)}function ZG(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!Go(i(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xs(t,e){for(e&=~v$,e&=~Ky,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-zo(e),r=1<<n;t[n]=-1,e&=~r}}function _2(t){if(Ye&6)throw Error(ue(327));hu();var e=Vm(t,0);if(!(e&1))return Sr(t,Gt()),null;var n=ag(t,e);if(t.tag!==0&&n===2){var r=Xb(t);r!==0&&(e=r,n=$1(t,r))}if(n===1)throw n=nh,Fa(t,0),xs(t,e),Sr(t,Gt()),n;if(n===6)throw Error(ue(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xa(t,pr,Ti),Sr(t,Gt()),null}function b$(t,e){var n=Ye;Ye|=1;try{return t(e)}finally{Ye=n,Ye===0&&(Nu=Gt()+500,Vy&&Zs())}}function qa(t){Ss!==null&&Ss.tag===0&&!(Ye&6)&&hu();var e=Ye;Ye|=1;var n=uo.transition,r=st;try{if(uo.transition=null,st=1,t)return t()}finally{st=r,uo.transition=n,Ye=e,!(Ye&6)&&Zs()}}function w$(){Or=nu.current,kt(nu)}function Fa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,EG(n)),Zt!==null)for(n=Zt.return;n!==null;){var r=n;switch(t$(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qm();break;case 3:Tu(),kt(br),kt(Qn),c$();break;case 5:u$(r);break;case 4:Tu();break;case 13:kt(Rt);break;case 19:kt(Rt);break;case 10:i$(r.type._context);break;case 22:case 23:w$()}n=n.return}if(bn=t,Zt=t=Ps(t.current,null),Nn=Or=e,hn=0,nh=null,v$=Ky=Ka=0,pr=Of=null,Ea!==null){for(e=0;e<Ea.length;e++)if(n=Ea[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var s=i.next;i.next=o,r.next=s}n.pending=r}Ea=null}return t}function dP(t,e){do{var n=Zt;try{if(o$(),Nm.current=rg,ng){for(var r=Pt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}ng=!1}if(Ha=0,vn=un=Pt=null,Nf=!1,Jf=0,y$.current=null,n===null||n.return===null){hn=1,nh=e,Zt=null;break}e:{var i=t,s=n.return,a=n,l=e;if(e=Nn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var d=x2(s);if(d!==null){d.flags&=-257,b2(d,s,a,i,e),d.mode&1&&v2(i,u,e),e=d,l=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){v2(i,u,e),S$();break e}l=Error(ue(426))}}else if(Et&&a.mode&1){var g=x2(s);if(g!==null){!(g.flags&65536)&&(g.flags|=256),b2(g,s,a,i,e),n$(Eu(l,a));break e}}i=l=Eu(l,a),hn!==4&&(hn=2),Of===null?Of=[i]:Of.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=YR(i,l,e);h2(i,y);break e;case 1:a=l;var v=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ds===null||!Ds.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=QR(i,a,e);h2(i,b);break e}}i=i.return}while(i!==null)}gP(n)}catch(w){e=w,Zt===n&&n!==null&&(Zt=n=n.return);continue}break}while(!0)}function pP(){var t=og.current;return og.current=rg,t===null?rg:t}function S$(){(hn===0||hn===3||hn===2)&&(hn=4),bn===null||!(Ka&268435455)&&!(Ky&268435455)||xs(bn,Nn)}function ag(t,e){var n=Ye;Ye|=2;var r=pP();(bn!==t||Nn!==e)&&(Ti=null,Fa(t,e));do try{JG();break}catch(o){dP(t,o)}while(!0);if(o$(),Ye=n,og.current=r,Zt!==null)throw Error(ue(261));return bn=null,Nn=0,hn}function JG(){for(;Zt!==null;)mP(Zt)}function eH(){for(;Zt!==null&&!kU();)mP(Zt)}function mP(t){var e=vP(t.alternate,t,Or);t.memoizedProps=t.pendingProps,e===null?gP(t):Zt=e,y$.current=null}function gP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=KG(n,e),n!==null){n.flags&=32767,Zt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{hn=6,Zt=null;return}}else if(n=HG(n,e,Or),n!==null){Zt=n;return}if(e=e.sibling,e!==null){Zt=e;return}Zt=e=t}while(e!==null);hn===0&&(hn=5)}function xa(t,e,n){var r=st,o=uo.transition;try{uo.transition=null,st=1,tH(t,e,n,r)}finally{uo.transition=o,st=r}return null}function tH(t,e,n,r){do hu();while(Ss!==null);if(Ye&6)throw Error(ue(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ue(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(PU(t,i),t===bn&&(Zt=bn=null,Nn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Kp||(Kp=!0,xP(Wm,function(){return hu(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=uo.transition,uo.transition=null;var s=st;st=1;var a=Ye;Ye|=4,y$.current=null,XG(t,n),cP(n,t),wG(t1),Um=!!e1,t1=e1=null,t.current=n,YG(n),IU(),Ye=a,st=s,uo.transition=i}else t.current=n;if(Kp&&(Kp=!1,Ss=t,sg=o),i=t.pendingLanes,i===0&&(Ds=null),NU(n.stateNode),Sr(t,Gt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(ig)throw ig=!1,t=w1,w1=null,t;return sg&1&&t.tag!==0&&hu(),i=t.pendingLanes,i&1?t===S1?_f++:(_f=0,S1=t):_f=0,Zs(),null}function hu(){if(Ss!==null){var t=YD(sg),e=uo.transition,n=st;try{if(uo.transition=null,st=16>t?16:t,Ss===null)var r=!1;else{if(t=Ss,Ss=null,sg=0,Ye&6)throw Error(ue(331));var o=Ye;for(Ye|=4,xe=t.current;xe!==null;){var i=xe,s=i.child;if(xe.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(xe=u;xe!==null;){var c=xe;switch(c.tag){case 0:case 11:case 15:Af(8,c,i)}var f=c.child;if(f!==null)f.return=c,xe=f;else for(;xe!==null;){c=xe;var h=c.sibling,d=c.return;if(aP(c),c===u){xe=null;break}if(h!==null){h.return=d,xe=h;break}xe=d}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}xe=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,xe=s;else e:for(;xe!==null;){if(i=xe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Af(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,xe=y;break e}xe=i.return}}var v=t.current;for(xe=v;xe!==null;){s=xe;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,xe=x;else e:for(s=v;xe!==null;){if(a=xe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Hy(9,a)}}catch(w){Ft(a,a.return,w)}if(a===s){xe=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,xe=b;break e}xe=a.return}}if(Ye=o,Zs(),ui&&typeof ui.onPostCommitFiberRoot=="function")try{ui.onPostCommitFiberRoot(Ly,t)}catch{}r=!0}return r}finally{st=n,uo.transition=e}}return!1}function D2(t,e,n){e=Eu(n,e),e=YR(t,e,1),t=_s(t,e,1),e=sr(),t!==null&&(Qh(t,1,e),Sr(t,e))}function Ft(t,e,n){if(t.tag===3)D2(t,t,n);else for(;e!==null;){if(e.tag===3){D2(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ds===null||!Ds.has(r))){t=Eu(n,t),t=QR(e,t,1),e=_s(e,t,1),t=sr(),e!==null&&(Qh(e,1,t),Sr(e,t));break}}e=e.return}}function nH(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=sr(),t.pingedLanes|=t.suspendedLanes&n,bn===t&&(Nn&n)===n&&(hn===4||hn===3&&(Nn&130023424)===Nn&&500>Gt()-x$?Fa(t,0):v$|=n),Sr(t,e)}function yP(t,e){e===0&&(t.mode&1?(e=Fp,Fp<<=1,!(Fp&130023424)&&(Fp=4194304)):e=1);var n=sr();t=Hi(t,e),t!==null&&(Qh(t,e,n),Sr(t,n))}function rH(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),yP(t,n)}function oH(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ue(314))}r!==null&&r.delete(e),yP(t,n)}var vP;vP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||br.current)gr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return gr=!1,GG(t,e,n);gr=!!(t.flags&131072)}else gr=!1,Et&&e.flags&1048576&&SR(e,Qm,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Om(t,e),t=e.pendingProps;var o=Cu(e,Qn.current);fu(e,n),o=h$(null,e,r,t,o,n);var i=d$();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wr(r)?(i=!0,Xm(e)):i=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,a$(e),o.updater=Gy,e.stateNode=o,o._reactInternals=e,c1(e,r,t,n),e=d1(null,e,r,!0,i,n)):(e.tag=0,Et&&i&&e$(e),tr(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Om(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=sH(r),t=Eo(r,t),o){case 0:e=h1(null,e,r,t,n);break e;case 1:e=$2(null,e,r,t,n);break e;case 11:e=w2(null,e,r,t,n);break e;case 14:e=S2(null,e,r,Eo(r.type,t),n);break e}throw Error(ue(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Eo(r,o),h1(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Eo(r,o),$2(t,e,r,o,n);case 3:e:{if(tP(e),t===null)throw Error(ue(387));r=e.pendingProps,i=e.memoizedState,o=i.element,ER(t,e),eg(e,r,null,n);var s=e.memoizedState;if(r=s.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){o=Eu(Error(ue(423)),e),e=C2(t,e,r,n,o);break e}else if(r!==o){o=Eu(Error(ue(424)),e),e=C2(t,e,r,n,o);break e}else for(Pr=Os(e.stateNode.containerInfo.firstChild),Fr=e,Et=!0,_o=null,n=IR(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ku(),r===o){e=Ki(t,e,n);break e}tr(t,e,r,n)}e=e.child}return e;case 5:return NR(e),t===null&&a1(e),r=e.type,o=e.pendingProps,i=t!==null?t.memoizedProps:null,s=o.children,n1(r,o)?s=null:i!==null&&n1(r,i)&&(e.flags|=32),eP(t,e),tr(t,e,s,n),e.child;case 6:return t===null&&a1(e),null;case 13:return nP(t,e,n);case 4:return l$(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Iu(e,null,r,n):tr(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Eo(r,o),w2(t,e,r,o,n);case 7:return tr(t,e,e.pendingProps,n),e.child;case 8:return tr(t,e,e.pendingProps.children,n),e.child;case 12:return tr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,i=e.memoizedProps,s=o.value,vt(Zm,r._currentValue),r._currentValue=s,i!==null)if(Go(i.value,s)){if(i.children===o.children&&!br.current){e=Ki(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){s=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Fi(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),l1(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)s=i.type===e.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(ue(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),l1(s,n,e),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===e){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}tr(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,fu(e,n),o=ho(o),r=r(o),e.flags|=1,tr(t,e,r,n),e.child;case 14:return r=e.type,o=Eo(r,e.pendingProps),o=Eo(r.type,o),S2(t,e,r,o,n);case 15:return ZR(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Eo(r,o),Om(t,e),e.tag=1,wr(r)?(t=!0,Xm(e)):t=!1,fu(e,n),XR(e,r,o),c1(e,r,o,n),d1(null,e,r,!0,t,n);case 19:return rP(t,e,n);case 22:return JR(t,e,n)}throw Error(ue(156,e.tag))};function xP(t,e){return HD(t,e)}function iH(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function no(t,e,n,r){return new iH(t,e,n,r)}function $$(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sH(t){if(typeof t=="function")return $$(t)?1:0;if(t!=null){if(t=t.$$typeof,t===WS)return 11;if(t===VS)return 14}return 2}function Ps(t,e){var n=t.alternate;return n===null?(n=no(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Rm(t,e,n,r,o,i){var s=2;if(r=t,typeof t=="function")$$(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Hl:return La(n.children,o,i,e);case jS:s=8,o|=8;break;case Rb:return t=no(12,n,e,o|2),t.elementType=Rb,t.lanes=i,t;case Pb:return t=no(13,n,e,o),t.elementType=Pb,t.lanes=i,t;case Mb:return t=no(19,n,e,o),t.elementType=Mb,t.lanes=i,t;case ND:return qy(n,o,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case TD:s=10;break e;case ED:s=9;break e;case WS:s=11;break e;case VS:s=14;break e;case ps:s=16,r=null;break e}throw Error(ue(130,t==null?t:typeof t,""))}return e=no(s,n,e,o),e.elementType=t,e.type=r,e.lanes=i,e}function La(t,e,n,r){return t=no(7,t,r,e),t.lanes=n,t}function qy(t,e,n,r){return t=no(22,t,r,e),t.elementType=ND,t.lanes=n,t.stateNode={isHidden:!1},t}function Lx(t,e,n){return t=no(6,t,null,e),t.lanes=n,t}function Bx(t,e,n){return e=no(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function aH(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xx(0),this.expirationTimes=xx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xx(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function C$(t,e,n,r,o,i,s,a,l){return t=new aH(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=no(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},a$(i),t}function lH(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function bP(t){if(!t)return Vs;t=t._reactInternals;e:{if(pl(t)!==t||t.tag!==1)throw Error(ue(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ue(171))}if(t.tag===1){var n=t.type;if(wr(n))return bR(t,n,e)}return e}function wP(t,e,n,r,o,i,s,a,l){return t=C$(n,r,!0,t,o,i,s,a,l),t.context=bP(null),n=t.current,r=sr(),o=Rs(n),i=Fi(r,o),i.callback=e??null,_s(n,i,o),t.current.lanes=o,Qh(t,o,r),Sr(t,r),t}function Xy(t,e,n,r){var o=e.current,i=sr(),s=Rs(o);return n=bP(n),e.context===null?e.context=n:e.pendingContext=n,e=Fi(i,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=_s(o,e,s),t!==null&&(jo(t,o,s,i),Em(t,o,s)),s}function lg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function R2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function k$(t,e){R2(t,e),(t=t.alternate)&&R2(t,e)}function uH(){return null}var SP=typeof reportError=="function"?reportError:function(t){console.error(t)};function I$(t){this._internalRoot=t}Yy.prototype.render=I$.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ue(409));Xy(t,e,null,null)};Yy.prototype.unmount=I$.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;qa(function(){Xy(null,t,null,null)}),e[Gi]=null}};function Yy(t){this._internalRoot=t}Yy.prototype.unstable_scheduleHydration=function(t){if(t){var e=JD();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vs.length&&e!==0&&e<vs[n].priority;n++);vs.splice(n,0,t),n===0&&tR(t)}};function T$(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Qy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function P2(){}function cH(t,e,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var u=lg(s);i.call(u)}}var s=wP(e,r,t,0,null,!1,!1,"",P2);return t._reactRootContainer=s,t[Gi]=s.current,qf(t.nodeType===8?t.parentNode:t),qa(),s}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var a=r;r=function(){var u=lg(l);a.call(u)}}var l=C$(t,0,!1,null,null,!1,!1,"",P2);return t._reactRootContainer=l,t[Gi]=l.current,qf(t.nodeType===8?t.parentNode:t),qa(function(){Xy(e,l,n,r)}),l}function Zy(t,e,n,r,o){var i=n._reactRootContainer;if(i){var s=i;if(typeof o=="function"){var a=o;o=function(){var l=lg(s);a.call(l)}}Xy(e,s,t,o)}else s=cH(n,e,t,o,r);return lg(s)}QD=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=mf(e.pendingLanes);n!==0&&(HS(e,n|1),Sr(e,Gt()),!(Ye&6)&&(Nu=Gt()+500,Zs()))}break;case 13:qa(function(){var r=Hi(t,1);if(r!==null){var o=sr();jo(r,t,1,o)}}),k$(t,1)}};KS=function(t){if(t.tag===13){var e=Hi(t,134217728);if(e!==null){var n=sr();jo(e,t,134217728,n)}k$(t,134217728)}};ZD=function(t){if(t.tag===13){var e=Rs(t),n=Hi(t,e);if(n!==null){var r=sr();jo(n,t,e,r)}k$(t,e)}};JD=function(){return st};eR=function(t,e){var n=st;try{return st=t,e()}finally{st=n}};Hb=function(t,e,n){switch(e){case"input":if(Bb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=Wy(r);if(!o)throw Error(ue(90));OD(r),Bb(r,o)}}}break;case"textarea":DD(t,n);break;case"select":e=n.value,e!=null&&au(t,!!n.multiple,e,!1)}};zD=b$;jD=qa;var fH={usingClientEntryPoint:!1,Events:[Jh,Yl,Wy,LD,BD,b$]},Qc={findFiberByHostInstance:Ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hH={bundleType:Qc.bundleType,version:Qc.version,rendererPackageName:Qc.rendererPackageName,rendererConfig:Qc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ns.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=UD(t),t===null?null:t.stateNode},findFiberByHostInstance:Qc.findFiberByHostInstance||uH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qp.isDisabled&&qp.supportsFiber)try{Ly=qp.inject(hH),ui=qp}catch{}}Wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fH;Wr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T$(e))throw Error(ue(200));return lH(t,e,null,n)};Wr.createRoot=function(t,e){if(!T$(t))throw Error(ue(299));var n=!1,r="",o=SP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=C$(t,1,!1,null,null,n,!1,r,o),t[Gi]=e.current,qf(t.nodeType===8?t.parentNode:t),new I$(e)};Wr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ue(188)):(t=Object.keys(t).join(","),Error(ue(268,t)));return t=UD(e),t=t===null?null:t.stateNode,t};Wr.flushSync=function(t){return qa(t)};Wr.hydrate=function(t,e,n){if(!Qy(e))throw Error(ue(200));return Zy(null,t,e,!0,n)};Wr.hydrateRoot=function(t,e,n){if(!T$(t))throw Error(ue(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",s=SP;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=wP(e,null,t,1,n??null,o,!1,i,s),t[Gi]=e.current,qf(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new Yy(e)};Wr.render=function(t,e,n){if(!Qy(e))throw Error(ue(200));return Zy(null,t,e,!1,n)};Wr.unmountComponentAtNode=function(t){if(!Qy(t))throw Error(ue(40));return t._reactRootContainer?(qa(function(){Zy(null,null,t,!1,function(){t._reactRootContainer=null,t[Gi]=null})}),!0):!1};Wr.unstable_batchedUpdates=b$;Wr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Qy(n))throw Error(ue(200));if(t==null||t._reactInternals===void 0)throw Error(ue(38));return Zy(t,e,n,!1,r)};Wr.version="18.3.1-next-f1338f8080-20240426";function $P(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($P)}catch(t){console.error(t)}}$P(),$D.exports=Wr;var dH=$D.exports,CP,M2=dH;CP=M2.createRoot,M2.hydrateRoot;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pH=1e-7,mH=1e-4;class kP{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class E${refCount(e){return dr("refCount")}incRef(e){return dr("incRef")}timerAvailable(){return!0}time(e){return dr("time")}read(e){return dr("read")}readSync(e){return dr("readSync")}readToGPU(e,n){return dr("readToGPU")}numDataIds(){return dr("numDataIds")}disposeData(e,n){return dr("disposeData")}write(e,n,r){return dr("write")}move(e,n,r,o,i){return dr("move")}createTensorFromGPUData(e,n,r){return dr("createTensorFromGPUData")}memory(){return dr("memory")}floatPrecision(){return dr("floatPrecision")}epsilon(){return this.floatPrecision()===32?pH:mH}dispose(){return dr("dispose")}}function dr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gH(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Wl(t,e,n)}function Xa(t,e,n){return Math.max(t,Math.min(e,n))}function N$(t){return t%2===0?t:t+1}function Wl(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function yH(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function E(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function A$(t,e,n=""){E(et(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function O$(t){E(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Q(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function et(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Au(t){return t%1===0}function k1(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function du(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function F2(t,e=o=>0,n,r){return new Promise((o,i)=>{let s=0;const a=()=>{if(t()){o();return}s++;const l=e(s);if(n!=null&&s>=n){i();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function IP(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const o=t.slice();return o[r]=e/n,o}function Fe(t,e){const n=e.length;return t=t==null?e.map((r,o)=>o):[].concat(t),E(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),E(t.every(r=>Au(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Js(t,e){const n=[],r=[],o=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||o?null:Fe(e,t).sort();let s=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[s]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[s]==null||i[s]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),i[s]<=a&&s++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function On(t,e){return Bt(t,e)}function Bt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function vH(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function xH(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function TP(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function ug(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function bH(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function td(t){return typeof t=="string"||t instanceof String}function wH(t){return typeof t=="boolean"}function I1(t){return typeof t=="number"}function pc(t){return Array.isArray(t)?pc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":I1(t)?"float32":td(t)?"string":wH(t)?"bool":"float32"}function T1(t){return!!(t&&t.constructor&&t.call&&t.apply)}function E1(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function ke(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function EP(t,e,n,r=!1){const o=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let s=0;s<i;s++)o[s]=n[t+s]}else{const i=e[0],s=e.slice(1),a=s.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<i;l++)o[l]=EP(t+l*a,s,n,r)}return o}function Wo(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((o,i)=>o*i)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return EP(0,t,e,n)}function SH(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function _$(t,e){const n=_n(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function _n(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function NP(t,e){const n=t.reduce((r,o)=>r*o,1);if(e==null||e==="float32")return Wo(t,new Float32Array(n));if(e==="int32")return Wo(t,new Int32Array(n));if(e==="bool")return Wo(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function rs(t){t.forEach(e=>{E(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function fi(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let o=0;o<t.length-1;++o)r+=n[o]*t[o];return r}function mc(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let o=0;o<r.length-1;++o)r[o]=Math.floor(t/n[o]),t-=r[o]*n[o];return r[r.length-1]=t,r}function D$(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L2="tfjsflags";class $H{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=CH,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(q().getBool("IS_TEST")||q().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const o=this.urlFlags[e];q().getBool("IS_TEST")||q().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${o}.`),this.set(e,o)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(D$(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);L2 in e&&e[L2].split(",").forEach(r=>{const[o,i]=r.split(":");this.urlFlags[o]=IH(o,i)})}}function CH(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(kH(e,r[0],r[1]),r.join("="))),e}function kH(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function IH(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function q(){return AP}let AP=null;function TH(t){AP=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zx;function OP(){if(zx==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");zx=t}return zx}function EH(){const t=OP();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function R$(t,e){const n=EH();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Jy="Abs",nd="Acos",rd="Acosh",gc="Add",P$="AddN",M$="All",F$="Any",ev="ArgMax",tv="ArgMin",od="Asin",id="Asinh",sd="Atan",ad="Atanh",ld="Atan2",nv="AvgPool",L$="AvgPoolGrad",rv="AvgPool3D",B$="AvgPool3DGrad",ov="BatchMatMul",iv="BatchToSpaceND",z$="Bincount",j$="BitwiseAnd",NH="BroadcastTo",_P="BroadcastArgs",ud="Cast",cd="Ceil",fd="ClipByValue",W$="Complex",sv="ComplexAbs",av="Concat",lv="Conv2D",V$="Conv2DBackpropFilter",uv="Conv2DBackpropInput",cv="Conv3D",U$="Conv3DBackpropFilterV2",G$="Conv3DBackpropInputV2",hd="Cos",dd="Cosh",H$="Cumprod",fv="Cumsum",K$="CropAndResize",q$="DenseBincount",X$="DepthToSpace",hv="DepthwiseConv2dNative",Y$="DepthwiseConv2dNativeBackpropFilter",Q$="DepthwiseConv2dNativeBackpropInput",DP="Diag",dv="Dilation2D",N1="Dilation2DBackpropInput",A1="Dilation2DBackpropFilter",AH="Draw",pd="RealDiv",Z$="Einsum",md="Elu",J$="EluGrad",gd="Erf",pv="Equal",yd="Exp",mv="ExpandDims",vd="Expm1",eC="FFT",tC="Fill",nC="FlipLeftRight",xd="Floor",bd="FloorDiv",gv="FusedBatchNorm",yv="GatherV2",RP="GatherNd",vv="Greater",wd="GreaterEqual",Sd="Identity",rC="IFFT",oC="Imag",$d="IsFinite",Cd="IsInf",kd="IsNan",xv="LeakyRelu",bv="Less",wv="LessEqual",PP="LinSpace",Id="Log",Td="Log1p",Sv="LogicalAnd",$v="LogicalNot",Cv="LogicalOr",OH="LogSoftmax",kv="LRN",iC="LRNGrad",Iv="Max",Ed="Maximum",Tv="MaxPool",sC="MaxPoolGrad",Ev="MaxPool3D",aC="MaxPool3DGrad",MP="MaxPoolWithArgmax",Nv="Mean",Av="Min",Nd="Minimum",Ov="MirrorPad",Ad="Mod",FP="Multinomial",Od="Multiply",_v="Neg",Dv="NotEqual",lC="NonMaxSuppressionV3",uC="NonMaxSuppressionV4",cC="NonMaxSuppressionV5",Rv="OnesLike",Pv="OneHot",Mv="Pack",Fv="PadV2",_d="Pow",Lv="Prelu",Bv="Prod",LP="RaggedGather",BP="RaggedRange",zP="RaggedTensorToTensor",fC="Range",hC="Real",Dd="Reciprocal",Rd="Relu",zv="Reshape",jv="ResizeNearestNeighbor",dC="ResizeNearestNeighborGrad",Wv="ResizeBilinear",pC="ResizeBilinearGrad",Pd="Relu6",Vv="Reverse",Md="Round",Fd="Rsqrt",jP="ScatterNd",WP="TensorScatterUpdate",VP="SearchSorted",Uv="Select",Ld="Selu",Gv="Slice",Bd="Sin",zd="Sinh",jd="Sign",Wd="Sigmoid",Vd="Softplus",Ud="Sqrt",Hv="Sum",Kv="SpaceToBatchND",qv="SplitV",Xv="Softmax",UP="SparseFillEmptyRows",GP="SparseReshape",HP="SparseSegmentMean",KP="SparseSegmentSum",qP="SparseToDense",Gd="SquaredDifference",mC="Square",gC="StaticRegexReplace",yC="StridedSlice",XP="StringNGrams",YP="StringSplit",QP="StringToHashBucketFast",Hd="Sub",Kd="Tan",qd="Tanh",Xd="Tile",vC="TopK",xC="Transform",pu="Transpose",bC="Unique",Yv="Unpack",Qv="UnsortedSegmentSum",Zv="ZerosLike",Yd="Step",_H="FromPixels",wC="RotateWithOffset",cg="_FusedMatMul",fg="FusedConv2D",ZP="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dr(...t){q().getBool("IS_TEST")||q().getBool("PROD")||console.warn(...t)}function DH(...t){q().getBool("IS_TEST")||q().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hg=R$("kernelRegistry",()=>new Map),O1=R$("gradRegistry",()=>new Map);function B2(t,e){const n=eM(t,e);return hg.get(n)}function z2(t){return O1.get(t)}function j2(t){const e=hg.entries(),n=[];for(;;){const{done:r,value:o}=e.next();if(r)break;const[i,s]=o,[a]=i.split("_");a===t&&n.push(s)}return n}function JP(t){const{kernelName:e,backendName:n}=t,r=eM(e,n);hg.has(r)&&Dr(`The kernel '${e}' for backend '${n}' is already registered`),hg.set(r,t)}function RH(t){const{kernelName:e}=t;O1.has(e)&&q().getBool("DEBUG")&&Dr(`Overriding the gradient for '${e}'`),O1.set(e,t)}function eM(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tM(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var nM=bt,ro=null;try{ro=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function bt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}bt.prototype.__isLong__;Object.defineProperty(bt.prototype,"__isLong__",{value:!0});function Ir(t){return(t&&t.__isLong__)===!0}bt.isLong=Ir;var W2={},V2={};function ml(t,e){var n,r,o;return e?(t>>>=0,(o=0<=t&&t<256)&&(r=V2[t],r)?r:(n=wt(t,(t|0)<0?-1:0,!0),o&&(V2[t]=n),n)):(t|=0,(o=-128<=t&&t<128)&&(r=W2[t],r)?r:(n=wt(t,t<0?-1:0,!1),o&&(W2[t]=n),n))}bt.fromInt=ml;function oo(t,e){if(isNaN(t))return e?Aa:io;if(e){if(t<0)return Aa;if(t>=rM)return sM}else{if(t<=-G2)return yr;if(t+1>=G2)return iM}return t<0?oo(-t,e).neg():wt(t%Ou|0,t/Ou|0,e)}bt.fromNumber=oo;function wt(t,e,n){return new bt(t,e,n)}bt.fromBits=wt;var dg=Math.pow;function SC(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return io;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return SC(t.substring(1),e,n).neg();for(var o=oo(dg(n,8)),i=io,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),l=parseInt(t.substring(s,s+a),n);if(a<8){var u=oo(dg(n,a));i=i.mul(u).add(oo(l))}else i=i.mul(o),i=i.add(oo(l))}return i.unsigned=e,i}bt.fromString=SC;function Xo(t,e){return typeof t=="number"?oo(t,e):typeof t=="string"?SC(t,e):wt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}bt.fromValue=Xo;var U2=65536,PH=1<<24,Ou=U2*U2,rM=Ou*Ou,G2=rM/2,H2=ml(PH),io=ml(0);bt.ZERO=io;var Aa=ml(0,!0);bt.UZERO=Aa;var ru=ml(1);bt.ONE=ru;var oM=ml(1,!0);bt.UONE=oM;var _1=ml(-1);bt.NEG_ONE=_1;var iM=wt(-1,2147483647,!1);bt.MAX_VALUE=iM;var sM=wt(-1,-1,!0);bt.MAX_UNSIGNED_VALUE=sM;var yr=wt(0,-2147483648,!1);bt.MIN_VALUE=yr;var de=bt.prototype;de.toInt=function(){return this.unsigned?this.low>>>0:this.low};de.toNumber=function(){return this.unsigned?(this.high>>>0)*Ou+(this.low>>>0):this.high*Ou+(this.low>>>0)};de.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(yr)){var n=oo(e),r=this.div(n),o=r.mul(n).sub(this);return r.toString(e)+o.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=oo(dg(e,6),this.unsigned),s=this,a="";;){var l=s.div(i),u=s.sub(l.mul(i)).toInt()>>>0,c=u.toString(e);if(s=l,s.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};de.getHighBits=function(){return this.high};de.getHighBitsUnsigned=function(){return this.high>>>0};de.getLowBits=function(){return this.low};de.getLowBitsUnsigned=function(){return this.low>>>0};de.getNumBitsAbs=function(){if(this.isNegative())return this.eq(yr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};de.isZero=function(){return this.high===0&&this.low===0};de.eqz=de.isZero;de.isNegative=function(){return!this.unsigned&&this.high<0};de.isPositive=function(){return this.unsigned||this.high>=0};de.isOdd=function(){return(this.low&1)===1};de.isEven=function(){return(this.low&1)===0};de.equals=function(e){return Ir(e)||(e=Xo(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};de.eq=de.equals;de.notEquals=function(e){return!this.eq(e)};de.neq=de.notEquals;de.ne=de.notEquals;de.lessThan=function(e){return this.comp(e)<0};de.lt=de.lessThan;de.lessThanOrEqual=function(e){return this.comp(e)<=0};de.lte=de.lessThanOrEqual;de.le=de.lessThanOrEqual;de.greaterThan=function(e){return this.comp(e)>0};de.gt=de.greaterThan;de.greaterThanOrEqual=function(e){return this.comp(e)>=0};de.gte=de.greaterThanOrEqual;de.ge=de.greaterThanOrEqual;de.compare=function(e){if(Ir(e)||(e=Xo(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};de.comp=de.compare;de.negate=function(){return!this.unsigned&&this.eq(yr)?yr:this.not().add(ru)};de.neg=de.negate;de.add=function(e){Ir(e)||(e=Xo(e));var n=this.high>>>16,r=this.high&65535,o=this.low>>>16,i=this.low&65535,s=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,f=0,h=0,d=0;return d+=i+u,h+=d>>>16,d&=65535,h+=o+l,f+=h>>>16,h&=65535,f+=r+a,c+=f>>>16,f&=65535,c+=n+s,c&=65535,wt(h<<16|d,c<<16|f,this.unsigned)};de.subtract=function(e){return Ir(e)||(e=Xo(e)),this.add(e.neg())};de.sub=de.subtract;de.multiply=function(e){if(this.isZero())return io;if(Ir(e)||(e=Xo(e)),ro){var n=ro.mul(this.low,this.high,e.low,e.high);return wt(n,ro.get_high(),this.unsigned)}if(e.isZero())return io;if(this.eq(yr))return e.isOdd()?yr:io;if(e.eq(yr))return this.isOdd()?yr:io;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(H2)&&e.lt(H2))return oo(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,o=this.high&65535,i=this.low>>>16,s=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,f=0,h=0,d=0,p=0;return p+=s*c,d+=p>>>16,p&=65535,d+=i*c,h+=d>>>16,d&=65535,d+=s*u,h+=d>>>16,d&=65535,h+=o*c,f+=h>>>16,h&=65535,h+=i*u,f+=h>>>16,h&=65535,h+=s*l,f+=h>>>16,h&=65535,f+=r*c+o*u+i*l+s*a,f&=65535,wt(d<<16|p,f<<16|h,this.unsigned)};de.mul=de.multiply;de.divide=function(e){if(Ir(e)||(e=Xo(e)),e.isZero())throw Error("division by zero");if(ro){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?ro.div_u:ro.div_s)(this.low,this.high,e.low,e.high);return wt(n,ro.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Aa:io;var r,o,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Aa;if(e.gt(this.shru(1)))return oM;i=Aa}else{if(this.eq(yr)){if(e.eq(ru)||e.eq(_1))return yr;if(e.eq(yr))return ru;var s=this.shr(1);return r=s.div(e).shl(1),r.eq(io)?e.isNegative()?ru:_1:(o=this.sub(e.mul(r)),i=r.add(o.div(e)),i)}else if(e.eq(yr))return this.unsigned?Aa:io;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=io}for(o=this;o.gte(e);){r=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:dg(2,a-48),u=oo(r),c=u.mul(e);c.isNegative()||c.gt(o);)r-=l,u=oo(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=ru),i=i.add(u),o=o.sub(c)}return i};de.div=de.divide;de.modulo=function(e){if(Ir(e)||(e=Xo(e)),ro){var n=(this.unsigned?ro.rem_u:ro.rem_s)(this.low,this.high,e.low,e.high);return wt(n,ro.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};de.mod=de.modulo;de.rem=de.modulo;de.not=function(){return wt(~this.low,~this.high,this.unsigned)};de.and=function(e){return Ir(e)||(e=Xo(e)),wt(this.low&e.low,this.high&e.high,this.unsigned)};de.or=function(e){return Ir(e)||(e=Xo(e)),wt(this.low|e.low,this.high|e.high,this.unsigned)};de.xor=function(e){return Ir(e)||(e=Xo(e)),wt(this.low^e.low,this.high^e.high,this.unsigned)};de.shiftLeft=function(e){return Ir(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?wt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):wt(0,this.low<<e-32,this.unsigned)};de.shl=de.shiftLeft;de.shiftRight=function(e){return Ir(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?wt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):wt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};de.shr=de.shiftRight;de.shiftRightUnsigned=function(e){if(Ir(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return wt(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?wt(n,0,this.unsigned):wt(n>>>e-32,0,this.unsigned)};de.shru=de.shiftRightUnsigned;de.shr_u=de.shiftRightUnsigned;de.toSigned=function(){return this.unsigned?wt(this.low,this.high,!1):this};de.toUnsigned=function(){return this.unsigned?this:wt(this.low,this.high,!0)};de.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};de.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};de.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};bt.fromBytes=function(e,n,r){return r?bt.fromBytesLE(e,n):bt.fromBytesBE(e,n)};bt.fromBytesLE=function(e,n){return new bt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};bt.fromBytesBE=function(e,n){return new bt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const aM=ft(nM),MH=zV({__proto__:null,default:aM},[nM]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ca=aM||MH;function Jv(t){return Ca.fromString(t,!0,16)}const lM=Jv("c3a5c85c97cb3127"),ba=Jv("b492b66fbe98f273"),Hn=Jv("9ae16a3b2f90404f");function D1(t){return t.xor(t.shru(47))}function uM(t,e,n){const r=t.slice(e,e+n);return Ca.fromBytes(Array.from(r),!0,!0)}function ht(t,e){return uM(t,e,8)}function K2(t,e){return uM(t,e,4)}function cn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Ms(t,e,n=Jv("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let o=e.xor(r).mul(n);return o=o.xor(o.shru(47)),o=o.mul(n),o}function FH(t,e,n,r,o,i){o=o.add(t),i=cn(i.add(o).add(r),21);const s=o;return o=o.add(e),o=o.add(n),i=i.add(cn(o,44)),[o.add(r),i.add(s)]}function Xp(t,e,n,r){return FH(ht(t,e),ht(t,e+8),ht(t,e+16),ht(t,e+24),n,r)}function LH(t,e=t.length){if(e>=8){const n=Hn.add(e*2),r=ht(t,0).add(Hn),o=ht(t,e-8),i=cn(o,37).mul(n).add(r),s=cn(r,25).add(o).mul(n);return Ms(i,s,n)}if(e>=4){const n=Hn.add(e*2),r=K2(t,0);return Ms(r.shl(3).add(e),K2(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],o=t[e-1],i=n+(r<<8),s=e+(o<<2);return D1(Hn.mul(i).xor(lM.mul(s))).mul(Hn)}return Hn}function BH(t,e=t.length){const n=Hn.add(e*2),r=ht(t,0).mul(ba),o=ht(t,8),i=ht(t,e-8).mul(n),s=ht(t,e-16).mul(Hn);return Ms(cn(r.add(o),43).add(cn(i,30)).add(s),r.add(cn(o.add(Hn),18)).add(i),n)}function zH(t,e=t.length){const n=Hn.add(e*2),r=ht(t,0).mul(Hn),o=ht(t,8),i=ht(t,e-8).mul(n),s=ht(t,e-16).mul(Hn),a=cn(r.add(o),43).add(cn(i,30)).add(s),l=Ms(a,r.add(cn(o.add(Hn),18)).add(i),n),u=ht(t,16).mul(n),c=ht(t,24),f=a.add(ht(t,e-32)).mul(n),h=l.add(ht(t,e-24)).mul(n);return Ms(cn(u.add(c),43).add(cn(f,30)).add(h),u.add(cn(c.add(r),18)).add(f),n)}function jH(t,e=t.length){const n=Ca.fromNumber(81,!0);if(e<=32)return e<=16?LH(t,e):BH(t,e);if(e<=64)return zH(t,e);let r=n,o=n.mul(ba).add(113),i=D1(o.mul(Hn).add(113)).mul(Hn),s=[Ca.UZERO,Ca.UZERO],a=[Ca.UZERO,Ca.UZERO];r=r.mul(Hn).add(ht(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=cn(r.add(o).add(s[0]).add(ht(t,l+8)),37).mul(ba),o=cn(o.add(s[1]).add(ht(t,l+48)),42).mul(ba),r=r.xor(a[1]),o=o.add(s[0]).add(ht(t,l+40)),i=cn(i.add(a[0]),33).mul(ba),s=Xp(t,l,s[1].mul(ba),r.add(a[0])),a=Xp(t,l+32,i.add(a[1]),o.add(ht(t,l+16))),[i,r]=[r,i],l+=64;while(l!==u);const f=ba.add(i.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),s[0]=s[0].add(a[0]),a[0]=a[0].add(s[0]),r=cn(r.add(o).add(s[0]).add(ht(t,l+8)),37).mul(f),o=cn(o.add(s[1]).add(ht(t,l+48)),42).mul(f),r=r.xor(a[1].mul(9)),o=o.add(s[0].mul(9).add(ht(t,l+40))),i=cn(i.add(a[0]),33).mul(f),s=Xp(t,l,s[1].mul(f),r.add(a[0])),a=Xp(t,l+32,i.add(a[1]),o.add(ht(t,l+16))),[i,r]=[r,i],Ms(Ms(s[0],a[0],f).add(D1(o).mul(lM)).add(i),Ms(s[1],a[1],f).add(r),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ea(t,e){return e==="string"?Fs(t):gl([t],e)}function WH(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function gl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Ya(t)),q().getBool("DEBUG")&&vH(t,e),WH(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function nr(){return q().platform.now()}function Fs(t,e="utf-8"){return e=e||"utf-8",q().platform.encode(t,e)}function Us(t,e="utf-8"){return e=e||"utf-8",q().platform.decode(t,e)}function mo(t){return q().platform.isTypedArray!=null?q().platform.isTypedArray(t):tM(t)}function Ya(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||D$(t)||t==null||mo(t)&&n)e.push(t);else if(Array.isArray(t)||mo(t))for(let r=0;r<t.length;++r)Ya(t[r],e,n);else{let r=-1;for(const o of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(o)&&(r=Math.max(r,Number(o)));for(let o=0;o<=r;o++)Ya(t[o],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VH{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new GH)}profileKernel(e,n,r){let o;const i=()=>{o=r()};let s;const a=nr();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(i);else{i();for(const u of o)u.dataSync();s=Promise.resolve({kernelMs:nr()-a})}if(q().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<o.length;u++){const c=o[u];c.data().then(f=>{UH(f,c.dtype,e)})}return{kernelName:e,outputs:o,inputs:n,timeMs:s.then(u=>u.kernelMs),extraInfo:s.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:o,inputs:i,extraInfo:s}=e;r.forEach(a=>{Promise.all([a.data(),o,s]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function UH(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const o=t[r];if(isNaN(o)||!isFinite(o))return console.warn(`Found ${o} in the result of '${n}'`),!0}return!1}class GH{logKernelProfile(e,n,r,o,i,s){const a=typeof o=="number"?du(`${o}ms`,9):o.error,l=du(e,25),u=n.rank,c=n.size,f=du(n.shape.toString(),14);let h="";for(const d in i){const p=i[d];if(p!=null){const m=p.shape||n.shape,g=m.length;h+=`${d}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${f}	%c${c}	%c${h}	%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HH(t,e,n){const r={},o={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const f in c){const h=c[f];let d=!1;for(let p=0;p<e.length;p++)if(r[h.id]){u.outputs.forEach(m=>r[m.id]=!0),d=!0,o[u.id]=!0;break}if(d)break}}const i={};i[n.id]=!0;const s={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let f=0;f<u.outputs.length;f++)if(i[u.outputs[f].id]){for(const h in c)i[c[h].id]=!0,s[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(o[u.id]&&s[u.id]){const c={};for(const h in u.inputs){const d=u.inputs[h];r[d.id]&&(c[h]=d)}const f=Object.assign({},u);f.inputs=c,f.outputs=u.outputs,a.push(f)}}return a}function KH(t,e,n,r){for(let o=e.length-1;o>=0;o--){const i=e[o],s=[];if(i.outputs.forEach(l=>{const u=t[l.id];u!=null?s.push(u):s.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(s);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=i.inputs[l];if(!et(u.shape,c.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const f=t[c.id];t[c.id]=r(f,u),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q2=20,Zc=3,jx=7;function qH(t,e,n,r){const o=ke(e),i=XH(t,e,n,o),s=e.length,a=Pm(t,e,n,o,i),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${s}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function XH(t,e,n,r){const o=Q(e),i=r[r.length-1],s=new Array(i).fill(0),a=e.length,l=n==="complex64"?vf(t):t;if(a>1)for(let u=0;u<o/i;u++){const c=u*i;for(let f=0;f<i;f++)s[f]=Math.max(s[f],yf(l[c+f],0,n).length)}return s}function yf(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(jx))} + ${parseFloat(t[1].toFixed(jx))}j`:td(t)?r=`'${t}'`:n==="bool"?r=cM(t):r=parseFloat(t.toFixed(jx)).toString(),du(r,e)}function cM(t){return t===0?"false":"true"}function Pm(t,e,n,r,o,i=!0){const s=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=vf(t);return[yf(m[0],0,n)]}return n==="bool"?[cM(t[0])]:[t[0].toString()]}if(l===1){if(a>q2){const g=Zc*s;let y=Array.from(t.slice(0,g)),v=Array.from(t.slice((a-Zc)*s,a*s));return n==="complex64"&&(y=vf(y),v=vf(v)),["["+y.map((x,b)=>yf(x,o[b],n)).join(", ")+", ..., "+v.map((x,b)=>yf(x,o[a-Zc+b],n)).join(", ")+"]"]}return["["+(n==="complex64"?vf(t):Array.from(t)).map((g,y)=>yf(g,o[y],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),f=r[0]*s,h=[];if(a>q2){for(let m=0;m<Zc;m++){const g=m*f,y=g+f;h.push(...Pm(t.slice(g,y),u,n,c,o,!1))}h.push("...");for(let m=a-Zc;m<a;m++){const g=m*f,y=g+f;h.push(...Pm(t.slice(g,y),u,n,c,o,m===a-1))}}else for(let m=0;m<a;m++){const g=m*f,y=g+f;h.push(...Pm(t.slice(g,y),u,n,c,o,m===a-1))}const d=l===2?",":"";h[0]="["+(a>0?h[0]+d:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+d;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":p),h}function vf(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wn{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=Q(e),r!=null){const o=r.length;E(o===this.size,()=>`Length of values '${o}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Bt(n,this.size),this.strides=ke(e)}set(e,...n){n.length===0&&(n=[0]),E(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const o of e){if(o<0||o>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let r=e[e.length-1];for(let o=0;o<e.length-1;++o)r+=this.strides[o]*e[o];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Do().makeTensor(this.values,this.shape,this.dtype)}}let Do=null,Vl=null;function YH(t){Do=t}function QH(t){Vl=t}class Qt{constructor(e,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Q(e),this.strides=ke(e),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Vl.buffer(this.shape,this.dtype,e)}bufferSync(){return Vl.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Wo(this.shape,e,this.dtype==="complex64")}arraySync(){return Wo(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Do().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>Us(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Do().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Do().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Us(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Do().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Do().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Vl.print(this,e)}clone(){return this.throwIfDisposed(),Vl.clone(this)}toString(e=!1){const n=this.dataSync();return qH(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Vl.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),Do().makeVariable(this,e,n,r)}}Object.defineProperty(Qt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function Y(){return R$("Tensor",()=>Qt)}Y();class pg extends Qt{constructor(e,n,r,o){super(e.shape,e.dtype,e.dataId,o),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!et(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Do().disposeTensor(this),this.dataId=e.dataId,Do().incRef(this,null)}dispose(){Do().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(pg,Symbol.hasInstance,{value:t=>t instanceof Qt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var X2;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(X2||(X2={}));var R1;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(R1||(R1={}));var P1;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(P1||(P1={}));var M1;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(M1||(M1={}));var F1;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(F1||(F1={}));const ZH={float32:M1,int32:R1,bool:P1,complex64:F1};function $r(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return ZH[t][e]}function $C(t){return $r(t,"int32")}function fM(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function hM(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jt(t,e){if(t.dtype===e.dtype)return[t,e];const n=$r(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function dM(t){const e=[];return pM(t,e,new Set),e}function pM(t,e,n){if(t==null)return;if(t instanceof Qt){e.push(t);return}if(!JH(t))return;const r=t;for(const o in r){const i=r[o];n.has(i)||(n.add(i),pM(i,e,n))}}function JH(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wx(t){return t.kernelName!=null}class Y2{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class _u{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Y2}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(Dr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new VH(this.backendInstance),!0}setupRegisteredKernels(){j2(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){j2(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof E$)&&typeof r.then=="function"){const o=++this.pendingBackendInitId,i=r.then(s=>o<this.pendingBackendInitId?!1:(this.registry[e]=s,this.pendingBackendInit=null,!0)).catch(s=>(o<this.pendingBackendInitId||(this.pendingBackendInit=null,Dr(`Initialization of backend ${e} failed`),Dr(s.stack||s.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Dr(`Initialization of backend ${e} failed`),Dr(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:o,asyncInit:i}=this.initializeBackend(r);if(i||o)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n),s=o.refCount(n);o.disposeData(n,!0),r.backend=e,e.move(n,i,r.shape,r.dtype,s),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let o;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(o),()=>(o=n(),o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),o))}scopedRun(e,n,r){e();try{const o=r();return n(),o}catch(o){throw n(),o}}nextTensorId(){return _u.nextTensorId++}nextVariableId(){return _u.nextVariableId++}clone(e){const n=j.runKernel(Sd,{x:e}),r={x:e},o=s=>({x:()=>{const a="float32",l={x:s},u={dtype:a};return j.runKernel(ud,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[n],o,i,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(B2(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const o=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=o-n-i-s;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const o=this.isTapeOn(),i=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=Wx(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Wx(e)){const{kernelName:p,inputs:m,attrs:g}=e;this.backendName==null&&this.backend;const y=B2(p,this.backendName);E(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const v=this.backend.numDataIds();l=y.kernelFunc({inputs:m,attrs:g,backend:this.backend});const x=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,v,x);const b=x.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(o){const w=this.getTensorsForGradient(p,m,b);r=this.saveTensorsForBackwardMode(w)}return b}}else{const{forwardFunc:p}=e,m=g=>{o&&(r=g.map(y=>this.keep(this.clone(y))))};a=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,g,y),y}}const{inputs:c,attrs:f}=e,h=Wx(e)?null:e.backwardsFunc;let d;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(d=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),n=d.outputs)}),o&&this.addTapeNode(u,c,n,h,r,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const o=z2(e);if(o!=null){const i=o.inputsToSave||[],s=o.outputsToSave||[];let a;o.saveAllInputs?(E(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=i.map(u=>n[u]);const l=r.filter((u,c)=>s[c]);return a.concat(l)}return[]}makeTensor(e,n,r,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;let i=e;r==="string"&&td(e[0])&&(i=e.map(l=>Fs(l)));const s=o.write(i,n,r),a=new Qt(n,r,s,this.nextTensorId());if(this.trackTensor(a,o),r==="string"){const l=this.state.tensorInfo.get(s),u=bH(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,r,o){r=r||"float32";const i={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(i,o)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:o,dtype:i}=e,s=new Qt(o,i,r,this.nextTensorId());return this.trackTensor(s,n),s}makeVariable(e,n=!0,r,o){r=r||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.cast(o));const i=new pg(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*ug(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof pg||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*ug(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(o=>o.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const o of this.state.activeProfile.kernels)o.kernelTimeMs=await o.kernelTimeMs,o.extraInfo=await o.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,o,i,s){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},l=z2(e);l!=null&&(o=l.gradFunc),o!=null&&(a.gradient=u=>(u=u.map((c,f)=>{if(c==null){const h=r[f],d=_n(h.size,h.dtype);return this.makeTensor(d,h.shape,h.dtype)}return c}),o(u.length>1?u:u[0],i,s))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=dM(e),r=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const s=this.state.activeScope.track[i];!s.kept&&!r.has(s.id)&&s.dispose()}const o=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===o.id&&this.track(i)})}gradients(e,n,r,o=!1){if(E(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));E(i instanceof Qt,()=>"The result y returned by f() must be a tensor.");const s=HH(this.state.activeTape,n,i);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=r??e6(i.shape),KH(a,s,u=>this.tidy(u),t6);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return E(T1(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{E(n.every(a=>a instanceof Qt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const o={};n.forEach((a,l)=>{o[l]=a});const i=(a,l)=>(r=e(...n,l),E(r.value instanceof Qt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),E(T1(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),s=(a,l)=>{const u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];E(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),E(c.every(h=>h instanceof Qt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return c.forEach((h,d)=>{f[d]=()=>h}),f};return this.runKernelFunc({forwardFunc:i,backwardsFunc:s,inputs:o})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=nr(),r=await this.backend.time(e);return r.wallMs=nr()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Y2;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}_u.nextTensorId=0;_u.nextVariableId=0;function e6(t){const e=_$(Q(t),"float32");return j.makeTensor(e,t,"float32")}function mM(){const t=OP();if(t._tfengine==null){const e=new $H(t);t._tfengine=new _u(e)}return TH(t._tfengine.ENV),YH(()=>t._tfengine),t._tfengine}const j=mM();function t6(t,e){const n={a:t,b:e};return j.runKernel(gc,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n6(){return typeof navigator<"u"&&navigator!=null}function gM(t){if(t||n6()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function yM(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lr=q();lr.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});lr.registerFlag("IS_BROWSER",()=>yM());lr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");lr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));lr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));lr.registerFlag("PROD",()=>!1);lr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>lr.getBool("DEBUG"));lr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);lr.registerFlag("IS_TEST",()=>!1);lr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>lr.getBool("DEBUG"));lr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);lr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);lr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qd(t,e){let n=t;if(mo(t))return e==="string"?[]:[t.length];if(fM(t)){const o=t.channels||"RGBA";return[t.height,t.width*o.length]}else if(hM(t))return[t.buffer.size/(e==null?4:ug(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||mo(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&q().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&vM(t,r,[]),r}function vM(t,e,n){if(n=n||[],!Array.isArray(t)&&!mo(t)){E(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}E(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),E(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let o=0;o<t.length;++o)vM(t[o],r,n.concat(o))}function Q2(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function M(t,e,n,r="numeric"){if(t instanceof Y())return Q2(r,t.dtype,e,n),t;let o=pc(t);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),Q2(r,o,e,n),t==null||!mo(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Qd(t,o);!mo(t)&&!Array.isArray(t)&&(t=[t]);const a=o!=="string"?gl(t,o):Ya(t,[],!0);return j.makeTensor(a,i,o)}function xM(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,s)=>M(i,`${e}[${s}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r6="__op";function G(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+r6;const o=(...i)=>{j.startScope(n);try{const s=r(...i);return D$(s)&&console.error("Cannot return a Promise inside of tidy."),j.endScope(s),s}catch(s){throw j.endScope(null),s}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6(t,e){const n=M(t,"real","complex"),r=M(e,"imag","complex");A$(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const o={real:n,imag:r};return j.runKernel(W$,o)}const Du=G({complex_:o6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zd(t,e,n,r){if(r==null)r=pc(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(hM(t)||fM(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return j.backend.createTensorFromGPUData(t,e||n,r)}if(!mo(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){rs(e);const o=Q(e),i=Q(n);E(o===i,()=>`Based on the provided shape, [${e}], the tensor should have ${o} values but has ${i}`);for(let s=0;s<n.length;++s){const a=n[s],l=s===n.length-1?a!==Q(e.slice(s)):!0;E(n[s]===e[s]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!mo(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?gl(t,r):Ya(t,[],!0),j.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bM(t,e,n){const r=Qd(t,n);return Zd(t,e,r,n)}class yc{static join(e){return new yc(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>mo(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const o=e[r];r!==e.length-1&&o.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+o.byteLength;this.shards.push({buffer:o,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const o=n-e,i=new ArrayBuffer(o),s=new Uint8Array(i);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],f=e+a-u.start,h=a,p=Math.min(n,u.end)-u.start,m=new Uint8Array(u.buffer,f,p-f);if(s.set(m,h),a+=m.length,n<u.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(o){return e<o.start?-1:e>=o.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=i6(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function i6(t,e){let n=0,r=t.length;for(;n<=r;){const o=Math.floor((r-n)/2)+n,i=e(t[o]);if(i===0)return o;i<0?r=o:n=o+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(){return j}function Z2(){return j.memory()}function K(t,e){return j.tidy(t,e)}function ze(t){dM(t).forEach(n=>n.dispose())}function hi(t){return j.keep(t)}function wM(t,e,n=1){return j.registerBackend(t,e,n)}function s6(){return j.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J2=4;async function eE(t,e){const n=[],r=[],o=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);for(let s=0;s<o.length;++s){const a=o[s],l=Array.isArray(t)?t[s].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async f=>{const h=await l.bytes(),d=h.reduce((g,y)=>g+y.length,0)+J2*h.length,p=new Uint8Array(d);let m=0;for(let g=0;g<h.length;g++){const y=h[g],v=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(v,m),m+=J2,p.set(y,m),m+=y.length}f(p)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const i=await Promise.all(r);return{data:a6(i),specs:n}}function a6(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let o=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}const CC=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function tE(t){return CC?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function l6(t){if(CC)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,o=e.length;r<o;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function u6(t){if(CC){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function c6(t){return yc.join(t)}function SM(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:tE(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:tE(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new yc(t.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Wn.instance==null&&(Wn.instance=new Wn),Wn.instance}static registerSaveRouter(e){Wn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Wn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Wn.getHandlers(e,"save")}static getLoadHandlers(e,n){return Wn.getHandlers(e,"load",n)}static getHandlers(e,n,r){const o=[];return(n==="load"?Wn.getInstance().loadRouters:Wn.getInstance().saveRouters).forEach(s=>{const a=s(e,r);a!==null&&o.push(a)}),o}}const f6=t=>Wn.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L1="tensorflowjs",B1=1,Oa="models_store",$s="model_info_store";function $M(){if(!q().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function z1(t){const e=t.result;e.createObjectStore(Oa,{keyPath:"modelPath"}),e.createObjectStore($s,{keyPath:"modelPath"})}class Qa{constructor(e){if(this.indexedDB=$M(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,o)=>{const i=this.indexedDB.open(L1,B1);i.onupgradeneeded=()=>z1(i),i.onsuccess=()=>{const s=i.result;if(n==null){const a=s.transaction(Oa,"readonly"),u=a.objectStore(Oa).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return s.close(),o(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(s.close(),o(u.error)),a.oncomplete=()=>s.close()}else{n.weightData=yc.join(n.weightData);const a=SM(n),l=s.transaction($s,"readwrite");let u=l.objectStore($s),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return o(h)}let f;c.onsuccess=()=>{f=s.transaction(Oa,"readwrite");const h=f.objectStore(Oa);let d;try{d=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return o(p)}d.onsuccess=()=>r({modelArtifactsInfo:a}),d.onerror=p=>{u=l.objectStore($s);const m=u.delete(this.modelPath);m.onsuccess=()=>(s.close(),o(d.error)),m.onerror=g=>(s.close(),o(d.error))}},c.onerror=h=>(s.close(),o(c.error)),l.oncomplete=()=>{f==null?s.close():f.oncomplete=()=>s.close()}}},i.onerror=s=>o(i.error)})}}Qa.URL_SCHEME="indexeddb://";const CM=t=>q().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Qa.URL_SCHEME)?h6(t.slice(Qa.URL_SCHEME.length)):null;Wn.registerSaveRouter(CM);Wn.registerLoadRouter(CM);function h6(t){return new Qa(t)}function d6(t){return t.startsWith(Qa.URL_SCHEME)?t.slice(Qa.URL_SCHEME.length):t}class p6{constructor(){this.indexedDB=$M()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(L1,B1);r.onupgradeneeded=()=>z1(r),r.onsuccess=()=>{const o=r.result,i=o.transaction($s,"readonly"),a=i.objectStore($s).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(o.close(),n(a.error)),i.oncomplete=()=>o.close()},r.onerror=o=>n(r.error)})}async removeModel(e){return e=d6(e),new Promise((n,r)=>{const o=this.indexedDB.open(L1,B1);o.onupgradeneeded=()=>z1(o),o.onsuccess=()=>{const i=o.result,s=i.transaction($s,"readwrite"),a=s.objectStore($s),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),f=()=>{u=i.transaction(Oa,"readwrite");const d=u.objectStore(Oa).delete(e);d.onsuccess=()=>n(l.result.modelArtifactsInfo),d.onerror=p=>r(l.error)};c.onsuccess=f,c.onerror=h=>(f(),i.close(),r(l.error))}},l.onerror=c=>(i.close(),r(l.error)),s.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},o.onerror=i=>r(o.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ai="/",Ul="tensorflowjs_models",kM="info",m6="model_topology",g6="weight_specs",y6="weight_data",v6="model_metadata";function IM(t){return{info:[Ul,t,kM].join(Ai),topology:[Ul,t,m6].join(Ai),weightSpecs:[Ul,t,g6].join(Ai),weightData:[Ul,t,y6].join(Ai),modelMetadata:[Ul,t,v6].join(Ai)}}function TM(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function x6(t){const e=t.split(Ai);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Ai)}function b6(t){return t.startsWith(Za.URL_SCHEME)?t.slice(Za.URL_SCHEME.length):t}class Za{constructor(e){if(!q().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=IM(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),o=SM(e),i=yc.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,l6(i));const s={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(s)),{modelArtifactsInfo:o}}catch{throw TM(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${o.modelTopologyBytes}, weightSpecsBytes=${o.weightSpecsBytes}, weightDataBytes=${o.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const o=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(o==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=o;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const s=this.LS.getItem(this.keys.weightData);if(s==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=u6(s),n}}Za.URL_SCHEME="localstorage://";const EM=t=>q().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Za.URL_SCHEME)?w6(t.slice(Za.URL_SCHEME.length)):null;Wn.registerSaveRouter(EM);Wn.registerLoadRouter(EM);function w6(t){return new Za(t)}class S6{constructor(){E(q().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),E(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Ul+Ai,r=Ai+kM;for(let o=0;o<this.LS.length;++o){const i=this.LS.key(o);if(i.startsWith(n)&&i.endsWith(r)){const s=x6(i);e[s]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=b6(e);const n=IM(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return TM(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nE="://";class ni{constructor(){this.managers={}}static getInstance(){return ni.instance==null&&(ni.instance=new ni),ni.instance}static registerManager(e,n){E(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(nE)&&(e=e.slice(0,e.indexOf(nE))),E(e.length>0,()=>"scheme must not be an empty string.");const r=ni.getInstance();E(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=ni.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ni.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $6{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!q().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const o=this.functionRefs[r.data.index];o(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return tM(e)}}if(q().get("IS_BROWSER")){q().setPlatform("browser",new $6);try{ni.registerManager(Za.URL_SCHEME,new S6)}catch{}try{ni.registerManager(Qa.URL_SCHEME,new p6)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C6={importFetch:()=>require("node-fetch")};let Vx;class k6{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return q().global.fetch!=null?q().global.fetch(e,n):(Vx==null&&(Vx=C6.importFetch()),Vx(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}q().get("IS_NODE")&&!q().get("IS_BROWSER")&&q().setPlatform("node",new k6);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Me(t,e="float32",n){return e=e||"float32",rs(t),new wn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I6(t,e){const n=M(t,"x","cast");if(!xH(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},o={dtype:e};return j.runKernel(ud,r,o)}const ge=G({cast_:I6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t){const n={x:M(t,"x","clone","string_or_numeric")};return j.runKernel(Sd,n)}const Ba=G({clone_:T6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */mM();const N6={buffer:Me,cast:ge,clone:Ba,print:E6};QH(N6);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A6(t,e){let n=M(t,"a","add"),r=M(e,"b","add");[n,r]=jt(n,r);const o={a:n,b:r};return j.runKernel(gc,o)}const ae=G({add_:A6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6(t,e){let n=M(t,"a","floorDiv"),r=M(e,"b","floorDiv");[n,r]=jt(n,r);const o={a:n,b:r};return j.runKernel(bd,o)}const NM=G({floorDiv_:O6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _6(t,e){let n=M(t,"a","div"),r=M(e,"b","div");if([n,r]=jt(n,r),n.dtype==="int32"&&r.dtype==="int32")return NM(n,r);const o={a:n,b:r},i={};return j.runKernel(pd,o,i)}const Te=G({div_:_6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D6(t,e){let n=M(t,"a","mul"),r=M(e,"b","mul");[n,r]=jt(n,r);const o={a:n,b:r};return j.runKernel(Od,o)}const B=G({mul_:D6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R6(t){const e=M(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return j.runKernel(sv,n)}else{const n={x:e};return j.runKernel(Jy,n)}}const Un=G({abs_:R6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6(t){const n={x:M(t,"x","acos")};return j.runKernel(nd,n)}const M6=G({acos_:P6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6(t){const n={x:M(t,"x","acosh")};return j.runKernel(rd,n)}const L6=G({acosh_:F6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6(t,e=null,n=!1){const o={x:M(t,"x","all","bool")},i={axis:e,keepDims:n};return j.runKernel(M$,o,i)}const AM=G({all_:B6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z6(t,e=null,n=!1){const o={x:M(t,"x","any","bool")},i={axis:e,keepDims:n};return j.runKernel(F$,o,i)}const j1=G({any_:z6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(t,e=0){const r={x:M(t,"x","argMax")},o={axis:e};return j.runKernel(ev,r,o)}const rh=G({argMax_:j6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(t,e=0){const r={x:M(t,"x","argMin")},o={axis:e};return j.runKernel(tv,r,o)}const V6=G({argMin_:W6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(t){const n={x:M(t,"x","asin")};return j.runKernel(od,n)}const G6=G({asin_:U6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(t){const n={x:M(t,"x","asinh")};return j.runKernel(id,n)}const K6=G({asinh_:H6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q6(t){const n={x:M(t,"x","atan")};return j.runKernel(sd,n)}const X6=G({atan_:q6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y6(t,e){let n=M(t,"a","atan2"),r=M(e,"b","atan2");[n,r]=jt(n,r);const o={a:n,b:r};return j.runKernel(ld,o)}const Q6=G({atan2_:Y6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6(t){const n={x:M(t,"x","atanh")};return j.runKernel(ad,n)}const J6=G({atanh_:Z6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jd(t,e,n,r,o="NHWC",i){const s=t[3],a=[...e,s],l=is(o);return Sn(t,a,n,i,r,null,null,l)}function vo(t,e,n,r,o,i,s="channelsLast"){const[a,l]=oh(e);let u;if(s==="channelsLast")u=[a,l,t[3],t[3]];else if(s==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${s}`);return Sn(t,u,n,r,o,i,!1,s)}function os(t,e,n,r,o,i,s="NDHWC"){const[a,l,u]=W1(e);let c,f;if(s==="NDHWC")f="channelsLast",c=[a,l,u,t[4],t[4]];else if(s==="NCDHW")f="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${s}`);return ta(t,c,n,r,o,!1,f,i)}function Sn(t,e,n,r,o,i,s=!1,a="channelsLast"){let[l,u,c,f]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,f]=t;else if(a==="channelsFirst")[l,f,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,d,,p]=e,[m,g]=oh(n),[y,v]=oh(r),x=mu(h,y),b=mu(d,v),{padInfo:w,outHeight:S,outWidth:$}=n5(o,u,c,m,g,x,b,i,a),C=s?p*f:p;let k;return a==="channelsFirst"?k=[l,C,S,$]:a==="channelsLast"&&(k=[l,S,$,C]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:f,outHeight:S,outWidth:$,outChannels:C,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:d,effectiveFilterHeight:x,effectiveFilterWidth:b,dilationHeight:y,dilationWidth:v,inShape:t,outShape:k,filterShape:e}}function ta(t,e,n,r,o,i=!1,s="channelsLast",a){let[l,u,c,f,h]=[-1,-1,-1,-1,-1];if(s==="channelsLast")[l,u,c,f,h]=t;else if(s==="channelsFirst")[l,h,u,c,f]=t;else throw new Error(`Unknown dataFormat ${s}`);const[d,p,m,,g]=e,[y,v,x]=W1(n),[b,w,S]=W1(r),$=mu(d,b),C=mu(p,w),k=mu(m,S),{padInfo:I,outDepth:T,outHeight:N,outWidth:_}=r5(o,u,c,f,y,v,x,$,C,k,a),D=i?g*h:g;let O;return s==="channelsFirst"?O=[l,D,T,N,_]:s==="channelsLast"&&(O=[l,T,N,_,D]),{batchSize:l,dataFormat:s,inDepth:u,inHeight:c,inWidth:f,inChannels:h,outDepth:T,outHeight:N,outWidth:_,outChannels:D,padInfo:I,strideDepth:y,strideHeight:v,strideWidth:x,filterDepth:d,filterHeight:p,filterWidth:m,effectiveFilterDepth:$,effectiveFilterHeight:C,effectiveFilterWidth:k,dilationDepth:b,dilationHeight:w,dilationWidth:S,inShape:t,outShape:O,filterShape:e}}function e5(t,e,n,r,o){r==null&&(r=kC(t,e,n));const i=t[0],s=t[1],a=ih((i-e+2*r)/n+1,o),l=ih((s-e+2*r)/n+1,o);return[a,l]}function t5(t,e,n,r,o,i){o==null&&(o=kC(t,e[0],r[0]));const s=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*o>=e[a]&&(s[a]=ih((t[a]-e[a]+2*o)/r[a]+1,i));return s}function kC(t,e,n,r=1){const o=mu(e,r);return Math.floor((t[0]*(n-1)-n+o)/2)}function oh(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function W1(t){return typeof t=="number"?[t,t,t]:t}function mu(t,e){return e<=1?t:t+(t-1)*(e-1)}function n5(t,e,n,r,o,i,s,a,l){let u,c,f;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const d=e5([e,n],i,r,t,a);c=d[0],f=d[1]}else if(t==="same"){c=Math.ceil(e/r),f=Math.ceil(n/o);const h=Math.max(0,(c-1)*r+i-e),d=Math.max(0,(f-1)*o+s-n),p=Math.floor(h/2),m=h-p,g=Math.floor(d/2),y=d-g;u={top:p,bottom:m,left:g,right:y,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),f=Math.ceil((n-s+1)/o);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],d=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];u={top:h,bottom:d,left:p,right:m,type:h===0&&d===0&&p===0&&m===0?"VALID":"EXPLICIT"},c=ih((e-i+h+d)/r+1,a),f=ih((n-s+p+m)/o+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:f}}function r5(t,e,n,r,o,i,s,a,l,u,c){let f,h,d,p;if(t==="valid"&&(t=0),typeof t=="number"){f={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const g=t5([e,n,r,1],[a,l,u],1,[o,i,s],t,c);h=g[0],d=g[1],p=g[2]}else if(t==="same"){h=Math.ceil(e/o),d=Math.ceil(n/i),p=Math.ceil(r/s);const m=(h-1)*o+a-e,g=(d-1)*i+l-n,y=(p-1)*s+u-r,v=Math.floor(m/2),x=m-v,b=Math.floor(g/2),w=g-b,S=Math.floor(y/2),$=y-S;f={top:b,bottom:w,left:S,right:$,front:v,back:x,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:f,outDepth:h,outHeight:d,outWidth:p}}function ih(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Ja(t){const[e,n,r]=oh(t);return e===1&&n===1&&r===1}function Rn(t,e){return Ja(t)||Ja(e)}function el(t){return oh(t).every(e=>e>0)}function is(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function hr(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")E(Au(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(o=>{E(Au(o),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${o}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o5(t,e){const r={x:M(t,"x","reshape","string_or_numeric")},o={shape:e};return j.runKernel(zv,r,o)}const V=G({reshape_:o5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i5(t,e,n,r,o){const i=M(t,"x","avgPool","float32"),s=1;E(Rn(n,s),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=V(i,[1,i.shape[0],i.shape[1],i.shape[2]])),E(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),hr("avgPool",r,o);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:o};let f=j.runKernel(nv,u,c);return f=ge(f,i.dtype),l?V(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const IC=G({avgPool_:i5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s5(t,e,n,r,o,i="NDHWC"){const s=M(t,"x","avgPool3d","float32");let a=s,l=!1;s.rank===4&&(l=!0,a=V(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),E(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),E(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),E(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),hr("avgPool3d",r,o);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:o,dataFormat:i};let f=j.runKernel(rv,u,c);return f=ge(f,a.dtype),l?V(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const a5=G({avgPool3d_:s5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l5(t,e=0){E(t.length>=1,()=>"Pass at least one tensor to concat");const n=xM(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Ba(n[0]);const r=n,o={axis:e};return j.runKernel(av,r,o)}const ar=G({concat_:l5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u5(t,e,n=!1,r=!1){let o=M(t,"a","matMul"),i=M(e,"b","matMul");[o,i]=jt(o,i);const s={a:o,b:i},a={transposeA:n,transposeB:r};return j.runKernel(ov,s,a)}const Qe=G({matMul_:u5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5(t){const n={x:M(t,"x","sigmoid","float32")};return j.runKernel(Wd,n)}const vc=G({sigmoid_:c5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f5(t,e,n){const r=M(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const o={x:r},i={begin:e,size:n};return j.runKernel(Gv,o,i)}const dt=G({slice_:f5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h5(t){const n={x:M(t,"x","tanh","float32")};return j.runKernel(qd,n)}const e0=G({tanh_:h5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d5(t,e,n){const r=M(t,"x","batchToSpaceND"),o=e.reduce((a,l)=>a*l);E(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),E(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),E(r.shape[0]%o===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${o}`);const i={x:r},s={blockShape:e,crops:n};return j.runKernel(iv,i,s)}const TC=G({batchToSpaceND_:d5});function p5(t){let e;return t.rank===0||t.rank===1?e=V(t,[1,1,1,t.size]):t.rank===2?e=V(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5(t,e,n,r,o,i){i==null&&(i=.001);const s=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let u;o!=null&&(u=M(o,"scale","batchNorm"));let c;r!=null&&(c=M(r,"offset","batchNorm")),E(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),E(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),E(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:p5(s),scale:u,offset:c,mean:a,variance:l},d={varianceEpsilon:i},p=j.runKernel(gv,h,d);return V(p,s.shape)}const t0=G({batchNorm_:m5});function g5(t,e,n,r,o,i){const s=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let u;o!=null&&(u=M(o,"scale","batchNorm"));let c;return r!=null&&(c=M(r,"offset","batchNorm")),E(s.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${s.rank}.`),E(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),E(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&E(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&E(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),t0(s,a,l,c,u,i)}const y5=G({batchNorm2d_:g5});function v5(t,e,n,r,o,i){const s=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let u;o!=null&&(u=M(o,"scale","batchNorm"));let c;return r!=null&&(c=M(r,"offset","batchNorm")),E(s.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${s.rank}.`),E(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),E(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&E(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&E(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),t0(s,a,l,c,u,i)}const x5=G({batchNorm3d_:v5});function b5(t,e,n,r,o,i){const s=M(t,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let u;o!=null&&(u=M(o,"scale","batchNorm"));let c;return r!=null&&(c=M(r,"offset","batchNorm")),E(s.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${s.rank}.`),E(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),E(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&E(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&E(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),t0(s,a,l,c,u,i)}const w5=G({batchNorm4d_:b5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S5(t,e,n){const r=M(t,"x","bincount"),o=M(e,"weights","bincount");E(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),E(n>=0,()=>`size must be non-negative, but got ${n}.`),E(o.size===r.size||o.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${o.shape}.`);const i={x:r,weights:o},s={size:n};return j.runKernel(z$,i,s)}const $5=G({bincount_:S5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C5(t,e){let n=M(t,"broadcastTo","x");const r=n.shape;if(rs(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=V(n,u)}const o=n.shape,i=Array.from(e);for(let u=e.length-1;u>=0;u--)if(o[u]===e[u])i[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Ba(n);const a={x:n},l={reps:i};return j.runKernel(Xd,a,l)}const Df=G({broadcastTo_:C5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k5(t){const n={x:M(t,"x","ceil","float32")};return j.runKernel(cd,n)}const I5=G({ceil_:k5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0(t,e,n){rs(t),n=n||pc(e);const r={shape:t,value:e,dtype:n};return j.runKernel(tC,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T5(t,e,n){const r=M(t,"x","clipByValue");if(E(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return n0(r.shape,e,r.dtype);const o={x:r},i={clipValueMin:e,clipValueMax:n};return j.runKernel(fd,o,i)}const zr=G({clipByValue_:T5});function E5(t){return ar(t,0)}const N5=G({concat1d_:E5});function A5(t,e){return ar(t,e)}const O5=G({concat2d_:A5});function _5(t,e){return ar(t,e)}const D5=G({concat3d_:_5});function R5(t,e){return ar(t,e)}const P5=G({concat4d_:R5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M5(t,e,n,r,o="NHWC",i=[1,1],s){const a=M(t,"x","conv2d","float32"),l=M(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),E(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),hr("conv2d",r,s);const f=o==="NHWC"?u.shape[3]:u.shape[1];E(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),E(Rn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),E(el(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),E(el(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:u,filter:l},d={strides:n,pad:r,dataFormat:o,dilations:i,dimRoundingMode:s},p=j.runKernel(lv,h,d);return c?V(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const tl=G({conv2d_:M5});function F5(t,e,n,r,o="NWC",i=1,s){const a=M(t,"x","conv1d"),l=M(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=V(a,[1,a.shape[0],a.shape[1]])),E(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),E(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),hr("conv1d",r,s),E(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),E(Rn(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),E(el(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),E(el(n),()=>"Error in conv1D: Stride should be larger than 0."),E(o==="NWC",()=>`Error in conv1d: got dataFormat of ${o} but only NWC is currently supported.`);const f=V(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=V(u,[u.shape[0],1,u.shape[1],u.shape[2]]),g=tl(h,f,[1,n],r,"NHWC",[1,i],s);return c?V(g,[g.shape[2],g.shape[3]]):V(g,[g.shape[0],g.shape[2],g.shape[3]])}const OM=G({conv1d_:F5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L5(t,e,n,r,o,i="NHWC",s){E(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),E(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),E(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),E(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=i==="NHWC"?a[3]:a[1],f=i==="NHWC"?l.shape[3]:l.shape[1];E(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),E(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),hr("conv2dDerInput",o,s);const h={dy:l,filter:n},d={strides:r,pad:o,dataFormat:i,dimRoundingMode:s,inputShape:a},p=j.runKernel(uv,h,d);return u?V(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const EC=G({conv2DBackpropInput_:L5});function B5(t,e,n,r,o,i){const s=M(t,"x","conv2dTranspose"),a=M(e,"filter","conv2dTranspose");return EC(n,s,a,r,o,"NHWC",i)}const _M=G({conv2dTranspose_:B5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z5(t,e,n,r,o="NDHWC",i=[1,1,1]){const s=M(t,"x","conv3d"),a=M(e,"filter","conv3d");let l=s,u=!1;s.rank===4&&(u=!0,l=V(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),E(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),E(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),E(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),E(Rn(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),E(o==="NDHWC",()=>`Error in conv3d: got dataFormat of ${o} but only NDHWC is currently supported.`),E(el(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),E(el(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},f={strides:n,pad:r,dataFormat:o,dilations:i},h=j.runKernel(cv,c,f);return u?V(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const j5=G({conv3d_:z5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W5(t,e,n,r,o){E(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,s=e,a=!1;e.rank===4&&(a=!0,s=V(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],u=s.shape[4];E(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),E(s.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${s.rank}`),E(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),E(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),E(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:s,filter:n},f={pad:o,strides:r,inputShape:i},h=j.runKernel(G$,c,f);return a?V(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const DM=G({conv3DBackpropInput_:W5});function V5(t,e,n,r,o){const i=M(t,"x","conv3dTranspose"),s=M(e,"filter","conv3dTranspose");return DM(n,i,s,r,o)}const U5=G({conv3dTranspose_:V5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G5(t){const n={x:M(t,"x","cos","float32")};return j.runKernel(hd,n)}const NC=G({cos_:G5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H5(t){const n={x:M(t,"x","cosh","float32")};return j.runKernel(dd,n)}const RM=G({cosh_:H5});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K5(t,e=0,n=!1,r=!1){const i={x:M(t,"x","cumprod")},s={axis:e,exclusive:n,reverse:r};return j.runKernel(H$,i,s)}const V1=G({cumprod_:K5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q5(t,e=0,n=!1,r=!1){const i={x:M(t,"x","cumsum")},s={axis:e,exclusive:n,reverse:r};return j.runKernel(fv,i,s)}const PM=G({cumsum_:q5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X5(t,e,n,r=!1){const o=M(t,"x","denseBincount"),i=M(e,"weights","denseBincount");E(o.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${o.dtype}`),E(o.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${o.rank}.`),E(n>=0,()=>`size must be non-negative, but got ${n}.`),E(i.size===o.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${o.shape}, weights shape: ${i.shape}.`);const s={x:o,weights:i},a={size:n,binaryOutput:r};return j.runKernel(q$,s,a)}const rE=G({denseBincount_:X5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y5(t,e,n="NHWC"){const r=M(t,"x","depthToSpace","float32"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],s=n==="NHWC"?r.shape[3]:r.shape[1];E(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),E(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e}  for depthToSpace with input shape
    ${r.shape}`),E(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),E(s%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${s} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return j.runKernel(X$,a,l)}const Q5=G({depthToSpace_:Y5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z5(t,e,n,r,o="NHWC",i=[1,1],s){const a=M(t,"x","depthwiseConv2d","float32"),l=M(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),E(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=o==="NHWC"?u.shape[3]:u.shape[1];E(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),hr("depthwiseConv2d",r,s);const h={x:u,filter:l},d={strides:n,pad:r,dataFormat:o,dilations:i,dimRoundingMode:s},p=j.runKernel(hv,h,d);return c?V(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const AC=G({depthwiseConv2d_:Z5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J5(t,e,n,r,o=[1,1],i="NHWC"){const s=M(t,"x","dilation2d"),a=M(e,"filter","dilation2d");E(s.rank===3||s.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`),E(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),E(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=s,u=!1;s.rank===3&&(l=V(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0),E(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},f={strides:n,pad:r,dilations:o},h=j.runKernel(dv,c,f);return u?V(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const e8=G({dilation2d_:J5});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ru(t,e){const n=t.length,r=[];for(let o=0;o<n;o++){const i=n-1-o,s=t[i]||1;(e[e.length-1-o]||1)>1&&s===1&&r.unshift(i)}return r}function on(t,e){const n=[];for(let r=0;r<e.length;r++){const o=t[t.length-r-1],i=e.length-r-1,s=e[i];(o==null||o===1&&s>1)&&n.unshift(i)}return n}function Re(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let o=0;o<n;o++){let i=t[t.length-o-1];i==null&&(i=1);let s=e[e.length-o-1];if(s==null&&(s=1),i===1)r[n-o-1]=s;else if(s===1)r[n-o-1]=i;else if(i!==s){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-o-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t8(t,e){let n=M(t,"a","equal","string_or_numeric"),r=M(e,"b","equal","string_or_numeric");[n,r]=jt(n,r),Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(pv,o)}const vi=G({equal_:t8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n8(t,e,n){const r=M(e,"a","where"),o=M(n,"b","where"),i=M(t,"condition","where","bool"),s=Re(Re(i.shape,r.shape),o.shape),a=Df(i,s),l=Df(r,s),u=Df(o,s),c={condition:a,t:l,e:u};return j.runKernel(Uv,c)}const Yn=G({where_:n8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8(t){const n={x:M(t,"x","zerosLike")};return j.runKernel(Zv,n)}const Ge=G({zerosLike_:r8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(t,e){let n=M(t,"a","div"),r=M(e,"b","div");[n,r]=jt(n,r);const o=Te(n,r),i=Ge(o),s=vi(r,i);return Yn(s,i,o)}const i8=G({divNoNan_:o8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s8(t,e){const n=M(t,"t1","dot"),r=M(e,"t2","dot");E((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(E(o===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${o} and ${i}.`),n.rank===1&&r.rank===1){const s=V(n,[1,-1]),a=V(r,[-1,1]),l=Qe(s,a);return V(l,[])}else if(n.rank===1&&r.rank===2){const s=V(n,[1,-1]),a=V(r,[r.shape[0],r.shape[1]]),l=Qe(s,a);return V(l,[l.size])}else if(n.rank===2&&r.rank===1){const s=V(r,[-1,1]),a=Qe(n,s);return V(a,[a.size])}else{const s=V(r,[r.shape[0],r.shape[1]]);return Qe(n,s)}}const a8=G({dot_:s8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l8(t,...e){const n=e.map((o,i)=>M(o,`tensors${i}`,"einsum")),r={equation:t};return j.runKernel(Z$,n,r)}const Jc=G({einsum_:l8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u8(t){const n={x:M(t,"x","elu","float32")};return j.runKernel(md,n)}const r0=G({elu_:u8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(t){let e=M(t,"x","erf");E(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=ge(e,"float32"));const n={x:e};return j.runKernel(gd,n)}const MM=G({erf_:c8});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OC(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function FM(t,e,n){const r=t.length+e.length,o=[];let i=0,s=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?o.push(t[i++]):o.push(e[s++]);return o}function mn(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&n.push(t[i]);const o=e.map(i=>t[i]);return[n,o]}function qt(t,e){const n=e.map(r=>1);return FM(t,n,e)}function $n(t,e,n){E(OC(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Ot(t,e){if(OC(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function na(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Wt(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f8(t,e=null,n=!1){const o={x:M(t,"x","max")},i={reductionIndices:e,keepDims:n};return j.runKernel(Iv,o,i)}const Vo=G({max_:f8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h8(t,e=null,n=!1){const o={x:M(t,"x","min")},i={axis:e,keepDims:n};return j.runKernel(Av,o,i)}const mg=G({min_:h8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(t,e){let n=M(t,"base","pow"),r=M(e,"exp","pow");[n,r]=jt(n,r);const o={a:n,b:r};return j.runKernel(_d,o)}const nl=G({pow_:d8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze(t,e){if((mo(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&mo(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Zd(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(t){const n={x:M(t,"x","sqrt","float32")};return j.runKernel(Ud,n)}const Dn=G({sqrt_:p8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(t){const e=M(t,"x","square"),n={};return j.runKernel("Square",{x:e},n)}const xt=G({square_:m8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g8(t,e=null,n=!1){let r=M(t,"x","sum");r.dtype==="bool"&&(r=ge(r,"int32"));const o={x:r},i={axis:e,keepDims:n};return j.runKernel(Hv,o,i)}const Ie=G({sum_:g8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y8(t,e="euclidean",n=null,r=!1){t=M(t,"x","norm");const o=LM(t,e,n);let i=o.shape;if(r){const s=Fe(n,t.shape);i=qt(o.shape,s)}return V(o,i)}function LM(t,e,n=null){if(t.rank===0)return Un(t);if(t.rank!==1&&n===null)return LM(V(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Ie(Un(t),n);if(e===1/0)return Vo(Un(t),n);if(e===-1/0)return mg(Un(t),n);if(e==="euclidean"||e===2)return Dn(Ie(nl(Un(t),Ze(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Vo(Ie(Un(t),n[0]),n[1]-1);if(e===1/0)return Vo(Ie(Un(t),n[1]),n[0]);if(e===-1/0)return mg(Ie(Un(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Dn(Ie(xt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const o0=G({norm_:y8});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v8(t,e=null,n=!1){return o0(t,"euclidean",e,n)}const x8=G({euclideanNorm_:v8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(t){const n={x:M(t,"x","exp")};return j.runKernel(yd,n)}const xi=G({exp_:b8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8(t,e=0){const n=M(t,"x","expandDims","string_or_numeric");E(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},o={dim:e};return j.runKernel(mv,r,o)}const rr=G({expandDims_:w8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(t){const n={x:M(t,"x","expm1")};return j.runKernel(vd,n)}const $8=G({expm1_:S8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C8(t,e){const n=M(t,"x","tile","string_or_numeric");E(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},o={reps:e};return j.runKernel(Xd,r,o)}const Lo=G({tile_:C8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8(t,e,n,r="float32"){e==null&&(e=t);const o=Me([t,e],r),i=t<=e?t:e;for(let a=0;a<i;++a)o.set(1,a,a);const s=V(o.toTensor(),[t,e]);if(n==null)return s;if(n.length===1)return Lo(rr(s,0),[n[0],1,1]);if(n.length===2)return Lo(rr(rr(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return Lo(rr(rr(rr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const BM=G({eye_:k8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(t){const n={x:M(t,"x","floor","float32")};return j.runKernel(xd,n)}const i0=G({floor_:I8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T8(t,e,n=0,r=0){const o=M(t,"x","gather"),i=M(e,"indices","gather","int32"),s={x:o,indices:i},a={axis:n,batchDims:r};return j.runKernel(yv,s,a)}const _C=G({gather_:T8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E8(t,e){let n=M(t,"a","greater","string_or_numeric"),r=M(e,"b","greater","string_or_numeric");[n,r]=jt(n,r),Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(vv,o)}const Ur=G({greater_:E8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N8(t,e){let n=M(t,"a","greaterEqual","string_or_numeric"),r=M(e,"b","greaterEqual","string_or_numeric");[n,r]=jt(n,r),Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(wd,o)}const yl=G({greaterEqual_:N8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A8(t){const n={input:M(t,"input","imag")};return j.runKernel(oC,n)}const DC=G({imag_:A8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O8(t){const n={x:M(t,"x","isFinite")};return j.runKernel($d,n)}const _8=G({isFinite_:O8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D8(t){const n={x:M(t,"x","isInf")};return j.runKernel(Cd,n)}const R8=G({isInf_:D8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8(t){const n={x:M(t,"x","isNaN")};return j.runKernel(kd,n)}const M8=G({isNaN_:P8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F8(t,e=.2){const r={x:M(t,"x","leakyRelu")},o={alpha:e};return j.runKernel(xv,r,o)}const RC=G({leakyRelu_:F8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L8(t,e){let n=M(t,"a","less","string_or_numeric"),r=M(e,"b","less","string_or_numeric");[n,r]=jt(n,r),Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(bv,o)}const gg=G({less_:L8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8(t,e){let n=M(t,"a","lessEqual","string_or_numeric"),r=M(e,"b","lessEqual","string_or_numeric");[n,r]=jt(n,r),Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(wv,o)}const xc=G({lessEqual_:B8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z8(t,e=5,n=1,r=1,o=.5){const i=M(t,"x","localResponseNormalization");E(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),E(Au(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let s=i,a=!1;i.rank===3&&(a=!0,s=V(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:s},u={depthRadius:e,bias:n,alpha:r,beta:o},c=j.runKernel(kv,l,u);return a?V(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const j8=G({localResponseNormalization_:z8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(t){const n={x:M(t,"x","log","float32")};return j.runKernel(Id,n)}const bi=G({log_:W8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(t){const n={x:M(t,"x","log1p")};return j.runKernel(Td,n)}const zM=G({log1p_:V8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8(t,e){E(T1(t),()=>"The f passed in variableGrads(f) must be a function"),E(e==null||Array.isArray(e)&&e.every(u=>u instanceof pg),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in j.registeredVariables)e.push(j.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,o=e.length;e=e.filter(u=>u.trainable),E(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${o} variables is trainable.`);const i=!0,{value:s,grads:a}=j.gradients(t,e,null,i);E(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),E(s.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${s.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:s,grads:l}}function Pu(t){return j.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G8(t){const n={x:M(t,"x","neg")};return j.runKernel(_v,n)}const zt=G({neg_:G8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H8(t){const n={x:M(t,"x","softplus")};return j.runKernel(Vd,n)}const ep=G({softplus_:H8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(t){const e=M(t,"x","logSigmoid");return Pu(r=>({value:zt(ep(zt(r))),gradFunc:s=>B(s,vc(zt(r)))}))(e)}const q8=G({logSigmoid_:K8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X8(t,e){let n=M(t,"a","sub"),r=M(e,"b","sub");[n,r]=jt(n,r);const o={a:n,b:r};return j.runKernel(Hd,o)}const Ae=G({sub_:X8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(t,e=-1){const n=M(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Pu((o,i)=>{const a=Vo(o,e,!0),l=Ae(o,a),u=Ae(ge(l,"float32"),bi(Ie(xi(l),e,!0)));return i([u]),{value:u,gradFunc:(f,h)=>{const[d]=h,p=!0,m=xi(d);return Ae(f,B(Ie(f,e,p),m))}}})(n)}const jM=G({logSoftmax_:Y8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q8(t,e=null,n=!1){const r=M(t,"x","logSumExp"),o=Fe(e,r.shape),i=Vo(r,o,!0),s=Ae(r,i),a=xi(s),l=Ie(a,o),u=bi(l),c=ae(V(i,u.shape),u);if(n){const f=qt(c.shape,o);return V(c,f)}return c}const WM=G({logSumExp_:Q8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(t,e){const n=M(t,"a","logicalAnd","bool"),r=M(e,"b","logicalAnd","bool");Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(Sv,o)}const qi=G({logicalAnd_:Z8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J8(t){const n={x:M(t,"x","logicalNot","bool")};return j.runKernel($v,n)}const PC=G({logicalNot_:J8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eK(t,e){const n=M(t,"a","logicalOr","bool"),r=M(e,"b","logicalOr","bool");Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(Cv,o)}const VM=G({logicalOr_:eK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tK(t,e){const n=M(t,"a","logicalXor","bool"),r=M(e,"b","logicalXor","bool");return Re(n.shape,r.shape),qi(VM(t,e),PC(qi(t,e)))}const nK=G({logicalXor_:tK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rK(t,e,n,r,o){const i=M(t,"x","maxPool"),s=1;let a=i,l=!1;i.rank===3&&(l=!0,a=V(i,[1,i.shape[0],i.shape[1],i.shape[2]])),E(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),E(Rn(n,s),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),hr("maxPool",r,o);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:o},f=j.runKernel(Tv,u,c);return l?V(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const MC=G({maxPool_:rK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oK(t,e=[1,1,1],n,r,o,i="NDHWC"){const s=M(t,"x","maxPool3d");let a=s,l=!1;s.rank===4&&(l=!0,a=V(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),E(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),E(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),hr("maxPool3d",r,o);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:o,dataFormat:i},f=j.runKernel(Ev,u,c);return l?V(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const iK=G({maxPool3d_:oK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sK(t,e){let n=M(t,"a","maximum"),r=M(e,"b","maximum");[n,r]=jt(n,r),n.dtype==="bool"&&(n=ge(n,"int32"),r=ge(r,"int32")),Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(Ed,o)}const ra=G({maximum_:sK});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aK(t,e=null,n=!1){const o={x:M(t,"x","mean")},i={axis:e,keepDims:n};return j.runKernel(Nv,o,i)}const Ht=G({mean_:aK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fn(t,e="float32"){if(rs(t),e==="complex64"){const r=fn(t,"float32"),o=fn(t,"float32");return Du(r,o)}const n=_n(Q(t),e);return j.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oa(t,e="float32"){if(rs(t),e==="complex64"){const r=oa(t,"float32"),o=fn(t,"float32");return Du(r,o)}const n=_$(Q(t),e);return j.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(t,e){let n=M(t,"a","minimum"),r=M(e,"b","minimum");[n,r]=jt(n,r),n.dtype==="bool"&&(n=ge(n,"int32"),r=ge(r,"int32")),Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(Nd,o)}const sh=G({minimum_:lK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uK(t,e,n){E(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=M(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");E(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const o=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)E(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),E(e[a][0]>=0&&e[a][0]<=r.shape[a]-o&&e[a][1]>=0&&e[a][1]<=r.shape[a]-o,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-o} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:n},s={x:r};return j.runKernel(Ov,s,i)}const cK=G({mirrorPad_:uK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fK(t,e){let n=M(t,"a","mod"),r=M(e,"b","mod");[n,r]=jt(n,r);const o={a:n,b:r};return j.runKernel(Ad,o)}const hK=G({mod_:fK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dK(t,e=null,n=!1){t=M(t,"x","moments");const r=Fe(e,t.shape),o=Ht(t,r,n);let i=o.shape;n||(i=qt(o.shape,r));const s=xt(Ae(ge(t,"float32"),V(o,i))),a=Ht(s,r,n);return{mean:o,variance:a}}const FC=G({moments_:dK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pK(t,e){let n=M(t,"a","notEqual","string_or_numeric"),r=M(e,"b","notEqual","string_or_numeric");[n,r]=jt(n,r),Re(n.shape,r.shape);const o={a:n,b:r};return j.runKernel(Dv,o)}const yg=G({notEqual_:pK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mK(t,e,n=1,r=0,o="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const s={indices:M(t,"indices","oneHot","int32")},a={dtype:o,depth:e,onValue:n,offValue:r};return j.runKernel(Pv,s,a)}const UM=G({oneHot_:mK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gK(t){const n={x:M(t,"x","onesLike")};return j.runKernel(Rv,n)}const go=G({onesLike_:gK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yK(t,e,n=0){const r=M(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const o={paddings:e,constantValue:n},i={x:r};return j.runKernel(Fv,i,o)}const LC=G({pad_:yK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vK(t,e,n){const r=M(t,"x","spaceToBatchND");E(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),E(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),E(r.shape.reduce((s,a,l)=>l>0&&l<=e.length?s&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:s,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const o={x:r},i={blockShape:e,paddings:n};return j.runKernel(Kv,o,i)}const BC=G({spaceToBatchND_:vK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xK(t,e,n,r,o,i,s){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");const a=M(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(Rn(i,o),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${o}'`);const c=vo(l.shape,e,i,o,r),f=[c.dilationHeight,c.dilationWidth];let h;r==="same"?h=wK([c.filterHeight,c.filterWidth],f):h=[[0,0],[0,0]];const d=f[0]===1&&f[1]===1,[p,m]=bK([c.inHeight,c.inWidth],f,h),g=d?r:"valid",y=d?l:BC(l,f,p),x=(n==="avg"?()=>IC(y,e,i,g,s):()=>MC(y,e,i,g,s))(),b=d?x:TC(x,f,m);return u?V(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function bK(t,e,n){const r=n.map(c=>c[0]),o=n.map(c=>c[1]),i=t.concat(r,o),s=e.map((c,f)=>(c-i[f]%c)%c),a=o.map((c,f)=>c+s[f]),l=e.map((c,f)=>[r[f],a[f]]),u=e.map((c,f)=>[0,s[f]]);return[l,u]}function wK(t,e){const r=t.map((s,a)=>s+(s-1)*(e[a]-1)).map(s=>s-1),o=r.map(s=>Math.floor(s/2)),i=r.map((s,a)=>s-o[a]);return r.map((s,a)=>[o[a],i[a]])}const SK=G({pool_:xK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $K(t,e){const n=M(t,"x","prelu"),r=M(e,"alpha","prelu"),o={x:n,alpha:r};return j.runKernel(Lv,o)}const zC=G({prelu_:$K});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CK(t,e=null,n=!1){let r=M(t,"x","prod");r.dtype==="bool"&&(r=ge(r,"int32"));const o={x:r},i={axis:e,keepDims:n};return j.runKernel(Bv,o,i)}const kK=G({prod_:CK});var jC={exports:{}};jC.exports;(function(t){(function(e,n,r){function o(l){var u=this,c=a();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function i(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new o(l),f=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,f&&(typeof f=="object"&&i(f,c),h.state=function(){return i(c,{})}),h}function a(){var l=4022871197,u=function(c){c=String(c);for(var f=0;f<c.length;f++){l+=c.charCodeAt(f);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=s:this.alea=s})(Fo,t)})(jC);var IK=jC.exports,WC={exports:{}};WC.exports;(function(t){(function(e,n,r){function o(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function s(a,l){var u=new o(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=s:this.xor128=s})(Fo,t)})(WC);var TK=WC.exports,VC={exports:{}};VC.exports;(function(t){(function(e,n,r){function o(a){var l=this,u="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function s(a,l){var u=new o(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=s:this.xorwow=s})(Fo,t)})(VC);var EK=VC.exports,UC={exports:{}};UC.exports;(function(t){(function(e,n,r){function o(a){var l=this;l.next=function(){var c=l.x,f=l.i,h,d;return h=c[f],h^=h>>>7,d=h^h<<24,h=c[f+1&7],d^=h^h>>>10,h=c[f+3&7],d^=h^h>>>3,h=c[f+4&7],d^=h^h<<7,h=c[f+7&7],h=h^h<<13,d^=h^h<<9,c[f]=d,l.i=f+1&7,d};function u(c,f){var h,d=[];if(f===(f|0))d[0]=f;else for(f=""+f,h=0;h<f.length;++h)d[h&7]=d[h&7]<<15^f.charCodeAt(h)+d[h+1&7]<<13;for(;d.length<8;)d.push(0);for(h=0;h<8&&d[h]===0;++h);for(h==8?d[7]=-1:d[h],c.x=d,c.i=0,h=256;h>0;--h)c.next()}u(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function s(a,l){a==null&&(a=+new Date);var u=new o(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.x&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=s:this.xorshift7=s})(Fo,t)})(UC);var NK=UC.exports,GC={exports:{}};GC.exports;(function(t){(function(e,n,r){function o(a){var l=this;l.next=function(){var c=l.w,f=l.X,h=l.i,d,p;return l.w=c=c+1640531527|0,p=f[h+34&127],d=f[h=h+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,p=f[h]=p^d,l.i=h,p+(c^c>>>16)|0};function u(c,f){var h,d,p,m,g,y=[],v=128;for(f===(f|0)?(d=f,f=null):(f=f+"\0",d=0,v=Math.max(v,f.length)),p=0,m=-32;m<v;++m)f&&(d^=f.charCodeAt((m+32)%f.length)),m===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,m>=0&&(g=g+1640531527|0,h=y[m&127]^=d+g,p=h==0?p+1:0);for(p>=128&&(y[(f&&f.length||0)&127]=-1),p=127,m=4*128;m>0;--m)d=y[p+34&127],h=y[p=p+1&127],d^=d<<13,h^=h<<17,d^=d>>>15,h^=h>>>12,y[p]=d^h;c.w=g,c.X=y,c.i=p}u(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function s(a,l){a==null&&(a=+new Date);var u=new o(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.X&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=s:this.xor4096=s})(Fo,t)})(GC);var AK=GC.exports,HC={exports:{}};HC.exports;(function(t){(function(e,n,r){function o(a){var l=this,u="";l.next=function(){var f=l.b,h=l.c,d=l.d,p=l.a;return f=f<<25^f>>>7^h,h=h-d|0,d=d<<24^d>>>8^p,p=p-f|0,l.b=f=f<<20^f>>>12^h,l.c=h=h-d|0,l.d=d<<16^h>>>16^p,l.a=p-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function s(a,l){var u=new o(a),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&i(c,u),f.state=function(){return i(u,{})}),f}n&&n.exports?n.exports=s:this.tychei=s})(Fo,t)})(HC);var OK=HC.exports,GM={exports:{}};const _K={},DK=Object.freeze(Object.defineProperty({__proto__:null,default:_K},Symbol.toStringTag,{value:"Module"})),RK=jV(DK);(function(t){(function(e,n,r){var o=256,i=6,s=52,a="random",l=r.pow(o,i),u=r.pow(2,s),c=u*2,f=o-1,h;function d(b,w,S){var $=[];w=w==!0?{entropy:!0}:w||{};var C=y(g(w.entropy?[b,x(n)]:b??v(),3),$),k=new p($),I=function(){for(var T=k.g(i),N=l,_=0;T<u;)T=(T+_)*o,N*=o,_=k.g(1);for(;T>=c;)T/=2,N/=2,_>>>=1;return(T+_)/N};return I.int32=function(){return k.g(4)|0},I.quick=function(){return k.g(4)/4294967296},I.double=I,y(x(k.S),n),(w.pass||S||function(T,N,_,D){return D&&(D.S&&m(D,k),T.state=function(){return m(k,{})}),_?(r[a]=T,N):T})(I,C,"global"in w?w.global:this==r,w.state)}function p(b){var w,S=b.length,$=this,C=0,k=$.i=$.j=0,I=$.S=[];for(S||(b=[S++]);C<o;)I[C]=C++;for(C=0;C<o;C++)I[C]=I[k=f&k+b[C%S]+(w=I[C])],I[k]=w;($.g=function(T){for(var N,_=0,D=$.i,O=$.j,R=$.S;T--;)N=R[D=f&D+1],_=_*o+R[f&(R[D]=R[O=f&O+N])+(R[O]=N)];return $.i=D,$.j=O,_})(o)}function m(b,w){return w.i=b.i,w.j=b.j,w.S=b.S.slice(),w}function g(b,w){var S=[],$=typeof b,C;if(w&&$=="object")for(C in b)try{S.push(g(b[C],w-1))}catch{}return S.length?S:$=="string"?b:b+"\0"}function y(b,w){for(var S=b+"",$,C=0;C<S.length;)w[f&C]=f&($^=w[f&C]*19)+S.charCodeAt(C++);return x(w)}function v(){try{var b;return h&&(b=h.randomBytes)?b=b(o):(b=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(b)),x(b)}catch{var w=e.navigator,S=w&&w.plugins;return[+new Date,e,S,e.screen,x(n)]}}function x(b){return String.fromCharCode.apply(0,b)}if(y(r.random(),n),t.exports){t.exports=d;try{h=RK}catch{}}else r["seed"+a]=d})(typeof self<"u"?self:Fo,[],Math)})(GM);var PK=GM.exports,MK=IK,FK=TK,LK=EK,BK=NK,zK=AK,jK=OK,vl=PK;vl.alea=MK;vl.xor128=FK;vl.xorwow=LK;vl.xorshift7=BK;vl.xor4096=zK;vl.tychei=jK;var KC=vl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HM{constructor(e,n,r,o,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const s=i||Math.random();this.random=KC.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){const o=this.nextVal;return this.nextVal=NaN,o}let e,n,r=!1;for(;!r;){let o,i,s;do o=2*this.random()-1,i=2*this.random()-1,s=o*o+i*i;while(s>=1||s===0);const a=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*o*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class WK{constructor(e=0,n=1,r,o){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=KC.alea(o)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VK(t,e=0,n=1,r,o){if(rs(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new HM(e,n,r,!1,o),s=Me(t,r);for(let a=0;a<s.values.length;a++)s.values[a]=i.nextValue();return s.toTensor()}const UK=G({randomNormal_:VK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GK(t,e=0,n=1,r="float32",o){rs(t);const i=Me(t,r),s=new WK(e,n,null,o);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}const tp=G({randomUniform_:GK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ah(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const o={start:t,stop:e,step:n,dtype:r};return j.runKernel(fC,{},o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HK(t){const n={input:M(t,"input","real")};return j.runKernel(hC,n)}const vg=G({real_:HK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KK(t){const n={x:M(t,"x","reciprocal")};return j.runKernel(Dd,n)}const qK=G({reciprocal_:KK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XK(t){const n={x:M(t,"x","relu")};return j.runKernel(Rd,n)}const xl=G({relu_:XK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YK(t){const n={x:M(t,"x","relu6")};return j.runKernel(Pd,n)}const KM=G({relu6_:YK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QK(t,e){const r={x:M(t,"x","reverse")},o={dims:e};return j.runKernel(Vv,r,o)}const rl=G({reverse_:QK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZK(t){const n={x:M(t,"x","round")};return j.runKernel(Md,n)}const qM=G({round_:ZK});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JK(t){const n={x:M(t,"x","rsqrt","float32")};return j.runKernel(Fd,n)}const XM=G({rsqrt_:JK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eq(t){const n={x:M(t,"x","selu")};return j.runKernel(Ld,n)}const YM=G({selu_:eq});function tq(t,e,n,r,o,i=[1,1],s="NHWC"){const a=M(t,"x","separableConv2d"),l=M(e,"depthwiseFilter","separableConv2d"),u=M(n,"pointwiseFilter","separableConv2d");let c=a,f=!1;if(a.rank===3&&(f=!0,c=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");E(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),E(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),E(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),E(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),E(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=l.shape[2],d=l.shape[3];E(u.shape[2]===h*d,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*d}, but got ${u.shape[2]}.`);const p=AC(c,l,r,o,s,i),g=tl(p,u,1,"valid",s);return f?V(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const QM=G({separableConv2d_:tq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nq(t){const n={x:M(t,"x","sign")};return j.runKernel(jd,n)}const rq=G({sign_:nq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(t){const n={x:M(t,"x","sin","float32")};return j.runKernel(Bd,n)}const ZM=G({sin_:oq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iq(t){const n={x:M(t,"x","sinh")};return j.runKernel(zd,n)}const JM=G({sinh_:iq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(t,e,n){const r=M(t,"x","slice1d");return E(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),dt(r,[e],[n])}const qC=G({slice1d_:sq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aq(t,e,n){const r=M(t,"x","slice2d");return E(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),dt(r,e,n)}const eF=G({slice2d_:aq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lq(t,e,n){const r=M(t,"x","slice3d");return E(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),dt(r,e,n)}const XC=G({slice3d_:lq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uq(t,e,n){const r=M(t,"x","slice4d");return E(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),dt(r,e,n)}const xg=G({slice4d_:uq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cq(t,e=-1){const n=M(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},o={dim:e};return j.runKernel(Xv,r,o)}const YC=G({softmax_:cq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fq(t){E(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return j.runKernel(eC,e)}const tF=G({fft_:fq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hq(t){E(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return j.runKernel(rC,e)}const U1=G({ifft_:hq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const o=V(t,[n,e]);r=U1(o)}else{const o=[n,2*(e-1)],i=V(vg(t),[n,e]),s=V(DC(t),[n,e]),a=rl(dt(i,[0,1],[n,e-2]),1),l=B(rl(dt(s,[0,1],[n,e-2]),1),Ze(-1)),u=ar([i,a],1),c=ar([s,l],1),f=V(Du(u,c),[o[0],o[1]]);r=U1(f)}if(r=vg(r),t.rank===3&&t.shape[0]!==0){const o=r,i=t.shape[0];r=V(r,[i,r.shape[0]/i,r.shape[1]]),o.dispose()}return r}const pq=G({irfft_:dq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mq(t,e,n=0){const o={x:M(t,"x","split")},i={numOrSizeSplits:e,axis:n};return j.runKernel(qv,o,i)}const Lr=G({split_:mq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gq(t,e){E(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let o;if(e!=null&&e<n){const p=t.shape.map(g=>0),m=t.shape.map(g=>g);m[t.shape.length-1]=e,o=dt(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,o=ar([t,fn(p)],t.shape.length-1),n=e}else o=t;const i=Ge(o),s=V(Du(o,i),[r,n]),a=tF(s),l=Math.floor(n/2)+1,u=vg(a),c=DC(a),f=Lr(u,[l,n-l],u.shape.length-1),h=Lr(c,[l,n-l],c.shape.length-1),d=o.shape.slice();return d[o.shape.length-1]=l,V(Du(f[0],h[0]),d)}const yq=G({rfft_:gq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(t,e){let n=M(t,"a","squaredDifference"),r=M(e,"b","squaredDifference");[n,r]=jt(n,r),Re(n.shape,r.shape);const o={a:n,b:r},i={};return j.runKernel(Gd,o,i)}const xq=G({squaredDifference_:vq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bq(t,e){const n=M(t,"x","squeeze","string_or_numeric");return V(n,Js(n.shape,e).newShape)}const np=G({squeeze_:bq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wq(t,e=0){const n=xM(t,"tensors","stack","string_or_numeric");E(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&E(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,o={axis:e};return j.runKernel(Mv,r,o)}const Xi=G({stack_:wq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(t,e=0){const r={x:M(t,"x","step")},o={alpha:e};return j.runKernel(Yd,r,o)}const rp=G({step_:Sq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $q(t,e,n,r,o=0,i=0,s=0,a=0,l=0){const c={x:M(t,"x","stridedSlice","string_or_numeric")},f={begin:e,end:n,strides:r,beginMask:o,endMask:i,ellipsisMask:s,newAxisMask:a,shrinkAxisMask:l};return j.runKernel(yC,c,f)}const Cq=G({stridedSlice_:$q});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kq(t){const n={x:M(t,"x","tan","float32")};return j.runKernel(Kd,n)}const Iq=G({tan_:kq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vr(t,e){O$(t);const n=Qd(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Zd(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mm(t,e,n){if(O$(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Qd(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Zd(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yp(t,e,n){if(O$(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Qd(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Zd(t,e,r,n)}function nF(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${o}.`;if(n.rank<o)throw new Error(i+` update.rank < ${o}. `);if(t.length<r+(n.rank-o))throw new Error(i+` Output shape length < ${r+(n.rank-o)}`);if(n.rank!==o+t.length-r)throw new Error(i+` update.rank != ${o+t.length-r}`);for(let s=0;s<o;++s)if(n.shape[s]!==e.shape[s])throw new Error(i+` updates.shape[${s}] (${n.shape[s]}) != indices.shape[${s}] (${e.shape[s]}).`);for(let s=0;s<n.rank-o;++s)if(n.shape[s+o]!==t[s+r])throw new Error(i+` updates.shape[${s+o}] (${n.shape[s+o]}) != shape[${s+o}] (${t[s+o]})`)}function Tq(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}nF(n,e,t)}function bl(t,e,n){const r=e.shape.length,o=r>1?e.shape[r-1]:1,i=n.length;let s=1;for(let f=o;f<i;++f)s*=n[f];const a=o<1?1:o,l=Q(e.shape)/a,u=[...ke(n.slice(0,o)),1],c=Q(n);return{sliceRank:o,numUpdates:l,sliceSize:s,strides:u,outputSize:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(t,e=1,n=!0){const r=M(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const o=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>o)throw new Error(`'k' passed to topk() must be <= the last dimension (${o}) but got ${e}`);const i={x:r},s={k:e,sorted:n},[a,l]=j.runKernel(vC,i,s);return{values:a,indices:l}}const Nq=G({topk_:Eq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aq(t,e=0,n=1,r,o){if(rs(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new HM(e,n,r,!0,o),s=Me(t,r);for(let a=0;a<s.values.length;a++)s.values[a]=i.nextValue();return s.toTensor()}const rF=G({truncatedNormal_:Aq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oq(t,e=0){const n=M(t,"x","unique","string_or_numeric");E(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},o={axis:e},[i,s]=j.runKernel(bC,r,o);return{values:i,indices:s}}const _q=G({unique_:Oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq(t,e,n){const r=M(t,"x","unsortedSegmentSum"),o=M(e,"segmentIds","unsortedSegmentSum","int32");E(Au(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:o},s={numSegments:n};return j.runKernel(Qv,i,s)}const oF=G({unsortedSegmentSum_:Dq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rq(t,e=0){const n=M(t,"x","unstack","string_or_numeric");E(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},o={axis:e};return j.runKernel(Yv,r,o)}const ol=G({unstack_:Rq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pq(t,e=!0,n,r){return j.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iF(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=Me(t,"int32"),o=Me([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const s=r.indexToLoc(n[i]),a=i*t.length;o.values.set(s,a)}return o.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mq(t,e,n){const r=M(t,"x","transpose");if(e==null&&(e=r.shape.map((s,a)=>a).reverse()),E(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(s=>{E(s>=0&&s<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const o={x:r},i={perm:e};return r.dtype==="complex64"?K(()=>{let s=vg(r),a=DC(r);return s=j.runKernel(pu,{x:s},i),a=j.runKernel(pu,{x:a},i),n&&(a=zt(a)),Du(s,a)}):j.runKernel(pu,o,i)}const Ue=G({transpose_:Mq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fq(t,e){if(e==null)return t.shape.slice();if(et(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(t,e,n,r){const o=M(t,"x","dropout");if(E(o.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${o.dtype} tensor instead.`),E(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Qt?o.clone():o;const i=Fq(o,n),s=1-e,a=Te(i0(ae(tp(i,0,1,"float32",r),s)),s);return B(o,a)}const Bq=G({dropout_:Lq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zq(t,e,n,r,o,i="NHWC",s){let a=t;t.rank===3&&(a=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=V(e,[1,e.shape[0],e.shape[1],e.shape[2]])),E(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),E(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),E(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=i==="NHWC"?a.shape[3]:a.shape[1],c=i==="NHWC"?l.shape[3]:l.shape[1];E(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),E(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),hr("conv2dDerFilter",o,s);const f={x:a,dy:l},h={strides:r,pad:o,dataFormat:i,dimRoundingMode:s,filterShape:n};return j.runKernel(V$,f,h)}const QC=G({conv2DBackpropFilter_:zq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZC(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return B(t,rp(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function JC(t,e){let n=e;const r=on(t.shape,e.shape);return r.length>0&&(n=Ie(n,r)),V(n,t.shape)}function ek(t,e,n,r){if(e==="linear")return t;if(e==="relu")return xl(t);if(e==="elu")return r0(t);if(e==="relu6")return KM(t);if(e==="prelu")return zC(t,n);if(e==="leakyrelu")return RC(t,r);if(e==="sigmoid")return vc(t);throw new Error(`Unknown fused activation ${e}.`)}const tk=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jq({x:t,filter:e,strides:n,pad:r,dataFormat:o="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",tk(j.state.gradientDepth,l)===!1){E(o==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${o} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=tl(t,e,n,r,o,i,s);return a!=null&&(S=ae(S,a)),ek(S,l,u,c)}const f=M(t,"x","conv2d","float32"),h=M(e,"filter","conv2d","float32");let d=f,p=!1;f.rank===3&&(p=!0,d=V(f,[1,f.shape[0],f.shape[1],f.shape[2]])),E(d.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${d.rank}.`),E(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),hr("fused conv2d",r,s);const m=o==="NHWC"?d.shape[3]:d.shape[1];E(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),E(Rn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const g=Sn(d.shape,h.shape,n,i,r,s);let y;a!=null&&(y=M(a,"bias","fused conv2d"),[y]=jt(y,f),o==="NHWC"?Re(g.outShape,y.shape):(E(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),E(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let v;if(u!=null){const S=u.shape;if(E(S.length<=1||S.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),S.length===1)E(S[0]===1||S[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${g.outChannels}).`);else if(S.length===3)try{Re(S,g.outShape)}catch{const C=`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(C)}v=M(u,"prelu weights","fused conv2d")}const x=(S,$)=>{E(o==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${o} but only NHWC is currently supported.`);const[C,k,I,T]=$,N=ZC(S,I,l);E(Ja(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const _=EC(k.shape,N,C,n,r),D=QC(k,N,C.shape,n,r),O=[_,D];if(T!=null){const R=JC(T,N);O.push(R)}return O},b={x:d,filter:h,bias:y,preluActivationWeights:v},w={strides:n,pad:r,dataFormat:o,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:c};return a==null?Pu(($,C,k)=>{let I=j.runKernel(fg,b,w);return k([C,$,I]),p&&(I=V(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:x}})(d,h):Pu(($,C,k,I)=>{let T=j.runKernel(fg,b,w);return I([C,$,T,k]),p&&(T=V(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:x}})(d,h,y)}const Wq=G({fusedConv2d_:jq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vq(t,e,n,r,o,i=[1,1],s){let a=t;t.rank===3&&(a=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:o,dimRoundingMode:s,dilations:i,filterShape:n};return j.runKernel(Y$,u,c)}const Uq=G({depthwiseConv2dNativeBackpropFilter_:Vq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gq(t,e,n,r,o,i=[1,1],s){let a=e,l=!1;e.rank===3&&(l=!0,a=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:o,dimRoundingMode:s,dilations:i,inputShape:t},f=j.runKernel(Q$,u,c);return l?V(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Hq=G({depthwiseConv2dNativeBackpropInput_:Gq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kq({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:o,activation:i="linear",preluActivationWeights:s,leakyreluAlpha:a=.2}){if(tk(j.state.gradientDepth,i)===!1){let T=Qe(t,e,n,r);return o!=null&&(T=ae(T,o)),ek(T,i,s,a)}let l=M(t,"a","fused matMul"),u=M(e,"b","fused matMul");[l,u]=jt(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],f=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],d=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),m=u.shape.slice(0,-2),g=Q(p),y=Q(m);E(c===f,()=>`Error in fused matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const x=Re(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,d]),b=n?V(l,[g,c,h]):V(l,[g,h,c]),w=r?V(u,[y,d,f]):V(u,[y,f,d]);let S;o!=null&&(S=M(o,"bias","fused matMul"),[S]=jt(S,l),Re(x,S.shape));let $;s!=null&&($=M(s,"prelu weights","fused matMul"));const C=(T,N)=>{const[_,D,O,R]=N,F=ZC(V(T,O.shape),O,i);let A,P;if(!n&&!r?(A=Qe(F,D,!1,!0),P=Qe(_,F,!0,!1)):!n&&r?(A=Qe(F,D,!1,!1),P=Qe(F,_,!0,!1)):n&&!r?(A=Qe(D,F,!1,!0),P=Qe(_,F,!1,!1)):(A=Qe(D,F,!0,!0),P=Qe(F,_,!0,!0)),o!=null){const z=JC(R,F);return[A,P,z]}else return[A,P]},k={a:b,b:w,bias:S,preluActivationWeights:$},I={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:a};return o==null?Pu((N,_,D)=>{const O=j.runKernel(cg,k,I);return D([N,_,O]),{value:V(O,x),gradFunc:C}})(b,w):Pu((N,_,D,O)=>{const R=j.runKernel(cg,k,I);return O([N,_,R,D]),{value:V(R,x),gradFunc:C}})(b,w,S)}const oE=G({fusedMatMul_:Kq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qq(t,e,n,r,o="bilinear",i=0){const s=M(t,"image","cropAndResize"),a=M(e,"boxes","cropAndResize","float32"),l=M(n,"boxInd","cropAndResize","int32"),u=a.shape[0];E(s.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`),E(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),E(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),E(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),E(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),E(o==="bilinear"||o==="nearest",()=>`method must be bilinear or nearest, but was ${o}`);const c={image:s,boxes:a,boxInd:l},f={method:o,extrapolationValue:i,cropSize:r};return j.runKernel(K$,c,f)}const Xq=G({cropAndResize_:qq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(t){const e=M(t,"image","flipLeftRight","float32");E(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return j.runKernel(nC,n,{})}const Qq=G({flipLeftRight_:Yq});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zq(t){const e=M(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];E(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),E(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const o=new Array(e.rank);return o.fill(1,0,n),o[n]=3,Lo(e,o)}const Jq=G({grayscaleToRGB_:Zq});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eX(t){const e=M(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];E(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),E(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const o=e.dtype,i=ge(e,"float32"),s=vr([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Jc("ij,j->i",i,s);break;case 3:a=Jc("ijk,k->ij",i,s);break;case 4:a=Jc("ijkl,l->ijk",i,s);break;case 5:a=Jc("ijklm,m->ijkl",i,s);break;case 6:a=Jc("ijklmn,n->ijklm",i,s);break;default:throw new Error("Not a valid tensor rank.")}return a=rr(a,-1),ge(a,o)}const tX=G({rgbToGrayscale_:eX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nX(t,e,n=0,r=.5){const o=M(t,"image","rotateWithOffset","float32");E(o.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${o.rank}.`);const i={image:o},s={radians:e,fillValue:n,center:r};return j.runKernel(wC,i,s)}const rX=G({rotateWithOffset_:nX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bc(t,e,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);const s=t.shape[0];return n=Math.min(n,s),E(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),E(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),E(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),E(e.rank===1,()=>"scores must be a 1D tensor"),E(e.shape[0]===s,()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${e.shape[0]}`),E(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oX(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY){const i=M(t,"boxes","nonMaxSuppression","float32"),s=M(e,"scores","nonMaxSuppression","float32"),a=bc(i,s,n,r,o);n=a.maxOutputSize,r=a.iouThreshold,o=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return j.runKernel(lC,{boxes:i,scores:s},l)}const iX=G({nonMaxSuppression_:oX});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sX(t,e,n){const r=aX(t,e,n),o=r<0?-(r+1):r;t.splice(o,0,e)}function aX(t,e,n){return uX(t,e,n||lX)}function lX(t,e){return t>e?1:t<e?-1:0}function uX(t,e,n){let r=0,o=t.length,i=0,s=!1;for(;r<o;){i=r+(o-r>>>1);const a=n(e,t[i]);a>0?r=i+1:(o=i,s=!a)}return s?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nk(t,e,n,r,o){return ik(t,e,n,r,o,0)}function rk(t,e,n,r,o,i){return ik(t,e,n,r,o,0,!1,i,!0)}function ok(t,e,n,r,o,i){return ik(t,e,n,r,o,i,!0)}function ik(t,e,n,r,o,i,s=!1,a=!1,l=!1){const u=[];for(let g=0;g<e.length;g++)e[g]>o&&u.push({score:e[g],boxIndex:g,suppressBeginIndex:0});u.sort(iE);const c=i>0?-.5/i:0,f=[],h=[];for(;f.length<n&&u.length>0;){const g=u.pop(),{score:y,boxIndex:v,suppressBeginIndex:x}=g;if(y<o)break;let b=!1;for(let w=f.length-1;w>=x;--w){const S=cX(t,v,f[w]);if(S>=r){b=!0;break}if(g.score=g.score*fX(r,c,S),g.score<=o)break}g.suppressBeginIndex=f.length,b||(g.score===y?(f.push(v),h.push(g.score)):g.score>o&&sX(u,g,iE))}const d=f.length,p=n-d;a&&p>0&&(f.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:f};return s&&(m.selectedScores=h),l&&(m.validOutputs=d),m}function cX(t,e,n){const r=t.subarray(e*4,e*4+4),o=t.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),f=Math.max(o[0],o[2]),h=Math.max(o[1],o[3]),d=(a-i)*(l-s),p=(f-u)*(h-c);if(d<=0||p<=0)return 0;const m=Math.max(i,u),g=Math.max(s,c),y=Math.min(a,f),v=Math.min(l,h),x=Math.max(y-m,0)*Math.max(v-g,0);return x/(d+p-x)}function fX(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function iE(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hX(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY){const i=M(t,"boxes","nonMaxSuppressionAsync"),s=M(e,"scores","nonMaxSuppressionAsync"),a=bc(i,s,n,r,o);n=a.maxOutputSize,r=a.iouThreshold,o=a.scoreThreshold;const l=await Promise.all([i.data(),s.data()]),u=l[0],c=l[1],{selectedIndices:f}=nk(u,c,n,r,o);return i!==t&&i.dispose(),s!==e&&s.dispose(),vr(f,"int32")}const dX=hX;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pX(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY,i=0){const s=M(t,"boxes","nonMaxSuppression"),a=M(e,"scores","nonMaxSuppression"),l=bc(s,a,n,r,o,i);n=l.maxOutputSize,r=l.iouThreshold,o=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:s,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i},f=j.runKernel(cC,u,c);return{selectedIndices:f[0],selectedScores:f[1]}}const mX=G({nonMaxSuppressionWithScore_:pX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function gX(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY,i=0){const s=M(t,"boxes","nonMaxSuppressionAsync"),a=M(e,"scores","nonMaxSuppressionAsync"),l=bc(s,a,n,r,o,i);n=l.maxOutputSize,r=l.iouThreshold,o=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([s.data(),a.data()]),c=u[0],f=u[1],{selectedIndices:h,selectedScores:d}=ok(c,f,n,r,o,i);return s!==t&&s.dispose(),a!==e&&a.dispose(),{selectedIndices:vr(h,"int32"),selectedScores:vr(d)}}const yX=gX;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vX(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY,i=!1){const s=M(t,"boxes","nonMaxSuppression"),a=M(e,"scores","nonMaxSuppression"),l=bc(s,a,n,r,o,null),u=l.maxOutputSize,c=l.iouThreshold,f=l.scoreThreshold,h={boxes:s,scores:a},d={maxOutputSize:u,iouThreshold:c,scoreThreshold:f,padToMaxOutputSize:i},p=j.runKernel(uC,h,d);return{selectedIndices:p[0],validOutputs:p[1]}}const xX=G({nonMaxSuppressionPadded_:vX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function bX(t,e,n,r=.5,o=Number.NEGATIVE_INFINITY,i=!1){const s=M(t,"boxes","nonMaxSuppressionAsync"),a=M(e,"scores","nonMaxSuppressionAsync"),l=bc(s,a,n,r,o,null),u=l.maxOutputSize,c=l.iouThreshold,f=l.scoreThreshold,[h,d]=await Promise.all([s.data(),a.data()]),{selectedIndices:p,validOutputs:m}=rk(h,d,u,c,f,i);return s!==t&&s.dispose(),a!==e&&a.dispose(),{selectedIndices:vr(p,"int32"),validOutputs:Ze(m,"int32")}}const wX=bX;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SX(t,e,n=!1,r=!1){const o=M(t,"images","resizeBilinear");E(o.rank===3||o.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${o.rank}.`),E(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),E(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=o,s=!1;o.rank===3&&(s=!0,i=V(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=j.runKernel(Wv,a,l);return s?V(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const sF=G({resizeBilinear_:SX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $X(t,e,n=!1,r=!1){const o=M(t,"images","resizeNearestNeighbor");E(o.rank===3||o.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${o.rank}.`),E(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),E(o.dtype==="float32"||o.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),E(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=o,s=!1;o.rank===3&&(s=!0,i=V(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=j.runKernel(jv,a,l);return s?V(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const aF=G({resizeNearestNeighbor_:$X});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CX(t,e="binary",n=!1,r=.5){const o=M(t,"image","threshold"),i=.2989,s=.587,a=.114,l=o.shape[0]*o.shape[1];let u=B(vr([r]),255),c,f,h,d;if(E(o.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${o.rank}.`),E(o.shape[2]===3||o.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${o.shape[2]}.`),E(o.dtype==="int32"||o.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${o.dtype}.`),E(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),o.shape[2]===3){[c,f,h]=Lr(o,[1,1,1],-1);const g=B(c,i),y=B(f,s),v=B(h,a);d=ae(ae(g,y),v)}else d=t;if(e==="otsu"){const g=$5(ge(qM(d),"int32"),bM([]),256);u=kX(g,l)}const p=n?xc(d,u):Ur(d,u);return ge(B(p,255),"int32")}function kX(t,e){let n=vr([-1]),r=vr([0]),o=vr([0]),i,s,a,l,u,c;for(let f=0;f<t.size-1;f++){i=dt(t,0,f+1),s=dt(t,f+1),u=Te(Ie(i),e),c=Te(Ie(s),e);const h=Ie(B(i,ah(0,i.size)));a=Te(h,Ie(i));const d=n0(s.shape,i.size),p=ae(ah(0,s.size),d),m=B(s,p);l=Te(Ie(m),Ie(s));const g=Ae(a,l),y=Ae(a,l),v=B(u,c);o=B(B(v,g),y);const x=Ur(o,r);r=Yn(x,o,r),n=Yn(x,vr([f]),n)}return n}const IX=G({threshold_:CX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TX(t,e,n="nearest",r="constant",o=0,i){const s=M(t,"image","transform","float32"),a=M(e,"transforms","transform","float32");E(s.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`),E(a.rank===2&&(a.shape[0]===s.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),E(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:s,transforms:a},u={interpolation:n,fillMode:r,fillValue:o,outputShape:i};return j.runKernel(xC,l,u)}const EX=G({transform_:TX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NX(t,e,n){const r=M(t,"a","bandPart");E(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const o=r.shape,[i,s]=r.shape.slice(-2);let a,l;typeof e=="number"?(E(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),E(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=M(e<0?i:e,"numLower","bandPart")):(E(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Yn(gg(e,0),i,sh(e,i))),typeof n=="number"?(E(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),E(n<=s,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${s}).`),l=M(n<0?s:n,"numUpper","bandPart")):(E(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Yn(gg(n,0),s,sh(n,s)));const u=V(ah(0,i,1,"int32"),[-1,1]),c=ah(0,s,1,"int32"),f=Ae(u,c),h=qi(xc(f,a),yl(f,zt(l))),d=fn([i,s],r.dtype);return V(Xi(ol(V(r,[-1,i,s])).map(p=>Yn(h,p,d))),o)}const AX=G({bandPart_:NX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OX(t){let e;if(Array.isArray(t)){e=!1,E(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const o=t[0].shape[0];for(let i=1;i<t.length;++i)E(t[i].shape[0]===o,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${o})`)}else e=!0,t=Lr(t,t.shape[0],0).map(o=>np(o,[0]));E(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let o=0;o<t.length;++o)n.push(j.tidy(()=>{let i=r[o];if(o>0)for(let s=0;s<o;++s){const a=B(Ie(B(n[s],i)),n[s]);i=Ae(i,a)}return Te(i,o0(i,"euclidean"))}));return e?Xi(n,0):n}const _X=G({gramSchmidt_:OX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DX(t,e=!1){if(E(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return sE(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=ol(V(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],i=[];r.forEach(l=>{const[u,c]=sE(l,e);o.push(u),i.push(c)});const s=V(Xi(o,0),t.shape),a=V(Xi(i,0),t.shape);return[s,a]}}function sE(t,e=!1){return j.tidy(()=>{E(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let o=BM(n),i=Ba(t);const s=Mm([[1]],[1,1]);let a=Ba(s);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=i,f=a,h=o;[a,i,o]=j.tidy(()=>{const d=dt(i,[u,u],[n-u,1]),p=o0(d),m=dt(i,[u,u],[1,1]),g=Yn(Ur(m,0),Mm([[-1]]),Mm([[1]])),y=Ae(m,B(g,p)),v=Te(d,y);v.shape[0]===1?a=Ba(s):a=ar([s,dt(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const x=zt(Te(Qe(g,y),p)),b=dt(i,[u,0],[n-u,r]),w=B(x,a),S=Ue(a);if(u===0)i=Ae(b,Qe(w,Qe(S,b)));else{const k=Ae(b,Qe(w,Qe(S,b)));i=ar([dt(i,[0,0],[u,r]),k],0)}const $=Ue(w),C=dt(o,[0,u],[n,o.shape[1]-u]);if(u===0)o=Ae(C,Qe(Qe(C,a),$));else{const k=Ae(C,Qe(Qe(C,a),$));o=ar([dt(o,[0,0],[n,u]),k],1)}return[a,i,o]}),ze([c,f,h])}return!e&&n>r&&(o=dt(o,[0,0],[n,r]),i=dt(i,[0,0],[r,r])),[o,i]})}const RX=G({qr_:DX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Di={flipLeftRight:Qq,grayscaleToRGB:Jq,resizeNearestNeighbor:aF,resizeBilinear:sF,rgbToGrayscale:tX,rotateWithOffset:rX,cropAndResize:Xq,nonMaxSuppression:iX,nonMaxSuppressionAsync:dX,nonMaxSuppressionWithScore:mX,nonMaxSuppressionWithScoreAsync:yX,nonMaxSuppressionPadded:xX,nonMaxSuppressionPaddedAsync:wX,threshold:IX,transform:EX},PX={bandPart:AX,gramSchmidt:_X,qr:RX};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MX=new Map,FX=new Map;class wc{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class to{constructor(){this.classNameMap={}}static getMap(){return to.instance==null&&(to.instance=new to),to.instance}static register(e){to.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ie(t,e,n){E(t.className!=null,()=>"Class being registered does not have the static className property defined."),E(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),E(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,o=e+">"+r;return to.register(t),MX.set(o,t),FX.set(t,o),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ia extends wc{minimize(e,n=!1,r){const{value:o,grads:i}=this.computeGradients(e,r);if(r!=null){const s=r.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(s)}else this.applyGradients(i);return ze(i),n?o:(o.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return U8(e,n)}dispose(){this.iterations_!=null&&ze(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ze(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ia,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lF extends ia{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=j.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const i=j.registeredVariables[r],s=!1;this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${r}/accum_grad`,variable:K(()=>Ge(i).variable(s))}),this.accumulatedUpdates[o]==null&&(this.accumulatedUpdates[o]={originalName:`${r}/accum_var`,variable:K(()=>Ge(i).variable(s))});const a=Array.isArray(e)?e[o].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[o].variable,u=this.accumulatedUpdates[o].variable;K(()=>{const c=ae(B(l,this.rho),B(xt(a),1-this.rho)),f=B(Te(Dn(ae(u,this.epsilon)),Dn(ae(l,this.epsilon))),a),h=ae(B(u,this.rho),B(xt(f),1-this.rho));l.assign(c),u.assign(h);const d=ae(B(f,-this.learningRate),i);i.assign(d)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(ze(this.accumulatedGrads.map(e=>e.variable)),ze(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uF extends ia{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const i=j.registeredVariables[r];this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${r}/accumulator`,variable:K(()=>n0(i.shape,this.initialAccumulatorValue).variable(!1))});const s=Array.isArray(e)?e[o].tensor:e[r];if(s==null)return;const a=this.accumulatedGrads[o].variable;K(()=>{const l=ae(a,xt(s));a.assign(l);const u=ae(B(Te(s,Dn(ae(l,j.backend.epsilon()))),-this.learningRate),i);i.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&ze(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cF extends ia{static get className(){return"Adam"}constructor(e,n,r,o=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=o,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],K(()=>{this.accBeta1=Ze(n).variable(),this.accBeta2=Ze(r).variable()}),o==null&&(this.epsilon=j.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);K(()=>{const r=Ae(1,this.accBeta1),o=Ae(1,this.accBeta2);n.forEach((i,s)=>{const a=j.registeredVariables[i],l=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${i}/m`,variable:K(()=>Ge(a).variable(l))}),this.accumulatedSecondMoment[s]==null&&(this.accumulatedSecondMoment[s]={originalName:`${i}/v`,variable:K(()=>Ge(a).variable(l))});const u=Array.isArray(e)?e[s].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[s].variable,f=this.accumulatedSecondMoment[s].variable,h=ae(B(c,this.beta1),B(u,1-this.beta1)),d=ae(B(f,this.beta2),B(xt(u),1-this.beta2)),p=Te(h,r),m=Te(d,o);c.assign(h),f.assign(d);const g=ae(B(Te(p,ae(Dn(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(B(this.accBeta1,this.beta1)),this.accBeta2.assign(B(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ze(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&ze(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),K(()=>{this.accBeta1.assign(nl(this.beta1,this.iterations_+1)),this.accBeta2.assign(nl(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fF extends ia{static get className(){return"Adamax"}constructor(e,n,r,o=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=o,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],K(()=>{this.iteration=Ze(0).variable(),this.accBeta1=Ze(n).variable()}),o==null&&(this.epsilon=j.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);K(()=>{const r=Ae(1,this.accBeta1),o=Te(-this.learningRate,ae(B(this.iteration,this.decay),1));n.forEach((i,s)=>{const a=j.registeredVariables[i],l=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${i}/m`,variable:Ge(a).variable(l)}),this.accumulatedWeightedInfNorm[s]==null&&(this.accumulatedWeightedInfNorm[s]={originalName:`${i}/v`,variable:Ge(a).variable(l)});const u=Array.isArray(e)?e[s].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[s].variable,f=this.accumulatedWeightedInfNorm[s].variable,h=ae(B(c,this.beta1),B(u,1-this.beta1)),d=B(f,this.beta2),p=Un(u),m=ra(d,p);c.assign(h),f.assign(m);const g=ae(B(Te(o,r),Te(h,ae(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(ae(this.iteration,1)),this.accBeta1.assign(B(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ze(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&ze(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sk extends ia{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const i=Array.isArray(e)?e[o].tensor:e[r];if(i==null)return;const s=j.registeredVariables[r];K(()=>{const a=ae(B(this.c,i),s);s.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=hi(Ze(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hF extends sk{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=Ze(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const i=j.registeredVariables[r];this.accumulations[o]==null&&(this.accumulations[o]={originalName:`${r}/momentum`,variable:K(()=>Ge(i).variable(!1))});const s=this.accumulations[o].variable,a=Array.isArray(e)?e[o].tensor:e[r];a!=null&&K(()=>{let l;const u=ae(B(this.m,s),a);this.useNesterov?l=ae(B(this.c,ae(a,B(u,this.m))),i):l=ae(B(this.c,u),i),s.assign(u),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&ze(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dF extends ia{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,o=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=o,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,o==null&&(this.epsilon=j.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,o)=>{const i=j.registeredVariables[r],s=!1;this.accumulatedMeanSquares[o]==null&&(this.accumulatedMeanSquares[o]={originalName:`${r}/rms`,variable:K(()=>Ge(i).variable(s))}),this.accumulatedMoments[o]==null&&(this.accumulatedMoments[o]={originalName:`${r}/momentum`,variable:K(()=>Ge(i).variable(s))}),this.accumulatedMeanGrads[o]==null&&this.centered&&(this.accumulatedMeanGrads[o]={originalName:`${r}/mg`,variable:K(()=>Ge(i).variable(s))});const a=Array.isArray(e)?e[o].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[o].variable,u=this.accumulatedMoments[o].variable;K(()=>{const c=ae(B(l,this.decay),B(xt(a),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[o].variable,h=ae(B(f,this.decay),B(a,1-this.decay)),d=Te(B(a,this.learningRate),Dn(Ae(c,ae(xt(h),this.epsilon)))),p=ae(B(u,this.momentum),d);l.assign(c),f.assign(h),u.assign(p);const m=Ae(i,p);i.assign(m)}else{const f=ae(B(l,this.decay),B(xt(a),1-this.decay)),h=ae(B(u,this.momentum),Te(B(a,this.learningRate),Dn(ae(f,this.epsilon))));l.assign(f),u.assign(h);const d=Ae(i,h);i.assign(d)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&ze(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&ze(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&ze(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LX=[lF,uF,cF,fF,hF,dF,sk];function BX(){for(const t of LX)ie(t)}function ak(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(Q(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const o=e.shape,i=o[o.length-1];let s=1;for(let f=0;f<o.length-1;++f)s*=o[f];const a=t.shape,l=o.slice();l.pop();let u=1;for(let f=i;f<n;++f)u*=a[f],l.push(a[f]);const c=[...ke(t.shape).map(f=>f/u),1].slice(0,i);return[l,s,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G1=-2,zX=-1;function lk(t,e,n){const r=t.shape.length;E(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),E(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let o=0;o<r;++o)E(e[o]+n[o]<=t.shape[o],()=>`Error in slice${r}D: begin[${o}] + size[${o}] (${e[o]+n[o]}) would overflow input.shape[${o}] (${t.shape[o]})`)}function jX(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function uk(t,e,n){const r=[];for(let o=0;o<t.length;o++)r[o]=Math.ceil((e[o]-t[o])/n[o]);return r}function pF(t,e,n,r){const o=[...t];for(let i=o.length;i<r.length;i++)o.push(1);for(let i=0;i<n;i++)i===0?o[e]=1:(o.splice(e,0,1),o.pop());return o}function mF(t,e,n){return n<=t?n:n-(e-1)}function gF(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function WX(t,e,n,r,o,i,s,a,l){const u=t.length;let c=new Array(u),f=new Array(u),h=new Array(u);if(e.length&&n>0){const d=e[0],p=n+1;c=yF(s,d,p,r,t),f=vF(a,d,p,o,t),h=pF(i,d,p,t)}else for(let d=0;d<u;d++)c[d]=bF(s,r,i,t,d,l),f[d]=wF(a,o,i,t,d,l),h[d]=xF(i,d,l);return{begin:c,end:f,strides:h}}function yF(t,e,n,r,o){const i=[...o],s=gF(n,e);for(let a=0;a<i.length;a++)if(s.indexOf(a)>-1)i[a]=0;else{const l=mF(e,n,a);let u=r[l];t&1<<l&&(u=0),i[a]=u}return i}function vF(t,e,n,r,o){const i=[...o],s=gF(n,e);for(let a=0;a<i.length;a++)if(s.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=mF(e,n,a);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),i[a]=u}for(let a=0;a<i.length;a++){const l=o[a];i[a]<0&&(i[a]+=l),i[a]=Xa(0,i[a],o[a])}return i}function xF(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function bF(t,e,n,r,o,i){let s=e[o];const a=n[o]||1;(t&1<<o||i&1<<o||s==null)&&(a>0?s=Number.MIN_SAFE_INTEGER:s=Number.MAX_SAFE_INTEGER);const l=r[o];return s<0&&(s+=l),s=Xa(0,s,l-1),s}function wF(t,e,n,r,o,i){let s=e[o];const a=n[o]||1;(t&1<<o||i&1<<o||s==null)&&(a>0?s=Number.MAX_SAFE_INTEGER:s=Number.MIN_SAFE_INTEGER);const l=r[o];return s<0&&(s+=l),a>0?s=Xa(0,s,l):s=Xa(-1,s,l-1),s}function ck(t,e,n){let r=n.length;for(let o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(let o=r+1;o<n.length;o++)if(e[o]>0||n[o]!==t[o])return!1;return!0}function fk(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function s0(t,e,n){let r;const o=t.shape.length;typeof e=="number"?r=[e,...new Array(o-1).fill(0)]:e.length<o?r=e.concat(new Array(o-e.length).fill(0)):r=e.slice(),r.forEach(s=>{E(s!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(o).fill(-1):typeof n=="number"?i=[n,...new Array(o-1).fill(-1)]:n.length<o?i=n.concat(new Array(o-n.length).fill(-1)):i=n,i=i.map((s,a)=>s>=0?s:(E(s===-1,()=>`Negative size values should be exactly -1 but got ${s} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,i]}function hk(t,e,n,r,o,i,s,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,s!=null&&s&s-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const f={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:o,endMask:i,ellipsisMask:s,newAxisMask:a,shrinkAxisMask:l};for(let x=0;x<f.dims;x++)c&&1<<x&a&&f.numAddAxisAfterEllipsis++,1<<x&s&&(c=!0);c||(f.ellipsisMask|=1<<f.dims,f.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};VX(f,h);let d=!0,p=!0,m=!0;const g=[],y=[];for(let x=0;x<t.length;++x){if(h.strides[x]===0)throw Error(`strides[${x}] must be non-zero`);const b=!!(h.shrinkAxisMask&1<<x),w=t[x];if(w===-1){g.push(b?1:-1);continue}const S=[h.beginMask&1<<x,h.endMask&1<<x],$=[h.strides[x]>0?0:-1,h.strides[x]>0?w:w-1];if(b&&h.strides[x]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[x]===1;const C=!!(h.beginMask&1<<x&&h.endMask&1<<x);if(h.beginValid&&h.endValid){if(b){const N=h.begin[x]<0?w+h.begin[x]:h.begin[x];if(h.begin[x]=N,h.end[x]=h.begin[x]+1,N<0||N>=w)throw Error(`slice index ${h.begin[x]} of dimension ${x} out of bounds.`)}else h.begin[x]=aE(h.begin[x],0,h.strides[x],w,S,$),h.end[x]=aE(h.end[x],1,h.strides[x],w,S,$);const T=h.strides[x]===1&&h.begin[x]===0&&h.end[x]===w;d=d&&T,p=p&&(x===0&&h.strides[x]===1||T)}else d=d&&h.strides[x]===1&&C,p=p&&(x===0&&h.strides[x]===1||C);let k,I=!1;if(h.beginValid&&h.endValid?(k=h.end[x]-h.begin[x],I=!0):b?(k=1,I=!0):C&&w>=0&&(h.strides[x]<0?k=-w:k=w,I=!0),I){let T;k===0||k<0!=h.strides[x]<0?T=0:T=Math.trunc(k/h.strides[x])+(k%h.strides[x]!==0?1:0),g.push(T)}else g.push(-1)}for(let x=0;x<h.finalShapeGatherIndices.length;++x){const b=h.finalShapeGatherIndices[x];b>=0?y.push(g[b]):b===G1&&y.push(1)}return{finalShapeSparse:y.filter((x,b)=>h.finalShapeGatherIndices[b]!==G1),finalShape:y,isIdentity:d,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function VX(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const o=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<o;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(G1),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(zX),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function aE(t,e,n,r,o,i){if(o[e])return n>0?i[e]:i[e+1&1];{const s=t<0?r+t:t;return s<i[0]?i[0]:s>i[1]?i[1]:s}}const UX=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:lk,computeFlatOffset:fk,computeOutShape:uk,getNormalizedAxes:WX,isSliceContinous:ck,maskToAxes:jX,parseSliceParams:s0,sliceInfo:hk,startForAxis:bF,startIndicesWithElidedDims:yF,stopForAxis:wF,stopIndicesWithElidedDims:vF,stridesForAxis:xF,stridesWithElidedDims:pF},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GX{static sgd(e){return new sk(e)}static momentum(e,n,r=!1){return new hF(e,n,r)}static rmsprop(e,n=.9,r=0,o=null,i=!1){return new dF(e,n,r,o,i)}static adam(e=.001,n=.9,r=.999,o=null){return new cF(e,n,r,o)}static adadelta(e=.001,n=.95,r=null){return new lF(e,n,r)}static adamax(e=.002,n=.9,r=.999,o=null,i=0){return new fF(e,n,r,o,i)}static adagrad(e,n=.1){return new uF(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pl=GX;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HX=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function SF(){return new Promise(t=>HX(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dk(t,e){const n=t[0].length;t.forEach((o,i)=>{E(o.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),E(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((o,i)=>{for(let s=0;s<n;s++)E(s===e||o[s]===r[s],()=>`Error in concat${n}D: Shape of tensors[${i}] (${o}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function di(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ro;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Ro||(Ro={}));function $F(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let o=1;o<n.length;++o){const i=n[o],s=r[r.length-n.length+o],a=r[s];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${o+t}] = ${i} but shape[${o+t}] = ${a}`)}else r[s]=i}return r}function CF(t){const e={FIRST_DIM_SIZE:Ro.FIRST_DIM_SIZE,VALUE_ROWIDS:Ro.VALUE_ROWIDS,ROW_LENGTHS:Ro.ROW_LENGTHS,ROW_SPLITS:Ro.ROW_SPLITS,ROW_LIMITS:Ro.ROW_LIMITS,ROW_STARTS:Ro.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function kF(t){return t.length===0?0:t[0]===Ro.FIRST_DIM_SIZE?t.length-1:t.length}function IF(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let o=0;o<Math.min(n,r-1);++o){const i=t[o],s=e[o+1];if(i>=0&&s>=0&&i!==1&&i!==s)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${o-t.length}] = ${i} but ragged tensor input.flatValues.shape[${o-t.length}] = ${s}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pk=30;function a0(t){return t<=pk?t:E1(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mk(t,e,n){const r=n*(typeof t=="number"?t:t[0]),o=e*(typeof t=="number"?t:t[1]);return[r,o]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function op(t,e,n,r=!0){let o=[];if(r)o=o.concat(e.slice(0)),o.push(t[0]/n),o=o.concat(t.slice(1));else{o=o.concat(t[0]);const i=e.length;for(let s=0;s<i;++s)o=o.concat([t[s+1]/e[s],e[s]]);o=o.concat(t.slice(i+1))}return o}function ip(t,e,n=!0){const r=[];if(n){r.push(e);for(let o=e+1;o<t;++o)o<=2*e?(r.push(o),r.push(o-(e+1))):r.push(o)}else{const o=[],i=[];for(let s=1;s<t;++s)s>=e*2+1||s%2===1?i.push(s):o.push(s);r.push(...o),r.push(0),r.push(...i)}return r}function sp(t,e,n,r=!0){const o=[];r?o.push(t[0]/n):o.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?o.push(e[i-1]*t[i]):o.push(t[i]/e[i-1]):o.push(t[i]);return o}function gk(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function yk(t,e,n){const r=t.slice(0,1);for(let o=0;o<n;++o)r.push(t[o+1]-e[o][0]-e[o][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l0=1.7580993408473768,u0=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vk=.3275911,xk=.254829592,bk=-.284496736,wk=1.421413741,Sk=-1.453152027,$k=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yi(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function TF(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function EF(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let o=0;o<t.length;o+=4)n[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:n,imag:r}}function NF(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let o=2;o<t.length;o+=4)n[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:n,imag:r}}function Ck(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function AF(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function OF(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let o=0;o<Math.ceil(t/2);o++){const i=(e?2:-2)*Math.PI*(o/t);n[o]=Math.cos(i),r[o]=Math.sin(i)}return{real:n,imag:r}}function _F(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),o=Math.cos(r),i=Math.sin(r);return{real:o,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ux="->",KX=/->/g,lE=",",uE="...";function kk(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(KX,"").length)/Ux.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Ux}").`);const[r,o]=t.split(Ux);E(r.indexOf(uE)===-1,()=>`The ellipsis notation ("${uE}") is not supported yet.`);const i=r.split(lE),s=i.length;if(e!==s)throw new Error(`Expected ${s} input tensors, received ${e}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<o.length;++h){const d=o[h];if(!i.some(p=>p.indexOf(d)!==-1))throw new Error(`Output subscripts contain the label ${d} not present in the input subscripts.`);a.indexOf(d)===-1&&a.push(d)}for(let h=0;h<r.length;++h){const d=r[h];a.indexOf(d)===-1&&d!==lE&&a.push(d)}const l=new Array(i.length);for(let h=0;h<s;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let d=0;d<i[h].length;++d)l[h].push(a.indexOf(i[h][d]))}const u=a.length,c=o.length,f=[];for(let h=c;h<u;++h)f.push(h);return{allDims:a,summedDims:f,idDims:l}}function Ik(t,e){let n=new Array(t);n.fill(-1);for(let o=0;o<e.length;++o)n[e[o]]=o;const r=[];for(let o=0;o<t;++o)n[o]===-1&&r.push(o);return n=n.filter(o=>o!==-1),{permutationIndices:n,expandDims:r}}function Tk(t,e,n){const r=new Array(t);for(let o=0;o<n.length;++o){const i=n[o].shape;for(let s=0;s<e[o].length;++s)r[e[o][s]]===void 0?r[e[o][s]]=i[s]:E(r[e[o][s]]===i[s],()=>`Expected dimension ${r[e[o][s]]} at axis ${s} of input shaped ${JSON.stringify(i)}, but got dimension ${i[s]}`)}}function Ek(t,e){const n=t,r=[];let o=0;t.length===0&&n.push(-1),o=t.length+1;for(let s=0;s<o;++s)r.push([]);const i=[];for(let s=0;s<n.length;++s){const a=n[s],l=qX(e,a);for(const u of l)i.indexOf(u)===-1&&(r[s].push(u),i.push(u))}return{path:n,steps:r}}function Nk(t){return t.every((e,n)=>e===n)}function qX(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function Ak(t,e,n=0){let r=[];if(typeof e=="number")E(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const o=e.reduce((s,a)=>(a===-1&&(s+=1),s),0);E(o<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const s=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-s}E(t.shape[n]===e.reduce((s,a)=>s+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DF(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function RF(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function PF(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MF(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function FF(t,e){return`size ${t} must be non-negative, not ${e}`}function LF(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function BF(t,e){const n=Q(t),r=Q(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function zF(t,e){const n=Q(t),r=Q(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1(){return"segment ids must be >= 0"}function jF(){return"segment ids are not increasing"}function WF(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function VF(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UF(t,e){let n=!1,r;for(t<=pk?(r=t,n=!0):r=E1(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=E1(t,r+1);return r}function GF(t,e,n){const r=[],o=t.length;for(let i=0;i<o;i++)i!==e?r.push(t[i]):r.push(n);return r}function Ok(t,e,n,r){const o=e.shape.length,i=t.shape.length;if(r!==0&&(r<-o||r>o))throw new Error(`Expect batchDims in the range of [-${o}, ${o}], but got ${r}`);if(r<0&&(r+=o),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let f=0;f<r;++f)if(t.shape[f]!==e.shape[f])throw new Error(`x.shape[${f}]: ${t.shape[f]} should be equal to indices.shape[${f}]: ${e.shape[f]}.`);const s=t.shape[n],a=[];let l=1,u=1,c=1;for(let f=0;f<r;++f)a.push(t.shape[f]),l*=t.shape[f];for(let f=r;f<n;f++)a.push(t.shape[f]),u*=t.shape[f];for(let f=r;f<o;f++)a.push(e.shape[f]);for(let f=n+1;f<i;f++)a.push(t.shape[f]),c*=t.shape[f];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:s,outputShape:a}}const XX=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:Ok,computeOutShape:GF,segOpComputeOptimalWindowSize:UF},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qi(t){try{return t.map(e=>Us(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function HF(t){return t.map(e=>Fs(e))}const YX=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:xk,ERF_A2:bk,ERF_A3:wk,ERF_A4:Sk,ERF_A5:$k,ERF_P:vk,PARALLELIZE_THRESHOLD:pk,get RowPartitionType(){return Ro},SELU_SCALE:u0,SELU_SCALEALPHA:l0,applyActivation:ek,assertAndGetBroadcastShape:Re,assertAxesAreInnerMostDims:$n,assertParamsConsistent:dk,assignToTypedArray:AF,axesAreInnerMostDims:OC,calculateShapes:bl,checkEinsumDimSizes:Tk,checkPadOnDimRoundingMode:hr,combineLocations:FM,combineRaggedTensorToTensorShapes:$F,complexWithEvenIndex:EF,complexWithOddIndex:NF,computeConv2DInfo:Sn,computeConv3DInfo:ta,computeDefaultPad:kC,computeDilation2DInfo:Jd,computeOptimalWindowSize:a0,computeOutAndReduceShapes:mn,computeOutShape:di,computePool2DInfo:vo,computePool3DInfo:os,convertConv2DDataFormat:is,decodeEinsumEquation:kk,eitherStridesOrDilationsAreOne:Rn,expandShapeToKeepDim:qt,exponent:_F,exponents:OF,fromStringArrayToUint8:HF,fromUint8ToStringArray:Qi,getAxesPermutation:Ot,getBroadcastDims:Ru,getComplexWithIndex:Ck,getEinsumComputePath:Ek,getEinsumPermutation:Ik,getFusedBiasGradient:JC,getFusedDyActivation:ZC,getImageCenter:mk,getInnerMostAxes:Wt,getPermuted:ip,getRaggedRank:kF,getReductionAxes:on,getReshaped:op,getReshapedPermuted:sp,getRowPartitionTypesHelper:CF,getSliceBeginCoords:gk,getSliceSize:yk,getSparseFillEmptyRowsIndicesDenseShapeMismatch:DF,getSparseFillEmptyRowsNegativeIndexErrorMessage:RF,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:PF,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:LF,getSparseReshapeInputOutputMismatchErrorMessage:zF,getSparseReshapeInputOutputMultipleErrorMessage:BF,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:MF,getSparseReshapeNegativeOutputDimErrorMessage:FF,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:VF,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:H1,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:jF,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:WF,getUndoAxesPermutation:na,isIdentityPermutation:Nk,log:DH,mergeRealAndImagArrays:Yi,prepareAndValidate:ak,prepareSplitSize:Ak,segment_util:XX,shouldFuse:tk,slice_util:UX,splitRealAndImagArrays:TF,stridesOrDilationsArePositive:el,tupleValuesAreOne:Ja,upcastType:$r,validateDefaultValueShape:IF,validateInput:Tq,validateUpdateShape:nF,warn:Dr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */BX();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KF={kernelName:Jy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,rp(ge(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QX={kernelName:nd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=xt(ge(n,"float32")),o=Dn(Ae(Ze(1),r));return zt(Te(t,o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZX={kernelName:rd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Dn(Ae(xt(ge(n,"float32")),1));return Te(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JX={kernelName:gc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=Re(n.shape,r.shape);return{a:()=>{let a=t;const l=on(n.shape,o);return l.length>0&&(a=Ie(a,l)),V(a,n.shape)},b:()=>{let a=t;const l=on(r.shape,o);return l.length>0&&(a=Ie(a,l)),V(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7={kernelName:P$,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,o)=>{n[o]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t7={kernelName:ev,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ge(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n7={kernelName:tv,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ge(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r7={kernelName:od,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,Dn(Ae(Ze(1),xt(ge(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7={kernelName:id,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Dn(ae(Ze(1),xt(ge(n,"float32"))));return Te(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7={kernelName:ld,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=Re(n.shape,r.shape);return{a:()=>{const a=ae(xt(n),xt(r));let l=B(t,Te(r,a));const u=on(n.shape,o);return u.length>0&&(l=Ie(l,u)),V(l,n.shape)},b:()=>{const a=ae(xt(n),xt(r));let l=zt(B(t,Te(n,a)));const u=on(r.shape,o);return u.length>0&&(l=Ie(l,u)),V(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s7={kernelName:sd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,ae(xt(ge(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a7={kernelName:ad,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,Ae(Ze(1),xt(ge(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(t,e,n,r,o,i){const s=M(t,"dy","avgPool3dGrad"),a=M(e,"input","avgPool3dGrad");let l=s,u=a,c=!1;a.rank===4&&(c=!0,l=V(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),u=V(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),E(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),E(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),hr("avgPool3dGrad",o,i);const f={dy:l,input:u},h={filterSize:n,strides:r,pad:o,dimRoundingMode:i},d=j.runKernel(B$,f,h);return c?V(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const u7=G({avgPool3dGrad_:l7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c7={kernelName:rv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:o,strides:i,pad:s,dimRoundingMode:a}=n;return{x:()=>u7(t,r,o,i,s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f7(t,e,n,r,o){const i=M(t,"dy","avgPoolGrad"),s=M(e,"input","avgPoolGrad");E(s.rank===i.rank,()=>`Rank of input (${s.rank}) does not match rank of dy (${i.rank})`);let a=s,l=i,u=!1;s.rank===3&&(u=!0,a=V(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=V(i,[1,i.shape[0],i.shape[1],i.shape[2]])),E(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),E(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:l,input:a},f={filterSize:n,strides:r,pad:o},h=j.runKernel(L$,c,f);return u?V(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const h7=G({avgPoolGrad_:f7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d7={kernelName:nv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:o,strides:i,pad:s}=n;return{x:()=>h7(t,r,o,i,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p7={kernelName:ov,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,o]=e,{transposeA:i,transposeB:s}=n;return!i&&!s?{a:()=>Qe(t,o,!1,!0),b:()=>Qe(r,t,!0,!1)}:!i&&s?{a:()=>Qe(t,o,!1,!1),b:()=>Qe(t,r,!0,!1)}:i&&!s?{a:()=>Qe(o,t,!1,!0),b:()=>Qe(r,t,!1,!1)}:{a:()=>Qe(o,t,!0,!0),b:()=>Qe(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m7={kernelName:iv,gradFunc:(t,e,n)=>{const{blockShape:r,crops:o}=n;return{x:()=>BC(t,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g7={kernelName:NH,gradFunc:(t,e,n)=>{const r=n,o=r.inputShape,i=r.shape,s=Array.from(i);for(let l=o.length-1;l>=0;l--)if(o[l]===i[l])s[l]=1;else if(o[l]!==1)throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<s.length;l++)s[l]>1&&a.push(l);return{x:()=>Ie(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y7={kernelName:ud,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v7={kernelName:cd,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x7={kernelName:fd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:o,clipValueMax:i}=n;return{x:()=>Yn(qi(yl(r,o),xc(r,i)),t,Ge(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b7={kernelName:sv,inputsToSave:["x"],gradFunc:KF.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w7={kernelName:av,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(l=>l.shape),{axis:o}=n,i=Fe(o,e[0].shape)[0],s=r.map(l=>l[i]);return Lr(t,s,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S7={kernelName:lv,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,o]=e,{dilations:i,strides:s,pad:a,dataFormat:l}=n;return E(Ja(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>EC(r.shape,t,o,s,a,l),filter:()=>QC(r,t,o.shape,s,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $7={kernelName:uv,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,o]=e,{strides:i,pad:s,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>tl(t,o,i,s,a,1,l),filter:()=>QC(t,r,o.shape,i,s,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7(t,e,n,r,o){let i=t;t.rank===4&&(i=V(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let s=e;s.rank===4&&(s=V(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),E(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),E(s.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${s.shape}.`),E(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),E(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),E(s.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${s.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:s},l={strides:r,pad:o,filterShape:n};return j.runKernel(U$,a,l)}const k7=G({conv3DBackpropFilter_:C7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I7={kernelName:cv,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:o,pad:i}=n;E(Ja(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[s,a]=e;return{x:()=>DM(s.shape,t,a,o,i),filter:()=>k7(s,t,a.shape,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T7={kernelName:hd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(zt(ZM(ge(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7={kernelName:dd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(JM(ge(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N7={kernelName:fv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:o,exclusive:i,reverse:s}=n;return{x:()=>{const a=Ot([o],r.rank);let l=PM(t,o,i,!s);return a!=null&&(l=Ue(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A7={kernelName:hv,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:o,pad:i,dimRoundingMode:s}=n,a=r??[1,1];E(Ja(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return E(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),E(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),E(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),E(Rn(o,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${o} and dilations '${a}'.`),hr("depthwiseConv2d",i,s),{x:()=>Hq(l.shape,t,u,o,i,a,s),filter:()=>Uq(l,t,u.shape,o,i,a,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O7={kernelName:dv,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,o]=e,i={x:r,filter:o,dy:t},s={x:r,filter:o,dy:t};return{x:()=>j.runKernel(N1,i,n),filter:()=>j.runKernel(A1,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _7={kernelName:md,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>j.runKernel(J$,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D7={kernelName:gd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=B(xi(zt(xt(n))),2/Math.sqrt(Math.PI));return{x:()=>B(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R7={kernelName:yd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P7={kernelName:mv,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>V(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M7={kernelName:vd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,xi(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F7={kernelName:xd,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L7={kernelName:bd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=Re(n.shape,r.shape);return{a:()=>{const a=Te(t,ge(r,"float32")),l=on(n.shape,o);return l.length>0?V(Ie(a,l),n.shape):a},b:()=>{let a=B(t,ge(n,"float32"));const l=on(r.shape,o);l.length>0&&(a=V(Ie(a,l),r.shape));const u=xt(r);return zt(Te(a,ge(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B7={kernelName:gv,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[o,i,s,a]=e,l=a??Ze(1),u=on(i.shape,o.shape),c=[];if(i.rank===1){for(let b=0;b<o.shape.length-1;++b)c.push(o.shape[b]);c.push(1)}const f=Ae(o,i),h=B(t,l),d=XM(ae(s,Ze(r))),p=B(B(B(d,d),d),Ze(-.5));return{x:()=>i.rank===1?V(B(B(t,Lo(V(d,[1,1,1,i.shape[0]]),c)),l),o.shape):V(B(B(t,d),l),o.shape),mean:()=>{let b=B(B(d,Ze(-1)),h);return i.rank===1&&(b=Ie(b,u)),V(b,i.shape)},variance:()=>{let b=B(B(p,f),h);return i.rank===1&&(b=Ie(b,u)),V(b,i.shape)},scale:()=>{const b=B(f,d);let w=B(t,b);return i.rank===1&&(w=Ie(w,u)),V(w,i.shape)},offset:()=>{let b=t;return i.rank===1&&(b=Ie(b,u)),V(b,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z7={kernelName:yv,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,o]=e,{axis:i,batchDims:s}=n,a=Fe(i,r.shape)[0],l=(u,c,f)=>()=>{const h=u.shape,d=c.size,p=h.slice(0,a),m=p.length,g=h.slice(i,h.length).slice(1),y=g.length,v=cE(0,m),x=cE(m+1,m+1+y),b=fE([p,[d],g]),w=V(f,b),S=V(c,[d]),$=fE([[m],v,x]),C=Ue(w,$);let k=oF(C,S,u.shape[a]);const I=na($);return k=Ue(k,I),k};if(s===1){const u=r.shape[0],c=r.split(u,0);return{x:()=>Xi(c.map((d,p)=>l(d,o.slice(p,1),t.slice(p,1))())).reshape(r.shape),indices:()=>o}}else return{x:l(r,o,t),indices:()=>o}}};function cE(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function fE(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j7={kernelName:wd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Ge(n),b:()=>Ge(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7={kernelName:Sd,gradFunc:t=>({x:()=>ge(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V7={kernelName:$d,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U7={kernelName:Cd,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G7={kernelName:kd,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H7={kernelName:xv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:o}=n,i=Ur(r,0);return{x:()=>Yn(i,t,B(t,o))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K7={kernelName:Td,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,ae(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q7={kernelName:Id,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,ge(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X7={kernelName:OH,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:o}=n;return{logits:()=>{const s=xi(r);return Ae(t,B(Ie(t,o,!0),s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(t,e,n,r=5,o=1,i=1,s=.5){const a={x:t,y:e,dy:n},l={depthRadius:r,bias:o,alpha:i,beta:s};return j.runKernel(iC,a,l)}const Q7=G({localResponseNormalizationBackprop_:Y7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z7={kernelName:kv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,o]=e,{depthRadius:i,bias:s,alpha:a,beta:l}=n;return{x:()=>Q7(r,o,t,i,s,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qF(t,e,n,r){return e.rank<n.rank&&(e=V(e,qt(e.shape,r))),t.rank<n.rank&&(t=V(t,qt(t.shape,r))),{x:()=>B(t,ge(vi(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hE={kernelName:Iv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:o}=r,i=e[0],s=e[1],a=Fe(o,i.shape),l=qF(t,s,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J7={kernelName:Ed,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>B(t,ge(yl(n,r),"float32")),b:()=>B(t,ge(gg(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(t,e,n,r,o,i,s){const a=M(t,"dy","maxPool3dGrad"),l=M(e,"input","maxPool3dGrad"),u=M(n,"output","maxPool3dGrad");let c=a,f=l,h=u,d=!1;l.rank===4&&(d=!0,c=V(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),f=V(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=V(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),E(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),E(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),E(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),hr("maxPool3dGrad",i,s);const p={dy:c,input:f,output:h},m={filterSize:r,strides:o,pad:i,dimRoundingMode:s},g=j.runKernel(aC,p,m);return d?V(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const t9=G({maxPool3dGrad_:e9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n9={kernelName:Ev,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,o]=e,{filterSize:i,strides:s,pad:a,dimRoundingMode:l}=n;return{x:()=>t9(t,r,o,i,s,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r9(t,e,n,r,o,i,s){const a=M(t,"dy","maxPoolGrad"),l=M(e,"input","maxPoolGrad"),u=M(n,"output","maxPoolGrad");E(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),E(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),E(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),hr("maxPoolGrad",i,s);const c={dy:a,input:l,output:u},f={filterSize:r,strides:o,pad:i,dimRoundingMode:s};return j.runKernel(sC,c,f)}const o9=G({maxPoolGrad_:r9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i9={kernelName:Tv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,o]=e,{filterSize:i,strides:s,pad:a}=n;return{x:()=>o9(t,r,o,i,s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s9={kernelName:Nv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:o}=n,i=Fe(o,r.shape),a=mn(r.shape,i)[1],l=Q(a);return{x:()=>{const c=r.shape.slice();i.forEach(d=>{c[d]=1});const f=V(t,c);return Te(B(f,oa(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a9={kernelName:Av,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:o}=r,[i,s]=e,a=Fe(o,i.shape),l=qF(t,s,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l9={kernelName:Nd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>B(t,ge(xc(n,r),"float32")),b:()=>B(t,ge(Ur(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9={kernelName:Ov,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:o}=n,i=o.map(s=>s[0]);return{x:()=>dt(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c9={kernelName:Ad,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=Re(n.shape,r.shape);return{a:()=>{const a=on(n.shape,o);return a.length>0?V(Ie(t,a),n.shape):t},b:()=>{const a=B(t,zt(i0(Te(n,r)))),l=on(r.shape,o);return l.length>0?V(Ie(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f9={kernelName:Od,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=Re(n.shape,r.shape);return{a:()=>{const a=B(t,ge(r,"float32")),l=on(n.shape,o);return l.length>0?V(Ie(a,l),n.shape):a},b:()=>{const a=B(t,ge(n,"float32")),l=on(r.shape,o);return l.length>0?V(Ie(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h9={kernelName:_v,gradFunc:t=>({x:()=>zt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d9={kernelName:Pv,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>fn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p9={kernelName:Rv,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m9={kernelName:Mv,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return ol(t,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dE={kernelName:Fv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:o}=n,i=o.map(s=>s[0]);return{x:()=>dt(t,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g9={kernelName:_d,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,o]=e,i=n,s=r,a=Re(i.shape,s.shape);return{a:()=>{const c=ge(s,"float32");let f=B(t,B(c,nl(i,Ae(c,Ze(1)))));const h=on(i.shape,a);return h.length>0&&(f=Ie(f,h)),V(f,i.shape)},b:()=>{const c=Ur(i,0),f=Yn(c,bi(i),Ge(i));let h=B(t,B(o,f));const d=on(s.shape,a);return d.length>0&&(h=Ie(h,d)),V(h,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y9={kernelName:Lv,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,o=Ur(n,0);return{x:()=>Yn(o,t,B(t,r)),alpha:()=>{let i=Yn(o,Ge(t),B(t,n));const s=on(r.shape,t.shape);return s.length>0&&(i=Ie(i,s)),V(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9(t,e,n){const r=t.shape.slice();r[n]=1;const o=V(e,r),i=V1(t,n,!0,!1),s=V1(t,n,!0,!0),a=B(i,s);return B(o,a)}function x9(t,e,n){const r=t.shape.length,o=r-n.length,i=Ot(n,r);let s=t;i!=null&&(s=Ue(t,i));const a=s.shape.slice(),u=a.splice(r-n.length,n.length).reduce((h,d)=>h*d,1);a.push(u);const c=s.reshape(a);let f=v9(c,e,o);if(f=f.reshape(s.shape),i!=null){const h=na(i);f=Ue(f,h)}return f}const b9={kernelName:Bv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:o}=n;let i=[];return o==null?i=r.shape.map((s,a)=>a):typeof o=="number"?i=[o]:i=o,{x:()=>x9(r,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w9={kernelName:pd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=Re(n.shape,r.shape);return{a:()=>{const a=Te(t,ge(r,"float32")),l=on(n.shape,o);return l.length>0?V(Ie(a,l),n.shape):a},b:()=>{let a=B(t,ge(n,"float32"));const l=on(r.shape,o);l.length>0&&(a=V(Ie(a,l),r.shape));const u=xt(r);return zt(Te(a,ge(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S9={kernelName:Dd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,zt(xt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $9={kernelName:Pd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=B(xc(n,6),rp(n));return{x:()=>B(t,ge(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C9={kernelName:Rd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,ge(rp(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k9={kernelName:zv,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I9={kernelName:Wv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,o={dy:t,images:r};return{images:()=>j.runKernel(pC,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T9={kernelName:jv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,o={dy:t,images:r};return{images:()=>j.runKernel(dC,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E9={kernelName:Vv,gradFunc:(t,e,n)=>{const{dims:r}=n,o=Fe(r,t.shape);return{x:()=>rl(t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N9={kernelName:Md,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A9={kernelName:Fd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>zt(Te(t,B(nl(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O9={kernelName:Uv,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>ge(Ge(n),"float32"),t:()=>B(t,ge(n,t.dtype)),e:()=>B(t,ge(PC(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _9={kernelName:Ld,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Ur(n,Ze(0)),o=Ze(l0),i=Ze(u0),s=B(t,i),a=B(B(t,o),xi(ge(n,"float32")));return Yn(r,s,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D9={kernelName:Wd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,B(n,Ae(Ze(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R9={kernelName:jd,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P9={kernelName:Bd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(NC(ge(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M9={kernelName:zd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(RM(ge(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F9={kernelName:Gv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:o,size:i}=n,s=r.shape,[a,l]=s0(r,o,i),u=[];for(let c=0;c<t.rank;c++)u.push([a[c],s[c]-a[c]-l[c]]);return{x:()=>LC(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L9={kernelName:Xv,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:o}=n,i=!0,s=B(t,r);return{logits:()=>Ae(s,B(Ie(s,[o],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B9={kernelName:Vd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,vc(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pE={kernelName:Kv,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:o}=n;return{x:()=>TC(t,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mE={kernelName:qv,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>ar(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z9={kernelName:Ud,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,B(Dn(ge(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j9={kernelName:mC,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,B(ge(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W9={kernelName:Gd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=Ze(2);return{a:()=>B(t,B(o,Ae(n,r))),b:()=>B(t,B(o,Ae(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V9={kernelName:Yd,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U9={kernelName:Hd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,o=Re(n.shape,r.shape);return{a:()=>{let a=t;const l=on(n.shape,o);return l.length>0&&(a=Ie(a,l)),V(a,n.shape)},b:()=>{let a=t;const l=on(r.shape,o);return l.length>0&&(a=Ie(a,l)),V(zt(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G9={kernelName:Hv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,o=r.shape.slice(),{axis:i}=n;Fe(i,r.shape).forEach(u=>{o[u]=1});const a=V(t,o),l=B(a,oa(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H9={kernelName:Kd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,xt(NC(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K9={kernelName:qd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(Ae(Ze(1),xt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q9={kernelName:Xd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:o}=n;return{x:()=>{let s=Ge(r);if(r.rank===1)for(let a=0;a<o[0];++a)s=ae(s,dt(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)s=ae(s,dt(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let u=0;u<o[2];++u)s=ae(s,dt(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let u=0;u<o[2];++u)for(let c=0;c<o[3];++c)s=ae(s,dt(t,[a*r.shape[0],l*r.shape[1],u*r.shape[2],c*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return s}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X9={kernelName:pu,gradFunc:(t,e,n)=>{const r=n,{perm:o}=r,i=na(o);return{x:()=>Ue(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y9={kernelName:Yv,gradFunc:(t,e,n)=>{const r=n,{axis:o}=r;return{value:()=>Xi(t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q9={kernelName:Qv,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z9(t,n)}}};function Z9(t,e){const n=ra(e,Ge(e)),r=_C(t,n);let o=yl(e,Ze(0,"int32"));const i=r.rank-o.rank;for(let a=0;a<i;++a)o=rr(o,a+1);o=qi(o,oa(r.shape,"bool"));const s=Ge(r);return Yn(o,r,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J9={kernelName:Zv,gradFunc:t=>({x:()=>Ge(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eY=[KF,QX,ZX,JX,e7,t7,n7,r7,o7,i7,s7,a7,c7,d7,p7,m7,g7,y7,v7,x7,b7,w7,$7,S7,I7,T7,E7,N7,A7,O7,w9,_7,D7,R7,P7,M7,L7,F7,B7,z7,j7,W7,V7,U7,G7,H7,K7,q7,X7,Z7,hE,hE,J7,n9,i9,s9,a9,l9,u9,c9,f9,h9,d9,p9,m9,dE,dE,g9,y9,b9,S9,$9,C9,k9,I9,T9,E9,N9,A9,O9,_9,D9,R9,P9,M9,F9,L9,B9,pE,pE,mE,mE,z9,W9,j9,V9,U9,G9,H9,K9,q9,X9,Y9,Q9,J9];for(const t of eY)RH(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.abs=function(){return this.throwIfDisposed(),Un(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.acos=function(){return this.throwIfDisposed(),M6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.acosh=function(){return this.throwIfDisposed(),L6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.add=function(t){return this.throwIfDisposed(),ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.all=function(t,e){return this.throwIfDisposed(),AM(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.any=function(t,e){return this.throwIfDisposed(),j1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.argMax=function(t){return this.throwIfDisposed(),rh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.argMin=function(t){return this.throwIfDisposed(),V6(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.asScalar=function(){return this.throwIfDisposed(),E(this.size===1,()=>"The array must have only 1 element."),V(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.asType=function(t){return this.throwIfDisposed(),ge(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as1D=function(){return this.throwIfDisposed(),V(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as2D=function(t,e){return this.throwIfDisposed(),V(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),V(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),V(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.as5D=function(t,e,n,r,o){return this.throwIfDisposed(),V(this,[t,e,n,r,o])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.asin=function(){return this.throwIfDisposed(),G6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.asinh=function(){return this.throwIfDisposed(),K6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.atan=function(){return this.throwIfDisposed(),X6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.atan2=function(t){return this.throwIfDisposed(),Q6(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.atanh=function(){return this.throwIfDisposed(),J6(this)};Y().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),IC(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),TC(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.batchNorm=function(t,e,n,r,o){return this.throwIfDisposed(),t0(this,t,e,n,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Df(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cast=function(t){return this.throwIfDisposed(),ge(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.ceil=function(){return this.throwIfDisposed(),I5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),zr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Qt&&(t=[t]),ar([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.conv1d=function(t,e,n,r,o,i){return this.throwIfDisposed(),OM(this,t,e,n,r,o,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.conv2dTranspose=function(t,e,n,r,o){return this.throwIfDisposed(),_M(this,t,e,n,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.conv2d=function(t,e,n,r,o,i){return this.throwIfDisposed(),tl(this,t,e,n,r,o,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cos=function(){return this.throwIfDisposed(),NC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cosh=function(){return this.throwIfDisposed(),RM(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),V1(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),PM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Q5(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.depthwiseConv2d=function(t,e,n,r,o,i){return this.throwIfDisposed(),AC(this,t,e,n,r,o,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.dilation2d=function(t,e,n,r,o){return this.throwIfDisposed(),e8(this,t,e,n,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.divNoNan=function(t){return this.throwIfDisposed(),i8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.div=function(t){return this.throwIfDisposed(),Te(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.dot=function(t){return this.throwIfDisposed(),a8(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.elu=function(){return this.throwIfDisposed(),r0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.equal=function(t){return this.throwIfDisposed(),vi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.erf=function(){return this.throwIfDisposed(),MM(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),x8(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.exp=function(){return this.throwIfDisposed(),xi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.expandDims=function(t){return this.throwIfDisposed(),rr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.expm1=function(){return this.throwIfDisposed(),$8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.fft=function(){return this.throwIfDisposed(),tF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.flatten=function(){return this.throwIfDisposed(),V(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.floor=function(){return this.throwIfDisposed(),i0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.floorDiv=function(t){return this.throwIfDisposed(),NM(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.gather=function(t,e,n){return this.throwIfDisposed(),_C(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.greaterEqual=function(t){return this.throwIfDisposed(),yl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.greater=function(t){return this.throwIfDisposed(),Ur(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.ifft=function(){return this.throwIfDisposed(),U1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.irfft=function(){return this.throwIfDisposed(),pq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.isFinite=function(){return this.throwIfDisposed(),_8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.isInf=function(){return this.throwIfDisposed(),R8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.isNaN=function(){return this.throwIfDisposed(),M8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.leakyRelu=function(t){return this.throwIfDisposed(),RC(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.lessEqual=function(t){return this.throwIfDisposed(),xc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.less=function(t){return this.throwIfDisposed(),gg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),j8(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logSigmoid=function(){return this.throwIfDisposed(),q8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logSoftmax=function(t){return this.throwIfDisposed(),jM(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),WM(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.log=function(){return this.throwIfDisposed(),bi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.log1p=function(){return this.throwIfDisposed(),zM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logicalAnd=function(t){return this.throwIfDisposed(),qi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logicalNot=function(){return this.throwIfDisposed(),PC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logicalOr=function(t){return this.throwIfDisposed(),VM(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.logicalXor=function(t){return this.throwIfDisposed(),nK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Qe(this,t,e,n)};Y().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),MC(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.max=function(t,e){return this.throwIfDisposed(),Vo(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.maximum=function(t){return this.throwIfDisposed(),ra(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.mean=function(t,e){return this.throwIfDisposed(),Ht(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.min=function(t,e){return this.throwIfDisposed(),mg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.minimum=function(t){return this.throwIfDisposed(),sh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),cK(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.mod=function(t){return this.throwIfDisposed(),hK(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.mul=function(t){return this.throwIfDisposed(),B(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.neg=function(){return this.throwIfDisposed(),zt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.norm=function(t,e,n){return this.throwIfDisposed(),o0(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.notEqual=function(t){return this.throwIfDisposed(),yg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),UM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.onesLike=function(){return this.throwIfDisposed(),go(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.pad=function(t,e){return this.throwIfDisposed(),LC(this,t,e)};Y().prototype.pool=function(t,e,n,r,o,i){return this.throwIfDisposed(),SK(this,t,e,n,r,o,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.pow=function(t){return this.throwIfDisposed(),nl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.prelu=function(t){return this.throwIfDisposed(),zC(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.prod=function(t,e){return this.throwIfDisposed(),kK(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.reciprocal=function(){return this.throwIfDisposed(),qK(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.relu=function(){return this.throwIfDisposed(),xl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.relu6=function(){return this.throwIfDisposed(),KM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.reshapeAs=function(t){return this.throwIfDisposed(),V(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.reshape=function(t){return this.throwIfDisposed(),V(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),sF(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),aF(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.reverse=function(t){return this.throwIfDisposed(),rl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.rfft=function(){return this.throwIfDisposed(),yq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.round=function(){return this.throwIfDisposed(),qM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.rsqrt=function(){return this.throwIfDisposed(),XM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.selu=function(){return this.throwIfDisposed(),YM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.separableConv2d=function(t,e,n,r,o,i){return this.throwIfDisposed(),QM(this,t,e,n,r,o,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sigmoid=function(){return this.throwIfDisposed(),vc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sign=function(){return this.throwIfDisposed(),rq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sin=function(){return this.throwIfDisposed(),ZM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sinh=function(){return this.throwIfDisposed(),JM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.slice=function(t,e){return this.throwIfDisposed(),dt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.softmax=function(t){return this.throwIfDisposed(),YC(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.softplus=function(){return this.throwIfDisposed(),ep(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),BC(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.split=function(t,e){return this.throwIfDisposed(),Lr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sqrt=function(){return this.throwIfDisposed(),Dn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.square=function(){return this.throwIfDisposed(),xt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.squaredDifference=function(t){return this.throwIfDisposed(),xq(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.squeeze=function(t){return this.throwIfDisposed(),np(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Qt?[this,t]:[this,...t];return Xi(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.step=function(t){return this.throwIfDisposed(),rp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.stridedSlice=function(t,e,n,r,o,i,s,a){return this.throwIfDisposed(),Cq(this,t,e,n,r,o,i,s,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sub=function(t){return this.throwIfDisposed(),Ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.sum=function(t,e){return this.throwIfDisposed(),Ie(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.tan=function(){return this.throwIfDisposed(),Iq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.tanh=function(){return this.throwIfDisposed(),e0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.tile=function(t){return this.throwIfDisposed(),Lo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.toBool=function(){return this.throwIfDisposed(),ge(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.toFloat=function(){return this.throwIfDisposed(),ge(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.toInt=function(){return this.throwIfDisposed(),ge(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.topk=function(t,e){return this.throwIfDisposed(),Nq(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.transpose=function(t){return this.throwIfDisposed(),Ue(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.unique=function(t){return this.throwIfDisposed(),_q(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),oF(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.unstack=function(t){return this.throwIfDisposed(),ol(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.where=function(t,e){return this.throwIfDisposed(),Yn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y().prototype.zerosLike=function(){return this.throwIfDisposed(),Ge(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ri extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ri.prototype)}}class so extends Error{constructor(e){super(e),Object.setPrototypeOf(this,so.prototype)}}class L extends Error{constructor(e){super(e),Object.setPrototypeOf(this,L.prototype)}}class Pe extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Pe.prototype)}}class _k extends Error{constructor(e){super(e),Object.setPrototypeOf(this,_k.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class XF{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function il(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function oi(t,e){if(!t)throw new _k(e)}function gE(t,e){let n=0;for(const r of t)r===e&&n++;return n}function or(t){return t.length===1?t[0]:t}function ot(t){return Array.isArray(t)?t:[t]}function Ni(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function ka(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Hr={};function Dk(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function K1(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>K1(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:K1(r))}}}function ap(t,e={},n={},r="object",o=!1){if(typeof t=="string"){const i=t;let s;if(i in n)s=n[i];else if(i in Hr)s=Hr[i];else if(s=e[i],s==null)throw new L(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return s}else{const i=t;if(i.className==null||i.config==null)throw new L(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const s=i.className;let a,l;if(s in n?[a,l]=n[s]:s in Hr?[a,l]=Hr.className:s in e&&([a,l]=e[s]),a==null)throw new L(`Unknown ${r}: ${s}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const d of Object.keys(Hr))u[d]=Hr[d];for(const d of Object.keys(n))u[d]=n[d];const c=i.config;c.customObjects=u;const f=Object.assign({},Hr);for(const d of Object.keys(n))Hr[d]=n[d];K1(i.config);const h=l(a,i.config,n,o);return Hr=Object.assign({},f),h}else{const u=Object.assign({},Hr);for(const f of Object.keys(n))Hr[f]=n[f];const c=new a(i.config);return Hr=Object.assign({},u),c}}}function tY(t,e){return t<e?-1:t>e?1:0}function Qp(t,e){return-1*tY(t,e)}function Ls(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function nY(t){if(t==null)throw new L(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function wl(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new L(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function Rk(t,e,n=0,r=1/0){return oi(n>=0),oi(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(o=>typeof o===e)}function dn(t,e){Array.isArray(t)?(E(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>dn(n,`element ${r+1} of ${e}`))):E(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${YF(t)}.`)}function YF(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>YF(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function rY(t,e,n){let r=n!=null?n():nr(),o;return(...s)=>{const a=n!=null?n():nr();return a-r<e||(r=a,o=t(...s)),o}}function QF(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let oY=0;function ZF(){return oY++}const Zp={};function c0(t=""){return t in Zp||(Zp[t]=0),Zp[t]+=1,t+Zp[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const iY=["channelsFirst","channelsLast"],sY=["nearest","bilinear"],aY=["valid","same","causal"],lY=["max","avg"],uY=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ml=new Map;function Vt(t){wl(iY,"DataFormat",t)}function cY(t){wl(sY,"InterpolationFormat",t)}function Gr(t){wl(aY,"PaddingMode",t)}function JF(t){wl(lY,"PoolMode",t)}const Rf=[],yE="/";function za(t,e){Rf.push(t);try{const n=e();return Rf.pop(),n}catch(n){throw Rf.pop(),n}}function fY(){return Rf.length===0?"":Rf.join(yE)+yE}function eL(t){if(!nL(t))throw new Error("Not a valid tensor name: '"+t+"'");return fY()+t}function tL(t){if(!nL(t))throw new Error("Not a valid tensor name: '"+t+"'");Ml.has(t)||Ml.set(t,0);const e=Ml.get(t);if(Ml.set(t,Ml.get(t)+1),e>0){const n=`${t}_${e}`;return Ml.set(n,1),n}else return t}const hY=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function nL(t){return!!t.match(hY)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dY(t){return t===parseInt(t.toString(),10)}function Bs(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let o=e;o<n;++o)r*=t[o];return r}function Mu(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function Gs(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function Ho(t,e){if(e<t)throw new L(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Gx;function Jt(){return Gx==null&&(Gx=s6().epsilon()),Gx}function Ko(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pi(t,e){return ge(t,e)}function lp(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),V(t,n)}function pY(t,e){return K(()=>{if(t.shape.length!==2)throw new L(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=lp(t,1);return q1(n,[1,e,1])})}function mY(t){const e=[Bs(t.shape)];return V(t,e)}function gY(t){if(t.rank<=1)throw new L(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Bs(t.shape,1)];return V(t,e)}function ja(t,e,n){return K(()=>{switch(t.rank){case 1:return qC(t,e,n);case 2:return eF(t,[e,0],[n,t.shape[1]]);case 3:return XC(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return xg(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return dt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return dt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new L(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Hx(t,e,n){return K(()=>{switch(t.rank){case 1:return qC(t,e,n);case 2:return eF(t,[0,e],[t.shape[0],n]);case 3:return XC(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return xg(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new L(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Jp(t,e,n,r){return K(()=>{switch(t.rank){case 1:return qC(t,e,n);case 2:switch(r){case 1:return ja(t,e,n);case 2:return Hx(t,e,n);default:throw new L(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return ja(t,e,n);case 2:return XC(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Hx(t,e,n);default:throw new L(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return ja(t,e,n);case 2:return xg(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return xg(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Hx(t,e,n);default:throw new L(`The axis is not within the rank of the tensor ${r}`)}default:throw new L(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Pk(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),ar(t,e)}function vE(t,e){switch(t.rank){case 1:return N5([t,e]);case 2:return O5([t,e],0);case 3:return D5([t,e],0);case 4:return P5([t,e],0);default:throw new L(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function q1(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new L(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Lo(t,e)}function f0(t,e=0,n=1,r,o){return UK(t,e,n,r,o)}function mi(t,e,n,r){if(t.rank<2||e.rank<2)throw new Pe(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const o=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(o!==i)throw new Pe(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return oE({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?X1(t.rank,r,Ko()):null,activation:n});{const o=t.shape.slice(),i=o.pop();t=V(t,[-1,i]);const s=e.shape.slice(),a=s.pop(),l=s.pop(),u=[...s,a],c=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=V(Ue(e,c),[l,-1]);const f=[...o,...u];return V(oE({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?X1(t.rank,r,Ko()):null,activation:n}),f)}}function rL(t,e,n){return K(()=>(Array.isArray(e)?e=vr(e,"int32"):e=ge(e,"int32"),_C(t,e,n)))}function up(t){return B(t,t)}function X1(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new L(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?V(e,[1,r[0],1,1,1]):V(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?V(e,[1,1,1,1,r[0]]):V(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?V(e,[1,r[0],1,1]):V(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?V(e,[1,1,1,r[0]]):V(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?V(e,[1,r[0],1]):V(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?V(e,[1,1,r[0]]):V(e,[1].concat(r))}else if(t<3)return e;throw new L(`Unsupported input rank by biasAdd: ${e.rank}`)}function Yo(t,e,n){return K(()=>(n==null&&(n=Ko()),Vt(n),ae(t,X1(t.rank,e,n))))}function yY(t,e=1){if(e!==1)throw new Pe(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return r0(t)}function vY(t){return K(()=>Te(t,ae(Un(t),1)))}function oL(t,e,n,r){return K(()=>Bq(t,e,n,r))}function xY(t){return K(()=>{const e=ae(.5,B(.2,t));return zr(e,0,1)})}function cp(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const bY=["fanIn","fanOut","fanAvg"],wY=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function SY(t){wl(bY,"FanMode",t)}function $Y(t){wl(wY,"Distribution",t)}class xo extends wc{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class iL extends xo{apply(e,n){return fn(e,n)}}iL.className="Zeros";ie(iL);class Mk extends xo{apply(e,n){return oa(e,n)}}Mk.className="Ones";ie(Mk);class sL extends xo{constructor(e){if(super(),typeof e!="object")throw new L(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new L(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return K(()=>B(Ze(this.value),oa(e,n)))}getConfig(){return{value:this.value}}}sL.className="Constant";ie(sL);class aL extends xo{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return tp(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}aL.className="RandomUniform";ie(aL);class lL extends xo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Pe(`randomNormal does not support dType ${n}.`);return f0(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}lL.className="RandomNormal";ie(lL);class uL extends xo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Pe(`truncatedNormal does not support dType ${n}.`);return rF(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}uL.className="TruncatedNormal";ie(uL);class cL extends xo{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return K(()=>{if(e.length!==2||e[0]!==e[1])throw new L("Identity matrix initializer can only be used for 2D square matrices.");return B(this.gain,BM(e[0]))})}getConfig(){return{gain:this.gain}}}cL.className="Identity";ie(cL);function CY(t,e="channelsLast"){let n,r;if(Vt(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const o=Bs(t,2);n=t[1]*o,r=t[0]*o}else if(e==="channelsLast"){const o=Bs(t,0,t.length-2);n=t[t.length-2]*o,r=t[t.length-1]*o}}else{const o=Bs(t);n=Math.sqrt(o),r=Math.sqrt(o)}return[n,r]}class Cr extends xo{constructor(e){if(super(),e.scale<0)throw new L(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,SY(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,$Y(this.distribution),this.seed=e.seed}apply(e,n){const r=CY(e),o=r[0],i=r[1];let s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,o):this.mode==="fanOut"?s/=Math.max(1,i):s/=Math.max(1,(o+i)/2),this.distribution==="normal"){const a=Math.sqrt(s);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Pe(`${this.getClassName()} does not support dType ${n}.`);return rF(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*s);return tp(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Cr.className="VarianceScaling";ie(Cr);class Fk extends Cr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Cr.className}}Fk.className="GlorotUniform";ie(Fk);class Lk extends Cr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Cr.className}}Lk.className="GlorotNormal";ie(Lk);class Bk extends Cr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Cr.className}}Bk.className="HeNormal";ie(Bk);class zk extends Cr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Cr.className}}zk.className="HeUniform";ie(zk);class jk extends Cr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Cr.className}}jk.className="LeCunNormal";ie(jk);class Wk extends Cr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Cr.className}}Wk.className="LeCunUniform";ie(Wk);class fL extends xo{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return K(()=>{if(e.length<2)throw new Pe("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=Q(e.slice(0,-1)),o=e[e.length-1],i=r*o;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const s=[Math.max(o,r),Math.min(o,r)],a=f0(s,0,1,n,this.seed),l=PX.qr(a,!1);let u=l[0];const f=l[1].flatten().stridedSlice([0],[Math.min(o,r)*Math.min(o,r)],[Math.min(o,r)+1]);return u=B(u,f.sign()),r<o&&(u=u.transpose()),B(Ze(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}fL.className="Orthogonal";ie(fL);const xE={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function bE(t,e={}){return ap(t,to.getMap().classNameMap,e,"initializer")}function Nt(t){return Dk(t)}function It(t){if(typeof t=="string"){const e=t in xE?xE[t]:t;if(e==="GlorotNormal")return new Lk;if(e==="GlorotUniform")return new Fk;if(e==="HeNormal")return new Bk;if(e==="HeUniform")return new zk;if(e==="LeCunNormal")return new jk;if(e==="LeCunUniform")return new Wk;{const n={};return n.className=e,n.config={},bE(n)}}else return t instanceof xo?t:bE(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Y1(t){return Array.isArray(t)&&Array.isArray(t[0])}function bg(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function De(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new L(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ke(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new L(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wg(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,o)=>r*o);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const wE="Variable";class kY{constructor(e,n="float32",r=wE,o=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=ZF(),r=r??wE,this.originalName=eL(r),this.name=tL(this.originalName),this.trainable_=o,this.constraint=i,this.val=Pq(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),IY(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function IY(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function Q1(t){return t.map(e=>e.read())}function Vk(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class en{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class wi{constructor(e,n,r,o,i,s,a){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=o,this.callArgs=i,this.outputTensorIndex=a,this.id=ZF(),s!=null&&(this.originalName=eL(s),this.name=tL(this.originalName)),this.rank=n.length}}let TY=0;class h0{constructor(e,n){this.callArgs=n,this.id=TY++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let EY=0,Le=class extends wc{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=EY++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=Ni(r)+"_"+c0(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let o=e.dtype;o==null&&(o=e.inputDType),o==null&&(o="float32"),this.dtype=o}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new so(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new L(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return or(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return or(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ri(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ri(`Layer ${this.name} is not connected, no input to return.`);return or(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ri(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ri(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return or(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=ot(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=ot(this.inputSpec);if(n.length!==r.length)throw new L(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let o=0;o<n.length;o++){const i=n[o],s=r[o];if(s==null)continue;const a=i.rank;if(s.ndim!=null&&a!==s.ndim)throw new L(`Input ${o} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${a}`);if(s.maxNDim!=null&&a>s.maxNDim)throw new L(`Input ${o} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${a}`);if(s.minNDim!=null&&a<s.minNDim)throw new L(`Input ${o} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${a}.`);if(s.dtype!=null&&i.dtype!==s.dtype)throw new L(`Input ${o} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${i.dtype}.`);if(s.axes){const l=i.shape;for(const u in s.axes){const c=Number(u),f=s.axes[u],h=c>=0?l[c]:l[l.length+c];if(f!=null&&[f,null].indexOf(h)===-1)throw new L(`Input ${o} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${f} but got shape ${l}.`)}}if(s.shape!=null)for(let l=0;l<s.shape.length;++l){const u=s.shape[l],c=i.shape[l];if(u!=null&&c!=null&&u!==c)throw new L(`Input ${o} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=ot(e),o=OY(e),i=_Y(e);if(o===i)throw new L("Arguments to apply() must be all SymbolicTensors or all Tensors");return za(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const s=[];for(const a of ot(e))s.push(a.shape);this.build(or(s)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let s=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,s);const a=ot(s),l=[];for(let u of a)r.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(s=or(l),this.activityRegularizer!=null)throw new Pe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return s}else{const s=NY(e),a=this.computeOutputShape(s);let l;const u=AY(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?s[0]:s),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((c,f)=>new wi(u,c,this,ot(e),n,this.name,f)):l=new wi(u,a,this,ot(e),n,this.name),this.addInboundNode(e,l,null,null,s,a,n),this._refCount++,this.activityRegularizer!=null)throw new Pe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,o)=>{r!=null&&e[o]!=null&&e[o]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ri(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new ri(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new so(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return wg(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Q1(e?this.trainableWeights:this.weights)}setWeights(e){K(()=>{const n=this.weights;if(n.length!==e.length)throw new L(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],o=Q1(n);for(let i=0;i<o.length;++i){const s=o[i],a=n[i],l=e[i];if(!et(s.shape,l.shape))throw new L(`Layer weight shape ${s.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}Vk(r)})}addWeight(e,n,r,o,i,s,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new L(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(o=l!=null?l():It("zeros"));const u=o.apply(n,r),c=new kY(u,r,e,s,a);return u.dispose(),i!=null&&this.addLoss(()=>i.apply(c.read())),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=ot(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,r){if(!this.supportsMasking)return;const o=this.computeMask(e,r),i=ot(n),s=ot(o);if(i.length!==s.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=s[a]}addInboundNode(e,n,r,o,i,s,a=null){const l=ot(e);n=ot(n),r=ot(r),o=ot(o),i=bg(i),s=bg(s);const u=[],c=[],f=[];for(const h of l)u.push(h.sourceLayer),c.push(h.nodeIndex),f.push(h.tensorIndex);new h0({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:f,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:o,inputShapes:i,outputShapes:s},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function NY(t){t=ot(t);const e=[];for(const n of t)e.push(n.shape);return or(e)}function AY(t){return"float32"}function hL(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const o=[];for(let i=0;i<r.inboundLayers.length;i++){const s=r.inputTensors[i],a=r.inboundLayers[i],l=r.nodeIndices[i],u=hL(s,a,l);for(const c of u)o.indexOf(c)===-1&&o.push(c)}return o}}}function OY(t){let e=!0;for(const n of ot(t))if(!(n instanceof wi)){e=!1;break}return e}function _Y(t){let e=!0;for(const n of ot(t))if(n instanceof wi){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fp extends Le{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:c0("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new L("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new L("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new L("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const o=new wi(this.dtype,this.batchInputShape,this,[],{},this.name);o.nodeIndex=0,o.tensorIndex=0,new h0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new L(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}fp.className="InputLayer";ie(fp);function DY(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new L("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new fp({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RY(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return ge(e,t.dtype)}catch{throw new L(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Cs{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Cs)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=RY(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new L(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof wi){if(this.id2Value[e.id]==null)throw new L(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new L(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof wi){if(this.id2Value[e.id]==null)throw new L(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new L(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&ze(this.id2Mask)}}const Sg=new XF,$g=new XF;function PY(t){Sg!=null&&Sg.setMaxEntries(t),$g!=null&&$g.setMaxEntries(t)}function xf(t,e,n,r){const o=n==null?!1:n.training,i=Array.isArray(t),s=i?t:[t],a=s.map(p=>p.name),l=[],u=e.names();for(const p of a)u.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const c=a.join(",")+"|"+e.names().sort().join(",");let f=Sg.get(c),h;if(f==null){const p=MY(s,e);f=p.sorted,h=p.recipientCounts,Sg.put(c,f),$g.put(c,h)}h={},o||Object.assign(h,$g.get(c));const d=new Cs(e);for(let p=0;p<f.length;++p){const m=f[p],g=m.sourceLayer;if(g instanceof fp)continue;const y=[],v=[],x=[];let b=!1;for(const k of m.inputs){const I=d.getValue(k),T=d.getMask(k);y.push(I),v.push(T),T!=null&&(b=!0),o||(h[k.name]--,h[k.name]===0&&!e.hasKey(k)&&a.indexOf(k.name)===-1&&!I.isDisposed&&k.sourceLayer.stateful!==!0&&x.push(I))}b&&(n=n||{},n.mask=v[0]);const w=ot(g.apply(y,n));let S=null;g.supportsMasking&&(S=g.computeMask(y,v));const $=LY(m),C=Array.isArray($)?$:[$];for(let k=0;k<C.length;++k){d.hasKey(C[k])||d.add(C[k],w[k],Array.isArray(S)?S[0]:S);const I=a.indexOf(C[k].name);I!==-1&&(l[I]=w[k])}o||ze(x)}return d.disposeMasks(),i?l:l[0]}function MY(t,e){E(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const o=SE(t[0],e);n=o.sorted,r=o.recipientMap}else{const o=new Set;for(const i of t){const{sorted:s,recipientMap:a}=SE(i,e);for(const l of s)o.has(l.name)||(n.push(l),o.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(u=>r[l].add(u))}}return{sorted:n,recipientCounts:FY(r)}}function FY(t){const e={};for(const n in t)e[n]=t[n].size;return e}function SE(t,e){const n=new Set,r=[],o={};for(const a of e.names())n.add(a);const i=[],s=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=s[s.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),r.push(a),n.add(a.name),l&&s.pop();else{s.push(i.length-1);for(const u of a.inputs)o[u.name]==null&&(o[u.name]=new Set),o[u.name].add(a.name),!n.has(u.name)&&i.push(u)}}return{sorted:r,recipientMap:o}}function LY(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const o of t.sourceLayer.inboundNodes[r].outputTensors)if(o.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BY=q();BY.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,PY);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Uk(t,e){return K(()=>Dn(Ie(B(t,t),e,!0)))}class hp extends wc{getConfig(){return{}}}class dL extends hp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>{const n=Uk(e,this.axis),r=zr(n,0,this.maxValue);return B(e,Te(r,ae(Jt(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}dL.className="MaxNorm";ie(dL);class pL extends hp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>Te(e,ae(Jt(),Uk(e,this.axis))))}getConfig(){return{axis:this.axis}}}pL.className="UnitNorm";ie(pL);class mL extends hp{apply(e){return xl(e)}}mL.className="NonNeg";ie(mL);class gL extends hp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>{const n=Uk(e,this.axis),r=ae(B(this.rate,zr(n,this.minValue,this.maxValue)),B(1-this.rate,n));return B(e,Te(r,ae(Jt(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}gL.className="MinMaxNorm";ie(gL);const $E={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function tn(t){return Dk(t)}function CE(t,e={}){return ap(t,to.getMap().classNameMap,e,"constraint")}function nn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in $E?$E[t]:t,config:{}};return CE(n)}else return t instanceof hp?t:CE(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function ma(t){if(t==null)return;const e=[],n=[],r=[];for(const o in t){const i=t[o];if(typeof i!="number"){const s=i;e.push(s.data()),n.push(o),r.push(s)}}if(e.length>0){const o=await Promise.all(e);for(let i=0;i<o.length;++i)t[n[i]]=o[i][0];ze(r)}}function yL(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var kE;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(kE||(kE={}));const zY=125;class lh{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class jY{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class WY extends lh{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const o in n){const i=n[o];if(typeof i=="number")this.totals.hasOwnProperty(o)||(this.totals[o]=0),this.totals[o]=this.totals[o]+i*r;else{let s;o in this.totals?s=this.totals[o]:this.totals[o]=0;const a=K(()=>ae(this.totals[o],B(i,r)));this.totals[o]=a,s!=null&&s.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:K(()=>{const o=B(Te(1,this.seen),this.totals[r]);n[r]=o,this.totals[r].dispose(),hi(n[r])}))}}class VY extends lh{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const i in this.history){const s=this.history[i];for(let a=0;a<s.length;++a)if(typeof s[a]!="number"){const l=s[a];e.push(l.data()),n.push(i),r.push(a)}}const o=await Promise.all(e);for(let i=0;i<o.length;++i)this.history[n[i]][r[i]].dispose(),this.history[n[i]][r[i]]=o[i][0]}}class UY extends lh{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||SF,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=zY),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");I1(this.yieldEvery)&&(this.maybeWait=rY(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const o=[];this.yield!=null&&(await ma(r),o.push(this.yield(e,n,r))),o.push(this.nextFrameFunc()),await Promise.all(o)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await ma(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await ma(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await ma(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await ma(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):I1(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await ma(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await ma(e),await this.trainEnd(e))}}function vL(t,e){return t==null&&(t={}),t instanceof lh?[t]:Array.isArray(t)&&t[0]instanceof lh?t:ot(t).map(r=>new UY(r,e))}class Qr{constructor(){}static registerCallbackConstructor(e,n){E(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Qr.checkForDuplicate(n),Qr.constructors[e]==null&&(Qr.constructors[e]=[]),Qr.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Qr.constructors)Qr.constructors[+n].forEach(o=>{if(o===e)throw new L("Duplicate callback constructor.")})}static clear(){Qr.constructors={}}static createCallbacks(e){const n=[];for(const r in Qr.constructors){const o=+r;e>=o&&n.push(...Qr.constructors[o])}return n.map(r=>new r)}}Qr.constructors={};function xL(t,e,n,r,o,i,s,a,l){const u=new VY,c=[new WY,...Qr.createCallbacks(e)];t!=null&&c.push(...t),c.push(u);const f=new jY(c);return f.setParams({epochs:n,initialEpoch:r,samples:o,steps:i,batchSize:s,verbose:e,doValidation:a,metrics:l}),{callbackList:f,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Li(t,e={},n=!1){return ap(t,to.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cg(t,e){return K(()=>{t.dtype!=="float32"&&(t=ge(t,"float32"));const n=Ie(up(t),e,!0),r=n0(n.shape,Jt()),o=Dn(ra(n,r));return Te(t,o)})}function d0(t,e){return K(()=>Ht(up(Ae(e,t)),-1))}function Gk(t,e){return K(()=>Ht(Un(Ae(e,t)),-1))}function Hk(t,e){return K(()=>{const n=Ae(t,e),r=zr(Un(t),Jt(),Number.MAX_VALUE),o=Un(Te(n,r));return B(100,Ht(o,-1))})}function GY(t,e){return K(()=>{const n=zr(e,Jt(),Number.MAX_VALUE),r=bi(ae(1,n)),o=zr(t,Jt(),Number.MAX_VALUE),i=bi(ae(1,o));return Ht(up(Ae(r,i)),-1)})}function HY(t,e){return K(()=>{const n=ra(0,Ae(1,B(t,e)));return Ht(up(n),-1)})}function KY(t,e){return K(()=>{const n=ra(0,Ae(1,B(t,e)));return Ht(n,-1)})}function qY(t,e){return K(()=>{const n=Ie(B(t,e),-1),r=Vo(B(Ae(1,t),e),-1);return ra(0,ae(1,Ae(r,n)))})}function XY(t,e){return K(()=>{const n=Math.log(2),r=Ae(e,t),o=Ae(ae(r,ep(B(-2,r))),n);return Ht(o,-1)})}function uh(t,e,n=!1){return K(()=>{if(n)e=YC(e);else{const r=Ie(e,e.shape.length-1,!0);e=Te(e,r)}return e=zr(e,Jt(),1-Jt()),zt(Ie(B(ge(t,"float32"),bi(e)),e.shape.length-1))})}function kg(t,e,n=!1){return K(()=>{const r=ge(i0(mY(t)),"int32");e=zr(e,Jt(),1-Jt());const o=e.shape,i=V(UM(r,o[o.length-1]),o);return uh(i,e,n)})}function YY(t,e){if(!et(t.shape,e.shape))throw new L(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return K(()=>{const n=xl(e),r=zt(Un(e));return ae(Ae(n,B(e,t)),zM(xi(r)))})}function p0(t,e){return K(()=>{let n;return n=zr(e,Jt(),1-Jt()),n=bi(Te(n,Ae(1,n))),Ht(YY(t,n),-1)})}function QY(t,e){return K(()=>{const n=zr(t,Jt(),1),r=zr(e,Jt(),1);return Ie(B(t,bi(Te(n,r))),-1)})}function ZY(t,e){return K(()=>{const n=bi(ae(Jt(),e));return Ht(Ae(e,B(t,n)),-1)})}function bL(t,e){return K(()=>{const n=Cg(t,-1),r=Cg(e,-1),o=B(n,r);return zt(Ie(o,-1))})}const Ig={meanSquaredError:d0,meanAbsoluteError:Gk,meanAbsolutePercentageError:Hk,meanSquaredLogarithmicError:GY,squaredHinge:HY,hinge:KY,categoricalHinge:qY,logcosh:XY,categoricalCrossentropy:uh,sparseCategoricalCrossentropy:kg,binaryCrossentropy:p0,kullbackLeiblerDivergence:QY,poisson:ZY,cosineProximity:bL};function Kx(t){if(typeof t=="string"){if(t in Ig)return Ig[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new L(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wL(t,e){return K(()=>{const n=B(.5,go(e)),r=pi(Ur(e,n),t.dtype);return Ht(vi(t,r),-1)})}function SL(t,e){return K(()=>pi(vi(rh(t,-1),rh(e,-1)),"float32"))}function JY(t,e){return K(()=>ge(Ie(qi(vi(t,1),vi(e,1))),"float32"))}function eQ(t,e){return K(()=>ge(Ie(qi(vi(t,0),vi(e,1))),"float32"))}function tQ(t,e){return K(()=>{const n=JY(t,e),r=eQ(t,e),o=ae(n,r);return ge(Yn(Ur(o,0),Te(n,o),0),"float32")})}function nQ(t,e){return p0(t,e)}function rQ(t,e){return t.rank===e.rank&&(t=np(t,[t.rank-1])),e=rh(e,-1),e.dtype!==t.dtype&&(e=ge(e,t.dtype)),ge(vi(t,e),"float32")}const oQ=d0,iQ=d0,sQ=Gk,aQ=Gk,lQ=Hk,uQ=Hk,$L=uh,cQ=bL,CL=kg,Tg={binaryAccuracy:wL,categoricalAccuracy:SL,precision:tQ,categoricalCrossentropy:$L,sparseCategoricalCrossentropy:CL,mse:oQ,MSE:iQ,mae:sQ,MAE:aQ,mape:lQ,MAPE:uQ,cosine:cQ};function fQ(t){if(typeof t=="string"&&t in Tg)return Tg[t];if(typeof t!="string"&&t!=null)return t;throw new L(`Unknown metric ${t}`)}function em(t){if(oi(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Ig))if(Ig[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Tg))if(Tg[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hQ(t){const e={Adagrad:()=>Pl.adagrad(.01),Adadelta:()=>Pl.adadelta(1,.95,Jt()),Adam:()=>Pl.adam(.001,.9,.999,Jt()),Adamax:()=>Pl.adamax(.002,.9,.999,Jt(),0),RMSProp:()=>Pl.rmsprop(.001,.9,0,Jt()),SGD:()=>Pl.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new L(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const IE=1*1024*1024;function TE(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!Z1(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>IE&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${IE}.`)}}function Z1(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!Z1(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!Z1(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dQ(t,e,n,r=console.log){const o=mQ(t),i=["Layer (type)","Input Shape","Output shape","Param #"];o?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(e*c)));let s;if(!o){i.push("Receives inputs"),s=[];for(const c in t.nodesByDepth)s.push(...t.nodesByDepth[c])}r("_".repeat(e)),Eg(i,n,r),r("=".repeat(e));const a=t.layers;for(let c=0;c<a.length;++c)o?gQ(a[c],n,r):yQ(a[c],n,s,r),r((c===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=pQ(t),u=wg(t.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}function pQ(t){let e;return t.collectedTrainableWeights!=null?e=wg(t.collectedTrainableWeights):e=wg(t.trainableWeights),e}function mQ(t){let e=!0;const n=[],r=[];for(const o in t.nodesByDepth)n.push(t.nodesByDepth[o]);for(const o of n){if(o.length>1||o.length===1&&o[0].inboundLayers.length>1){e=!1;break}r.push(...o)}if(e)for(const o of t.layers){let i=!1;for(const s of o.inboundNodes)if(r.indexOf(s)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function Eg(t,e,n=console.log){let r="";for(let o=0;o<t.length;++o)o>0&&(r=r.slice(0,r.length-1)+" "),r+=t[o],r=r.slice(0,e[o]),r+=" ".repeat(e[o]-r.length);n(r)}function gQ(t,e,n){let r,o;try{o=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=t.name,s=t.getClassName(),a=[`${i} (${s})`,o,r,t.countParams().toString()];Eg(a,e,n)}function yQ(t,e,n,r){let o,i;try{i=t.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{i="multiple"}try{o=JSON.stringify(t.outputShape)}catch{o="multiple"}const s=[];for(const f of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(f)===-1))for(let h=0;h<f.inboundLayers.length;++h){const d=f.inboundLayers[h].name,p=f.nodeIndices[h],m=f.tensorIndices[h];s.push(`${d}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),u=s.length===0?"":s[0],c=[`${a} (${l})`,i,o,t.countParams().toString(),u];Eg(c,e,r);for(let f=1;f<s.length;++f)Eg(["","","","",s[f]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kL(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function J1(t,e){if(t===null)return null;if(typeof t=="string")return ka(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let o=0;o<r;++o){const i=t[o];kL(e,o,i)?n.push(i):n.push(J1(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const o=t[r];if(r==="name"&&typeof o=="string")n[r]=o;else{const i=ka(r);n[i]=J1(o,i)}}return n}}function ew(t,e){if(t==null)return null;if(typeof t=="string")return Ni(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let o=0;o<r;++o){const i=t[o];kL(e,o,i)?n.push(i):n.push(ew(i,e))}return n}else{const n={};for(const r of Object.keys(t)){const o=t[r],i=Ni(r);(r==="name"||r==="className")&&typeof o=="string"?n[i]=o:n[i]=ew(o,r)}return n}}/** @license See the LICENSE file. */const IL="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vQ=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class To extends Le{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const v=this.getClassName().toLowerCase();this.name=c0(v)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Ls(this.inputs).length!==this.inputs.length)throw new L(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(v=>v.name)}`);Ls(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(v=>v.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const x=v.sourceLayer,b=v.nodeIndex,w=v.tensorIndex;this.outputLayers.push(x),this.outputLayersNodeIndices.push(b),this.outputLayersTensorIndices.push(w)}for(const v of this.inputs){const x=v.sourceLayer,b=v.nodeIndex,w=v.tensorIndex;oi(b===0,"input layer has >1 nodes"),oi(w===0,"input layer has >1 tensors"),this.inputLayers.push(x),this.inputLayersNodeIndices.push(b),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const x=this.inputLayers[v];if(!(x instanceof fp))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${v} (0-based) originates from layer type ${x.getClassName()}.`);this.inputNames.push(x.name),this.feedInputShapes.push(x.batchInputShape),this.feedInputNames.push(x.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(v=>v.shape),this.internalOutputShapes=this.outputs.map(v=>v.shape);const n={},r={},o={},i={},s={},a=[],l=(v,x,b,w,S,$)=>{(w==null||S==null||$==null)&&(w=v.sourceLayer,S=v.nodeIndex,$=v.tensorIndex);const C=w.inboundNodes[S];if(b.indexOf(C)!==-1)throw new so(`The tensor ${v.name} at layer "${w.name}" is part of a cycle.`);if(x.indexOf(C)!==-1)return;this.containerNodes.add(To.nodeKey(w,S)),w.id in s||(s[w.id]=Object.keys(s).length),b.indexOf(C)===-1&&b.push(C);const k=C.inboundLayers.length;for(let I=0;I<k;I++){const T=C.inputTensors[I],N=C.inboundLayers[I],_=C.nodeIndices[I],D=C.tensorIndices[I];l(T,x,b,N,_,D)}for(x.push(C);b.indexOf(C)>=0;)b.splice(b.indexOf(C),1);a.push(C)},u=[],c=[];for(const v of this.outputs)l(v,u,c);const f=a.slice().reverse();for(const v of f){r[v.id]=v,v.id in n||(n[v.id]=0);let x=n[v.id];const b=o[v.outboundLayer.id]==null?0:o[v.outboundLayer.id];x=Math.max(x,b),o[v.outboundLayer.id]=x,i[v.outboundLayer.id]=v.outboundLayer,n[v.id]=x;for(let w=0;w<v.inboundLayers.length;w++){const S=v.inboundLayers[w],$=v.nodeIndices[w],C=S.inboundNodes[$],k=n[C.id]==null?0:n[C.id];n[C.id]=Math.max(x+1,k),r[C.id]=C}}const h={};for(const v in n){const x=n[v];x in h||(h[x]=[]),h[x].push(r[v])}const d={};for(const v in o){const x=o[v];x in d||(d[x]=[]),d[x].push(i[v])}let p=Object.keys(d).map(v=>parseInt(v,10)).sort(Qp);this.layers=[];for(const v of p){const x=d[v];x.sort((b,w)=>{const S=s[b.id],$=s[w.id];return S<$?-1:S>$?1:0});for(const b of x)b instanceof To&&this.internalContainerRefs.push(b),this.layers.push(b)}this.layersByDepth=d,p=Object.keys(h).map(v=>parseInt(v,10)).sort(Qp);const m=this.inputs.slice(),g=[];for(const v of p)for(const x of h[v]){const b=x.outboundLayer;if(b!=null){for(const w of x.inputTensors)if(m.indexOf(w)===-1)throw new so(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${b.name}". The following previous layers were accessed without issue: ${g}`);for(const w of x.outputTensors)m.push(w);g.push(b.name)}}this.nodesByDepth=h;const y=this.layers.map(v=>v.name);for(const v of y){const x=y.filter(b=>b===v).length;if(x!==1)throw new so(`The name "${v}" is used ${x} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new h0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(v=>null),outputMasks:this.outputs.map(v=>null),inputShapes:this.inputs.map(v=>v.shape),outputShapes:this.outputs.map(v=>v.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new L("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let o=0;const i=vQ(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,u]of a.weights.entries()){const c=i?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(r[c]!=null)throw new L(`Duplicate weight name: ${c}`);r[c]=u,o++}const s=[];for(const a in e){let l=a;if(r[a]==null){const u=a.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(r[l]!=null)s.push([r[l],e[a]]);else if(n)throw new L(`Provided weight data has no target variable: ${a}`);delete r[l]}if(n){const a=[];for(const l in r)a.push(l);if(a.length>0)throw new L(`${a.length} of ${o} weights are not set: ${a}`)}Vk(s)}parseWeights(e){for(const n in Object.keys(e)){const r=n.split("/"),o=["vars","layer_checkpoint_dependencies"],i=r.map(s=>s.startsWith("_")?s.slice(1):s).filter(s=>!o.includes(s)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${IL}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=ew(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return K(()=>{e=ot(e);const r=new Cs;for(let o=0;o<this.inputs.length;++o)r.add(this.inputs[o],e[o]);return xf(this.outputs,r,n)})}computeMask(e,n){return K(()=>{e=ot(e);let r;return n==null?r=il(null,e.length):r=ot(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=bg(e);if(n.length!==this.inputLayers.length)throw new L(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],u=n[a],c=l.name+"_0_0";r[c]=u}const o=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Qp);if(o.length>1)for(const a of o){const l=this.nodesByDepth[a];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(c.id)!==-1)continue;const f=[];for(let m=0;m<u.inboundLayers.length;m++){const g=u.inboundLayers[m],y=u.nodeIndices[m],v=u.tensorIndices[m],x=`${g.name}_${y}_${v}`,b=r[x];f.push(b)}const h=c.computeOutputShape(or(f)),d=bg(h),p=c.inboundNodes.indexOf(u);for(let m=0;m<d.length;m++){const g=`${c.name}_${p}_${m}`;r[g]=d[m]}}}const i=[],s=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],f=`${l.name}_${u}_${c}`;s.push(f)}for(let a=0;a<s.length;a++){const l=s[a];oi(l in r),i.push(r[l])}return or(i)}runInternalGraph(e,n){n==null&&(n=il(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],f=n[l];r[u.id]=[c,f]}const o=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Qp);for(const l of o){const u=this.nodesByDepth[l];for(const c of u){const f=c.outboundLayer,h=c.inputTensors,d=c.outputTensors,p=new Array;for(const m of h)m.id in r&&p.push(r[m.id]);if(p.length===h.length){let m={},g,y,v,x;if(c.callArgs!=null&&(m=c.callArgs),p.length===1){const[b,w]=p[0];m.mask==null&&(m.mask=w),v=ot(f.call(b,m)),x=ot(f.computeMask(b,w)),g=[b],y=[w]}else g=p.map(b=>b[0]),y=p.map(b=>b[1]),m.mask==null&&(m.mask=y),v=ot(f.call(g,m)),x=ot(f.computeMask(g,y));if(f.activityRegularizer)throw new Pe("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let b=0;b<d.length;++b){const w=d[b],S=v[b],$=x[b];r[w.id]=[S,$]}}}}const i=[],s=[],a=[];for(const l of this.outputs){oi(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=r[l.id];a.push(u.shape),i.push(u),s.push(c)}return[i,s,a]}buildNodeConversionMap(e){const n={};let r;for(const o of this.layers){r=o instanceof To?1:0;for(let i=0;i<o.inboundNodes.length;i++){const s=To.nodeKey(o,i);this.containerNodes.has(s)&&(n[s]=r,r+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new L("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new L(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new L(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return K(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const o=To.nodeKey(n,r);this.containerNodes.has(o)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const s of this.layers){const a=s.getClassName(),l=s.getConfig(),u=[];for(let f=0;f<s.inboundNodes.length;f++){const h=s.inboundNodes[f],d=To.nodeKey(s,f);let p={};if(this.containerNodes.has(d)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${s.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let g=0;g<h.inboundLayers.length;g++){const y=h.inboundLayers[g],v=h.nodeIndices[g],x=h.tensorIndices[g],b=To.nodeKey(y,v);let w=n[b];w==null&&(w=0),m.push([y.name,w,x,p])}u.push(m)}}}const c={};c.name=s.name,c.className=a,c.config=l,c.inboundNodes=u,r.push(c)}e.layers=r;const o=[];for(let s=0;s<this.inputLayers.length;s++){const a=this.inputLayers[s],l=this.inputLayersNodeIndices[s],u=To.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const f=this.inputLayersTensorIndices[s];o.push([a.name,c,f])}e.inputLayers=o;const i=[];for(let s=0;s<this.outputLayers.length;s++){const a=this.outputLayers[s],l=this.outputLayersNodeIndices[s],u=To.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const f=this.outputLayersTensorIndices[s];i.push([a.name,c,f])}return e.outputLayers=i,e}static fromConfig(e,n,r={},o=!1){const i={},s={};function a(g,y){g.name in s?s[g.name].push(y):s[g.name]=[y]}function l(g,y){const v=[];let x;for(const b of y){const w=b[0],S=b[1],$=b[2];if(x=b[3]==null?{}:b[3],!(w in i)){a(g,y);return}const C=i[w];if(C.inboundNodes.length<=S){a(g,y);return}const k=C.inboundNodes[S];v.push(k.outputTensors[$])}v.length>0&&g.apply(or(v),x)}function u(g){const y=g.name,v=Li(g,n.customObjects!=null?n.customObjects:{});v.setFastWeightInitDuringBuild(o),i[y]=v,g.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new L(`Corrupted configuration, expected array for nodeData: ${b}`);a(v,b)})}const c=n.name,f=n.layers;for(const g of f)u(g);for(;!nY(s);)for(const g of f){const y=i[g.name];if(y.name in s){const v=s[y.name];delete s[y.name];for(const x of v)l(y,x)}}const h=[],d=[],p=n.inputLayers;for(const g of p){const y=g[0],v=g[1],x=g[2];oi(y in i);const w=i[y].inboundNodes[v].outputTensors;h.push(w[x])}const m=n.outputLayers;for(const g of m){const y=g[0],v=g[1],x=g[2];oi(y in i);const w=i[y].inboundNodes[v].outputTensors;d.push(w[x])}return new e({inputs:h,outputs:d,name:c})}get stateful(){if(this._stateful)throw new L("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){K(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xQ(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(o=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const o=[];return e.forEach(i=>{i in t?o.push(t[i]):o.push(null)}),o}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function TL(t,e){return xQ(t,e,"classWeight")}async function EL(t,e,n,r){if(n!=null){const o=K(()=>{if(t.shape.length===1)return Ba(t);if(t.shape.length===2){if(t.shape[1]>1)return rh(t,1);if(t.shape[1]===1)return V(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await o.data());ze(o);const s=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);s.push(n[a])}),vr(s,"float32")}else return null}function bQ(t,e){return B(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const wQ=32;function NL(t,e){let n,r;const o=e;n=o.xs,r=o.ys,E(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=EE("input",t.inputNames,n),s=EE("output",t.outputNames,r),a=i[0].shape[0];E(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),E(s.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)E(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<s.length;l++)E(s[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${s[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:s}}function EE(t,e,n){if(n instanceof Qt)return[n];if(Array.isArray(n))return E(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const o of e){if(n[o]==null)throw new L(`The feature data generated by the dataset lacks the required ${t} key '${o}'.`);r.push(n[o])}return r}}function SQ(t){if(t.length===3)throw new Pe("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function $Q(t,e,n){const r=n.batchesPerEpoch!=null;if(E(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),E(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),E(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),E(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),E(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const o=n.validationData!=null;let i,s;if(o)if(NE(n.validationData))E(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const g=SQ(n.validationData);i=g.xs,s=g.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;o?u=l.slice().concat(l.map(g=>"val_"+g)):u=l.slice();const c=vL(n.callbacks,n.yieldEvery),f=n.verbose==null?1:n.verbose,{callbackList:h,history:d}=xL(c,f,n.epochs,null,null,CQ(e,n),null,o,u);h.setModel(t),t.history=d,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const g={};await h.onEpochBegin(p);let y=0,v=0;for(r||(m=await e.iterator());!r||y<n.batchesPerEpoch;){const x=await m.next();if(r&&x.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(x.value!=null){const{xs:b,ys:w}=NL(t,x.value),S={};S.batch=v,S.size=b[0].shape[0],await h.onBatchBegin(v,S);const $=[];if(n.classWeight!=null){const I=TL(n.classWeight,t.outputNames);for(let T=0;T<I.length;++T)$.push(await EL(w[T],null,I[T]))}const C=b.concat(w).concat($),k=a(C);ze(C);for(let I=0;I<l.length;++I){const T=l[I],N=k[I];S[T]=N,hi(N)}await h.onBatchEnd(v,S),yL(S),v++,y++}if(r?y>=n.batchesPerEpoch:x.done){if(o){let b;NE(n.validationData)?b=ot(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):b=ot(t.evaluate(i,s,{batchSize:n.validationBatchSize==null?wQ:n.validationBatchSize,verbose:0}));for(let w=0;w<t.metricsNames.length;++w)g[`val_${t.metricsNames[w]}`]=b[w]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,g),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function CQ(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function NE(t){return typeof t.iterator=="function"}function kQ(t){return typeof t.next=="function"}async function IQ(t,e,n){n=n||{};const r=n.batches!=null,o=t.testFunction;let i=[];if(n.verbose>0)throw new Pe("Verbose mode is not implemented yet.");E(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const s=kQ(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<n.batches;){const u=await s.next();if(i=K(()=>{if(u.value){const{xs:c,ys:f}=NL(t,u.value),h=c.concat(f),d=K(()=>o(h));if(ze(h),l===0)for(let m=0;m<d.length;++m)i.push(Ze(0));const p=h[0].shape[0];for(let m=0;m<d.length;++m){const g=d[m],y=i[m];i[m]=K(()=>ae(i[m],B(p,g))),l>0&&ze(y)}ze(d),a+=p,++l}return i}),u.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<i.length;++u){const c=i[u];i[u]=Te(i[u],a),ze(c)}return or(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qx(t){E(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function ef(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>ja(r,e,n-e)):ja(t,e,n-e)}function tw(t,e){return K(()=>t==null?null:Array.isArray(t)?t.map(n=>tw(n,e)):rL(t,e.dtype==="int32"?e:ge(e,"int32")))}function Xx(t,e){const n=[];let r=0,o=null;for(;r<t;)o=r+e,o>=t&&(o=t),n.push([r,o]),r=o;return n}function AL(t){const e=[];t instanceof Qt&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(lp(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function ko(t,e){if(t==null)return;const n=[];if(e instanceof Qt)n.push(e.id);else if(Array.isArray(e))e.forEach(o=>n.push(o.id));else if(e!=null)for(const o in e){const i=e[o];n.push(i.id)}const r=[];if(t instanceof Qt)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(o=>{n.indexOf(o.id)===-1&&r.push(o)});else if(t!=null)for(const o in t){const i=t[o];n.indexOf(i.id)===-1&&r.push(i)}r.forEach(o=>{o.isDisposed||o.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function TQ(t){return t instanceof Qt}function nw(t){return Array.isArray(t)}function AE(t){return!TQ(t)&&!nw(t)}function OE(t,e,n,r=!0,o=""){if(e==null||e.length===0){if(t!=null){let s=!1;if(nw(t)&&t.length>0)s=!0;else if(AE(t)){for(const a in t)if(t.hasOwnProperty(a)){s=!0;break}}else s=!0;if(s)throw new L(`Error when checking model ${o} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(s=>null);let i;if(AE(t)){t=t,i=[];for(const s of e){if(t[s]==null)throw new L(`No data provided for "${s}". Need data for each key in: ${e}`);i.push(t[s])}}else if(nw(t)){if(t=t,t.length!==e.length)throw new L(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new L(`The model ${o} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=AL(i),n!=null)for(let s=0;s<e.length;++s){if(n[s]==null)continue;const a=i[s];if(a.shape.length!==n[s].length)throw new L(`Error when checking ${o}: expected ${e[s]} to have ${n[s].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[s][l];if(c!=null&&c>=0&&u!==c)throw new L(`${o} expected a batch of elements where each example has shape [${n[s].slice(1,n[s].length)}] (i.e.,tensor shape [*,${n[s].slice(1,n[s].length)}]) but the ${o} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function EQ(t,e,n){const r=Ls(t.map(i=>i.shape[0]));r.sort();const o=Ls(e.map(i=>i.shape[0]));if(o.sort(),r.length>1)throw new L(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(o.length>1)throw new L(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&o.length>0&&!et(r,o))throw new L(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${o[0]} target sample(s).`)}function NQ(t,e,n){const r=[d0,p0,uh];for(let o=0;o<t.length;++o){const i=t[o],s=e[o],a=n[o];if(s!=null){if(s===uh&&i.shape[i.shape.length-1]===1)throw new L(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(s)!==-1){const l=i.shape.slice(1),u=a.slice(1);for(let c=0;c<l.length;++c){const f=l[c],h=u[c];if(h!=null&&f!==h)throw new L(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function _E(t,e,n,r=!0,o=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new L(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new L(`The model expects ${e.length} ${o} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let s=0;s<e.length;++s){if(n[s]==null)continue;const a=i[s];if(a.shape.length!==n[s].length)throw new L(`Error when checking ${o}: expected ${e[s]} to have ${n[s].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[s].length;++l){if(l===0&&!r)continue;const u=a.shape[l],c=n[s][l];if(c!=null&&c!==u)throw new L(`Error when checking ${o}: expected ${e[s]} to have shape ${JSON.stringify(n[s])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function AQ(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const o of e){let i=n.hasOwnProperty(o)?n[o]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const OQ="layers-model";class gu extends To{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new L("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");dQ(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=hQ(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ia))throw new L("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const s in e.loss)if(this.outputNames.indexOf(s)===-1)throw new L(`Unknown entry in loss dictionary: "${s}". Only expected the following keys: ${this.outputNames}`);for(const s of this.outputNames)e.loss[s]==null&&console.warn(`Output "${s}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${s} during training`),n.push(Kx(e.loss[s]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new L(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>Kx(a))}else{const s=Kx(e.loss);this.outputs.forEach(a=>{n.push(s)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let s=0;s<this.outputs.length;++s){const a=this.internalOutputShapes[s],l=this.outputNames[s];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[s])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],za("loss",()=>{for(let s=0;s<this.outputs.length;++s){if(r.indexOf(s)!==-1)continue;const a=this.lossFunctions[s];this.outputs.length>1&&(this.metricsTensors.push([a,s]),this.metricsNames.push(this.outputNames[s]+"_loss"))}});const o=AQ(e.metrics,this.outputNames),i=(s,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[s]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,s])};za("metric",()=>{for(let s=0;s<this.outputs.length;++s){if(r.indexOf(s)!==-1)continue;const a=o[s];(u=>{const c="";let f,h,d;for(const p of u){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[s];g[g.length-1]===1||this.lossFunctions[s]===p0?["accuracy","acc"].indexOf(p)!==-1?h=wL:["crossentropy","ce"].indexOf(p)!==-1&&(h=nQ):this.lossFunctions[s]===kg?["accuracy","acc"].indexOf(p)!==-1?h=rQ:["crossentropy","ce"].indexOf(p)!==-1&&(h=CL):["accuracy","acc"].indexOf(p)!==-1?h=SL:["crossentropy","ce"].indexOf(p)!==-1&&(h=$L);let y;["accuracy","acc"].indexOf(p)!==-1?y="acc":["crossentropy","ce"].indexOf(p)!==-1&&(y="ce"),d=h,f=c+y}else d=fQ(p),f=c+em(p);let m;za(f,()=>{m=d}),i(s,f,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const o=r.batchSize==null?32:r.batchSize;qx(o);const s=this.standardizeUserDataXY(e,n,!0,o);try{const a=s[0].concat(s[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,o,r.verbose,r.steps);return or(u)}finally{ko(s[0],e),ko(s[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),IQ(this,e,n)}checkNumSamples(e,n,r,o="steps"){let i;if(r!=null){if(i=null,n!=null)throw new L(`If ${o} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new L(`Either the input data should have a defined shape, or ${o} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new L("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),o=r?n:[n],i=this.retrieveSymbolicTensors(o),s=new Cs;if(e instanceof Qt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new L(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)s.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new L(`No value is provided for the model's input ${l.name}`);s.add(l,u)}const a=xf(i,s);return r?a:a[0]}retrieveSymbolicTensors(e){const n=il(null,e.length);let r=e.length;for(const o of this.layers){const i=Array.isArray(o.output)?o.output:[o.output],s=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=s.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],r--),r===0)break}if(r===0)break}if(r>0){const o=[];throw n.forEach((i,s)=>{i==null&&o.push(e[s])}),new L(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(o)}`)}return n}predictLoop(e,n=32,r=!1){return K(()=>{const o=this.checkNumSamples(e);if(r)throw new Pe("Verbose predictLoop() is not implemented yet.");const i=Xx(o,n),s=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)K(()=>{const u=i[a][0],c=i[a][1],f=ef(e,u,c),h=[];if(Array.isArray(f))for(let p=0;p<f.length;++p)h.push({key:this.inputs[p],value:f[p]});else h.push({key:this.inputs[0],value:f});const d=new Cs(h);return xf(this.outputs,d)}).forEach((u,c)=>s[c].push(u));return or(s.map(a=>ar(a,0)))})}predict(e,n={}){const r=AL(e);_E(r,this.inputNames,this.feedInputShapes,!1);try{const o=n.batchSize==null?32:n.batchSize;return qx(o),this.predictLoop(r,o)}finally{ko(r,e)}}predictOnBatch(e){_E(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,o){if(this.optimizer_==null)throw new so("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let s=0;s<this.feedOutputShapes.length;++s){const a=this.feedOutputShapes[s];this.feedLossFns[s]===kg?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=OE(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=OE(n,this.feedOutputNames,i,!1,"target"),EQ(e,n),NQ(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&o!=null&&o>0&&e[0].shape[0]%o!==0)throw new L(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${o}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,o,i=!0,s){const[a,l]=this.standardizeUserDataXY(e,n,i,s);if(r!=null)throw new Error("sample weight is not supported yet.");let u=null;if(o!=null){const c=TL(o,this.outputNames);u=[];for(let f=0;f<c.length;++f)u.push(await EL(l[f],null,c[f]))}return[a,l,u]}testLoop(e,n,r,o=0,i){return K(()=>{const s=this.checkNumSamples(n,r,i,"steps"),a=[];if(o>0)throw new Pe("Verbose mode is not implemented yet.");if(i!=null)throw new Pe("steps mode in testLoop() is not implemented yet");{const l=Xx(s,r),u=vr(Ho(0,s));for(let c=0;c<l.length;++c){const f=l[c][0],h=l[c][1],d=ja(u,f,h-f),p=tw(n,d),m=e(p);if(c===0)for(let g=0;g<m.length;++g)a.push(Ze(0));for(let g=0;g<m.length;++g){const y=m[g];a[g]=ae(a[g],B(h-f,y))}}for(let c=0;c<a.length;++c)a[c]=Te(a[c],s)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const o=e[r];let i=o;if(gE(e,o)>1){const s=gE(e.slice(0,r),o);i+=`_${s}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),s=[],a=()=>{const f=[];for(let m=0;m<this.inputs.length;++m)f.push({key:this.inputs[m],value:r[m]});const h=new Cs(f),d=xf(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const g=this.lossFunctions[m];let y=g(o[m],d[m]);i[m]!=null&&(y=bQ(y,i[m]));const v=Ht(y);n.push(v),m===0?p=y:p=ae(p,y)}for(let m=0;m<this.metricsTensors.length;++m){let g;if(this.outputs.length>1&&m<this.outputs.length)g=n[m];else{const y=this.metricsTensors[m][0],v=this.metricsTensors[m][1];g=Ht(y(o[v],d[v]))}hi(g),s.push(g)}return p=Ht(p),this.calculateLosses().forEach(m=>{p=ae(p,m)}),p},l=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(a,!0,l)].concat(s)}}makeTestFunction(){this.testFunction=e=>K(()=>{const n=[];let r;const o=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=[];for(let u=0;u<this.inputs.length;++u)s.push({key:this.inputs[u],value:o[u]});const a=new Cs(s),l=xf(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],f=Ht(c(i[u],l[u]));u===0?r=f:r=ae(r,f),n.push(r)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],f=this.metricsTensors[u][1],h=Ht(c(i[f],l[f]));n.push(h)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let o,i,s,a,l,u,c,f,h;try{const d=r.batchSize==null?32:r.batchSize;qx(d);const m=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,d);o=m[0],i=m[1],h=m[2];let g=!1,y;if(r.validationData!=null&&r.validationData.length>0){if(g=!0,r.validationData.length===2)l=r.validationData[0],u=r.validationData[1];else throw r.validationData.length===3?new Pe("validationData including sample weights is not supported yet."):new L(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const I=await this.standardizeUserData(l,u,null,null,!0,d);c=I[0],f=I[1],y=c.concat(f)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){g=!0;const k=Math.floor(o[0].shape[0]*(1-r.validationSplit)),I=o[0].shape[0];c=ef(o,k,I),s=o,o=ef(o,0,k),f=ef(i,k,I),a=i,i=ef(i,0,k),y=c.concat(f)}else r.validationSteps!=null&&(g=!0);const v=o.concat(i).concat(h);this.checkTrainableWeightsConsistency();const x=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let w,S;g?(this.makeTestFunction(),w=this.testFunction,S=b.slice().concat(b.map(k=>"val_"+k))):(w=null,y=[],S=b.slice());const $=vL(r.callbacks,r.yieldEvery);return await this.fitLoop(x,v,b,d,r.epochs,r.verbose,$,w,y,r.shuffle,S,r.initialEpoch,null,null)}finally{this.isTraining=!1,ko(o,e),ko(i,n),ko(s,e),ko(a,n),ko(c,l),ko(f,u),h!=null&&ze(h)}}async fitLoop(e,n,r,o,i,s,a,l,u,c,f,h,d,p){o==null&&(o=32),i==null&&(i=1),c==null&&(c=!0),h==null&&(h=0);let m=!1;if(l!=null&&u!=null&&(m=!0),p!=null&&(m=!0,d==null))throw new L("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(n,o,d,"steps_per_epoch");let y;g!=null&&(y=Ho(0,g)),s==null&&(s=1);const{callbackList:v,history:x}=xL(a,s,i,h,g,d,o,m,f);v.setModel(this),this.history=x,await v.onTrainBegin(),this.stopTraining_=!1;for(let b=h;b<i;++b){await v.onEpochBegin(b);const w={};if(d!=null)throw new Pe("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Pe("batch shuffling is not implemneted yet");c&&gH(y);const S=vr(y),$=Xx(g,o);for(let C=0;C<$.length;++C){const k={};if(await v.onBatchBegin(C,k),K(()=>{const I=$[C][0],T=$[C][1],N=ja(S,I,T-I);k.batch=C,k.size=T-I;const _=tw(n,N),D=e(_);for(let O=0;O<r.length;++O){const R=r[O],F=D[O];k[R]=F,hi(F)}if(C===$.length-1&&m){const O=this.testLoop(l,u,o);for(let R=0;R<r.length;++R){const F=r[R],A=O[R];hi(A),w["val_"+F]=A}}}),await v.onBatchEnd(C,k),yL(k),this.stopTraining_)break}S.dispose()}if(await v.onEpochEnd(b,w),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return $Q(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),o=r[0],i=r[1],a=this.makeTrainFunction()(o.concat(i)),l=[];for(const u of a){const c=await u.data();l.push(c[0])}return ze(a),ko(r[0],e),ko(r[1],n),or(l)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,o=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let s=0;s<o.length;++s)r&&!o[s].trainable||n.push({name:o[s].originalName,tensor:i[s]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=Z2().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Z2().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Ni(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Ni(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const o of n)if(typeof r[o]=="string")e[o]=Ni(r[o]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Ni(em(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Ni(em(e)));{const e={};for(const n in this.metrics)e[n]=Ni(em(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=J1(e.optimizer_config),r=Li(n);let o;if(typeof e.loss=="string")o=ka(e.loss);else if(Array.isArray(e.loss))o=e.loss.map(s=>ka(s));else if(e.loss!=null){o={};for(const s in e.loss)o[s]=ka(e.loss[s])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(s=>ka(s));else if(e.metrics!=null){i={};for(const s in e.metrics)i[s]=ka(e.metrics[s])}this.compile({loss:o,metrics:i,optimizer:r})}async save(e,n){if(typeof e=="string"){const u=f6(e);if(u.length===0)throw new L(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new L(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new L("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await eE(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:OQ,generatedBy:`TensorFlow.js tfjs-layers v${IL}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:f}=await eE(await this.optimizer.getWeights(),u);r.specs.push(...f),r.data=c6([r.data,c])}return this.userDefinedMetadata!=null&&(TE(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){TE(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}gu.className="Model";ie(gu);class OL extends gu{}OL.className="Functional";ie(OL);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fu extends gu{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:c0("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new L(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Fu||e instanceof gu;let r;if(n){if(r=e,r.outputs.length!==1)throw new L("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new L("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new L("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const o=DY({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(o)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new L(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new L("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=hL(this.outputs[0])}this.inboundNodes=[],new h0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:il(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(o=>o.shape),outputShapes:this.outputs[0].shape})}else{const o=e.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ke(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new gu({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new so("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new so("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new so("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new so("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},o=!1){let i,s={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new L("Legacy serialization format not supported yet.");i=n}else E(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,s=n;const a=new e(s);if(!(a instanceof Fu))throw new Pe(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const c=Li(l,void 0,o);o&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(e){if(this.model==null)throw new L("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new L("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}Fu.className="Sequential";ie(Fu);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _Q(t){return new Fu(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Pn=class extends wc{getConfig(){return{}}};class _L extends Pn{apply(e,n=1){return yY(e,n)}}_L.className="elu";ie(_L);class DL extends Pn{apply(e){return YM(e)}}DL.className="selu";ie(DL);class RL extends Pn{apply(e){return xl(e)}}RL.className="relu";ie(RL);class PL extends Pn{apply(e){return K(()=>sh(6,xl(e)))}}PL.className="relu6";ie(PL);let ML=class extends Pn{apply(e){return e}};ML.className="linear";ie(ML);class FL extends Pn{apply(e){return vc(e)}}FL.className="sigmoid";ie(FL);class LL extends Pn{apply(e){return xY(e)}}LL.className="hardSigmoid";ie(LL);class BL extends Pn{apply(e){return ep(e)}}BL.className="softplus";ie(BL);class zL extends Pn{apply(e){return vY(e)}}zL.className="softsign";ie(zL);class jL extends Pn{apply(e){return e0(e)}}jL.className="tanh";ie(jL);let Kk=class extends Pn{apply(e,n=-1){return YC(e,n)}};Kk.className="softmax";ie(Kk);class WL extends Pn{apply(e,n=-1){return jM(e,n)}}WL.className="logSoftmax";ie(WL);class VL extends Pn{apply(e){return K(()=>K(()=>{const n=Math.sqrt(2),r=B(.5,ae(1,MM(Te(e,n))));return B(e,r)}))}}VL.className="gelu";ie(VL);class UL extends Pn{apply(e){return K(()=>B(.5,B(e,ae(1,e0(B(Dn(Te(2,Math.PI)),ae(e,B(.044715,nl(e,3)))))))))}}UL.className="gelu_new";ie(UL);class GL extends Pn{apply(e){return K(()=>B(e,e0(ep(e))))}}GL.className="mish";ie(GL);class HL extends Pn{apply(e,n=1){return K(()=>B(vc(B(e,n)),e))}}HL.className="swish";ie(HL);function Hs(t){return t.getClassName()}function Yx(t,e={}){return ap(t,to.getMap().classNameMap,e,"activation")}function Ks(t){if(t==null){const e={};return e.className="linear",e.config={},Yx(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},Yx(e)}else return t instanceof Pn?t:Yx(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DQ(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class KL extends wc{}class qL extends KL{constructor(e){super(),DQ(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return K(()=>{let n=fn([1]);return this.hasL1&&(n=ae(n,Ie(B(this.l1,Un(e))))),this.hasL2&&(n=ae(n,Ie(B(this.l2,up(e))))),V(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}qL.className="L1L2";ie(qL);const DE={l1l2:"L1L2"};function ct(t){return Dk(t)}function RE(t,e={}){return ap(t,to.getMap().classNameMap,e,"regularizer")}function Tt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in DE?DE[t]:t,config:{}};return RE(n)}else return t instanceof KL?t:RE(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class XL extends Le{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=De(e);let r=xl(e);return this.maxValue!=null&&(r=zr(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}XL.className="ReLU";ie(XL);class YL extends Le{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=De(e);return RC(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}YL.className="LeakyReLU";ie(YL);class QL extends Le{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=It(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Tt(e.alphaRegularizer),this.alphaConstraint=nn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new L(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ke(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const o of this.sharedAxes)n[o-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let o=1;o<e.length;++o)r[o]=e[o];this.inputSpec=[new en({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=De(e),zC(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Nt(this.alphaInitializer),alphaRegularizer:ct(this.alphaRegularizer),alphaConstraint:tn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}QL.className="PReLU";ie(QL);let ZL=class extends Le{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Pe(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=De(e);return r0(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};ZL.className="ELU";ie(ZL);class JL extends Le{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=De(e);return B(r,ge(Ur(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}JL.className="ThresholdedReLU";ie(JL);class e3 extends Le{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new Kk().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return K(()=>{let r=De(e);const o=n.mask;if(o!=null){const i=B(Ae(oa(r.shape),ge(o,r.dtype)),Ze(-1e9));r=ae(r,i)}return this.axis instanceof Array?this.axis.length>1?xi(Ae(r,WM(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}e3.className="Softmax";ie(e3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yu(t,e,n){if(typeof t=="number")return il(t,e);if(t.length!==e)throw new L(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const o=t[r];if(!dY(o))throw new L(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${o}`)}return t}function Uo(t,e,n,r,o=1){if(t==null)return t;const i=e+(e-1)*(o-1);let s;return n==="same"?s=t:s=t-i+1,Math.floor((s+r-1)/r)}function ii(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+Gs([n-e,0]);else if(r==="same")t=t*e;else throw new L(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qk(t,e){return K(()=>(Vt(e),e==="channelsFirst"?Ue(t,[0,2,3,1]):t))}function t3(t,e){return K(()=>(Vt(e),e==="channelsFirst"?Ue(t,[0,2,3,4,1]):t))}function RQ(t,e,n,r=1,o="valid",i,s=1){return K(()=>{if(i==null&&(i=Ko()),Vt(i),t.shape.length!==3)throw new L(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new L(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new L(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=Ue(t,[0,2,1])),o==="causal")throw new Pe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=OM(t,e,r,o==="same"?"same":"valid","NWC",s);return n!=null&&(a=Yo(a,n)),a})}function PE(t,e,n,r=[1,1],o="valid",i,s,a=null){return K(()=>{if(i==null&&(i=Ko()),Vt(i),t.rank!==3&&t.rank!==4)throw new L(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new L(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=qk(t,i);if(o==="causal")throw new Pe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Wq({x:l,filter:e,strides:r,pad:o==="same"?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=Ue(l,[0,3,1,2])),l})}function PQ(t,e,n,r=[1,1,1],o="valid",i,s){return K(()=>{if(i==null&&(i=Ko()),Vt(i),t.rank!==4&&t.rank!==5)throw new L(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new L(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=t3(t,i);if(o==="causal")throw new Pe("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=j5(a,e,r,o==="same"?"same":"valid","NDHWC",s),n!=null&&(a=Yo(a,n)),i==="channelsFirst"&&(a=Ue(a,[0,4,1,2,3])),a})}class m0 extends Le{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",m0.verifyArgs(n),this.rank=e,dn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Pe(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=yu(n.kernelSize,e,"kernelSize"),this.strides=yu(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Gr(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Vt(this.dataFormat),this.activation=Ks(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=It(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=nn(n.biasConstraint),this.biasRegularizer=Tt(n.biasRegularizer),this.activityRegularizer=Tt(n.activityRegularizer),this.dilationRate=yu(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new L(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new L(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new L(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(oi("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!Rk(e.kernelSize,"number",1,3))throw new L(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Hs(this.activation),useBias:this.useBias,biasInitializer:Nt(this.biasInitializer),biasRegularizer:ct(this.biasRegularizer),activityRegularizer:ct(this.activityRegularizer),biasConstraint:tn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Sc extends m0{constructor(e,n){super(e,n),this.kernel=null,Sc.verifyArgs(n),this.filters=n.filters,dn(this.filters,"filters"),this.kernelInitializer=It(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=nn(n.kernelConstraint),this.kernelRegularizer=Tt(n.kernelRegularizer)}build(e){e=Ke(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new L(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],o=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return K(()=>{e=De(e);let r;const o=this.bias==null?null:this.bias.read(),i=QF(this.activation.getClassName());if(i!=null&&this.rank===2)r=PE(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=RQ(e,this.kernel.read(),o,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=PE(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=PQ(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Pe("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Ke(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const s=Uo(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(s)}let o=[e[0]];return this.dataFormat==="channelsLast"?(o=o.concat(n),o.push(this.filters)):(o.push(this.filters),o=o.concat(n)),o}getConfig(){const e={filters:this.filters,kernelInitializer:Nt(this.kernelInitializer),kernelRegularizer:ct(this.kernelRegularizer),kernelConstraint:tn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new L(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class dp extends Sc{constructor(e){super(2,e),dp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Rk(e.kernelSize,"number",1,2))throw new L(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}dp.className="Conv2D";ie(dp);class pp extends Sc{constructor(e){super(3,e),pp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new L(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}pp.className="Conv3D";ie(pp);class n3 extends dp{constructor(e){if(super(e),this.inputSpec=[new en({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new L(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ke(e),e.length!==4)throw new L("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new L("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],o=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new en({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return K(()=>{let r=De(e);if(r.shape.length!==4)throw new L(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const o=r.shape,i=o[0];let s,a;this.dataFormat==="channelsFirst"?(s=2,a=3):(s=1,a=2);const l=o[s],u=o[a],c=this.kernelSize[0],f=this.kernelSize[1],h=this.strides[0],d=this.strides[1],p=ii(l,h,c,this.padding),m=ii(u,d,f,this.padding),g=[i,p,m,this.filters];this.dataFormat!=="channelsLast"&&(r=Ue(r,[0,2,3,1]));let y=_M(r,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(y=Ue(y,[0,3,1,2])),this.bias!=null&&(y=Yo(y,this.bias.read(),this.dataFormat)),this.activation!=null&&(y=this.activation.apply(y)),y})}computeOutputShape(e){e=Ke(e);const n=e.slice();let r,o,i;this.dataFormat==="channelsFirst"?(r=1,o=2,i=3):(r=3,o=1,i=2);const s=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[r]=this.filters,n[o]=ii(n[o],l,s,this.padding),n[i]=ii(n[i],u,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}n3.className="Conv2DTranspose";ie(n3);class r3 extends pp{constructor(e){if(super(e),this.inputSpec=[new en({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new L(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ke(e),e.length!==5)throw new L("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new L("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],o=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new en({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return K(()=>{let r=De(e);if(r.shape.length!==5)throw new L(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const o=r.shape,i=o[0];let s,a,l;this.dataFormat==="channelsFirst"?(l=2,s=3,a=4):(l=1,s=2,a=3);const u=o[l],c=o[s],f=o[a],h=this.kernelSize[0],d=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],g=this.strides[1],y=this.strides[2],v=ii(u,m,h,this.padding),x=ii(c,g,d,this.padding),b=ii(f,y,p,this.padding),w=[i,v,x,b,this.filters];this.dataFormat!=="channelsLast"&&(r=Ue(r,[0,2,3,4,1]));let S=U5(r,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=Ue(S,[0,4,1,2,3])),this.bias!==null&&(S=Yo(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=Ke(e);const n=e.slice();let r,o,i,s;this.dataFormat==="channelsFirst"?(r=1,o=2,i=3,s=4):(r=4,o=1,i=2,s=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],f=this.strides[1],h=this.strides[2];return n[r]=this.filters,n[o]=ii(n[o],c,a,this.padding),n[i]=ii(n[i],f,l,this.padding),n[s]=ii(n[s],h,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}r3.className="Conv3DTranspose";ie(r3);class o3 extends Sc{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new L("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new L("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new L(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=It(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Tt(n.depthwiseRegularizer),this.depthwiseConstraint=nn(n.depthwiseConstraint),this.pointwiseInitializer=It(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Tt(n.pointwiseRegularizer),this.pointwiseConstraint=nn(n.pointwiseConstraint)}build(e){if(e=Ke(e),e.length<this.rank+2)throw new L(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new L(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],o=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(r*this.depthMultiplier,this.filters);const s=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,s,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,s,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,s,this.biasConstraint):this.bias=null,this.inputSpec=[new en({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return K(()=>{e=De(e);let r;if(this.rank===1)throw new Pe("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Ue(e,[0,2,3,1])),r=QM(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=Yo(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Ue(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Nt(this.depthwiseInitializer),e.pointwiseInitializer=Nt(this.pointwiseInitializer),e.depthwiseRegularizer=ct(this.depthwiseRegularizer),e.pointwiseRegularizer=ct(this.pointwiseRegularizer),e.depthwiseConstraint=tn(this.depthwiseConstraint),e.pointwiseConstraint=tn(this.pointwiseConstraint),e}}o3.className="SeparableConv";class i3 extends o3{constructor(e){super(2,e)}}i3.className="SeparableConv2D";ie(i3);class g0 extends Sc{constructor(e){super(1,e),g0.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Rk(e.kernelSize,"number",1,1))throw new L(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}g0.className="Conv1D";ie(g0);class s3 extends Le{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return K(()=>{if(e=De(e),this.dataFormat==="channelsLast"){const r=Jp(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Jp(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=Jp(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Jp(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}s3.className="Cropping2D";ie(s3);class a3 extends Le{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Vt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,cY(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return K(()=>{let r=De(e);const o=r.shape;if(this.dataFormat==="channelsFirst"){r=Ue(r,[0,2,3,1]);const i=this.size[0]*o[2],s=this.size[1]*o[3],a=this.interpolation==="nearest"?Di.resizeNearestNeighbor(r,[i,s]):Di.resizeBilinear(r,[i,s]);return Ue(a,[0,3,1,2])}else{const i=this.size[0]*o[1],s=this.size[1]*o[2];return this.interpolation==="nearest"?Di.resizeNearestNeighbor(r,[i,s]):Di.resizeBilinear(r,[i,s])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}a3.className="UpSampling2D";ie(a3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MQ(t,e,n=[1,1],r="valid",o,i){return K(()=>{o==null&&(o=Ko()),Vt(o);let s=qk(t,o);if(t.rank!==4)throw new L(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new L(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return s=AC(s,e,n,r==="same"?"same":"valid","NHWC",i),o==="channelsFirst"&&(s=Ue(s,[0,3,1,2])),s})}class l3 extends m0{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=It(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=nn(e.depthwiseConstraint),this.depthwiseRegularizer=Tt(e.depthwiseRegularizer)}build(e){if(e=Ke(e),e.length<4)throw new L(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new L(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],o=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",o,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return K(()=>{e=De(e);let r=MQ(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=Yo(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Ke(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Uo(n,this.kernelSize[0],this.padding,this.strides[0]),s=Uo(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],o,i,s]:[e[0],i,s,o]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Nt(this.depthwiseInitializer),e.depthwiseRegularizer=ct(this.depthwiseRegularizer),e.depthwiseConstraint=tn(this.depthwiseRegularizer),e}}l3.className="DepthwiseConv2D";ie(l3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function u3(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new L("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function o(i){return i==null||Array.isArray(i)?i:[i]}return e=o(e),n=o(n),{inputs:t,initialState:e,constants:n}}function c3(t,e,n,r=!1,o,i,s=!1,a=!1){return K(()=>{const l=e.shape.length;if(l<3)throw new L(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(Ho(2,l));e=Ue(e,u),s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),o!=null&&(o=ge(ge(o,"bool"),"float32"),o.rank===l-1&&(o=rr(o,-1)),o=Ue(o,u)),r&&(e=rl(e,0),o!=null&&(o=rl(o,0)));const c=[];let f,h=n;const d=e.shape[0],p=ol(e);let m;o!=null&&(m=ol(o));for(let y=0;y<d;++y){const v=p[y],x=K(()=>t(v,h));if(o==null)f=x[0],h=x[1];else{const b=K(()=>{const w=m[y],S=Ae(go(w),w),$=ae(B(x[0],w),B(h[0],S)),C=h.map((k,I)=>ae(B(x[1][I],w),B(k,S)));return{output:$,newStates:C}});f=b.output,h=b.newStates}a&&c.push(f)}let g;return a&&(g=Xi(c,1)),[f,g,h]})}class sa extends Le{constructor(e){super(e);let n;if(e.cell==null)throw new L("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new Zk({cells:e.cell}):n=e.cell,n.stateSize==null)throw new L("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new en({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ho(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Y1(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let o;if(this.returnSequences?o=[e[0],e[1],r]:o=[e[0],r],this.returnState){const i=[];for(const s of n)i.push([e[0],s]);return[o].concat(i)}else return o}computeMask(e,n){return K(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const o=this.states.map(i=>null);return[r].concat(o)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Pe("Constants support is not implemented in RNN yet.");Y1(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new en({shape:[n,null,...r]});const o=[e[0]].concat(e.slice(2));this.cell.build(o);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!et(this.stateSpec.map(s=>s.shape[s.shape.length-1]),i))throw new L(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(s=>new en({shape:[null,s]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){K(()=>{if(!this.stateful)throw new ri("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new L("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>fn([r,o])):this.states_=[fn([r,this.cell.stateSize])];else if(e==null)ze(this.states_),this.keptStates!=null&&(ze(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>fn([r,o])):this.states_[0]=fn([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new L(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):ze(this.states_);for(let o=0;o<this.states_.length;++o){const i=e[o],s=Array.isArray(this.cell.stateSize)?this.cell.stateSize[o]:this.cell.stateSize,a=[r,s];if(!et(i.shape,a))throw new L(`State ${o} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[o]=i}}this.states_=this.states_.map(o=>hi(o.clone()))})}apply(e,n){let r=n==null?null:n.initialState,o=n==null?null:n.constants;n==null&&(n={});const i=u3(e,r,o,this.numConstants);e=i.inputs,r=i.initialState,o=i.constants;let s=[],a=[];if(r!=null){n.initialState=r,s=s.concat(r),this.stateSpec=[];for(const u of r)this.stateSpec.push(new en({shape:u.shape}));a=a.concat(this.stateSpec)}if(o!=null&&(n.constants=o,s=s.concat(o),this.numConstants=o.length),s[0]instanceof wi){const u=[e].concat(s),c=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=f,h}else return super.apply(e,n)}call(e,n){return K(()=>{const r=n==null?null:n.mask,o=n==null?null:n.training;let i=n==null?null:n.initialState;e=De(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const s=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==s)throw new L(`RNN Layer has ${s} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:o},u=c3((p,m)=>{const g=this.cell.call([p].concat(m),a);return[g[0],g.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),c=u[0],f=u[1],h=u[2];this.stateful&&this.resetStates(h,o);const d=this.returnSequences?f:c;return this.returnState?[d].concat(h):d})}getInitialState(e){return K(()=>{let n=fn(e.shape);return n=Ie(n,[1,2]),n=lp(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?q1(n,[1,r]):n):this.cell.stateSize>1?[q1(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===sa.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const o=n.cell,i=Li(o,r);return new e(Object.assign(n,{cell:i}))}}sa.className="RNN";ie(sa);class y0 extends Le{}class Xk extends y0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,dn(this.units,"units"),this.activation=Ks(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=It(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=It(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=It(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Tt(e.kernelRegularizer),this.recurrentRegularizer=Tt(e.recurrentRegularizer),this.biasRegularizer=Tt(e.biasRegularizer),this.kernelConstraint=nn(e.kernelConstraint),this.recurrentConstraint=nn(e.recurrentConstraint),this.biasConstraint=nn(e.biasConstraint),this.dropout=Mu([1,Gs([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Mu([1,Gs([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ke(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return K(()=>{if(e=e,e.length!==2)throw new L(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const o=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=qs({ones:()=>go(e),rate:this.dropout,training:o,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=qs({ones:()=>go(r),rate:this.recurrentDropout,training:o,dropoutFunc:this.dropoutFunc}));let i;const s=this.dropoutMask,a=this.recurrentDropoutMask;s!=null?i=mi(B(e,s),this.kernel.read()):i=mi(e,this.kernel.read()),this.bias!=null&&(i=Yo(i,this.bias.read())),a!=null&&(r=B(r,a));let l=ae(i,mi(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Hs(this.activation),useBias:this.useBias,kernelInitializer:Nt(this.kernelInitializer),recurrentInitializer:Nt(this.recurrentInitializer),biasInitializer:Nt(this.biasInitializer),kernelRegularizer:ct(this.kernelRegularizer),recurrentRegularizer:ct(this.recurrentRegularizer),biasRegularizer:ct(this.biasRegularizer),activityRegularizer:ct(this.activityRegularizer),kernelConstraint:tn(this.kernelConstraint),recurrentConstraint:tn(this.recurrentConstraint),biasConstraint:tn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}Xk.className="SimpleRNNCell";ie(Xk);class f3 extends sa{constructor(e){e.cell=new Xk(e),super(e)}call(e,n){return K(()=>{this.cell.dropoutMask!=null&&(ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,o=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:o,initialState:i})})}static fromConfig(e,n){return new e(n)}}f3.className="SimpleRNN";ie(f3);class Yk extends y0{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new L("GRUCell does not support reset_after parameter set to true.");this.units=e.units,dn(this.units,"units"),this.activation=Ks(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ks(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=It(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=It(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=It(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Tt(e.kernelRegularizer),this.recurrentRegularizer=Tt(e.recurrentRegularizer),this.biasRegularizer=Tt(e.biasRegularizer),this.kernelConstraint=nn(e.kernelConstraint),this.recurrentConstraint=nn(e.recurrentConstraint),this.biasConstraint=nn(e.biasConstraint),this.dropout=Mu([1,Gs([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Mu([1,Gs([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ke(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return K(()=>{if(e=e,e.length!==2)throw new L(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let o=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=qs({ones:()=>go(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=qs({ones:()=>go(o),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,s=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=B(e,i[0]));let c=mi(e,this.kernel.read());this.useBias&&(c=Yo(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(o=B(o,s[0]));const f=this.recurrentKernel.read(),[h,d]=Lr(f,[2*this.units,this.units],f.rank-1),p=mi(o,h),[m,g,y]=Lr(c,3,c.rank-1),[v,x]=Lr(p,2,p.rank-1);a=this.recurrentActivation.apply(ae(m,v)),l=this.recurrentActivation.apply(ae(g,x));const b=mi(B(l,o),d);u=this.activation.apply(ae(y,b));const w=ae(B(a,o),B(ae(1,zt(a)),u));return[w,w]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Hs(this.activation),recurrentActivation:Hs(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Nt(this.kernelInitializer),recurrentInitializer:Nt(this.recurrentInitializer),biasInitializer:Nt(this.biasInitializer),kernelRegularizer:ct(this.kernelRegularizer),recurrentRegularizer:ct(this.recurrentRegularizer),biasRegularizer:ct(this.biasRegularizer),activityRegularizer:ct(this.activityRegularizer),kernelConstraint:tn(this.kernelConstraint),recurrentConstraint:tn(this.recurrentConstraint),biasConstraint:tn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}Yk.className="GRUCell";ie(Yk);class h3 extends sa{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Yk(e),super(e)}call(e,n){return K(()=>{this.cell.dropoutMask!=null&&(ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,o=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:o,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}h3.className="GRU";ie(h3);class v0 extends y0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,dn(this.units,"units"),this.activation=Ks(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ks(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=It(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=It(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=It(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Tt(e.kernelRegularizer),this.recurrentRegularizer=Tt(e.recurrentRegularizer),this.biasRegularizer=Tt(e.biasRegularizer),this.kernelConstraint=nn(e.kernelConstraint),this.recurrentConstraint=nn(e.recurrentConstraint),this.biasConstraint=nn(e.biasConstraint),this.dropout=Mu([1,Gs([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Mu([1,Gs([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ke(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let o;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,s=this.units;o=new(n=class extends xo{apply(l,u){const c=i.apply([s]),f=new Mk().apply([s]),h=i.apply([s*2]);return vE(vE(c,f),h)}},n.className="CustomInit",n)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,o,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return K(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new L(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let o=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=qs({ones:()=>go(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=qs({ones:()=>go(o),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,c,f;0<this.dropout&&this.dropout<1&&(e=B(e,s[0]));let h=mi(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(o=B(o,a[0])),h=ae(h,mi(o,this.recurrentKernel.read())),this.useBias&&(h=Yo(h,this.bias.read()));const[d,p,m,g]=Lr(h,4,h.rank-1);l=this.recurrentActivation.apply(d),u=this.recurrentActivation.apply(p),c=ae(B(u,i),B(l,this.activation.apply(m))),f=this.recurrentActivation.apply(g);const y=B(f,this.activation.apply(c));return[y,y,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Hs(this.activation),recurrentActivation:Hs(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Nt(this.kernelInitializer),recurrentInitializer:Nt(this.recurrentInitializer),biasInitializer:Nt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ct(this.kernelRegularizer),recurrentRegularizer:ct(this.recurrentRegularizer),biasRegularizer:ct(this.biasRegularizer),activityRegularizer:ct(this.activityRegularizer),kernelConstraint:tn(this.kernelConstraint),recurrentConstraint:tn(this.recurrentConstraint),biasConstraint:tn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}v0.className="LSTMCell";ie(v0);class Qk extends sa{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new v0(e),super(e)}call(e,n){return K(()=>{this.cell.dropoutMask!=null&&(ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,o=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:o,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}Qk.className="LSTM";ie(Qk);class Zk extends y0{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return K(()=>{e=e;let r=e.slice(1);const o=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?o.push(r.splice(0,a.stateSize.length)):o.push(r.splice(0,1));o.reverse();const i=[];let s;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=o[a],a===0?s=[e[0]].concat(r):s=[s[0]].concat(r),s=l.call(s,n),i.push(s.slice(1))}r=[];for(const a of i.slice().reverse())r.push(...a);return[s[0]].concat(r)})}build(e){Y1(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,o)=>{za(`RNNCell_${o}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),o={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),o)}static fromConfig(e,n,r={}){const o=[];for(const i of n.cells)o.push(Li(i,r));return new e({cells:o})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return Q1(e)}setWeights(e){const n=[];for(const r of this.cells){const o=r.weights.length,i=e.splice(o);for(let s=0;s<r.weights.length;++s)n.push([r.weights[s],i[s]])}Vk(n)}}Zk.className="StackedRNNCells";ie(Zk);function qs(t){const{ones:e,rate:n,training:r=!1,count:o=1,dropoutFunc:i}=t,s=()=>i!=null?i(e(),n):oL(e(),n),a=()=>cp(s,e,r);return!o||o<=1?hi(a().clone()):Array(o).fill(void 0).map(a).map(u=>hi(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var FQ=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};class d3 extends sa{constructor(e){if(e.unroll)throw new Pe("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Pe("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new en({ndim:5})]}call(e,n){return K(()=>{if(this.cell.dropoutMask!=null&&(ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new L("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,o=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:r,training:o,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return K(()=>{const{stateSize:n}=this.cell,r=e.shape,o=this.computeSingleOutputShape(r),i=[o[0],...o.slice(2)],s=fn(i);return Array.isArray(n)?Array(n.length).fill(s):[s]})}resetStates(e,n=!1){K(()=>{if(!this.stateful)throw new ri("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,o=this.computeSingleOutputShape(r),i=[o[0],...o.slice(2)];if(r[0]==null)throw new L("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>fn(i)):this.states_=[fn(i)];else if(e==null)ze(this.states_),this.keptStates!=null&&(ze(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>fn(i)):this.states_[0]=fn(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new L(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):ze(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=i;if(!et(l.shape,u))throw new L(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>hi(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:o,padding:i,strides:s,dilationRate:a}=this.cell,l=n==="channelsFirst",u=e[l?3:2],c=e[l?4:3],f=Uo(u,o[0],i,s[0],a[0]),h=Uo(c,o[1],i,s[1],a[1]);return[...e.slice(0,2),...l?[r,f,h]:[f,h,r]]}}d3.className="ConvRNN2D";class Jk extends v0{constructor(e){const{filters:n,kernelSize:r,strides:o,padding:i,dataFormat:s,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,dn(this.filters,"filters"),this.kernelSize=yu(r,2,"kernelSize"),this.kernelSize.forEach(l=>dn(l,"kernelSize")),this.strides=yu(o||1,2,"strides"),this.strides.forEach(l=>dn(l,"strides")),this.padding=i||"valid",Gr(this.padding),this.dataFormat=s||"channelsLast",Vt(this.dataFormat),this.dilationRate=yu(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>dn(l,"dilationRate"))}build(e){var n;e=Ke(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new L(`The channel dimension of the input should be defined. Found ${e[r]}`);const o=e[r],i=4,s=this.kernelSize.concat([o,this.filters*i]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends xo{apply(h,d){const p=u.apply([c]),m=oa([c]),g=u.apply([c*2]);return Pk([p,m,g])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return K(()=>{if(e.length!==3)throw new L(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,o=e[0],i=e[1],s=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=qs({ones:()=>go(o),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(z,U,H)=>!U||!U[H]?z:B(U[H],z);let c=u(o,l,0),f=u(o,l,1),h=u(o,l,2),d=u(o,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=qs({ones:()=>go(i),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=u(i,p,0),g=u(i,p,1),y=u(i,p,2),v=u(i,p,3);const x=3,[b,w,S,$]=Lr(this.kernel.read(),a,x),[C,k,I,T]=this.useBias?Lr(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,b,C,this.padding),f=this.inputConv(f,w,k,this.padding),h=this.inputConv(h,S,I,this.padding),d=this.inputConv(d,$,T,this.padding);const[N,_,D,O]=Lr(this.recurrentKernel.read(),a,x);m=this.recurrentConv(m,N),g=this.recurrentConv(g,_),y=this.recurrentConv(y,D),v=this.recurrentConv(v,O);const R=this.recurrentActivation.apply(ae(c,m)),F=this.recurrentActivation.apply(ae(f,g)),A=ae(B(F,s),B(R,this.activation.apply(ae(h,y)))),P=B(this.recurrentActivation.apply(ae(d,v)),this.activation.apply(A));return[P,P,A]})}getConfig(){const e=super.getConfig(),n=FQ(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,n,r,o){const i=tl(e,n,this.strides,o||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?Yo(i,r,this.dataFormat):i}recurrentConv(e,n){return tl(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}Jk.className="ConvLSTM2DCell";ie(Jk);class p3 extends d3{constructor(e){const n=new Jk(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}p3.className="ConvLSTM2D";ie(p3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class eI extends Le{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let o=0;o<this.noiseShape.length;++o)r.push(this.noiseShape[o]==null?n[o]:this.noiseShape[o]);return r}call(e,n){return K(()=>{this.invokeCallHook(e,n);const r=De(e);if(0<this.rate&&this.rate<1){const o=n.training==null?!1:n.training,i=this.getNoiseShape(r);return cp(()=>oL(r,this.rate,i,this.seed),()=>r,o)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}eI.className="Dropout";ie(eI);class m3 extends eI{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}m3.className="SpatialDropout1D";ie(m3);class tI extends Le{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,dn(this.units,"units"),this.activation=Ks(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=It(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=It(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=nn(e.kernelConstraint),this.biasConstraint=nn(e.biasConstraint),this.kernelRegularizer=Tt(e.kernelRegularizer),this.biasRegularizer=Tt(e.biasRegularizer),this.activityRegularizer=Tt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ke(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ke(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return K(()=>{this.invokeCallHook(e,n);const r=De(e),o=QF(this.activation.getClassName());let i;return o!=null?i=mi(r,this.kernel.read(),o,this.bias?this.bias.read():null):(i=mi(r,this.kernel.read()),this.bias!=null&&(i=Yo(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:Hs(this.activation),useBias:this.useBias,kernelInitializer:Nt(this.kernelInitializer),biasInitializer:Nt(this.biasInitializer),kernelRegularizer:ct(this.kernelRegularizer),biasRegularizer:ct(this.biasRegularizer),activityRegularizer:ct(this.activityRegularizer),kernelConstraint:tn(this.kernelConstraint),biasConstraint:tn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}tI.className="Dense";ie(tI);class g3 extends Le{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ke(e);for(const n of e.slice(1))if(n==null)throw new L(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Bs(e,1)]}call(e,n){return K(()=>{this.invokeCallHook(e,n);let r=De(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const o=[0];for(let i=2;i<r.rank;++i)o.push(i);o.push(1),r=Ue(r,o)}return gY(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}g3.className="Flatten";ie(g3);class y3 extends Le{constructor(e){super(e),this.supportsMasking=!0,this.activation=Ks(e.activation)}call(e,n){return K(()=>{this.invokeCallHook(e,n);const r=De(e);return this.activation.apply(r)})}getConfig(){const e={activation:Hs(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}y3.className="Activation";ie(y3);class v3 extends Le{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return K(()=>(e=De(e),pY(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}v3.className="RepeatVector";ie(v3);class x3 extends Le{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",o=n.slice();let i=1,s=null;for(let l=0;l<o.length;++l){const u=o[l];if(this.isUnknown(u))if(s===null)s=l;else throw new L("Can only specifiy one unknown dimension.");else i*=u}const a=Bs(e);if(s!==null){if(i===0||a%i!==0)throw new L(r);o[s]=a/i}else if(a!==i)throw new L(r);return o}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return K(()=>{this.invokeCallHook(e,n);const r=De(e),o=r.shape,i=o.slice(0,1).concat(this.fixUnknownDimension(o.slice(1),this.targetShape));return V(r,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}x3.className="Reshape";ie(x3);class b3 extends Le{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Ho(1,e.dims.length+1);if(!et(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new en({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ke(e);const n=e.slice();return this.dims.forEach((r,o)=>{n[o+1]=e[r]}),n}call(e,n){return Ue(De(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}b3.className="Permute";ie(b3);class w3 extends Le{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=De(e);return j1(yg(r,this.maskValue),-1)}call(e,n){return K(()=>{this.invokeCallHook(e,n);const r=De(e),s=j1(yg(r,this.maskValue),-1,!0);return B(r,ge(s,r.dtype))})}}w3.className="Masking";ie(w3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class S3 extends Le{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(ot(e.inputLength))}this.inputDim=e.inputDim,dn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,dn(this.outputDim,"outputDim"),this.embeddingsInitializer=It(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Tt(e.embeddingsRegularizer),this.activityRegularizer=Tt(e.activityRegularizer),this.embeddingsConstraint=nn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return K(()=>this.maskZero?(e=De(e),yg(e,Ge(e))):null)}computeOutputShape(e){if(e=Ke(e),this.inputLength==null)return[...e,this.outputDim];const n=ot(this.inputLength);if(n.length!==e.length-1)throw new L(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let o=0;o<n.length;++o){const i=n[o],s=e[o+1];if(i!=null&&s!=null&&i!==s)throw new L(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[r]=s),r++}}return[e[0],...n,this.outputDim]}call(e,n){return K(()=>{this.invokeCallHook(e,n);let r=De(e);r.dtype!=="int32"&&(r=pi(r,"int32"));const o=rL(this.embeddings.read(),V(r,[r.size]));return V(o,Ke(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Nt(this.embeddingsInitializer),embeddingsRegularizer:ct(this.embeddingsRegularizer),activityRegularizer:ct(this.activityRegularizer),embeddingsConstraint:tn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}S3.className="Embedding";ie(S3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Sl extends Le{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Pe}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let o=0;o<n.length;++o){const i=e[e.length-n.length+o],s=n[o];if(i==null||s==null||i<0||s<0)r.push(null);else if(i===1)r.push(s);else if(s===1)r.push(i);else{if(i!==s)throw new L("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ke(e)]),e=e,e.length<2)throw new L(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=Ls(n),n.length>1)throw new L(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const s=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,s)}const o=e.map(i=>i.length);e.indexOf(null)===-1&&Ls(o).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return K(()=>{if(e=e,this.reshapeRequired){const r=[],o=e.map(i=>i.rank);if(o.indexOf(null)===-1){const i=Gs(o);for(let s of e){const a=s.rank;for(let l=0;l<i-a;++l)s=lp(s,1);r.push(s)}return this.mergeFunction(r)}else{let i=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,f=c[0],h=c.slice(1).concat([f]);let d=V(l,[f].concat(Bs(c.slice(1))));d=Ue(d,[1,0]),d=V(d,h),r.push(d),i=!0}else if(u>1){const c=Ho(1,u).concat([0]);r.push(Ue(l,c)),i=!0}else r.push(l)}let s=this.mergeFunction(r);const a=s.rank;if(i){if(a==null){const l=s.shape,u=l.length,c=l[u-1],f=[c].concat(l.slice(0,l.length-1));s=V(Ue(V(s,[-1,c]),[1,0]),f)}else if(a>1){const l=[a-1].concat(Ho(0,a-1));s=Ue(s,l)}}return s}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let r=[];for(const o of e)o!=null&&o[0]!==null&&r.push(o[0]);return r=Ls(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return K(()=>{if(n==null)return null;if(!Array.isArray(n))throw new L("`mask` should be an Array");if(!Array.isArray(e))throw new L("`inputs` should be an Array");if(n.length!==e.length)throw new L(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(o=>o==null))return null;n=n.map(o=>o==null?o:rr(o,0));let r=n[0];for(let o=1;o<n.length-1;++o)r=qi(r,n[o]);return r})}}class $3 extends Sl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=ae(n,e[r]);return n})}}$3.className="Add";ie($3);class C3 extends Sl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=B(n,e[r]);return n})}}C3.className="Multiply";ie(C3);class k3 extends Sl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=ae(n,e[r]);return B(1/e.length,n)})}}k3.className="Average";ie(k3);class I3 extends Sl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=ra(n,e[r]);return n})}}I3.className="Maximum";ie(I3);class T3 extends Sl{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=sh(n,e[r]);return n})}}T3.className="Minimum";ie(T3);class E3 extends Sl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new L("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const o of e)if(o!=null){n=!1;break}if(n)return;const r=[];for(let o=0;o<e.length;++o){const i=e[o].slice();i.splice(this.axis,1);let s=!1;for(const a of r)if(et(a,i)){s=!0;break}s||r.push(i)}if(r.length>1)throw new L("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return K(()=>Pk(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new L("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),o=this.axis<0?r.length+this.axis:this.axis;for(const i of n.slice(1)){if(r[o]==null||i[o]==null){r[o]=null;break}r[o]+=i[o]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new L("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new L("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new L(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return K(()=>{let r=!0;if(n.forEach(s=>{if(s!=null){r=!1;return}}),r)return null;const o=[];for(let s=0;s<e.length;++s)n[s]==null?o.push(ge(go(e[s]),"bool")):n[s].rank<e[s].rank?o.push(rr(n[s],-1)):o.push(n[s]);const i=ar(o,this.axis);return AM(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}E3.className="Concatenate";ie(E3);function tf(t,e){for(;t<0;)t+=e;return t}function LQ(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Pe("batchDot is not implemented for tensors of 4D or higher rank yet");if(E(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),E(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Pe("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,o=e.shape.length;n==null&&(n=[r-1,o-2]);const i=n;return K(()=>{let s;if(r>o){s=r-o;const l=[];for(let u=0;u<s;++u)l.push(1);e=V(e,e.shape.concat(l))}else if(o>r){s=o-r;const l=[];for(let u=0;u<s;++u)l.push(1);t=V(t,t.shape.concat(l))}else s=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Ie(B(t,e),i[0]):a=Ie(B(Ue(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,u=i[1]===e.shape.length-1;a=Qe(t,e,l,u)}if(s>0){let l;r>o?l=r+o-3:l=r-1;const u=[];for(let c=l;c<l+s;++c)u.push(c);a=np(a,u)}return a.shape.length===1&&(a=rr(a,1)),a})}let N3=class extends Sl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){E(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new Pe("Dot layer does not support tensors of 4D or higher rank yet.");const o=this.interpretAxes(n,r);if(n[o[0]]!==r[o[1]])throw new L(`Dimension incompatibility: ${n[o[0]]} !== ${r[o[1]]}`)}mergeFunction(e){if(e.length!==2)throw new L(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],o;return Array.isArray(this.axes)?o=this.axes.map((i,s)=>tf(i,e[s].shape.length)):o=[tf(this.axes,n.shape.length),tf(this.axes,r.shape.length)],this.normalize&&(n=Cg(n,o[0]),r=Cg(r,o[1])),LQ(n,r,o)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[tf(this.axes,e.length),tf(this.axes,n.length)],r}computeOutputShape(e){E(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new Pe("Dot layer does not support tensors of 4D or higher rank yet.");const o=this.interpretAxes(n,r);n.splice(o[0],1),r.splice(o[1],1),r.splice(0,1);const i=n.concat(r);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}};N3.className="Dot";ie(N3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class A3 extends Le{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return K(()=>{this.invokeCallHook(e,n);const r=De(e);return cp(()=>ae(f0(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}A3.className="GaussianNoise";ie(A3);class O3 extends Le{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return K(()=>{this.invokeCallHook(e,n);const r=De(e);return this.rate>0&&this.rate<1?cp(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return B(r,f0(r.shape,1,i))},()=>r,n.training||!1):r})}}O3.className="GaussianDropout";ie(O3);class _3 extends Le{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||De(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return K(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return cp(()=>{const i=De(e),l=-1.6732632423543772*1.0507009873554805;let u=yl(tp(r),this.rate);u=pi(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,f=-c*l*this.rate,h=ae(B(i,u),B(ae(u,-1),l));return ae(B(h,c),f)},()=>De(e),n.training||!1)}return e})}}_3.className="AlphaDropout";ie(_3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ch(t,e,n,r,o,i=.001){let s;if(t.rank===2)s=y5(t,e,n,r,o,i);else if(t.rank===3)s=x5(t,e,n,r,o,i);else if(t.rank===4)s=w5(t,e,n,r,o,i);else throw new Pe(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return s}function BQ(t,e,n,r,o=.001){return K(()=>{const i=FC(t,r),s=i.mean,a=i.variance;return[ch(t,s,a,n,e,o),s,a]})}function zQ(t,e,n,r,o=.001){return K(()=>{const i=FC(t,r),s=i.mean,a=i.variance,l=[];for(const p of Ho(0,t.rank))r.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const u=V(s,l),c=V(a,l),f=e==null?null:V(e,l),h=n==null?null:V(n,l);return[ch(t,u,c,h,f,o),s,a]})}function jQ(t,e,n,r,o=.001){return et(r.slice().sort(),Ho(0,t.rank-1))?BQ(t,e,n,r,o):zQ(t,e,n,r,o)}class D3 extends Le{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=It(e.betaInitializer||"zeros"),this.gammaInitializer=It(e.gammaInitializer||"ones"),this.movingMeanInitializer=It(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=It(e.movingVarianceInitializer||"ones"),this.betaConstraint=nn(e.betaConstraint),this.gammaConstraint=nn(e.gammaConstraint),this.betaRegularizer=Tt(e.betaRegularizer),this.gammaRegularizer=Tt(e.gammaRegularizer)}build(e){e=Ke(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new L(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new en({ndim:e.length,axes:{[n]:r}})];const o=[r];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return K(()=>{const r=n.training==null?!1:n.training,o=De(e),i=o.shape,s=i.length,a=Ho(0,s),l=this.axis>=0?this.axis:this.axis+s;a.splice(l,1);const u=il(1,s);u[l]=i[l];const c=a.slice();c.sort();const f=!et(c,Ho(0,s).slice(0,s-1)),h=()=>{if(f){const v=V(this.movingMean.read(),u),x=V(this.movingVariance.read(),u),b=this.center?V(this.beta.read(),u):null,w=this.scale?V(this.gamma.read(),u):null;return ch(o,v,x,b,w,this.epsilon)}else return ch(o,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return h();const[d,p,m]=jQ(o,this.gamma.read(),this.beta.read(),a,this.epsilon),g=(v,x,b)=>{K(()=>{const w=1-b,S=v.read(),$=B(Ae(S,x),w);v.write(Ae(S,$))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,m,this.momentum)})(),d})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Nt(this.betaInitializer),gammaInitializer:Nt(this.gammaInitializer),movingMeanInitializer:Nt(this.movingMeanInitializer),movingVarianceInitializer:Nt(this.movingVarianceInitializer),betaRegularizer:ct(this.betaRegularizer),gammaRegularizer:ct(this.gammaRegularizer),betaConstraint:tn(this.betaConstraint),gammaConstraint:tn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}D3.className="BatchNormalization";ie(D3);class R3 extends Le{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=It(e.betaInitializer||"zeros"),this.gammaInitializer=It(e.gammaInitializer||"ones"),this.betaRegularizer=Tt(e.betaRegularizer),this.gammaRegularizer=Tt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ke(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Ls(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),o=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,o):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,o):this.beta=null,this.built=!0}call(e,n){const r=De(e),o=r.shape,i=o.length;return K(()=>{let{mean:a,variance:l}=FC(r,this.axis,!0);const u=il(1,i);for(const m of this.axis)u[m]=o[m];const c=m=>m!=null&&m.shape.length!==i?V(m,u):m;let f=this.scale?c(this.gamma.read()):null,h=this.center?c(this.beta.read()):null;const d=[],p=[];for(let m=0;m<i;++m)this.axis.indexOf(m)!==-1?(d.push(o[m]),p.push(1)):(d.push(1),p.push(o[m]));return a=Lo(a,d),l=Lo(l,d),f!=null&&(f=Lo(f,p)),h!=null&&(h=Lo(h,p)),ch(r,a,l,h,f,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Nt(this.betaInitializer),gammaInitializer:Nt(this.gammaInitializer),betaRegularizer:ct(this.betaRegularizer),gammaRegularizer:ct(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}R3.className="LayerNormalization";ie(R3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WQ(t,e,n){return K(()=>{if(t.rank!==4)throw new L(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new L("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Ko()),n!=="channelsLast"&&n!=="channelsFirst")throw new L(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],LC(t,r)})}class P3 extends Le{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ko():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new L(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new L(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new L(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new en({ndim:4})]}computeOutputShape(e){e=Ke(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return K(()=>WQ(De(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}P3.className="ZeroPadding2D";ie(P3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function x0(t,e,n,r,o,i){return K(()=>{Vt(o),JF(i),Gr(r),n==null&&(n=[1,1]),r==null&&(r="valid"),o==null&&(o=Ko()),i==null&&(i="max"),t=qk(t,o);let s;const a=r==="same"?"same":"valid";return i==="max"?s=MC(t,e,n,a):s=IC(t,e,n,a),o==="channelsFirst"&&(s=Ue(s,[0,3,1,2])),s})}function M3(t,e,n,r,o,i){return K(()=>{Vt(o),JF(i),Gr(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),o==null&&(o=Ko()),i==null&&(i="max"),t=t3(t,o);let s;const a=r==="same"?"same":"valid";return i==="max"?s=iK(t,e,n,a):s=a5(t,e,n,a),o==="channelsFirst"&&(s=Ue(s,[0,4,1,2,3])),s})}class F3 extends Le{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new L(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(dn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new L(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);dn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Gr(this.padding),this.inputSpec=[new en({ndim:3})]}computeOutputShape(e){e=Ke(e);const n=Uo(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return K(()=>{this.invokeCallHook(e,n),e=lp(De(e),2);const r=this.poolingFunction(De(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return np(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class L3 extends F3{constructor(e){super(e)}poolingFunction(e,n,r,o,i){return Vt(i),Gr(o),x0(e,n,r,o,i,"max")}}L3.className="MaxPooling1D";ie(L3);class B3 extends F3{constructor(e){super(e)}poolingFunction(e,n,r,o,i){return Vt(i),Gr(o),x0(e,n,r,o,i,"avg")}}B3.className="AveragePooling1D";ie(B3);class z3 extends Le{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new L(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];dn(this.poolSize,"poolSize"),dn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Vt(this.dataFormat),Gr(this.padding),this.inputSpec=[new en({ndim:4})]}computeOutputShape(e){e=Ke(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Uo(n,this.poolSize[0],this.padding,this.strides[0]),r=Uo(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return K(()=>(this.invokeCallHook(e,n),this.poolingFunction(De(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class j3 extends z3{constructor(e){super(e)}poolingFunction(e,n,r,o,i){return Vt(i),Gr(o),x0(e,n,r,o,i,"max")}}j3.className="MaxPooling2D";ie(j3);class W3 extends z3{constructor(e){super(e)}poolingFunction(e,n,r,o,i){return Vt(i),Gr(o),x0(e,n,r,o,i,"avg")}}W3.className="AveragePooling2D";ie(W3);class V3 extends Le{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new L(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];dn(this.poolSize,"poolSize"),dn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Vt(this.dataFormat),Gr(this.padding),this.inputSpec=[new en({ndim:5})]}computeOutputShape(e){e=Ke(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Uo(n,this.poolSize[0],this.padding,this.strides[0]),r=Uo(r,this.poolSize[1],this.padding,this.strides[1]),o=Uo(o,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,o]:[e[0],n,r,o,e[4]]}call(e,n){return K(()=>(this.invokeCallHook(e,n),this.poolingFunction(De(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class U3 extends V3{constructor(e){super(e)}poolingFunction(e,n,r,o,i){return Vt(i),Gr(o),M3(e,n,r,o,i,"max")}}U3.className="MaxPooling3D";ie(U3);class G3 extends V3{constructor(e){super(e)}poolingFunction(e,n,r,o,i){return Vt(i),Gr(o),M3(e,n,r,o,i,"avg")}}G3.className="AveragePooling3D";ie(G3);class H3 extends Le{constructor(e){super(e),this.inputSpec=[new en({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Pe}}class K3 extends H3{constructor(e){super(e||{})}call(e,n){return K(()=>{const r=De(e);return Ht(r,1)})}}K3.className="GlobalAveragePooling1D";ie(K3);class q3 extends H3{constructor(e){super(e||{})}call(e,n){return K(()=>{const r=De(e);return Vo(r,1)})}}q3.className="GlobalMaxPooling1D";ie(q3);class X3 extends Le{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Vt(this.dataFormat),this.inputSpec=[new en({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Pe}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class Y3 extends X3{call(e,n){return K(()=>{const r=De(e);return this.dataFormat==="channelsLast"?Ht(r,[1,2]):Ht(r,[2,3])})}}Y3.className="GlobalAveragePooling2D";ie(Y3);class Q3 extends X3{call(e,n){return K(()=>{const r=De(e);return this.dataFormat==="channelsLast"?Vo(r,[1,2]):Vo(r,[2,3])})}}Q3.className="GlobalMaxPooling2D";ie(Q3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Z3 extends Le{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const o=n.layer,i=Li(o,r);delete n.layer;const s={layer:i};return Object.assign(s,n),new e(s)}}class J3 extends Z3{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ke(e),e.length<3)throw new L(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ke(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),o=e[1];return[r[0],o].concat(r.slice(1))}call(e,n){return K(()=>(e=De(e),c3((s,a)=>[De(this.layer.call(s,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}J3.className="TimeDistributed";ie(J3);function VQ(t){wl(uY,"BidirectionalMergeMode",t)}const UQ="concat";class eB extends Z3{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=Li(r),n.goBackwards=n.goBackwards!==!0;const o={};if(o.className=e.layer.getClassName(),o.config=n,this.backwardLayer=Li(o),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?UQ:e.mergeMode,VQ(this.mergeMode),e.weights)throw new Pe("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,o,i;return this.returnState&&(i=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,o=[r]):this.mergeMode==null?o=[r,r.slice()]:o=[r],this.returnState?this.mergeMode==null?o.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):or(o)}apply(e,n){let r=n==null?null:n.initialState,o=n==null?null:n.constants;n==null&&(n={});const i=u3(e,r,o,this.numConstants);if(e=i.inputs,r=i.initialState,o=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&o==null)return super.apply(e,n);const s=[],a=[];if(r!=null){const u=r.length;if(u%2>0)throw new L("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,s.push(...r);const c=r.map(f=>new en({shape:f.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),a.push(...c)}if(o!=null)throw new Pe("Support for constants in Bidirectional layers is not implemented yet.");const l=s[0]instanceof wi;for(const u of s)if(u instanceof wi!==l)throw new L("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(s),c=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=f,h}else return super.apply(e,n)}call(e,n){return K(()=>{const r=n.initialState;let o,i;if(r==null)o=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=r.slice(0,r.length/2),u=r.slice(r.length/2);o=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let s;this.returnState&&(Array.isArray(o)&&(s=o.slice(1).concat(i.slice(1))),o=o[0],i=i[0]),this.returnSequences&&(i=rl(i,1));let a;return this.mergeMode==="concat"?a=Pk([o,i]):this.mergeMode==="sum"?a=ae(o,i):this.mergeMode==="ave"?a=B(.5,ae(o,i)):this.mergeMode==="mul"?a=B(o,i):this.mergeMode==null&&(a=[o,i]),this.returnState?this.mergeMode==null?a.concat(s):[a].concat(s):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){za(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),za(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(s=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=Li(n.layer);if(delete n.layer,n.numConstants!=null)throw new Pe("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const o=n;return o.layer=r,new e(o)}}eB.className="Bidirectional";ie(eB);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class tB extends Le{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return K(()=>(e=De(e),e.dtype!=="float32"&&(e=pi(e,"float32")),ae(B(e,this.scale),this.offset)))}}tB.className="Rescaling";ie(tB);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:GQ,cropAndResize:HQ}=Di;class nB extends Le{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,o,i,s,a,l){return K(()=>{let u,c=!1;const f=n/s,h=r/a,d=(o+n)/s,p=(i+r)/a,m=[f,h,d,p],g=[];e.rank===3?(c=!0,u=Xi([e])):u=e;for(let w=0;w<u.shape[0];w++)g.push(m);const y=bM(g,[g.length,4]),v=ah(0,g.length,1,"int32"),b=HQ(u,y,v,[o,i],"nearest");return pi(c?De(ol(b)):b,l)})}upsize(e,n,r,o){return K(()=>{const i=GQ(e,[n,r]);return pi(i,o)})}call(e,n){return K(()=>{const r=De(e),o=r.dtype,i=r.shape,s=i[i.length-3],a=i[i.length-2];let l=0;s!==this.height&&(l=Math.floor((s-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(r,l,u,this.height,this.width,s,a,o):this.upsize(e,this.height,this.width,o)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ke(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}nB.className="CenterCrop";ie(nB);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function KQ(t,e,n,r){let o=De(t);if(o.dtype!=="int32"&&(o=pi(o,"int32")),e==="int")return o;const i=o.shape;if(o.rank===0&&(o=rr(o,-1)),e==="oneHot"&&o.shape[o.shape.length-1]!==1&&(o=rr(o,-1)),o.rank>2)throw new L(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${o.rank}.`);const s=["multiHot","oneHot"].includes(e),a=o;let l;if(typeof r<"u"&&e==="count"?l=rE(a,r,n,s):l=rE(a,[],n,s),e!=="tfIdf")return l;if(r)return B(l,r);throw new L("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class rB extends Le{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Ke(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return K(()=>{e=De(e),e.dtype!=="int32"&&(e=pi(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new L(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=De(n.countWeights)}const o=Vo(e),i=mg(e),s=Ur(this.numTokens,o).bufferSync().get(0),a=yl(i,0).bufferSync().get(0);if(!(s&&a))throw new L(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return KQ(e,this.outputMode,this.numTokens,r)})}}rB.className="CategoryEncoding";ie(rB);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const qQ=["bilinear","nearest"],ME=new Set(qQ);class oB extends Le{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(ME.has(e.interpolation))this.interpolation=e.interpolation;else throw new L(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ke(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return K(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Di.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Di.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...ME]} are supported`)})}}oB.className="Resizing";ie(oB);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class iB{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}iB.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sB extends Le{constructor(e){super(e),this.randomGenerator=new iB(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}sB.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const XQ=["bilinear","nearest"],FE=new Set(XQ);class aB extends sB{constructor(e){super(e);const{factor:n,interpolation:r="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new L(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new L(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new L(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(FE.has(r))this.interpolation=r;else throw new L(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ke(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return K(()=>{const r=De(e);this.imgHeight=r.shape[r.shape.length-3];const o=r.shape[r.shape.length-2];this.widthFactor=tp([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*o;i=Math.round(i);const s=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Di.resizeBilinear(e,s);case"nearest":return Di.resizeNearestNeighbor(e,s);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...FE]} are supported`)}})}}aB.className="RandomWidth";ie(aB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function YQ(t){return new tI(t)}function QQ(t){return new Qk(t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZQ=q();ZQ.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var LE;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(LE||(LE={}));var BE;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(BE||(BE={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var zE;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(zE||(zE={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function we(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&E(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JQ=iF;class b0 extends E${nextDataId(){return b0.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new kP(this,ti())}write(e,n,r){this.firstUse&&(this.firstUse=!1,q().get("IS_NODE")&&Dr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const o={id:this.nextDataId()};return this.data.set(o,{values:e,dtype:r,refCount:1}),o}makeTensorInfo(e,n,r){let o;if(n==="string"&&r!=null&&r.length>0&&td(r[0])){const i=r.map(s=>Fs(s));o=this.write(i,e,n)}else o=this.write(r,e,n);return{dataId:o,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,o,i){this.data.set(e,{values:n,dtype:o,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const o=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return Yi(o,i)}return SH(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(o=>Us(o));return Me(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Me(e.shape,e.dtype,n)}makeOutput(e,n,r){return ti().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=nr();return e(),{kernelMs:nr()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){we([e],"where");const n=this.readSync(e.dataId);return JQ(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}b0.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const eZ=t=>{const{x:e}=t.inputs,n=t.backend;we(e,"abs");let r=new Float32Array(Q(e.shape));const o=n.data.get(e.dataId).values;return r=lB(o),n.makeOutput(r,e.shape,e.dtype)},tZ={kernelName:Jy,backendName:"cpu",kernelFunc:eZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ut(t){return(e,n,r,o,i)=>{const s=Re(e,n),a=s.length,l=ke(s),u=Q(s),c=On(i,u),f=e.length,h=n.length,d=ke(e),p=ke(n),m=Ru(e,s),g=Ru(n,s);if(m.length+g.length===0)for(let y=0;y<c.length;++y)c[y]=t(r[y%r.length],o[y%o.length]);else for(let y=0;y<c.length;++y){const v=mc(y,a,l),x=v.slice(-f);m.forEach($=>x[$]=0);const b=fi(x,f,d),w=v.slice(-h);g.forEach($=>w[$]=0);const S=fi(w,h,p);c[y]=t(r[b],o[S])}return[c,s]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mr(t){const{inputs:e,backend:n}=t,{real:r,imag:o}=e,i=n.data.get(r.dataId).values,s=n.data.get(o.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(o.shape,"float32",s)},a}const nZ={kernelName:W$,backendName:"cpu",kernelFunc:mr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ng(t,e,n="float32"){if(n==="complex64"){const o=Ng(t,e,"float32"),i=Ng(t,e,"float32");return mr({inputs:{real:o,imag:i},backend:t})}const r=_n(Q(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Si(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const rZ={kernelName:Sd,backendName:"cpu",kernelFunc:Si};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sl(t){const{inputs:e,backend:n}=t,{input:r}=e,o=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(o.dataId).values;return n.makeTensorInfo(o.shape,o.dtype,i)}const oZ={kernelName:hC,backendName:"cpu",kernelFunc:sl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uB(t,e,n,r){if(r==="int32"){const o=Int32Array.from(t);return[e,"int32",o]}if(r==="bool"){const o=gl([0],n),[i,s]=Ut((a,l)=>a!==l?1:0)(e,[],t,o,"bool");return[s,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Xs(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{dtype:i}=r;if(i==="complex64"){if(o.dtype==="complex64")return Si({inputs:{x:o},backend:n});const c=Ng(n,o.shape,o.dtype),f=Xs({inputs:{x:o},backend:n,attrs:{dtype:"float32"}}),h=mr({inputs:{real:f,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),h}if(o.dtype==="complex64"){const c=sl({inputs:{input:o},backend:n}),f=Xs({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),f}if(!TP(o.dtype,i)){const c=Si({inputs:{x:o},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:i}}const s=n.data.get(o.dataId).values,[a,l,u]=uB(s,o.shape,o.dtype,i);return n.makeTensorInfo(a,l,u)}const iZ={kernelName:ud,backendName:"cpu",kernelFunc:Xs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sn(t,e,n,r){return n==null?({inputs:o,backend:i})=>{const{a:s,b:a}=o,l=i;we([s,a],t);const u=l.data.get(s.dataId).values,c=l.data.get(a.dataId).values,f=s.dtype==="string"?Qi(u):u,h=s.dtype==="string"?Qi(c):c,d=r||s.dtype,[p,m]=e(s.shape,a.shape,f,h,d);return l.makeTensorInfo(m,d,p)}:({inputs:o,backend:i})=>{const{a:s,b:a}=o,l=i;if(s.dtype==="complex64"||a.dtype==="complex64"){const u=Xs({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),f=c.complexTensorInfos.real,h=c.complexTensorInfos.imag,d=l.data.get(f.dataId).values,p=l.data.get(h.dataId).values,m=Xs({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),y=g.complexTensorInfos.real,v=g.complexTensorInfos.imag,x=l.data.get(y.dataId).values,b=l.data.get(v.dataId).values,[w,S,$]=n(s.shape,a.shape,d,p,x,b),C=l.makeTensorInfo($,"float32",w),k=l.makeTensorInfo($,"float32",S),I=mr({inputs:{real:C,imag:k},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(C),l.disposeIntermediateTensorInfo(k),I}else{const u=l.data.get(s.dataId).values,c=l.data.get(a.dataId).values,f=r||s.dtype,[h,d]=e(s.shape,a.shape,u,c,f);return l.makeTensorInfo(d,f,h)}}}function nI(t){return(e,n,r,o,i,s)=>{const a=Re(e,n),l=Q(a),u=a.length,c=ke(a),f=On("float32",l),h=On("float32",l),d=Ru(e,a),p=Ru(n,a),m=Yi(r,o),g=Yi(i,s),y=e.length,v=ke(e),x=n.length,b=ke(n);if(d.length+p.length===0)for(let w=0;w<f.length;w++){const S=w%m.length,$=w%g.length,C=t(m[S*2],m[S*2+1],g[$*2],g[$*2+1]);f[w]=C.real,h[w]=C.imag}else for(let w=0;w<f.length;w++){const S=mc(w,u,c),$=S.slice(-y);d.forEach(N=>$[N]=0);const C=fi($,y,v),k=S.slice(-x);p.forEach(N=>k[N]=0);const I=fi(k,x,b),T=t(m[C*2],m[C*2+1],g[I*2],g[I*2+1]);f[w]=T.real,h[w]=T.imag}return[f,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cB=Ut((t,e)=>t+e),sZ=nI((t,e,n,r)=>({real:t+n,imag:e+r})),Lu=sn(gc,cB,sZ),aZ={kernelName:gc,backendName:"cpu",kernelFunc:Lu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rI(t,e,n,r,o){const i=Q(r),s=_n(o,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=o||(i>0?s[l]+=e[a]:s[l]+=1)}return s}function fB(t,e,n,r=!1){const o=t.shape[0],i=t.shape[1],s=Me([o,n],e.dtype);for(let a=0;a<o;a++)for(let l=0;l<i;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?s.set(1,a,u):e.size>0?s.set(s.get(a,u)+e.get(a,l),a,u):s.set(s.get(a,u)+1,a,u))}return s}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hB=Ut((t,e)=>t&e),lZ=sn(j$,hB),uZ={kernelName:j$,backendName:"cpu",kernelFunc:lZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ci(t){return(e,n,r)=>{const o=Bt(n,e.length);for(let i=0;i<e.length;++i)o[i]=t(e[i],r);return o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function it(t,e,n){const r=Ci(e);return aa(t,r,n)}function aa(t,e,n){return({inputs:r,attrs:o,backend:i})=>{const{x:s}=r;we(s,t);const a=i,l=a.data.get(s.dataId).values;let u;if(s.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Qi(l)}else u=l;const c=n||s.dtype,f=e(u,c,o);return a.makeTensorInfo(s.shape,c,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dB=Ci(t=>Math.ceil(t)),cZ=aa(cd,dB),fZ={kernelName:cd,backendName:"cpu",kernelFunc:cZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(t,e,n,r){const o=Bt(n,Q(e));if(r&&n!=="string"){let i=0;t.forEach(s=>{const a=Q(s.shape);o.set(s.vals,i),i+=a})}else{let i=0;t.forEach(s=>{const a=n==="string"?Qi(s.vals):s.vals;let l=0;for(let u=0;u<s.shape[0];++u){const c=u*e[1]+i;for(let f=0;f<s.shape[1];++f)o[c+f]=a[l++]}i+=s.shape[1]})}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mB=Ut((t,e)=>t===e?1:0),gB=sn(pv,mB,null,"bool"),hZ={kernelName:pv,backendName:"cpu",kernelFunc:gB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yB=Ci(t=>Math.exp(t)),vB=aa(yd,yB,"float32"),dZ={kernelName:yd,backendName:"cpu",kernelFunc:vB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xB=Ci(t=>Math.expm1(t)),pZ=aa(vd,xB),mZ={kernelName:vd,backendName:"cpu",kernelFunc:pZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bB=Ci(t=>Math.floor(t)),gZ=aa(xd,bB),yZ={kernelName:xd,backendName:"cpu",kernelFunc:gZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wB=Ut((t,e)=>Math.floor(t/e)),vZ=sn(bd,wB,null,"int32"),xZ={kernelName:bd,backendName:"cpu",kernelFunc:vZ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SB(t,e,n,r,o,i,s,a,l){const u=Me([r,i],n);for(let c=0;c<r;c++){const f=[];let h=0;for(let d=0;d<o;d++){const p=t[c*o+d];h+=p*s[d],f.push(p)}if(h<0||h>=l/i)throw new Error(`Invalid indices: ${f} does not index into ${a}`);for(let d=0;d<i;d++)u.values[c*i+d]=e.get(...e.indexToLoc(h*i+d))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $B(t,e,n){const r=Me(n,t.dtype);for(let o=0;o<r.size;++o){const s=r.indexToLoc(o).slice(),a=s[0],l=s[2],u=e.locToIndex([a,l]);s[2]=e.values[u];const c=t.locToIndex(s);0<=c&&c<t.values.length&&(r.values[o]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CB=Ut((t,e)=>t>e?1:0),bZ=sn(vv,CB,null,"bool"),wZ={kernelName:vv,backendName:"cpu",kernelFunc:bZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kB=Ut((t,e)=>t>=e?1:0),SZ=sn(wd,kB,null,"bool"),$Z={kernelName:wd,backendName:"cpu",kernelFunc:SZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IB=Ut((t,e)=>t<e?1:0),CZ=sn(bv,IB,null,"bool"),kZ={kernelName:bv,backendName:"cpu",kernelFunc:CZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TB=Ut((t,e)=>t<=e?1:0),IZ=sn(wv,TB,null,"bool"),TZ={kernelName:wv,backendName:"cpu",kernelFunc:IZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EB(t,e,n){const r=(e-t)/(n-1),o=_n(n,"float32");o[0]=t;for(let i=1;i<o.length;i++)o[i]=o[i-1]+r;return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NB=Ci(t=>Math.log(t)),EZ=aa(Id,NB),NZ={kernelName:Id,backendName:"cpu",kernelFunc:EZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AB(t,e,n,r){const o=On(r,Q(n));for(let i=0;i<o.length;++i){const s=i*e;let a=t[s];for(let l=0;l<e;++l){const u=t[s+l];(Number.isNaN(u)||u>a)&&(a=u)}o[i]=a}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OB=Ut((t,e)=>Math.max(t,e)),AZ=sn(Ed,OB),OZ={kernelName:Ed,backendName:"cpu",kernelFunc:AZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _B=Ut((t,e)=>Math.min(t,e)),_Z=sn(Nd,_B),DZ={kernelName:Nd,backendName:"cpu",kernelFunc:_Z};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oI=Ut((t,e)=>t*e),RZ=nI((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),w0=sn(Od,oI,RZ),PZ={kernelName:Od,backendName:"cpu",kernelFunc:w0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DB(t,e,n){const r=ea(-1,n);return oI([],e,r,t,n)}function MZ(t){const{inputs:e,backend:n}=t,{x:r}=e;we(r,"neg");const o=n.data.get(r.dataId).values,[i,s]=DB(o,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,i)}const FZ={kernelName:_v,backendName:"cpu",kernelFunc:MZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RB=Ut((t,e)=>t!==e?1:0),LZ=sn(Dv,RB,null,"bool"),BZ={kernelName:Dv,backendName:"cpu",kernelFunc:LZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iI(t,e,n,r,o){const i=e.length,s=Q(e),a=ke(e),l=ke(o),u=On(n,Q(o));for(let c=0;c<s;++c){const f=mc(c,i,a),h=new Array(f.length);for(let p=0;p<h.length;p++)h[p]=f[r[p]];const d=fi(h,i,l);u[d]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ur(t){const{inputs:e,attrs:n,backend:r}=t,{x:o}=e,{perm:i}=n;we(o,"transpose");const s=o.shape.length,a=new Array(s);for(let f=0;f<a.length;f++)a[f]=o.shape[i[f]];const l=r.data.get(o.dataId).values,u=iI(l,o.shape,o.dtype,i,a);return{dataId:r.write(u,a,o.dtype),shape:a,dtype:o.dtype}}const zZ={kernelName:pu,backendName:"cpu",kernelFunc:ur};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PB(t,e,n,r){const[o,i]=mn(t,r),s=$r(e,"int32"),a=_n(Q(o),s),l=Q(i);for(let u=0;u<a.length;++u){const c=u*l;let f=1;for(let h=0;h<l;++h)f*=n[c+h];a[u]=f}return{outVals:a,outShape:o,outDtype:s}}function jZ(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r;we(o,"prod");const a=o.shape.length,l=Fe(i,o.shape),u=Ot(l,a);let c=l,f=o;const h=[];u!=null&&(f=ur({inputs:{x:o},backend:n,attrs:{perm:u}}),h.push(f),c=Wt(c.length,a));const d=n.data.get(f.dataId).values,{outVals:p,outShape:m,outDtype:g}=PB(f.shape,f.dtype,d,c);let y=m;return s&&(y=qt(m,l)),h.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(y,g,p)}const WZ={kernelName:Bv,backendName:"cpu",kernelFunc:jZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VZ(t,e,n){t.forEach((r,o)=>{if(r<0||r>=n){const i=mc(o,e.length,ke(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function UZ(t,e){for(let n=0;n<t.length;++n){const r=t[n],o=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>o)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function GZ(t,e,n,r){const o=[];let i=0;const s=e.length-1+n.length,a=new Array(s).fill(null).map(()=>[0]);UZ(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let f=1;f<l+1;++f)a[u].push(f*c)}for(let u=0;u<t.length;++u){let c=t[u],f=t[u]+1;for(let h=0;h<n.length;++h){const d=n[h],p=h+e.length-1;if(p>=0){const m=a[p],g=m[m.length-1]-d[c];for(let y=c;y<f;++y)a[p].push(d[y+1]+g)}c=d[c],f=d[f]}f!==c&&(o.push([c,f]),i+=f-c)}return{outSplits:a,valueSlices:o,numValues:i}}function HZ(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,o=Bt("int32",r);e.push(o),t[n].forEach((i,s)=>o[s]=i)}return e}function jE(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function KZ(t,e,n,r,o,i){const s=jE(e,2)[1],a=jE(i,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let f=0;f<r;++f)o[l*a+f]=t[c*s+f];++l}}function qZ(t,e,n,r,o){const i=e.slice();i[0]=o;const s=Bt(n,Q(i)),a=t.length,l=a===0?0:a/e[0];return KZ(t,e,r,l,s,i),[s,i]}function MB(t,e,n,r,o,i,s,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(VZ(i,s,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:f,numValues:h}=GZ(i,s,t,u),d=HZ(c),p=qZ(n,r,o,f,h);return[d,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WE=2147483647;function FB(t,e,n,r,o,i,s){if(e.length>1)throw new Error("starts must be a scalar or vector");if(o.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=o.length===0,u=s.length===0,c=[];a||c.push(e[0]),l||c.push(o[0]),u||c.push(s[0]);for(let g=1;g<c.length;++g)if(c[g]!==c[g-1])throw new Error("starts, limits, and deltas must have the same shape");const f=c.length===0?1:c[0],h=Bt("int32",f+1);h[0]=0;for(let g=0;g<f;++g){const y=a?t[0]:t[g],v=l?r[0]:r[g],x=u?i[0]:i[g];if(x===0)throw new Error("Requires delta != 0");let b;if(x>0&&v<y||x<0&&v>y)b=0;else if(b=Math.ceil(Math.abs((v-y)/x)),b>WE)throw new Error(`Requires ((limit - start) / delta) <= ${WE}`);h[g+1]=h[g]+b}const d=h[f],p=Bt(n,d);let m=0;for(let g=0;g<f;++g){const y=h[g+1]-h[g];let v=a?t[0]:t[g];const x=u?i[0]:i[g];for(let b=0;b<y;++b)p[m++]=v,v+=x}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Kr=Ro;class Ag{constructor(e,n,r,o,i,s,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=o,this.valuesDType=i,this.defaultValue=s,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=CF(c),this.raggedRank=kF(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Kr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Kr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Kr.VALUE_ROWIDS:return Ag.getMaxWidthValueRowID(n);case Kr.ROW_SPLITS:return Ag.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Kr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let o=0;o<n-1;++o){const i=e[o+1]-e[o];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,o=e[0],i=0;for(let s=1;s<n;++s){const a=e[s];a!==o&&(o=a,i=Math.max(s-r,i),r=s)}return Math.max(n-r,i)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return UE(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;IF(r,n);const o=this.tensorShapeFromTensor(this.shape,this.shapeShape),s=$F(this.raggedRank,o,n);s[0]<0&&(s[0]=e);for(let a=1;a<=this.raggedRank;++a)s[a]<0&&(s[a]=this.getMaxWidth(a));return s}calculateFirstParentOutputIndex(e,n,r){const o=Math.min(e,r),i=[];let s=0;for(let a=0;a<o;++a,s+=n)i.push(s);for(let a=o;a<e;++a)i.push(-1);return E(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,r,o){const i=e.length,s=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let u=Math.min(o,l),c=n[a];c===-1&&(u=0);for(let f=0;f<u;++f)s.push(c),c+=r;for(let f=0;f<l-u;++f)s.push(-1)}if(i>0&&s.length!==e[i-1])throw new Error("Invalid row split size.");return s}calculateOutputIndexValueRowID(e,n,r,o){const i=e.length,s=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];s.push(u);for(let c=1;c<i;++c){const f=e[c];if(f===l)u>=0&&(++a,a<o?u+=r:u=-1);else{if(a=0,l=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);u=n[f]}s.push(u)}if(s.length!==e.length)throw new Error("Invalid row ids.");return s}calculateOutputIndex(e,n,r,o){const i=this.getRowPartitionTensor(e),s=this.getRowPartitionTypeByDimension(e);switch(s){case Kr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,r,o);case Kr.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,r,o);default:throw new Error(`Unsupported partition type: ${Kr[s]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Kr.FIRST_DIM_SIZE:return e[0];case Kr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Kr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Kr[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),o=new Array(this.raggedRank+1);o[o.length-1]=1;for(let l=o.length-2;l>=0;--l)o[l]=o[l+1]*r[l+1];const i=UE(r,!1),s=Bt(this.valuesDType,Q(i));if(o[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,o[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,o[u],r[u]);this.setOutput(this.raggedRank,l,s,i)}return[i,s]}setOutput(e,n,r,o){if(r.length===0)return;const i=this.values,s=r;let a=o.slice();a=a.slice(e+1);const l=Q(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;K(()=>{const m=V(c,p);c=Df(m,a).dataSync()})}let f=0,h=0,d=0;for(let p=0;p<=u;++p){let m=p<u?n[p]:-1;if(m===d){++d;continue}if(h<d){const g=i.subarray(f*l),y=s.subarray(h*l),v=(d-h)*l;VE(y,g,v)}if(p>=u){const g=r.length;m=Math.floor(g/l)}if(m>d)if(this.defaultValue.length===1)s.subarray(d*l,m*l).fill(this.defaultValue[0]),d=m;else for(;m>d;){const g=s.slice(d*l);VE(g,c,l),++d}m<0?(f=p+1,h=d):(f=p,h=d,d=h+1)}}}function VE(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function UE(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function LB(t,e,n,r,o,i,s,a,l,u){return new Ag(t,e,n,r,o,i,s,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BB(t,e,n,r){const o=t===e,i=t<e&&n<0,s=e<t&&n>1;if(o||i||s)return _n(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=_n(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zB=Ci(t=>1/Math.sqrt(t)),XZ=aa(Fd,zB),YZ={kernelName:Fd,backendName:"cpu",kernelFunc:XZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _a(t,e,n,r,o,i,s,a,l,u){const c=[r/o,o],f=t.values,h=e.values;if(r===0)return Me(n,e.dtype);const d=l instanceof wn?l:Me(c,e.dtype);typeof l=="string"||typeof l=="number"?d.values.fill(l):typeof l=="boolean"&&d.values.fill(+l);for(let p=0;p<i;p++){const m=[];let g=0;for(let y=0;y<s;y++){const v=f[p*s+y];m.push(v),g+=v*a[y]}if(g<0||g>=r/o)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let y=0;y<o;y++)u?d.values[g*o+y]+=h[p*o+y]:d.values[g*o+y]=e.rank===0?h[0]:h[p*o+y]}return d}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QZ=Ci(t=>1/(1+Math.exp(-t))),jB=it(Wd,t=>1/(1+Math.exp(-t))),ZZ={kernelName:Wd,backendName:"cpu",kernelFunc:jB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WB(t,e,n,r,o){const i=ck(r,e,n),s=Q(n),a=ke(r);if(i){const f=fk(e,a);return o==="string"?t.slice(f,f+s):t.subarray(f,f+s)}const l=o==="string"?Qi(t):t,u=Me(r,o,l),c=Me(n,o);for(let f=0;f<c.size;++f){const h=c.indexToLoc(f),d=h.map((p,m)=>p+e[m]);c.set(u.get(...d),...h)}return o==="string"?HF(c.values):c.values}function al(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{begin:i,size:s}=r;we(o,"slice");const[a,l]=s0(o,i,s);lk(o,a,l);const u=n.data.get(o.dataId).values,c=WB(u,a,l,o.shape,o.dtype);return n.makeTensorInfo(l,o.dtype,c)}const JZ={kernelName:Gv,backendName:"cpu",kernelFunc:al};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VB(t,e,n,r,o,i,s){const a=e[0],l=i[0],u=new Array(l),c=new Array(a),f=e[1];if(l===0){if(a!==0)throw new Error(DF(a));const g=Bt(n,0),y=Bt(o,0);return[g,[0,f],y,u,c]}let h=!0,d=0;const p=new Array(l).fill(0);for(let g=0;g<a;++g){const y=t[g*f];if(y<0)throw new Error(RF(g,y));if(y>=l)throw new Error(PF(g,y,l));++p[y],h=h&&y>=d,d=y}let m=!0;for(let g=0;g<l;++g){const y=p[g]===0;u[g]=y,m=m&&!y,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&h){const g=t,y=r;for(let v=0;v<a;++v)c[v]=v;return[g,[a,f],y,u,c]}else{const g=p[l-1],y=Bt(n,g*f),v=Bt(o,g),x=new Array(l).fill(0);for(let b=0;b<a;++b){const w=t[b*f],S=x[w],$=(w===0?0:p[w-1])+S;x[w]++;for(let C=0;C<f;++C)y[$*f+C]=t[b*f+C];v[$]=r[b],c[b]=$}for(let b=0;b<l;++b)if(x[b]===0){const S=b===0?0:p[b-1];y[S*f+0]=b;for(let $=1;$<f;++$)y[S*f+$]=0;v[S]=s}return[y,[g,f],v,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(t,e,n,r,o){const i=Q(r),s=e[0],a=o.length,l=[];let u=1,c=-1;for(let g=0;g<a;++g){const y=o[g];if(y===-1){if(c!==-1)throw new Error(MF(c,g));c=g,l.push(1)}else{if(y<0)throw new Error(FF(g,y));u*=y,l.push(y)}}if(c!==-1){if(u<=0)throw new Error(LF());const g=Math.trunc(i/u);if(u*g!==i)throw new Error(BF(r,l));l[c]=g}if(Q(l)!==i)throw new Error(zF(r,l));const h=r.length,d=[];if(h>0){d[h-1]=1;for(let g=h-2;g>=0;--g)d[g]=d[g+1]*r[g+1]}const p=[];if(a>0){p[a-1]=1;for(let g=a-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const m=Bt(n,s*a);for(let g=0;g<s;++g){let y=0;for(let v=0;v<h;++v)y+=t[g*h+v]*d[v];for(let v=0;v<a;++v)m[g*a+v]=Math.trunc(y/p[v]),y%=p[v]}return[m,[s,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sI(t,e,n,r,o,i=!1,s=0){const a=r.length,l=[e[0],t.length/e[0]],u=l[1],f=a>0?o[a-1]+1:0;if(f<0)throw new Error(H1());const h=e.slice();h[0]=f;const d=h.reduce((x,b)=>x*b,1),p=Bt(n,d);if(a===0)return f>0&&p.fill(s),[p,h];if(f<=0)throw new Error(H1());let m=0,g=1,y=0,v=o[m];for(;;){let x=0;if(g<a){if(x=o[g],v===x){++g;continue}if(v>=x)throw new Error(jF())}if(v<0||v>=f)throw new Error(WF(v,f));v>y&&p.fill(s,y*u,v*u);for(let b=m;b<g;++b){const w=r[b];if(w<0||w>=l[0])throw new Error(VF(b,r[b],l[0]));for(let S=0;S<u;S++)p[v*u+S]+=t[w*u+S]}if(i)for(let b=0;b<u;b++)p[v*u+b]/=g-m;if(m=g,++g,y=v+1,v=x,g>a)break}return y<f&&p.fill(s,y*u,f*u),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eJ=Ci(t=>Math.sqrt(t)),tJ=it(Ud,t=>Math.sqrt(t)),nJ={kernelName:Ud,backendName:"cpu",kernelFunc:tJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GB=Ut((t,e)=>{const n=t-e;return n*n}),rJ=sn(Gd,GB),oJ={kernelName:Gd,backendName:"cpu",kernelFunc:rJ};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HB=Ci((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:o}=e;return t.replace(new RegExp(n,r?"g":""),o)}),iJ=aa(gC,HB),sJ={kernelName:gC,backendName:"cpu",kernelFunc:iJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KB(t,e,n,r){const o=Me(t,e.dtype);for(let i=0;i<o.size;i++){const s=o.indexToLoc(i),a=new Array(s.length);for(let l=0;l<a.length;l++)a[l]=s[l]*n[l]+r[l];o.set(e.get(...a),...s)}return o}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aJ{constructor(e,n,r,o,i,s){this.separator=Fs(e),this.nGramWidths=n,this.leftPad=Fs(r),this.rightPad=Fs(o),this.padWidth=i,this.preserveShort=s}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,o,i,s){for(let a=0;a<i;++a){const l=this.getPadWidth(s),u=Math.max(0,l-a),c=Math.max(0,l-(i-(a+1))),f=s-(u+c),h=n+(u>0?0:a-l);let d=0;d+=u*this.leftPad.length;for(let v=0;v<f;++v)d+=e[h+v].length;d+=c*this.rightPad.length;const p=u+c+f-1;d+=p*this.separator.length,r[o+a]=new Uint8Array(d);const m=r[o+a];let g=0;const y=v=>v.forEach(x=>m[g++]=x);for(let v=0;v<u;++v)y(this.leftPad),y(this.separator);for(let v=0;v<f-1;++v)y(e[h+v]),y(this.separator);if(f>0){y(e[h+f-1]);for(let v=0;v<c;++v)y(this.separator),y(this.rightPad)}else{for(let v=0;v<c-1;++v)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,n){const r=e.length,o=n.length;if(o>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<o;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=o-1,s=Bt("int32",o);if(r===0||o===0){const l=new Array(r);for(let u=0;u<=i;++u)s[u]=0;return[l,s]}s[0]=0;for(let l=1;l<=i;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(f=>{c+=this.getNumNGrams(u,f)}),this.preserveShort&&u>0&&c===0&&(c=1),s[l]=s[l-1]+c}const a=new Array(s[i]);for(let l=0;l<i;++l){const u=n[l];let c=s[l];if(this.nGramWidths.forEach(f=>{const h=n[l+1]-n[l],d=this.getNumNGrams(h,f);this.createNGrams(e,u,a,c,d,f),c+=d}),this.preserveShort&&c===s[l]){const f=n[l+1]-n[l];if(f===0)continue;const h=f+2*this.padWidth;this.createNGrams(e,u,a,c,1,h)}}return[a,s]}}function qB(t,e,n,r,o,i,s,a){return new aJ(n,r,o,i,s,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lJ(t,e,n,r){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)r.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let s=t.indexOf(i);for(;s!==-1;){const a=t.subarray(0,s);(!n||a.length!==0)&&r.push(a),t=t.subarray(s+1),s=t.indexOf(i)}(!n||t.length!==0)&&r.push(t);return}let o=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const s=t.subarray(o,i);(!n||s.length!==0)&&r.push(s),o=i+1}}function XB(t,e,n){const r=t.length,o=[];let i=0,s=0;const a=new Array(r);for(let h=0;h<r;++h){const d=o.length;lJ(t[h],e,n,o);const p=o.length-d;a[h]=p,i+=p,s=Math.max(s,p)}const l=Bt("int32",i*2),u=new Array(i),c=[r,s];let f=0;for(let h=0;h<r;++h)for(let d=0;d<a[h];++d)l[f*2]=h,l[f*2+1]=d,u[f]=o[f],++f;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(t,e){const n=Bt("int32",t.length);for(let r=0;r<t.length;++r)n[r]=jH(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QB=Ut((t,e)=>t-e),uJ=nI((t,e,n,r)=>({real:t-n,imag:e-r})),aI=sn(Hd,QB,uJ),cJ={kernelName:Hd,backendName:"cpu",kernelFunc:aI};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(t,e){const n=new Array(t.rank);for(let o=0;o<n.length;o++)n[o]=t.shape[o]*e[o];const r=Me(n,t.dtype);for(let o=0;o<r.values.length;++o){const i=r.indexToLoc(o),s=new Array(t.rank);for(let l=0;l<s.length;l++)s[l]=i[l]%t.shape[l];const a=t.locToIndex(s);r.values[o]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bf=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function JB(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*c/a+f)),d=Math.min(r,Math.floor(e+(a-l)*c/a+f));JB(t,e,h,d)}const o=t[e];let i=n,s=r;for(Wl(t,n,e),bf(t[r],o)>0&&Wl(t,n,r);i<s;){for(Wl(t,i,s),i++,s--;bf(t[i],o)<0;)i=i+1;for(;bf(t[s],o)>0;)s=s-1}bf(t[n],o)===0?Wl(t,n,s):(s=s+1,Wl(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}}function ez(t,e,n,r,o){const i=e[e.length-1],[s,a]=[t.length/i,i],l=On(n,s*r),u=On("int32",s*r);for(let f=0;f<s;f++){const h=f*a,d=t.subarray(h,h+a);let p=new Array(d.length);d.forEach((v,x)=>p[x]={value:v,index:x}),r<p.length&&(JB(p,r),p=p.slice(0,r)),o&&p.sort(bf);const m=f*r,g=l.subarray(m,m+r),y=u.subarray(m,m+r);for(let v=0;v<r;v++)g[v]=p[v].value,y[v]=p[v].index}const c=e.slice();return c[c.length-1]=r,[Me(c,n,l),Me(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(t,e,n,r){const o=Fe(e,n)[0],i=[1,n[0],1];for(let p=0;p<o;p++)i[0]*=n[p];i[1]=n[o];for(let p=o+1;p<n.length;p++)i[2]*=n[p];const s=new Map,a=new Int32Array(n[o]),l=new wn(i,r,t),u=[],c=i[0]===1&&i[2]===1;for(let p=0;p<n[o];p++){let m;if(c)m=t[p].toString();else{const y=[];for(let v=0;v<i[0];v++)for(let x=0;x<i[2];x++)y.push(l.get(v,p,x));m=y.join(",")}const g=s.get(m);if(g!=null)a[p]=g;else{const y=s.size;s.set(m,y),a[p]=y,u.push(p)}}const f=i.slice();f[1]=s.size;const h=new wn(f,r);u.forEach((p,m)=>{for(let g=0;g<i[0];g++)for(let y=0;y<i[2];y++)h.set(l.get(g,p,y),g,m,y)});const d=n.slice();return d[o]=f[1],{outputValues:h.values,outputShape:d,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fJ=Object.freeze(Object.defineProperty({__proto__:null,addImpl:cB,bincountImpl:rI,bincountReduceImpl:fB,bitwiseAndImpl:hB,castImpl:uB,ceilImpl:dB,concatImpl:pB,equalImpl:mB,expImpl:yB,expm1Impl:xB,floorDivImpl:wB,floorImpl:bB,gatherNdImpl:SB,gatherV2Impl:$B,greaterEqualImpl:kB,greaterImpl:CB,lessEqualImpl:TB,lessImpl:IB,linSpaceImpl:EB,logImpl:NB,maxImpl:AB,maximumImpl:OB,minimumImpl:_B,multiplyImpl:oI,negImpl:DB,notEqualImpl:RB,prodImpl:PB,raggedGatherImpl:MB,raggedRangeImpl:FB,raggedTensorToTensorImpl:LB,rangeImpl:BB,rsqrtImpl:zB,scatterImpl:_a,sigmoidImpl:QZ,simpleAbsImpl:lB,sliceImpl:WB,sparseFillEmptyRowsImpl:VB,sparseReshapeImpl:UB,sparseSegmentReductionImpl:sI,sqrtImpl:eJ,squaredDifferenceImpl:GB,staticRegexReplaceImpl:HB,stridedSliceImpl:KB,stringNGramsImpl:qB,stringSplitImpl:XB,stringToHashBucketFastImpl:YB,subImpl:QB,tileImpl:ZB,topKImpl:ez,transposeImpl:iI,uniqueImpl:tz},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */wM("cpu",()=>new b0,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nz=it(md,t=>t>=0?t:Math.exp(t)-1),hJ={kernelName:md,backendName:"cpu",kernelFunc:nz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{alpha:i}=r;we([o],"leakyRelu");const s=Q(o.shape),a=n.data.get(o.dataId).values,l=On("float32",s);for(let u=0;u<a.length;u++)l[u]=a[u]<0?i*a[u]:a[u];return n.makeTensorInfo(o.shape,"float32",l)}const dJ={kernelName:xv,backendName:"cpu",kernelFunc:rz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pJ=Ut((t,e)=>t<0?e*t:t);function oz(t){const{inputs:e,backend:n}=t,{x:r,alpha:o}=e;we([r,o],"prelu");const i=n.data.get(r.dataId).values,s=n.data.get(o.dataId).values,[a,l]=pJ(r.shape,o.shape,i,s,"float32");return n.makeTensorInfo(l,"float32",a)}const mJ={kernelName:Lv,backendName:"cpu",kernelFunc:oz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iz=it(Rd,t=>Math.max(0,t)),gJ={kernelName:Rd,backendName:"cpu",kernelFunc:iz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sz=it(Pd,t=>Math.min(Math.max(0,t),6)),yJ={kernelName:Pd,backendName:"cpu",kernelFunc:sz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Og(t,e,n,r,o){if(n==="linear")return Si({inputs:{x:e},backend:t});if(n==="relu")return iz({inputs:{x:e},backend:t});if(n==="elu")return nz({inputs:{x:e},backend:t});if(n==="relu6")return sz({inputs:{x:e},backend:t});if(n==="prelu")return oz({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return rz({inputs:{x:e},backend:t,attrs:{alpha:o}});if(n==="sigmoid")return jB({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mt(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{shape:i}=r,s=Q(o.shape),a=IP(i,s),l=Q(a);E(s===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${o.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),n.incRef(o.dataId);const u=n.data.get(o.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,f=u.complexTensorInfos.imag;c.shape=a,f.shape=a}return{dataId:o.dataId,shape:a,dtype:o.dtype}}const vJ={kernelName:zv,backendName:"cpu",kernelFunc:mt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function az(t){const{inputs:e,backend:n,attrs:r}=t,{a:o,b:i}=e,{transposeA:s,transposeB:a}=r;we([o,i],"matMul");const l=o.shape.length,u=i.shape.length,c=s?o.shape[l-2]:o.shape[l-1],f=a?i.shape[u-1]:i.shape[u-2],h=s?o.shape[l-1]:o.shape[l-2],d=a?i.shape[u-2]:i.shape[u-1],p=o.shape.slice(0,-2),m=i.shape.slice(0,-2),g=Q(p),y=Q(m),x=Re(o.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,d]);E(c===f,()=>`Error in matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${o.shape} and ${i.shape} and transposeA=${s} and transposeB=${a} must match.`);const b=s?[g,c,h]:[g,h,c],w=a?[y,d,f]:[y,f,d],S=mt({inputs:{x:o},backend:n,attrs:{shape:b}}),$=mt({inputs:{x:i},backend:n,attrs:{shape:w}}),C=s?S.shape[1]:S.shape[2],k=s?S.shape[2]:S.shape[1],I=a?$.shape[1]:$.shape[2],T=Math.max(g,y),N=n.data.get(S.dataId).values,_=n.data.get($.dataId).values,D=ke(S.shape),O=ke($.shape),[R,F,A]=s?[D[0],1,D[1]]:[D[0],D[1],1],[P,z,U]=a?[1,O[1],O[0]]:[O[1],1,O[0]],H=k*I,X=Me([T,k,I],S.dtype),ne=X.values,re=n.blockSize;for(let le=0;le<T;le++){const ye=le%g,ve=le%y;for(let J=0;J<k;J+=re){const ce=Math.min(J+re,k);for(let fe=0;fe<I;fe+=re){const Z=Math.min(fe+re,I);for(let Ne=0;Ne<C;Ne+=re){const $e=Math.min(Ne+re,C);for(let Oe=J;Oe<ce;Oe++)for(let te=fe;te<Z;te++){let Ce=0;for(let Ee=Ne;Ee<$e;Ee++){const qe=N[ye*R+Oe*F+Ee*A],Xe=_[Ee*P+te*z+ve*U];Ce+=qe*Xe}ne[le*H+(Oe*I+te)]+=Ce}}}}}return n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo($),n.makeTensorInfo(x,X.dtype,X.values)}const xJ={kernelName:ov,backendName:"cpu",kernelFunc:az};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bJ(t){const{inputs:e,backend:n,attrs:r}=t,{a:o,b:i,bias:s,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:f}=r;let h,d,p;const m=[];h=az({inputs:{a:o,b:i},attrs:{transposeA:l,transposeB:u},backend:n}),s&&(d=Lu({inputs:{a:h,b:s},backend:n}),m.push(h),h=d),c&&(p=Og(n,h,c,a,f),m.push(h),h=p);for(const y of m)n.disposeIntermediateTensorInfo(y);return h}const wJ={kernelName:cg,backendName:"cpu",kernelFunc:bJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SJ=it(nd,t=>Math.acos(t)),$J={kernelName:nd,backendName:"cpu",kernelFunc:SJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CJ=it(rd,t=>Math.acosh(t)),kJ={kernelName:rd,backendName:"cpu",kernelFunc:CJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(t){const{inputs:e,backend:n}=t,r=e;we(e,"addN");const o=r.map(a=>n.data.get(a.dataId).values),i=Me(r[0].shape,r[0].dtype),s=i.values;for(let a=0;a<r.length;a++){const l=o[a];for(let u=0;u<s.length;u++)s[u]+=l[u]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const TJ={kernelName:P$,backendName:"cpu",kernelFunc:IJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EJ(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r;we(o,"all");const a=Fe(i,o.shape);let l=a;const u=Ot(l,o.shape.length);let c=o;u!=null&&(c=ur({inputs:{x:o},backend:n,attrs:{perm:u}}),l=Wt(l.length,o.shape.length)),$n("all",l,c.shape.length);const[f,h]=mn(c.shape,l),d=Q(h),p=_n(Q(f),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<p.length;++y){const v=y*d;let x=m[v];for(let b=0;b<d;++b){const w=m[v+b];x=x&&w}p[y]=x}u!=null&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(f,c.dtype,p);if(s){const y=qt(f,a),v=mt({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),v}return g}const NJ={kernelName:M$,backendName:"cpu",kernelFunc:EJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AJ(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r;we(o,"any");const a=Fe(i,o.shape);let l=a;const u=Ot(l,o.shape.length);let c=o;u!=null&&(c=ur({inputs:{x:o},backend:n,attrs:{perm:u}}),l=Wt(l.length,o.shape.length)),$n("any",l,c.shape.length);const[f,h]=mn(c.shape,l),d=Q(h),p=_n(Q(f),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<p.length;++y){const v=y*d;let x=m[v];for(let b=0;b<d;++b){const w=m[v+b];x=x||w}p[y]=x}u!=null&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(f,c.dtype,p);if(s){const y=qt(f,a),v=mt({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),v}return g}const OJ={kernelName:F$,backendName:"cpu",kernelFunc:AJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _J(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i}=r;we(o,"argMax");let s=Fe(i,o.shape);const a=Ot(s,o.shape.length);let l=o;const u=[];a!=null&&(l=ur({inputs:{x:o},backend:n,attrs:{perm:a}}),u.push(l),s=Wt(s.length,l.shape.length)),s=[s[0]],$n("argMax",s,l.shape.length);const[c,f]=mn(l.shape,s),h=Q(c),d=_n(h,"int32"),p=Q(f),m=n.data.get(l.dataId).values;for(let g=0;g<d.length;++g){const y=g*p;let v=m[y],x=0;for(let b=0;b<p;++b){const w=m[y+b];w>v&&(v=w,x=b)}d[g]=x}return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(c,"int32",d)}const DJ={kernelName:ev,backendName:"cpu",kernelFunc:_J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RJ(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i}=r;we(o,"argMin");let s=Fe(i,o.shape);const a=Ot(s,o.shape.length);let l=o;const u=[];a!=null&&(l=ur({inputs:{x:o},backend:n,attrs:{perm:a}}),u.push(l),s=Wt(s.length,l.shape.length)),s=[s[0]],$n("argMin",s,l.shape.length);const[c,f]=mn(l.shape,s),h=Q(c),d=_n(h,"int32"),p=Q(f),m=n.data.get(l.dataId).values;for(let g=0;g<d.length;++g){const y=g*p;let v=m[y],x=0;for(let b=0;b<p;++b){const w=m[y+b];w<v&&(v=w,x=b)}d[g]=x}return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(c,"int32",d)}const PJ={kernelName:tv,backendName:"cpu",kernelFunc:RJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MJ=it(od,t=>Math.asin(t)),FJ={kernelName:od,backendName:"cpu",kernelFunc:MJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LJ=it(id,t=>Math.asinh(t)),BJ={kernelName:id,backendName:"cpu",kernelFunc:LJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zJ=it(sd,t=>Math.atan(t)),jJ={kernelName:sd,backendName:"cpu",kernelFunc:zJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WJ=Ut((t,e)=>Math.atan2(t,e)),VJ=sn(ld,WJ),UJ={kernelName:ld,backendName:"cpu",kernelFunc:VJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GJ=it(ad,t=>Math.atanh(t)),HJ={kernelName:ad,backendName:"cpu",kernelFunc:GJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lI(t,e,n,r,o,i){const s=o.strideHeight,a=o.strideWidth,l=o.dilationHeight,u=o.dilationWidth,c=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=o.padInfo.top,d=o.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Me(o.outShape,n),g=m.values,y=o.outShape[1]*o.outShape[2]*o.outShape[3],v=o.outShape[2]*o.outShape[3],x=o.outShape[3];for(let b=0;b<o.batchSize;++b){const w=b*y,S=b*r[0];for(let $=0;$<o.inChannels;++$)for(let C=0;C<o.outHeight;++C){const k=C*s-h,I=Math.max(0,k),T=Math.min(o.inHeight,c+k),N=w+C*v;for(let _=0;_<o.outWidth;++_){const D=_*a-d,O=Math.max(0,D),R=Math.min(o.inWidth,f+D);let F=p,A=0,P=0;for(let U=I;U<T;U+=l){const H=S+U*r[1];for(let X=O;X<R;X+=u){const ne=H+X*r[2],re=t[ne+$];i==="max"&&re>F?F=re:i==="avg"&&(A+=re,P++)}if(isNaN(F))break}const z=N+_*x+$;g[z]=i==="avg"?A/P:F}}}return m}function lz(t,e,n,r,o=!1,i=!1){const s=Me(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,m=Me(e,n,t);for(let g=0;g<r.batchSize;++g)for(let y=0;y<r.inChannels;++y)for(let v=0;v<r.outHeight;++v){const x=v*a-d;let b=x;for(;b<0;)b+=u;const w=Math.min(r.inHeight,f+x);for(let S=0;S<r.outWidth;++S){const $=S*l-p;let C=$;for(;C<0;)C+=c;const k=Math.min(r.inWidth,h+$);let I=Number.NEGATIVE_INFINITY,T=-1;for(let N=b;N<w;N+=u){const _=N-x;for(let D=C;D<k;D+=c){const O=D-$,R=m.get(g,N,D,y);R>I&&(I=R,o?T=i?((g*r.inHeight+N)*r.inWidth+D)*r.inChannels+y:(N*r.inWidth+D)*r.inChannels+y:T=_*h+O)}}s.set(T,g,v,S,y)}}return s}function uz(t,e,n,r,o,i){const s=o.strideDepth,a=o.strideHeight,l=o.strideWidth,u=o.dilationDepth,c=o.dilationHeight,f=o.dilationWidth,h=o.effectiveFilterDepth,d=o.effectiveFilterHeight,p=o.effectiveFilterWidth,m=o.padInfo.front,g=o.padInfo.top,y=o.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=Me(o.outShape,n),b=x.values,w=o.outShape[1]*o.outShape[2]*o.outShape[3]*o.outShape[4],S=o.outShape[2]*o.outShape[3]*o.outShape[4],$=o.outShape[3]*o.outShape[4],C=o.outShape[4];for(let k=0;k<o.batchSize;++k){const I=k*w,T=k*r[0];for(let N=0;N<o.inChannels;++N)for(let _=0;_<o.outDepth;++_){const D=_*s-m;let O=D;for(;O<0;)O+=u;const R=Math.min(o.inDepth,h+D),F=I+_*S;for(let A=0;A<o.outHeight;++A){const P=A*a-g;let z=P;for(;z<0;)z+=c;const U=Math.min(o.inHeight,d+P),H=F+A*$;for(let X=0;X<o.outWidth;++X){const ne=X*l-y;let re=ne;for(;re<0;)re+=f;const le=Math.min(o.inWidth,p+ne),ye=H+X*C;let ve=v,J=0,ce=0;for(let Z=O;Z<R;Z+=u){const Ne=T+Z*r[1];for(let $e=z;$e<U;$e+=c){const Oe=Ne+$e*r[2];for(let te=re;te<le;te+=f){const Ce=Oe+te*r[3],Ee=t[Ce+N];if(i==="max"&&Ee>ve?ve=Ee:i==="avg"&&(J+=Ee,ce++),isNaN(ve))break}if(isNaN(ve))break}if(isNaN(ve))break}const fe=ye+N;b[fe]=i==="avg"?J/Math.max(ce,1):ve}}}}return x}function KJ(t,e){const n=Me(e.outShape,"int32"),r=e.strideDepth,o=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.front,d=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let y=0;y<e.outDepth;++y){const v=y*r-h;let x=v;for(;x<0;)x+=s;const b=Math.min(e.inDepth,u+v);for(let w=0;w<e.outHeight;++w){const S=w*o-d;let $=S;for(;$<0;)$+=a;const C=Math.min(e.inHeight,c+S);for(let k=0;k<e.outWidth;++k){const I=k*i-p;let T=I;for(;T<0;)T+=l;const N=Math.min(e.inWidth,f+I);let _=Number.NEGATIVE_INFINITY,D=-1;for(let O=x;O<b;O+=s){const R=O-v;for(let F=$;F<C;F+=a){const A=F-S;for(let P=T;P<N;P+=l){const z=P-I,U=t.get(m,O,F,P,g);U>=_&&(_=U,D=R*c*f+A*c+z)}}}n.set(D,m,y,w,k,g)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qJ(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e;we(o,"avgPool");const{filterSize:i,strides:s,pad:a,dimRoundingMode:l}=r,u=1;E(Rn(s,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=vo(o.shape,i,s,u,a,l);let f;if(c.filterWidth===1&&c.filterHeight===1&&et(c.inShape,c.outShape))f=Si({inputs:{x:o},backend:n});else{const h=n.data.get(o.dataId).values,d=ke(o.shape),p=lI(h,o.shape,o.dtype,d,c,"avg");f=n.makeTensorInfo(c.outShape,o.dtype,p.values)}return f}const XJ={kernelName:nv,backendName:"cpu",kernelFunc:qJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YJ(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{filterSize:i,strides:s,pad:a,dimRoundingMode:l,dataFormat:u}=r;we(o,"avgPool3d");const c=os(o.shape,i,s,1,a,l,u),f=n.data.get(o.dataId).values,h=uz(f,o.shape,o.dtype,ke(o.shape),c,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const QJ={kernelName:rv,backendName:"cpu",kernelFunc:YJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:i}=e,{filterSize:s,strides:a,pad:l,dimRoundingMode:u}=r;we([o,i],"avgPool3DGrad");const c=os(i.shape,s,a,1,l,u),f=c.strideDepth,h=c.strideHeight,d=c.strideWidth,p=c.filterDepth,m=c.filterHeight,g=c.filterWidth,y=c.dilationDepth,v=c.dilationHeight,x=c.dilationWidth,b=c.effectiveFilterDepth,w=c.effectiveFilterHeight,S=c.effectiveFilterWidth,$=b-1-c.padInfo.front,C=S-1-c.padInfo.left,k=w-1-c.padInfo.top,I=Me(i.shape,"float32"),T=1/(p*m*g),N=n.bufferSync(o);for(let _=0;_<c.batchSize;++_)for(let D=0;D<c.inChannels;++D)for(let O=0;O<c.inDepth;++O)for(let R=0;R<c.inHeight;++R)for(let F=0;F<c.inWidth;++F){const A=O-$,P=R-k,z=F-C;let U=0;for(let H=0;H<b;H+=y){const X=(A+H)/f;if(!(X<0||X>=c.outDepth||Math.floor(X)!==X))for(let ne=0;ne<w;ne+=v){const re=(P+ne)/h;if(!(re<0||re>=c.outHeight||Math.floor(re)!==re))for(let le=0;le<S;le+=x){const ye=(z+le)/d;if(ye<0||ye>=c.outWidth||Math.floor(ye)!==ye)continue;const ve=N.get(_,X,re,ye,D);U+=ve}}}I.set(U*T,_,O,R,F,D)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const JJ={kernelName:B$,backendName:"cpu",kernelFunc:ZJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eee(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:i}=e,s=i;we([o,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=vo(s.shape,a,l,1,u),f=c.strideHeight,h=c.strideWidth,d=c.filterHeight,p=c.filterWidth,m=c.dilationHeight,g=c.dilationWidth,y=c.effectiveFilterHeight,v=c.effectiveFilterWidth,x=v-1-c.padInfo.left,b=y-1-c.padInfo.top,w=Me(s.shape,"float32"),S=1/(d*p),$=n.data.get(o.dataId).values,C=Me(o.shape,"float32",$);for(let k=0;k<c.batchSize;++k)for(let I=0;I<c.inChannels;++I)for(let T=0;T<c.inHeight;++T)for(let N=0;N<c.inWidth;++N){const _=T-b,D=N-x;let O=0;for(let R=0;R<y;R+=m){const F=(_+R)/f;if(!(F<0||F>=c.outHeight||Math.floor(F)!==F))for(let A=0;A<v;A+=g){const P=(D+A)/h;if(P<0||P>=c.outWidth||Math.floor(P)!==P)continue;const z=C.get(k,F,P,I);O+=z}}w.set(O*S,k,T,N,I)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const tee={kernelName:L$,backendName:"cpu",kernelFunc:eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,scale:i,offset:s,mean:a,variance:l}=e;E(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),E(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),E(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),we([o,a,l,i,s],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=n.data.get(o.dataId).values,f=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,d=i?n.data.get(i.dataId).values:new Float32Array([1]),p=s?n.data.get(s.dataId).values:new Float32Array([0]),m=new Float32Array(c.length),g=p.length,y=d.length,v=h.length,x=f.length;let b=0,w=0,S=0,$=0;for(let C=0;C<c.length;++C)m[C]=p[b++]+(c[C]-f[w++])*d[S++]/Math.sqrt(h[$++]+u),b>=g&&(b=0),w>=x&&(w=0),S>=y&&(S=0),$>=v&&($=0);return n.makeTensorInfo(o.shape,o.dtype,m)}const ree={kernelName:gv,backendName:"cpu",kernelFunc:nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockShape:i,crops:s}=r;we([o],"batchToSpaceND");const a=i.reduce((y,v)=>y*v),l=op(o.shape,i,a),u=ip(l.length,i.length),c=sp(o.shape,i,a),f=gk(s,i.length),h=yk(c,s,i.length),d=mt({inputs:{x:o},backend:n,attrs:{shape:l}}),p=ur({inputs:{x:d},backend:n,attrs:{perm:u}}),m=mt({inputs:{x:p},backend:n,attrs:{shape:c}}),g=al({inputs:{x:m},backend:n,attrs:{begin:f,size:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const iee={kernelName:iv,backendName:"cpu",kernelFunc:oee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function see(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,weights:i}=e,{size:s}=r,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values,u=rI(a,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}const aee={kernelName:z$,backendName:"cpu",kernelFunc:see};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lee(t){const{inputs:e,backend:n}=t,{s0:r,s1:o}=e,i=n.data.get(r.dataId).values,s=n.data.get(o.dataId).values,a=Re(Array.from(i),Array.from(s));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const uee={kernelName:_P,backendName:"cpu",kernelFunc:lee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cee=it(fd,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),fee={kernelName:fd,backendName:"cpu",kernelFunc:cee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hee=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(Q(e.shape)),o=n.data.get(e.dataId),i=o.complexTensorInfos.real,s=o.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values;for(let u=0;u<a.length;u++){const c=a[u],f=l[u];r[u]=Math.hypot(c,f)}return n.makeOutput(r,e.shape,"float32")},dee={kernelName:sv,backendName:"cpu",kernelFunc:hee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bu(t){const{inputs:e,backend:n}=t,{input:r}=e,o=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(o.dataId).values;return n.makeTensorInfo(o.shape,o.dtype,i)}const pee={kernelName:oC,backendName:"cpu",kernelFunc:Bu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zu(t){const{inputs:e,backend:n,attrs:r}=t,{axis:o}=r,i=Fe(o,e[0].shape)[0],s=e.map(m=>m.shape);dk(s,i);let a=di(e.map(m=>m.shape),i);if(Q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>Q(m.shape)>0);if(l.length===1)return Si({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(b=>sl({inputs:{input:b},backend:n})),g=l.map(b=>Bu({inputs:{input:b},backend:n})),y=zu({inputs:m,backend:n,attrs:{axis:i}}),v=zu({inputs:g,backend:n,attrs:{axis:i}}),x=mr({inputs:{real:y,imag:v},backend:n});return m.forEach(b=>n.disposeIntermediateTensorInfo(b)),g.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),x}const u=l.map(m=>{const y=[-1,Q(m.shape.slice(i))];return mt({inputs:{x:m},backend:n,attrs:{shape:y}})}),c=u.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=di(u.map(m=>m.shape),1);const f=u[0].shape[0]===1,h=pB(c,a,e[0].dtype,f),d=di(l.map(m=>m.shape),i),p=n.makeTensorInfo(d,e[0].dtype,h);return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const mee={kernelName:av,backendName:"cpu",kernelFunc:zu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cz(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i}=e,{strides:s,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r;we([o,i],"conv2d");const f=is(l),h=Sn(o.shape,i.shape,s,u,a,c,!1,f),d=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.padInfo.left,v=h.padInfo.top,x=h.dataFormat==="channelsLast",b=new wn(h.outShape,o.dtype),w=ke(o.shape),S=ke(i.shape),$=w[0],C=x?w[1]:w[2],k=x?w[2]:1,I=x?1:w[1],T=b.strides[0],N=x?b.strides[1]:b.strides[2],_=x?b.strides[2]:1,D=x?1:b.strides[1],O=n.data.get(o.dataId).values,R=n.data.get(i.dataId).values,F=b.values;for(let A=0;A<h.batchSize;++A){const P=A*$,z=A*T;for(let U=0;U<h.outHeight;++U){const H=z+U*N,X=U*h.strideHeight-v;for(let ne=0;ne<d;++ne){const re=X+ne*m;if(re<0||re>=h.inHeight)continue;const le=ne*S[0],ye=P+re*C;for(let ve=0;ve<h.outWidth;++ve){const J=H+ve*_,ce=ve*h.strideWidth-y;for(let fe=0;fe<p;++fe){const Z=ce+fe*g;if(Z<0||Z>=h.inWidth)continue;const Ne=le+fe*S[1],$e=ye+Z*k;let Oe=Ne;for(let te=0;te<h.inChannels;++te){const Ce=O[$e+te*I];for(let Ee=0;Ee<h.outChannels;++Ee)F[J+Ee*D]+=Ce*R[Oe+Ee];Oe+=h.outChannels}}}}}}return n.makeTensorInfo(b.shape,b.dtype,F)}const gee={kernelName:lv,backendName:"cpu",kernelFunc:cz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:i}=e,{strides:s,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;we([o,i],"conv2dBackpropFilter");const f=is(l),h=Sn(o.shape,c,s,1,a,u,!1,f),{strideHeight:d,strideWidth:p,filterHeight:m,filterWidth:g}=h,y=h.dataFormat==="channelsLast",v=new wn(h.filterShape,"float32"),x=h.padInfo.left,b=h.padInfo.top,w=n.data.get(o.dataId).values,S=n.data.get(i.dataId).values,$=new wn(o.shape,o.dtype,w),C=new wn(i.shape,i.dtype,S);for(let k=0;k<m;++k){const I=Math.max(0,Math.ceil((b-k)/d)),T=Math.min(h.outHeight,(h.inHeight+b-k)/d);for(let N=0;N<g;++N){const _=Math.max(0,Math.ceil((x-N)/p)),D=Math.min(h.outWidth,(h.inWidth+x-N)/p);for(let O=0;O<h.inChannels;++O)for(let R=0;R<h.outChannels;++R){let F=0;for(let A=0;A<h.batchSize;++A)for(let P=I;P<T;++P){const z=k+P*d-b;for(let U=_;U<D;++U){const H=N+U*p-x;y?F+=$.get(A,z,H,O)*C.get(A,P,U,R):F+=$.get(A,O,z,H)*C.get(A,R,P,U)}}v.set(F,k,N,O,R)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const vee={kernelName:V$,backendName:"cpu",kernelFunc:yee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:i}=e,{inputShape:s,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r;we([o,i],"conv2dBackpropInput");const f=ke(i.shape),h=ke(o.shape);let d=is(u);const p=Sn(s,i.shape,a,1,l,c,!1,d),m=new wn(p.inShape,"float32"),g=m.values,y=n.data.get(o.dataId).values,v=n.data.get(i.dataId).values,[x,b,w]=f,{batchSize:S,filterHeight:$,filterWidth:C,inChannels:k,inHeight:I,inWidth:T,outChannels:N,outHeight:_,outWidth:D,strideHeight:O,strideWidth:R}=p;d=p.dataFormat;const F=$-1-p.padInfo.top,A=C-1-p.padInfo.left,P=d==="channelsLast",z=m.strides[0],U=P?m.strides[1]:m.strides[2],H=P?m.strides[2]:1,X=P?1:m.strides[1],ne=h[0],re=P?h[1]:h[2],le=P?h[2]:1,ye=P?1:h[1];for(let ve=0;ve<S;++ve)for(let J=0;J<k;++J)for(let ce=0;ce<I;++ce){const fe=ce-F,Z=Math.max(0,Math.ceil(fe/O)),Ne=Math.min(_,($+fe)/O);for(let $e=0;$e<T;++$e){const Oe=$e-A,te=Math.max(0,Math.ceil(Oe/R)),Ce=Math.min(D,(C+Oe)/R);let Ee=0;for(let Xe=Z;Xe<Ne;++Xe){const _t=Xe*O-fe;for(let nt=te;nt<Ce;++nt){const Xt=nt*R-Oe,gt=ne*ve+re*Xe+le*nt,Dt=x*($-1-_t)+b*(C-1-Xt)+w*J;for(let Er=0;Er<N;++Er){const an=y[gt+ye*Er],Fn=v[Dt+Er];Ee+=an*Fn}}}const qe=z*ve+U*ce+H*$e+X*J;g[qe]=Ee}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const bee={kernelName:uv,backendName:"cpu",kernelFunc:xee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i}=e,{strides:s,pad:a,dilations:l}=r;we([o,i],"conv3d");const u=ta(o.shape,i.shape,s,l,a),{filterDepth:c,filterHeight:f,filterWidth:h,dilationDepth:d,dilationHeight:p,dilationWidth:m,padInfo:g}=u,y=g.front,v=g.left,x=g.top,b=new wn(u.outShape,o.dtype),w=n.data.get(o.dataId).values,S=n.data.get(i.dataId).values,$=b.values,C=ke(o.shape),k=ke(i.shape);for(let I=0;I<u.batchSize;++I){const T=I*C[0],N=I*b.strides[0];for(let _=0;_<u.outDepth;++_){const D=N+_*b.strides[1],O=_*u.strideDepth-y;for(let R=0;R<c;++R){const F=O+R*d;if(F<0||F>=u.inDepth)continue;const A=R*k[0],P=T+F*C[1];for(let z=0;z<u.outHeight;++z){const U=D+z*b.strides[2],H=z*u.strideHeight-x;for(let X=0;X<f;++X){const ne=H+X*p;if(ne<0||ne>=u.inHeight)continue;const re=A+X*k[1],le=P+ne*C[2];for(let ye=0;ye<u.outWidth;++ye){const ve=U+ye*u.outChannels,J=ye*u.strideWidth-v;for(let ce=0;ce<h;++ce){const fe=J+ce*m;if(fe<0||fe>=u.inWidth)continue;const Z=re+ce*k[2],Ne=le+fe*u.inChannels;let $e=Z;for(let Oe=0;Oe<u.inChannels;++Oe){const te=w[Ne+Oe];for(let Ce=0;Ce<u.outChannels;++Ce)$[ve+Ce]+=te*S[$e+Ce];$e+=u.outChannels}}}}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const See={kernelName:cv,backendName:"cpu",kernelFunc:wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:i}=e,{strides:s,pad:a,filterShape:l}=r;we([o,i],"conv3dBackpropFilterV2");const u=ke(o.shape),c=ke(i.shape),f=ta(o.shape,l,s,1,a),h=f.strideDepth,d=f.strideHeight,p=f.strideWidth,m=f.filterDepth,g=f.filterHeight,y=f.filterWidth,v=new wn(f.filterShape,"float32"),x=v.values,[b,w,S,$]=v.strides,C=n.data.get(i.dataId).values,[k,I,T,N]=c,_=n.data.get(o.dataId).values,[D,O,R,F]=u,A=f.padInfo.front,P=f.padInfo.left,z=f.padInfo.top;for(let U=0;U<m;++U){const H=Math.max(0,Math.ceil((A-U)/h)),X=Math.min(f.outDepth,(f.inDepth+A-U)/h),ne=U*b;for(let re=0;re<g;++re){const le=Math.max(0,Math.ceil((z-re)/d)),ye=Math.min(f.outHeight,(f.inHeight+z-re)/d),ve=re*w+ne;for(let J=0;J<y;++J){const ce=Math.max(0,Math.ceil((P-J)/p)),fe=Math.min(f.outWidth,(f.inWidth+P-J)/p),Z=J*S+ve;for(let Ne=0;Ne<f.inChannels;++Ne){const $e=Ne*$+Z;for(let Oe=0;Oe<f.outChannels;++Oe){let te=0;for(let Ce=0;Ce<f.batchSize;++Ce){const Ee=Ce*D,qe=Ce*k;for(let Xe=H;Xe<X;++Xe){const nt=(U+Xe*h-A)*O+Ee,Xt=Xe*I+qe;for(let gt=le;gt<ye;++gt){const Er=(re+gt*d-z)*R+nt,an=gt*T+Xt;for(let Fn=ce;Fn<fe;++Fn){const pa=(J+Fn*p-P)*F+Er,Ol=Fn*N+an;te+=_[pa+Ne]*C[Ol+Oe]}}}}x[$e+Oe]=te}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const Cee={kernelName:U$,backendName:"cpu",kernelFunc:$ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kee(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:i}=e,{pad:s,strides:a,inputShape:l}=r;we([o],"conv3dBackpropInputV2");const u=ke(o.shape),c=ke(i.shape),f=ta(l,i.shape,a,1,s),h=new wn(f.inShape,"float32"),d=h.values,[p,m,g,y]=h.strides,v=n.data.get(o.dataId).values,[x,b,w,S]=u,$=n.data.get(i.dataId).values,[C,k,I,T]=c,{batchSize:N,filterDepth:_,filterHeight:D,filterWidth:O,inChannels:R,inDepth:F,inHeight:A,inWidth:P,outChannels:z,outDepth:U,outHeight:H,outWidth:X,strideDepth:ne,strideHeight:re,strideWidth:le}=f,ye=_-1-f.padInfo.front,ve=D-1-f.padInfo.top,J=O-1-f.padInfo.left;for(let ce=0;ce<N;++ce)for(let fe=0;fe<R;++fe)for(let Z=0;Z<F;++Z){const Ne=Z-ye,$e=Math.max(0,Math.ceil(Ne/ne)),Oe=Math.min(U,(_+Ne)/ne);for(let te=0;te<A;++te){const Ce=te-ve,Ee=Math.max(0,Math.ceil(Ce/re)),qe=Math.min(H,(D+Ce)/re);for(let Xe=0;Xe<P;++Xe){const _t=Xe-J,nt=Math.max(0,Math.ceil(_t/le)),Xt=Math.min(X,(O+_t)/le);let gt=0;for(let Dt=$e;Dt<Oe;++Dt){const Er=Dt*ne-Ne;for(let an=Ee;an<qe;++an){const Fn=an*re-Ce;for(let Zo=nt;Zo<Xt;++Zo){const pa=Zo*le-_t,Ol=x*ce+b*Dt+w*an+S*Zo,Ln=C*(_-1-Er)+k*(D-1-Fn)+I*(O-1-pa)+T*fe;for(let $o=0;$o<z;++$o){const _l=v[Ol+$o],Dl=$[Ln+$o];gt+=_l*Dl}}}}d[p*ce+m*Z+g*te+y*Xe+fe]=gt}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const Iee={kernelName:G$,backendName:"cpu",kernelFunc:kee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tee=it(hd,t=>Math.cos(t)),Eee={kernelName:hd,backendName:"cpu",kernelFunc:Tee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nee=it(dd,t=>Math.cosh(t)),Aee={kernelName:dd,backendName:"cpu",kernelFunc:Nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oee(t){const{inputs:e,backend:n,attrs:r}=t,{image:o,boxes:i,boxInd:s}=e,{cropSize:a,method:l,extrapolationValue:u}=r,[c,f,h,d]=o.shape,p=i.shape[0],[m,g]=a,y=Me([p,m,g,d],"float32"),v=n.data.get(i.dataId).values,x=n.data.get(s.dataId).values,b=n.data.get(o.dataId).values,w=ke(o.shape),S=ke(y.shape);for(let $=0;$<p;$++){const C=$*4,k=v[C],I=v[C+1],T=v[C+2],N=v[C+3],_=x[$];if(_>=c)continue;const D=m>1?(T-k)*(f-1)/(m-1):0,O=g>1?(N-I)*(h-1)/(g-1):0;for(let R=0;R<m;R++){const F=m>1?k*(f-1)+R*D:.5*(k+T)*(f-1);if(F<0||F>f-1){for(let A=0;A<g;A++)for(let P=0;P<d;P++){const z=P+A*S[2]+R*S[1]+$*S[0];y.values[z]=u}continue}if(l==="bilinear"){const A=Math.floor(F),P=Math.ceil(F),z=F-A;for(let U=0;U<g;U++){const H=g>1?I*(h-1)+U*O:.5*(I+N)*(h-1);if(H<0||H>h-1){for(let le=0;le<d;le++){const ye=le+U*S[2]+R*S[1]+$*S[0];y.values[ye]=u}continue}const X=Math.floor(H),ne=Math.ceil(H),re=H-X;for(let le=0;le<d;le++){let ye=le+X*w[2]+A*w[1]+_*w[0];const ve=b[ye];ye=le+ne*w[2]+A*w[1]+_*w[0];const J=b[ye];ye=le+X*w[2]+P*w[1]+_*w[0];const ce=b[ye];ye=le+ne*w[2]+P*w[1]+_*w[0];const fe=b[ye],Z=ve+(J-ve)*re,Ne=ce+(fe-ce)*re;ye=le+U*S[2]+R*S[1]+$*S[0],y.values[ye]=Z+(Ne-Z)*z}}}else for(let A=0;A<g;++A){const P=g>1?I*(h-1)+A*O:.5*(I+N)*(h-1);if(P<0||P>h-1){for(let H=0;H<d;H++){const X=H+A*S[2]+R*S[1]+$*S[0];y.values[X]=u}continue}const z=Math.round(P),U=Math.round(F);for(let H=0;H<d;H++){const X=H+z*w[2]+U*w[1]+_*w[0],ne=H+A*S[2]+R*S[1]+$*S[0];y.values[ne]=b[X]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const _ee={kernelName:K$,backendName:"cpu",kernelFunc:Oee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,exclusive:s,reverse:a}=r;we(o,"cumprod");const l=Ot([i],o.shape.length);let u=o;l!=null&&(u=ur({inputs:{x:o},backend:n,attrs:{perm:l}}));const c=Wt(1,o.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const f=$r(u.dtype,"int32"),h=_$(Q(u.shape),f),d=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],m=a?(y,v)=>y+p-v-1:(y,v)=>y+v;for(let y=0;y<d.length;y+=p)for(let v=0;v<p;v++){const x=m(y,v);if(v===0)h[x]=s?1:d[x];else{const b=m(y,v-1);h[x]=s?d[b]*h[b]:d[x]*h[b]}}const g=n.makeTensorInfo(u.shape,f,h);if(l!=null){const y=na(l),v=ur({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),v}return g}const Ree={kernelName:H$,backendName:"cpu",kernelFunc:Dee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,exclusive:s,reverse:a}=r;we(o,"cumsum");const l=Ot([i],o.shape.length);let u=o;l!=null&&(u=ur({inputs:{x:o},backend:n,attrs:{perm:l}}));const c=Wt(1,o.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const f=$r(u.dtype,"int32"),h=_n(Q(u.shape),f),d=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],m=a?(y,v)=>y+p-v-1:(y,v)=>y+v;for(let y=0;y<d.length;y+=p)for(let v=0;v<p;v++){const x=m(y,v);if(v===0)h[x]=s?0:d[x];else{const b=m(y,v-1);h[x]=s?d[b]+h[b]:d[x]+h[b]}}const g=n.makeTensorInfo(u.shape,f,h);if(l!=null){const y=na(l),v=ur({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),v}return g}const Mee={kernelName:fv,backendName:"cpu",kernelFunc:Pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,weights:i}=e,{size:s,binaryOutput:a}=r;if(o.shape.length===1){const l=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values,c=rI(l,u,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,c)}else if(o.shape.length===2){const l=n.bufferSync(o),u=n.bufferSync(i),c=fB(l,u,s,a);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}const Lee={kernelName:q$,backendName:"cpu",kernelFunc:Fee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockSize:i,dataFormat:s}=r;E(s==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${s}`);const a=o.shape[0],l=o.shape[1],u=o.shape[2],c=o.shape[3],f=l*i,h=u*i,d=c/(i*i),p=n.data.get(o.dataId).values,m=new Float32Array(a*f*h*d);let g=0;for(let y=0;y<a;++y)for(let v=0;v<f;++v){const x=Math.floor(v/i),b=v%i;for(let w=0;w<h;++w){const S=Math.floor(w/i),$=w%i,C=(b*i+$)*d;for(let k=0;k<d;++k){const T=k+C+c*(S+u*(x+l*y));m[g++]=p[T]}}}return n.makeTensorInfo([a,f,h,d],o.dtype,m)}const zee={kernelName:X$,backendName:"cpu",kernelFunc:Bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fz(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i}=e,{strides:s,pad:a,dilations:l,dimRoundingMode:u}=r;we([o,i],"depthwiseConv2DNative");const c=ke(o.shape),f=ke(i.shape);let h=l;h==null&&(h=[1,1]),E(Rn(s,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${h}'`);const d=Sn(o.shape,i.shape,s,h,a,u,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:v}=d,x=v.left,b=v.top,w=d.outChannels/d.inChannels,S=new wn(d.outShape,o.dtype),$=n.data.get(o.dataId).values,C=n.data.get(i.dataId).values,k=S.values;for(let I=0;I<d.batchSize;++I){const T=I*c[0],N=I*S.strides[0];for(let _=0;_<d.outHeight;++_){const D=N+_*S.strides[1],O=_*d.strideHeight-b;for(let R=0;R<p;++R){const F=O+R*g;if(F<0||F>=d.inHeight)continue;const A=R*f[0],P=T+F*c[1];for(let z=0;z<d.outWidth;++z){const U=D+z*S.strides[2],H=z*d.strideWidth-x;for(let X=0;X<m;++X){const ne=H+X*y;if(ne<0||ne>=d.inWidth)continue;const re=A+X*f[1],le=P+ne*d.inChannels;let ye=U,ve=re;for(let J=0;J<d.inChannels;++J){const ce=$[le+J];for(let fe=0;fe<w;++fe)k[ye+fe]+=ce*C[ve+fe];ye+=w,ve+=w}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const jee={kernelName:hv,backendName:"cpu",kernelFunc:fz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:i}=e,{strides:s,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r;we([o,i],"depthwiseConv2dNativeBackpropFilter");const f=Sn(o.shape,c,s,a,l,u,!0),{strideHeight:h,strideWidth:d,filterHeight:p,filterWidth:m}=f,g=new wn(f.filterShape,"float32"),y=f.padInfo.left,v=f.padInfo.top,x=f.outChannels/f.inChannels,b=n.data.get(o.dataId).values,w=new wn(o.shape,o.dtype,b),S=n.data.get(i.dataId).values,$=new wn(i.shape,i.dtype,S);for(let C=0;C<p;++C){const k=Math.max(0,Math.ceil((v-C)/h)),I=Math.min(f.outHeight,(f.inHeight+v-C)/h);for(let T=0;T<m;++T){const N=Math.max(0,Math.ceil((y-T)/d)),_=Math.min(f.outWidth,(f.inWidth+y-T)/d);for(let D=0;D<f.outChannels;++D){const O=Math.trunc(D/x),R=D%x;let F=0;for(let A=0;A<f.batchSize;++A)for(let P=k;P<I;++P){const z=C+P*h-v;for(let U=N;U<_;++U){const H=T+U*d-y;F+=w.get(A,z,H,O)*$.get(A,P,U,D)}}g.set(F,C,T,O,R)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const Vee={kernelName:Y$,backendName:"cpu",kernelFunc:Wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:i}=e,{strides:s,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r;we([o,i],"depthwiseConv2DNativeBackpropInput");const f=ke(o.shape),h=ke(i.shape),d=Sn(c,i.shape,s,a,l,u,!0),p=new wn(d.inShape,"float32"),m=p.values,[g,y,v]=p.strides,x=n.data.get(o.dataId).values,[b,w,S]=f,$=n.data.get(i.dataId).values,[C,k,I]=h,{batchSize:T,filterHeight:N,filterWidth:_,inChannels:D,inHeight:O,inWidth:R,outChannels:F,outHeight:A,outWidth:P,strideHeight:z,strideWidth:U}=d,H=N-1-d.padInfo.top,X=_-1-d.padInfo.left,ne=F/D;for(let re=0;re<T;++re)for(let le=0;le<D;++le)for(let ye=0;ye<O;++ye){const ve=ye-H,J=Math.max(0,Math.ceil(ve/z)),ce=Math.min(A,(N+ve)/z);for(let fe=0;fe<R;++fe){const Z=fe-X,Ne=Math.max(0,Math.ceil(Z/U)),$e=Math.min(P,(_+Z)/U);let Oe=0;for(let te=J;te<ce;++te){const Ce=te*z-ve;for(let Ee=Ne;Ee<$e;++Ee){const qe=Ee*U-Z,Xe=b*re+w*te+S*Ee,_t=C*(N-1-Ce)+k*(_-1-qe)+I*le;for(let nt=0;nt<ne;++nt){const Xt=le*ne+nt,gt=x[Xe+Xt],Dt=$[_t+nt];Oe+=gt*Dt}}}m[g*re+y*ye+v*fe+le]=Oe}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Gee={kernelName:Q$,backendName:"cpu",kernelFunc:Uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hee(t){const{inputs:e,backend:n}=t,{x:r}=e,o=Q(r.shape),i=n.data.get(r.dataId).values,s=Me([o,o],r.dtype),a=s.values;for(let u=0;u<i.length;u++)a[u*o+u]=i[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,s.dtype,s.values)}const Kee={kernelName:DP,backendName:"cpu",kernelFunc:Hee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qee={kernelName:dv,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:o}=t,{strides:i,pad:s,dilations:a}=n,l=e,u=l.data.get(r.dataId).values,c=r.shape.length,f=l.data.get(o.dataId).values,h=o.shape.length,{batchSize:d,inHeight:p,inWidth:m,inChannels:g,outHeight:y,outWidth:v,padInfo:x,strideHeight:b,strideWidth:w,filterHeight:S,filterWidth:$,dilationHeight:C,dilationWidth:k,outShape:I}=Jd(r.shape,o.shape,i,s,"NHWC",a),T=Q(I),N=I.length,_=Bt(r.dtype,T);for(let O=0;O<d;++O)for(let R=0;R<y;++R){const F=R*b-x.top;for(let A=0;A<v;++A){const P=A*w-x.left;for(let z=0;z<g;++z){let U=Number.MIN_SAFE_INTEGER;for(let X=0;X<S;++X){const ne=F+X*C;if(ne>=0&&ne<p)for(let re=0;re<$;++re){const le=P+re*k;if(le>=0&&le<m){const ye=fi([O,ne,le,z],c,ke(r.shape)),ve=fi([X,re,z],h,ke(o.shape)),J=u[ye]+f[ve];J>U&&(U=J)}}}const H=fi([O,R,A,z],N,ke(I));_[H]=U}}}return{dataId:l.write(gl(_,r.dtype),I,r.dtype),shape:I,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xee={kernelName:A1,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:o,dy:i}=t,{strides:s,pad:a,dilations:l}=n,u=e,c=Wo(r.shape,u.data.get(r.dataId).values),f=Wo(o.shape,u.data.get(o.dataId).values),{batchSize:h,inHeight:d,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:v,strideHeight:x,strideWidth:b,filterHeight:w,filterWidth:S,dilationHeight:$,dilationWidth:C,outShape:k}=Jd(r.shape,o.shape,s,a,"NHWC",l);E(i.rank===k.length,()=>`Error in ${A1}, dy must have the same rank as output ${k.length}, but got ${i.rank}`);const I=Wo(k,u.data.get(i.dataId).values),T=NP(o.shape,o.dtype);for(let _=0;_<h;++_)for(let D=0;D<g;++D){const O=D*x-v.top;for(let R=0;R<y;++R){const F=R*b-v.left;for(let A=0;A<m;++A){let P=Number.MIN_SAFE_INTEGER,z=0,U=0;for(let H=0;H<w;++H){const X=O+H*$;if(X>=0&&X<d)for(let ne=0;ne<S;++ne){const re=F+ne*C;if(re>=0&&re<p){const le=c[_][X][re][A]+f[H][ne][A];le>P&&(P=le,z=H,U=ne)}}}T[z][U][A]+=I[_][D][R][A]}}}return{dataId:u.write(gl(T,r.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yee={kernelName:N1,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:o,dy:i}=t,{strides:s,pad:a,dilations:l}=n,u=e,c=Wo(r.shape,u.data.get(r.dataId).values),f=Wo(o.shape,u.data.get(o.dataId).values),{batchSize:h,inHeight:d,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:v,strideHeight:x,strideWidth:b,filterHeight:w,filterWidth:S,dilationHeight:$,dilationWidth:C,outShape:k}=Jd(r.shape,o.shape,s,a,"NHWC",l);E(i.rank===k.length,()=>`Error in ${N1}, dy must have the same rank as output ${k.length}, but got ${i.rank}`);const I=Wo(k,u.data.get(i.dataId).values),T=NP(r.shape,r.dtype);for(let _=0;_<h;++_)for(let D=0;D<g;++D){const O=D*x-v.top;for(let R=0;R<y;++R){const F=R*b-v.left;for(let A=0;A<m;++A){let P=Number.MIN_SAFE_INTEGER,z=O<0?0:O,U=F<0?0:F;for(let H=0;H<w;++H){const X=O+H*$;if(X>=0&&X<d)for(let ne=0;ne<S;++ne){const re=F+ne*C;if(re>=0&&re<p){const le=c[_][X][re][A]+f[H][ne][A];le>P&&(P=le,z=X,U=re)}}}T[_][z][U][A]+=I[_][D][R][A]}}}return{dataId:u.write(gl(T,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t){const{inputs:e,backend:n,attrs:r}=t,{image:o}=e,{canvas:i,options:s}=r,{contextOptions:a,imageOptions:l}=s||{},u=(l==null?void 0:l.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const f=i.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${c} type.`);const[h,d]=o.shape.slice(0,2),p=o.shape.length===2?1:o.shape[2],m=n.data.get(o.dataId).values,g=o.dtype==="float32"?255:1,y=new Uint8ClampedArray(d*h*4);for(let x=0;x<h*d;++x){const b=[0,0,0,255*u];for(let S=0;S<p;S++){const $=m[x*p+S];if(o.dtype==="float32"){if($<0||$>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${$}.`)}else if(o.dtype==="int32"&&($<0||$>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${$}.`);p===1?(b[0]=$*g,b[1]=$*g,b[2]=$*g):b[S]=$*g}const w=x*4;y[w+0]=Math.round(b[0]),y[w+1]=Math.round(b[1]),y[w+2]=Math.round(b[2]),y[w+3]=Math.round(b[3])}i.width=d,i.height=h;const v=new ImageData(y,d,h);return f.putImageData(v,0,0),o}const Zee={kernelName:AH,backendName:"cpu",kernelFunc:Qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mp(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r;we(o,"sum");let a;o.dtype==="bool"?a=Xs({inputs:{x:o},backend:n,attrs:{dtype:"int32"}}):a=Si({inputs:{x:o},backend:n});const l=a.shape.length,u=Fe(i,a.shape),c=Ot(u,l);let f=u,h=a;c!=null&&(h=ur({inputs:{x:a},backend:n,attrs:{perm:c}}),f=Wt(f.length,l)),$n("sum",f,h.shape.length);const[d,p]=mn(h.shape,f),m=$r(h.dtype,"int32");let g=Ng(n,d,m);const y=Q(p),v=n.data.get(g.dataId).values,x=n.data.get(h.dataId).values;for(let b=0;b<v.length;++b){const w=b*y;let S=0;for(let $=0;$<y;++$)S+=x[w+$];v[b]=S}if(s){const b=qt(g.shape,u),w=g;g=mt({inputs:{x:g},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(h),g}const Jee={kernelName:Hv,backendName:"cpu",kernelFunc:mp};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(t){const{inputs:e,backend:n,attrs:r}=t,{equation:o}=r,i=e,{allDims:s,summedDims:a,idDims:l}=kk(o,i.length);Tk(s.length,l,i);const{path:u,steps:c}=Ek(a,l),f=c.length;let h=null,d=s.length;const p=[];for(let m=0;m<f;++m){for(const g of c[m]){const{permutationIndices:y,expandDims:v}=Ik(d,l[g]);let x;Nk(y)?x=i[g]:(x=ur({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),p.push(x));const b=x.shape.slice();for(let w=0;w<v.length;++w)b.splice(v[w],0,1);et(x.shape,b)||(x=mt({inputs:{x},backend:n,attrs:{shape:b}}),p.push(x)),h===null?h=x:(h=w0({inputs:{a:x,b:h},backend:n}),p.push(h))}m<f-1&&(u[m]>=0&&(h=mp({inputs:{x:h},backend:n,attrs:{axis:u[m]-(s.length-d),keepDims:!1}}),p.push(h)),d--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const tte={kernelName:Z$,backendName:"cpu",kernelFunc:ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nte(t){const{inputs:e,backend:n}=t,{dy:r,y:o}=e;we([r,o],"eluGrad");const i=new Float32Array(Q(o.shape)),s=n.data.get(o.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<s.length;++l){const u=s[l];u>=0?i[l]=a[l]:i[l]=a[l]*(u+1)}return n.makeTensorInfo(o.shape,"float32",i)}const rte={kernelName:J$,backendName:"cpu",kernelFunc:nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ote=vk,ite=xk,ste=bk,ate=wk,lte=Sk,ute=$k,cte=it(gd,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+ote*n);return e*(1-((((ute*r+lte)*r+ate)*r+ste)*r+ite)*r*Math.exp(-n*n))}),fte={kernelName:gd,backendName:"cpu",kernelFunc:cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _g(t){const{inputs:e,backend:n,attrs:r}=t,{input:o}=e,{dim:i}=r,s=o.shape.length,a=o.shape.slice();let l=i;return i<0&&(E(-(s+1)<=i,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+i+1),a.splice(l,0,1),mt({inputs:{x:o},backend:n,attrs:{shape:a}})}const hte={kernelName:mv,backendName:"cpu",kernelFunc:_g};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dte=Ut((t,e)=>t/e),uI=sn(pd,dte),rw={kernelName:pd,backendName:"cpu",kernelFunc:uI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hz(t,e,n){const r=t.shape,o=r[0],i=r[1],s=n.data.get(t.dataId),a=s.complexTensorInfos.real,l=s.complexTensorInfos.imag,u=[o,i],c=Q(u),f=On("float32",c),h=On("float32",c);for(let g=0;g<o;g++){const y=al({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,i]}}),v=al({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,i]}}),x=mr({inputs:{real:y,imag:v},backend:n}),{real:b,imag:w}=pte(x,e,n),S=Yi(b,w);for(let $=0;$<i;$++){const C=Ck(S,$);f[g*i+$]=C.real,h[g*i+$]=C.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x)}const d=n.makeTensorInfo(u,"float32",f),p=n.makeTensorInfo(u,"float32",h),m=mr({inputs:{real:d,imag:p},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),m}function pte(t,e,n){const r=Q(t.shape),o=n.data.get(t.dataId),i=n.data.get(o.complexTensorInfos.real.dataId).values,s=n.data.get(o.complexTensorInfos.imag.dataId).values;if(mte(r)){const a=ow(i,s,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",a.real),c=n.makeTensorInfo(l,"float32",a.imag),f=n.makeTensorInfo([],"float32",ea(r,"float32")),h=Si({inputs:{x:f},backend:n}),d=rw.kernelFunc({inputs:{a:u,b:f},backend:n}),p=rw.kernelFunc({inputs:{a:c,b:h},backend:n}),m=n.data.get(d.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),{real:m,imag:g}}return a}else{const a=Yi(i,s),l=gte(a,r,e);return TF(l)}}function mte(t){return(t&t-1)===0}function ow(t,e,n,r,o){if(n===1)return{real:t,imag:e};const i=Yi(t,e),s=n/2,a=EF(i),l=a.real,u=a.imag,c=[l.length],f=o.makeTensorInfo(c,"float32",l),h=o.makeTensorInfo(c,"float32",u),d=mr({inputs:{real:f,imag:h},backend:o}),p=NF(i),m=p.real,g=p.imag,y=[m.length],v=o.makeTensorInfo(y,"float32",m),x=o.makeTensorInfo(y,"float32",g),b=mr({inputs:{real:v,imag:x},backend:o}),w=ow(l,u,s,r,o),S=w.real,$=w.imag,C=[S.length],k=o.makeTensorInfo(C,"float32",S),I=o.makeTensorInfo(C,"float32",$),T=mr({inputs:{real:k,imag:I},backend:o}),N=ow(m,g,s,r,o),_=N.real,D=N.imag,O=[_.length],R=o.makeTensorInfo(O,"float32",_),F=o.makeTensorInfo(O,"float32",D),A=mr({inputs:{real:R,imag:F},backend:o}),P=OF(n,r),z=[P.real.length],U=o.makeTensorInfo(z,"float32",P.real),H=o.makeTensorInfo(z,"float32",P.imag),X=mr({inputs:{real:U,imag:H},backend:o}),ne=w0({inputs:{a:X,b:A},backend:o}),re=Lu({inputs:{a:T,b:ne},backend:o}),le=aI({inputs:{a:T,b:ne},backend:o}),ye=sl({inputs:{input:re},backend:o}),ve=sl({inputs:{input:le},backend:o}),J=Bu({inputs:{input:re},backend:o}),ce=Bu({inputs:{input:le},backend:o}),fe=zu({inputs:[ye,ve],backend:o,attrs:{axis:0}}),Z=zu({inputs:[J,ce],backend:o,attrs:{axis:0}}),Ne=o.data.get(fe.dataId).values,$e=o.data.get(Z.dataId).values;return o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(h),o.disposeIntermediateTensorInfo(d),o.disposeIntermediateTensorInfo(v),o.disposeIntermediateTensorInfo(x),o.disposeIntermediateTensorInfo(b),o.disposeIntermediateTensorInfo(k),o.disposeIntermediateTensorInfo(I),o.disposeIntermediateTensorInfo(T),o.disposeIntermediateTensorInfo(R),o.disposeIntermediateTensorInfo(F),o.disposeIntermediateTensorInfo(A),o.disposeIntermediateTensorInfo(U),o.disposeIntermediateTensorInfo(H),o.disposeIntermediateTensorInfo(X),o.disposeIntermediateTensorInfo(ne),o.disposeIntermediateTensorInfo(re),o.disposeIntermediateTensorInfo(le),o.disposeIntermediateTensorInfo(ye),o.disposeIntermediateTensorInfo(J),o.disposeIntermediateTensorInfo(ve),o.disposeIntermediateTensorInfo(ce),o.disposeIntermediateTensorInfo(fe),o.disposeIntermediateTensorInfo(Z),{real:Ne,imag:$e}}function gte(t,e,n){const r=new Float32Array(e*2);for(let o=0;o<e;o++){let i=0,s=0;for(let a=0;a<e;a++){const l=_F(o*a,e,n),u=Ck(t,a);i+=u.real*l.real-u.imag*l.imag,s+=u.real*l.imag+u.imag*l.real}n&&(i/=e,s/=e),AF(r,i,s,o)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yte(t){const{inputs:e,backend:n}=t,{input:r}=e,o=Q(r.shape),i=r.shape[r.shape.length-1],s=o/i,a=mt({inputs:{x:r},backend:n,attrs:{shape:[s,i]}}),l=hz(a,!1,n),u=mt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const vte={kernelName:eC,backendName:"cpu",kernelFunc:yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cI(t){const{backend:e,attrs:n}=t,{shape:r,value:o,dtype:i}=n,s=i||pc(o),a=Bt(s,Q(r));return bte(a,o,s),e.makeTensorInfo(r,s,a)}const xte={kernelName:tC,backendName:"cpu",kernelFunc:cI};function bte(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wte={kernelName:nC,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,o=n,i=On(r.dtype,Q(r.shape)),[s,a,l,u]=r.shape,c=o.data.get(r.dataId).values;for(let h=0;h<s;h++){const d=h*l*a*u;for(let p=0;p<a;p++){const m=p*(l*u);for(let g=0;g<l;g++){const y=g*u;for(let v=0;v<u;v++){const x=Math.round(l-g-1),b=d+m+y+v;let w=c[b];if(x>=0&&x<l){const S=x*u,$=d+m+S+v;w=c[$]}i[b]=w}}}}return{dataId:o.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ste(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i,bias:s,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r;let m=cz({inputs:{x:o,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h}});if(s){const g=m;if(c==="NCHW"&&s.shape.length===1&&s.shape[0]!==1){const y=mt({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=Lu({inputs:{a:m,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else m=Lu({inputs:{a:m,b:s},backend:n});n.disposeIntermediateTensorInfo(g)}if(d){const g=m;if(c==="NCHW"&&d==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const y=mt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=Og(n,m,d,y,p),n.disposeIntermediateTensorInfo(y)}else m=Og(n,m,d,a,p);n.disposeIntermediateTensorInfo(g)}return m}const $te={kernelName:fg,backendName:"cpu",kernelFunc:Ste};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i,bias:s,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r;let m=fz({inputs:{x:o,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h}});if(s){const g=m;m=Lu({inputs:{a:m,b:s},backend:n}),n.disposeIntermediateTensorInfo(g)}if(d){const g=m;m=Og(n,m,d,a,p),n.disposeIntermediateTensorInfo(g)}return m}const kte={kernelName:ZP,backendName:"cpu",kernelFunc:Cte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ite(t){const{inputs:e,backend:n}=t,{params:r,indices:o}=e,i=Q(r.shape),s=o.shape,a=s[s.length-1],[l,u,c,f]=ak(r,o);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);const h=n.data.get(o.dataId).values,d=n.bufferSync(r),p=SB(h,d,r.dtype,u,a,c,f,r.shape,i);return n.makeTensorInfo(l,r.dtype,p.values)}const Tte={kernelName:RP,backendName:"cpu",kernelFunc:Ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ete(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,indices:i}=e,{axis:s,batchDims:a}=r;we([o,i],"gatherV2");const l=Fe(s,o.shape)[0],u=n.data.get(i.dataId).values,c=o.shape[l];for(let b=0;b<u.length;++b){const w=u[b];E(w<=c-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${c-1}]`)}let f=a;a==null&&(f=0);const h=Q(i.shape),d=Ok(o,i,l,f),p=mt({inputs:{x:o},backend:n,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),m=mt({inputs:{x:i},backend:n,attrs:{shape:[d.batchSize,h/d.batchSize]}}),g=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize],y=n.bufferSync(m),v=n.bufferSync(p),x=$B(v,y,g);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(d.outputShape,x.dtype,x.values)}const Nte={kernelName:yv,backendName:"cpu",kernelFunc:Ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(t){const{inputs:e,backend:n}=t,{input:r}=e,o=Q(r.shape),i=r.shape[r.shape.length-1],s=o/i,a=mt({inputs:{x:r},backend:n,attrs:{shape:[s,i]}}),l=hz(a,!0,n),u=mt({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const Ote={kernelName:rC,backendName:"cpu",kernelFunc:Ate};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _te=it($d,t=>Number.isFinite(t)?1:0,"bool"),Dte={kernelName:$d,backendName:"cpu",kernelFunc:_te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rte=it(Cd,t=>Math.abs(t)===1/0?1:0,"bool"),Pte={kernelName:Cd,backendName:"cpu",kernelFunc:Rte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mte=it(kd,t=>Number.isNaN(t)?1:0,"bool"),Fte={kernelName:kd,backendName:"cpu",kernelFunc:Mte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(t){const{backend:e,attrs:n}=t,{start:r,stop:o,num:i}=n,s=EB(r,o,i);return e.makeTensorInfo([s.length],"float32",s)}const Bte={kernelName:PP,backendName:"cpu",kernelFunc:Lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zte=it(Td,t=>Math.log1p(t)),jte={kernelName:Td,backendName:"cpu",kernelFunc:zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wte=Ut((t,e)=>t&&e),Vte=sn(Sv,Wte,null,"bool"),Ute={kernelName:Sv,backendName:"cpu",kernelFunc:Vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gte=it($v,t=>t?0:1,"bool"),Hte={kernelName:$v,backendName:"cpu",kernelFunc:Gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kte=Ut((t,e)=>t||e),qte=sn(Cv,Kte,null,"bool"),Xte={kernelName:Cv,backendName:"cpu",kernelFunc:qte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{depthRadius:i,bias:s,alpha:a,beta:l}=r;we(o,"LRN");const u=o.shape[3],c=u-1,f=n.data.get(o.dataId).values,h=Q(o.shape),d=new Float32Array(h);function p(m){const g=m%u;let y=m-g+Math.max(0,g-i);const v=m-g+Math.min(g+i,c);let x=0;for(;y<=v;y++){const b=f[y];x+=b*b}return x}for(let m=0;m<h;m++){const g=p(m),y=f[m]*Math.pow(s+a*g,-l);d[m]=y}return n.makeTensorInfo(o.shape,o.dtype,d)}const Qte={kernelName:kv,backendName:"cpu",kernelFunc:Yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,y:i,dy:s}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r;we(s,"LRNGrad");const f=Q(s.shape),h=s.shape[3],d=n.data.get(s.dataId).values,p=n.data.get(o.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(f),y=f;for(let v=0;v<y;v++){const x=v%h,b=v-x+Math.max(0,x-a),w=v-x+Math.min(h,x+a+1);let S=0;for(let $=b;$<w;$++)S+=Math.pow(p[$],2);S=u*S+l;for(let $=b;$<w;$++){let C=-2*u*c*p[$]*m[v]/S;v===$&&(C+=Math.pow(S,-c)),C*=d[v],g[$]+=C}}return n.makeTensorInfo(s.shape,o.dtype,g)}const Jte={kernelName:iC,backendName:"cpu",kernelFunc:Zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dz(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{reductionIndices:i,keepDims:s}=r,a=n;let l=o.shape;const u=l.length,c=Fe(i,l);let f=c;const h=Ot(f,u);let d=a.data.get(o.dataId).values;if(h!=null){const b=new Array(u);for(let w=0;w<b.length;w++)b[w]=l[h[w]];d=iI(d,l,o.dtype,h,b),f=Wt(f.length,u),l=b}we(o,"max"),$n("max",f,u);const[p,m]=mn(l,f),g=Q(m),y=AB(d,g,p,o.dtype),v=a.write(y,p,o.dtype);let x=p;return s&&(x=qt(p,c)),{dataId:v,shape:x,dtype:o.dtype}}const ene={kernelName:Iv,backendName:"cpu",kernelFunc:dz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e;we(o,"maxPool");const{filterSize:i,strides:s,pad:a,dimRoundingMode:l}=r,u=1;E(Rn(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=vo(o.shape,i,s,u,a,l);let f;if(c.filterWidth===1&&c.filterHeight===1&&et(c.inShape,c.outShape))f=Si({inputs:{x:o},backend:n});else{const h=n.data.get(o.dataId).values,d=ke(o.shape),p=lI(h,o.shape,o.dtype,d,c,"max");f=n.makeTensorInfo(c.outShape,o.dtype,p.values)}return f}const nne={kernelName:Tv,backendName:"cpu",kernelFunc:tne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{filterSize:i,strides:s,pad:a,dimRoundingMode:l,dataFormat:u}=r;we(o,"maxPool3d");const c=os(o.shape,i,s,1,a,l,u),f=n.data.get(o.dataId).values,h=uz(f,o.shape,o.dtype,ke(o.shape),c,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const one={kernelName:Ev,backendName:"cpu",kernelFunc:rne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:i}=e,{filterSize:s,strides:a,pad:l,dimRoundingMode:u}=r;we([o,i],"maxPool3DGrad");const c=os(i.shape,s,a,1,l,u),f=n.bufferSync(i),h=KJ(f,c),d=c.strideDepth,p=c.strideHeight,m=c.strideWidth,g=c.dilationDepth,y=c.dilationHeight,v=c.dilationWidth,x=c.effectiveFilterDepth,b=c.effectiveFilterHeight,w=c.effectiveFilterWidth,S=x-1-c.padInfo.front,$=w-1-c.padInfo.left,C=b-1-c.padInfo.top,k=Me(i.shape,"float32"),I=n.bufferSync(o);for(let T=0;T<c.batchSize;++T)for(let N=0;N<c.inChannels;++N)for(let _=0;_<c.inDepth;++_)for(let D=0;D<c.inHeight;++D)for(let O=0;O<c.inWidth;++O){const R=_-S,F=D-C,A=O-$;let P=0;for(let z=0;z<x;z+=g){const U=(R+z)/d;if(!(U<0||U>=c.outDepth||Math.floor(U)!==U))for(let H=0;H<b;H+=y){const X=(F+H)/p;if(!(X<0||X>=c.outHeight||Math.floor(X)!==X))for(let ne=0;ne<w;ne+=v){const re=(A+ne)/m;if(re<0||re>=c.outWidth||Math.floor(re)!==re)continue;const le=x*b*w-1-h.get(T,U,X,re,N),ye=z*b*w+H*w+ne,ve=le===ye?1:0;if(ve===0)continue;const J=I.get(T,U,X,re,N);P+=J*ve}}}k.set(P,T,_,D,O,N)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const sne={kernelName:aC,backendName:"cpu",kernelFunc:ine};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:i,output:s}=e,a=i;we([i,s],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:f}=r,h=vo(a.shape,l,u,1,c,f),d=n.data.get(a.dataId).values,p=Me(h.outShape,a.dtype,lz(d,a.shape,a.dtype,h).values),m=h.strideHeight,g=h.strideWidth,y=h.dilationHeight,v=h.dilationWidth,x=h.effectiveFilterHeight,b=h.effectiveFilterWidth,w=b-1-h.padInfo.left,S=x-1-h.padInfo.top,$=Me(a.shape,"float32"),C=n.data.get(o.dataId).values,k=Me(o.shape,"float32",C);for(let I=0;I<h.batchSize;++I)for(let T=0;T<h.inChannels;++T)for(let N=0;N<h.inHeight;++N)for(let _=0;_<h.inWidth;++_){const D=N-S,O=_-w;let R=0;for(let F=0;F<x;F+=y){const A=(D+F)/m;if(!(A<0||A>=h.outHeight||Math.floor(A)!==A))for(let P=0;P<b;P+=v){const z=(O+P)/g;if(z<0||z>=h.outWidth||Math.floor(z)!==z)continue;const U=x*b-1-p.get(I,A,z,T),H=F*b+P,X=U===H?1:0;if(X===0)continue;const ne=k.get(I,A,z,T);R+=ne*X}}$.set(R,I,N,_,T)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const lne={kernelName:sC,backendName:"cpu",kernelFunc:ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(t,e,n,r,o){const i=ke(e),s=lI(t,e,n,i,o,"max"),a=lz(t,e,n,o,!0,r);return[s.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cne={kernelName:MP,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:o,strides:i,pad:s,includeBatchInIndex:a}=e,l=n;we(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=vo(r.shape,o,i,[1,1],s),[f,h]=une(u,r.shape,r.dtype,a,c),d=l.write(f,c.outShape,r.dtype),p=l.write(h,c.outShape,r.dtype);return[{dataId:d,shape:c.outShape,dtype:r.dtype},{dataId:p,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r,a=Fe(i,o.shape),u=mn(o.shape,a)[1],c=Q(u),f=[],h=n.makeTensorInfo([],"float32",new Float32Array([c]));f.push(h);const d=Xs({inputs:{x:o},backend:n,attrs:{dtype:"float32"}});f.push(d);const p=uI({inputs:{a:d,b:h},backend:n});f.push(p);const m=mp({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:s}});return f.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const hne={kernelName:Nv,backendName:"cpu",kernelFunc:fne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r;we(o,"min");const a=Fe(i,o.shape);let l=a;const u=Ot(l,o.shape.length);let c=o;u!=null&&(c=ur({inputs:{x:o},backend:n,attrs:{perm:u}}),l=Wt(l.length,o.shape.length)),$n("min",l,c.shape.length);const[f,h]=mn(c.shape,l),d=Q(h),p=_n(Q(f),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<p.length;++y){const v=y*d;let x=m[v];for(let b=0;b<d;++b){const w=m[v+b];(Number.isNaN(w)||w<x)&&(x=w)}p[y]=x}u!=null&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(f,c.dtype,p);if(s){const y=qt(f,a),v=mt({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),v}return g}const pne={kernelName:Av,backendName:"cpu",kernelFunc:dne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{paddings:i,mode:s}=r;we(o,"mirrorPad");const a=i.map((x,b)=>x[0]+o.shape[b]+x[1]),l=i.map(x=>x[0]),u=i.map((x,b)=>x[0]+o.shape[b]),c=s==="reflect"?0:1,f=n.data.get(o.dataId).values,h=o.shape.length,d=ke(o.shape),p=Q(a),m=a.length,g=ke(a),y=On(o.dtype,p);for(let x=0;x<p;x++){let b=mc(x,m,g);for(let S=0;S<m;S++)b[S]<l[S]?b[S]=l[S]*2-b[S]-c:b[S]>=u[S]&&(b[S]=(u[S]-1)*2-b[S]+c);b=b.map((S,$)=>S-l[$]);const w=fi(b,h,d);y[x]=f[w]}return{dataId:n.write(y,a,o.dtype),shape:a,dtype:o.dtype}}const gne={kernelName:Ov,backendName:"cpu",kernelFunc:mne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yne=Ut((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),vne=sn(Ad,yne),xne={kernelName:Ad,backendName:"cpu",kernelFunc:vne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pz(t){const{inputs:e,backend:n,attrs:r}=t,{logits:o}=e,{dim:i}=r,s=o.shape.length;let a=i;if(a===-1&&(a=s-1),a!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${a}`);const l=Fe([a],o.shape),u=dz({inputs:{x:o},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=qt(u.shape,l),f=mt({inputs:{x:u},backend:n,attrs:{shape:c}}),h=aI({inputs:{a:o,b:f},backend:n}),d=vB({inputs:{x:h},backend:n}),p=mp({inputs:{x:d},backend:n,attrs:{axis:l,keepDims:!1}}),m=mt({inputs:{x:p},backend:n,attrs:{shape:c}}),g=uI({inputs:{a:d,b:m},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const bne={kernelName:Xv,backendName:"cpu",kernelFunc:pz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(t){const{inputs:e,backend:n,attrs:r}=t,{logits:o}=e,{numSamples:i,seed:s,normalized:a}=r;we(o,"multinomial");const l=a?o:pz({inputs:{logits:o},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],f=n.data.get(l.dataId).values,h=[u,i],d=_n(Q(h),"int32");for(let p=0;p<u;++p){const m=p*c,g=new Float32Array(c-1);g[0]=f[m];for(let x=1;x<g.length;++x)g[x]=g[x-1]+f[m+x];const y=KC.alea(s.toString()),v=p*i;for(let x=0;x<i;++x){const b=y();d[v+x]=g.length;for(let w=0;w<g.length;w++)if(b<g[w]){d[v+x]=w;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",d)}const Sne={kernelName:FP,backendName:"cpu",kernelFunc:wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ne=nk;function Cne(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:i}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l}=r;we(o,"NonMaxSuppression");const u=n.data.get(o.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:f}=$ne(u,c,s,a,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const kne={kernelName:lC,backendName:"cpu",kernelFunc:Cne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ine=rk;function Tne(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:i}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r;we(o,"NonMaxSuppressionPadded");const c=n.data.get(o.dataId).values,f=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:d}=Ine(c,f,s,a,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}const Ene={kernelName:uC,backendName:"cpu",kernelFunc:Tne};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nne=ok;function Ane(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:i}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r;we(o,"NonMaxSuppressionWithScore");const c=n.data.get(o.dataId).values,f=n.data.get(i.dataId).values,h=s,d=a,p=l,m=u,{selectedIndices:g,selectedScores:y}=Nne(c,f,h,d,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const One={kernelName:cC,backendName:"cpu",kernelFunc:Ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ne(t){const{inputs:e,backend:n,attrs:r}=t,{indices:o}=e,{dtype:i,depth:s,onValue:a,offValue:l}=r;we(o,"oneHot");const u=Q(o.shape),c=new Float32Array(u*s);c.fill(l);const f=n.data.get(o.dataId).values;for(let h=0;h<u;++h)f[h]>=0&&f[h]<s&&(c[h*s+f[h]]=a);return n.makeTensorInfo([...o.shape,s],i,c)}const Dne={kernelName:Pv,backendName:"cpu",kernelFunc:_ne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dg(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const o=sl({inputs:{input:r},backend:n}),i=Dg({inputs:{x:o},backend:n}),s=Bu({inputs:{input:r},backend:n}),a=Dg({inputs:{x:s},backend:n}),l=mr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),l}else return cI({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const Rne={kernelName:Zv,backendName:"cpu",kernelFunc:Dg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mz(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const o=sl({inputs:{input:r},backend:n}),i=mz({inputs:{x:o},backend:n}),s=Bu({inputs:{input:r},backend:n}),a=Dg({inputs:{x:s},backend:n}),l=mr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),l}else return cI({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const Pne={kernelName:Rv,backendName:"cpu",kernelFunc:mz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gz(t){const{inputs:e,backend:n,attrs:r}=t,{axis:o}=r;if(e.length===1)return _g({inputs:{input:e[0]},backend:n,attrs:{dim:o}});const i=e[0].shape,s=e[0].dtype;e.forEach(c=>{A$(i,c.shape,"All tensors passed to stack must have matching shapes"),E(s===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const f=_g({inputs:{input:c},backend:n,attrs:{dim:o}});return a.push(f),f}),u=zu({inputs:l,backend:n,attrs:{axis:o}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const Mne={kernelName:Mv,backendName:"cpu",kernelFunc:gz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fne(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{paddings:i,constantValue:s}=r;we(o,"pad");const a=i.map((v,x)=>v[0]+o.shape[x]+v[1]),l=i.map(v=>v[0]),u=n.data.get(o.dataId).values,c=Q(o.shape),f=o.shape.length,h=ke(o.shape),d=Q(a),p=a.length,m=ke(a),g=On(o.dtype,d);s!==0&&g.fill(s);for(let v=0;v<c;v++){const b=mc(v,f,h).map((S,$)=>S+l[$]),w=fi(b,p,m);g[w]=u[v]}return{dataId:n.write(g,a,o.dtype),shape:a,dtype:o.dtype}}const yz={kernelName:Fv,backendName:"cpu",kernelFunc:Fne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lne=Ut((t,e)=>Math.pow(t,e)),Bne=sn(_d,Lne),zne={kernelName:_d,backendName:"cpu",kernelFunc:Bne};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:o,paramsDenseValues:i,indices:s}=e,a=o.map(g=>n.data.get(g.dataId).values),l=o.map(g=>g.shape),u=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,[f,h,d]=MB(a,l,u,i.shape,i.dtype,c,s.shape),p=f.map(g=>n.makeTensorInfo([g.length],"int32",g)),m=n.makeTensorInfo(d,i.dtype,h);return p.concat([m])}const Wne={kernelName:LP,backendName:"cpu",kernelFunc:jne};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t){const{inputs:e,backend:n}=t,{starts:r,limits:o,deltas:i}=e,s=n.data.get(r.dataId).values,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values,[u,c]=FB(s,r.shape,r.dtype,a,o.shape,l,i.shape),f=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[f,h]}const Une={kernelName:BP,backendName:"cpu",kernelFunc:Vne};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne(t){const{inputs:e,backend:n,attrs:r}=t,{shape:o,values:i,defaultValue:s,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.data.get(o.dataId).values,c=n.data.get(i.dataId).values,f=n.data.get(s.dataId).values,h=a.map(g=>n.data.get(g.dataId).values),d=a.map(g=>g.shape),[p,m]=LB(u,o.shape,c,i.shape,i.dtype,f,s.shape,h,d,l);return n.makeTensorInfo(p,i.dtype,m)}const Hne={kernelName:zP,backendName:"cpu",kernelFunc:Gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(t){const{backend:e,attrs:n}=t,{start:r,stop:o,dtype:i,step:s}=n,a=BB(r,o,s,i);return e.makeTensorInfo([a.length],i,a)}const qne={kernelName:fC,backendName:"cpu",kernelFunc:Kne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xne=it(Dd,t=>1/t),Yne={kernelName:Dd,backendName:"cpu",kernelFunc:Xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t){const{inputs:e,backend:n,attrs:r}=t,{images:o}=e,{alignCorners:i,halfPixelCenters:s,size:a}=r;we(o,"resizeBilinear");const l=ke(o.shape),[u,c]=a,[f,h,d,p]=o.shape,m=n.data.get(o.dataId).values,g=new Float32Array(Q([f,u,c,p])),y=[i&&u>1?h-1:h,i&&c>1?d-1:d],v=[i&&u>1?u-1:u,i&&c>1?c-1:c];let x=0;const b=y[0]/v[0],w=y[1]/v[1];for(let S=0;S<f;S++)for(let $=0;$<u;$++){let C;s?C=b*($+.5)-.5:C=b*$;const k=Math.max(0,Math.floor(C)),I=C-k,T=Math.min(h-1,Math.ceil(C)),N=S*l[0]+k*l[1],_=S*l[0]+T*l[1];for(let D=0;D<c;D++){let O;s?O=w*(D+.5)-.5:O=w*D;const R=Math.max(0,Math.floor(O)),F=O-R,A=Math.min(d-1,Math.ceil(O)),P=N+R*l[2],z=_+R*l[2],U=N+A*l[2],H=_+A*l[2];for(let X=0;X<p;X++){const ne=m[P+X],re=m[z+X],le=m[U+X],ye=m[H+X],ve=ne+(le-ne)*F,J=re+(ye-re)*F,ce=ve+(J-ve)*I;g[x++]=ce}}}return n.makeTensorInfo([f,u,c,p],"float32",g)}const Zne={kernelName:Wv,backendName:"cpu",kernelFunc:Qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jne(t){const{inputs:e,backend:n,attrs:r}=t,{images:o,dy:i}=e,{alignCorners:s}=r;we([i,o],"resizeBilinearGrad");const a=ke(o.shape),[l,u,c,f]=o.shape,[,h,d]=i.shape,p=new Float32Array(l*u*c*f),m=[s&&h>1?u-1:u,s&&d>1?c-1:c],g=[s&&h>1?h-1:h,s&&d>1?d-1:d],y=m[0]/g[0],v=m[1]/g[1],x=n.data.get(i.dataId).values;let b=0;for(let w=0;w<l;w++){const S=w*a[0];for(let $=0;$<h;$++){const C=$*y,k=Math.floor(C),I=Math.min(Math.ceil(C),u-1),T=S+k*a[1],N=S+I*a[1],_=C-k,D=1-_;for(let O=0;O<d;O++){const R=O*v,F=Math.floor(R),A=Math.min(Math.ceil(R),c-1),P=R-F,z=1-P,U=T+F*a[2],H=T+A*a[2],X=N+F*a[2],ne=N+A*a[2],re=D*z,le=D*P,ye=_*z,ve=_*P;for(let J=0;J<f;J++){const ce=x[b++];p[U+J]+=ce*re,p[H+J]+=ce*le,p[X+J]+=ce*ye,p[ne+J]+=ce*ve}}}}return n.makeTensorInfo([l,c,u,f],"float32",p)}const ere={kernelName:pC,backendName:"cpu",kernelFunc:Jne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tre(t){const{inputs:e,backend:n,attrs:r}=t,{images:o}=e,{alignCorners:i,halfPixelCenters:s,size:a}=r;we(o,"resizeNearestNeighbor");const l=ke(o.shape),[u,c]=a,[f,h,d,p]=o.shape,m=n.data.get(o.dataId).values,g=new Float32Array(f*u*c*p),y=[i&&u>1?h-1:h,i&&c>1?d-1:d],v=[i&&u>1?u-1:u,i&&c>1?c-1:c],x=y[0]/v[0],b=y[1]/v[1];let w=0;for(let S=0;S<f;S++){const $=S*l[0];for(let C=0;C<u;C++){const k=s?x*(C+.5):x*C;let I=Math.min(h-1,i?Math.round(k):Math.floor(k));s&&(I=Math.max(0,I));const T=$+I*l[1];for(let N=0;N<c;N++){const _=s?b*(N+.5):b*N;let D=Math.min(d-1,i?Math.round(_):Math.floor(_));s&&(D=Math.max(0,D));const O=T+D*l[2];for(let R=0;R<p;R++){const F=m[O+R];g[w++]=F}}}}return n.makeTensorInfo([f,u,c,p],o.dtype,g)}const nre={kernelName:jv,backendName:"cpu",kernelFunc:tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rre(t){const{inputs:e,backend:n,attrs:r}=t,{images:o,dy:i}=e,{alignCorners:s}=r;we([i,o],"resizeNearestNeighborGrad");const a=ke(o.shape),l=ke(i.shape),[u,c,f,h]=o.shape,[,d,p]=i.shape,m=new Float32Array(u*c*f*h),g=n.data.get(i.dataId).values,y=[s&&d>1?c-1:c,s&&p>1?f-1:f],v=[s&&d>1?d-1:d,s&&p>1?p-1:p],x=y[0]/v[0],b=y[1]/v[1],w=1/x,S=1/b,$=Math.ceil(w)*2+2,C=Math.ceil(S)*2+2;for(let k=0;k<u;k++){const I=k*a[0];for(let T=0;T<c;T++){const N=I+T*a[1],_=Math.floor(T*w),D=Math.floor(_-$/2);for(let O=0;O<f;O++){const R=N+O*a[2],F=Math.floor(O*S),A=Math.floor(F-C/2);for(let P=0;P<h;P++){let z=0;for(let U=0;U<$;U++){const H=U+D;if(H<0||H>=d)continue;const X=I+H*l[1],ne=H*x,re=Math.min(c-1,s?Math.round(ne):Math.floor(ne));if(T===re)for(let le=0;le<C;le++){const ye=le+A;if(ye<0||ye>=p)continue;const ve=X+ye*l[2],J=ye*b,ce=Math.min(f-1,s?Math.round(J):Math.floor(J));O===ce&&(z+=g[ve+P])}}m[R+P]=z}}}}return n.makeTensorInfo(o.shape,o.dtype,m)}const ore={kernelName:dC,backendName:"cpu",kernelFunc:rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ire(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{dims:i}=r;we(o,"reverse");const s=o.shape.length,a=Fe(i,o.shape);if(s===0)return Si({inputs:{x:o},backend:n});const l=new wn(o.shape,o.dtype),u=n.bufferSync(o);for(let c=0;c<l.size;c++){const f=l.indexToLoc(c),h=f.slice();a.forEach(d=>h[d]=o.shape[d]-1-h[d]),l.set(u.get(...h),...f)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const sre={kernelName:Vv,backendName:"cpu",kernelFunc:ire};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const are={kernelName:wC,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:o,fillValue:i,center:s}=e,a=n,l=On(r.dtype,Q(r.shape)),[u,c,f,h]=r.shape,[d,p]=mk(s,c,f),m=255,g=Math.sin(o),y=Math.cos(o),v=a.data.get(r.dataId).values;for(let b=0;b<u;b++){const w=b*f*c*h;for(let S=0;S<c;S++){const $=S*(f*h);for(let C=0;C<f;C++){const k=C*h;for(let I=0;I<h;I++){const T=[u,S,C,I],N=T[2],_=T[1];let D=(N-d)*y-(_-p)*g,O=(N-d)*g+(_-p)*y;D=Math.round(D+d),O=Math.round(O+p);let R=i;if(typeof i!="number"&&(I===3?R=m:R=i[I]),D>=0&&D<f&&O>=0&&O<c){const A=O*(f*h),P=D*h,z=w+A+P+I;R=v[z]}const F=w+$+k+I;l[F]=R}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lre=it(Md,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),ure={kernelName:Md,backendName:"cpu",kernelFunc:lre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre(t){const{inputs:e,backend:n,attrs:r}=t,{indices:o,updates:i}=e,{shape:s}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=bl(i,o,s),h=!0,d=n.bufferSync(o),p=n.bufferSync(i),m=_a(d,p,s,f,u,l,a,c,0,h);return n.makeTensorInfo(s,m.dtype,m.values)}const fre={kernelName:jP,backendName:"cpu",kernelFunc:cre};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t,e){let n=0,r=t.length,o=0;for(;n<r;)o=Math.floor((n+r)/2),t[o]<e?n=o+1:r=o;return r}function dre(t,e){let n=0,r=t.length,o=0;for(;n<r;)o=Math.floor((n+r)/2),t[o]<=e?n=o+1:r=o;return r}function pre(t,e,n,r,o,i){const s=Bt("int32",n*o);for(let a=0;a<n;++a){const l=t.slice(a*r,(a+1)*r),u=a*o;for(let c=0;c<o;++c)s[u+c]=i==="left"?hre(l,e[c+u]):dre(l,e[c+u])}return s}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mre(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:o,values:i}=e,{side:s}=r,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values,u=pre(a,l,o.shape[0],o.shape[1],i.shape[1],s);return n.makeTensorInfo(i.shape,"int32",u)}const gre={kernelName:VP,backendName:"cpu",kernelFunc:mre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yre(t){const{inputs:e,backend:n}=t,{condition:r,t:o,e:i}=e;we([r,o,i],"select");const s=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values,c=$r(o.dtype,i.dtype),f=_n(Q(o.shape),c);let h=0;const d=s===0||s>1||o.shape.length===1?1:Q(o.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<d;m++)a[p]===1?f[h++]=l[p]:f[h++]=u[p];return n.makeTensorInfo(o.shape,c,f)}const vre={kernelName:Uv,backendName:"cpu",kernelFunc:yre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xre=l0,bre=u0,wre=it(Ld,t=>t>=0?bre*t:xre*(Math.exp(t)-1)),Sre={kernelName:Ld,backendName:"cpu",kernelFunc:wre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $re=it(jd,t=>t<0?-1:t>0?1:0),Cre={kernelName:jd,backendName:"cpu",kernelFunc:$re};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kre=it(Bd,t=>Math.sin(t)),Ire={kernelName:Bd,backendName:"cpu",kernelFunc:kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tre=it(zd,t=>Math.sinh(t)),Ere={kernelName:zd,backendName:"cpu",kernelFunc:Tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nre=11920928955078125e-23,GE=Math.log(Nre)+2,Are=it(Vd,t=>{const e=t>-GE,n=t<GE,r=Math.exp(t);let o;return n?o=r:e?o=t:o=Math.log(1+r),o}),Ore={kernelName:Vd,backendName:"cpu",kernelFunc:Are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockShape:i,paddings:s}=r;we([o],"spaceToBatchND");const a=Q(i),l=[[0,0]];l.push(...s);for(let S=1+i.length;S<o.shape.length;++S)l.push([0,0]);const u=yz.kernelFunc({inputs:{x:o},backend:n,attrs:{paddings:l,constantValue:0}}),c=op(u.shape,i,a,!1),f=ip(c.length,i.length,!1),h=sp(u.shape,i,a,!1),m=mt({inputs:{x:u},backend:n,attrs:{shape:c}}),v=ur({inputs:{x:m},backend:n,attrs:{perm:f}}),w=mt({inputs:{x:v},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),w}const Dre={kernelName:Kv,backendName:"cpu",kernelFunc:_re};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(t){const{inputs:e,backend:n}=t,{indices:r,values:o,denseShape:i,defaultValue:s}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values[0],[f,h,d,p,m]=VB(a,r.shape,r.dtype,l,o.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,f),n.makeTensorInfo([h[0]],o.dtype,d),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const Pre={kernelName:UP,backendName:"cpu",kernelFunc:Rre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mre(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:o,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${o.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const s=Array.from(n.data.get(o.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[u,c,f]=UB(a,r.shape,r.dtype,s,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([f.length],i.dtype,new Int32Array(f))]}const Fre={kernelName:GP,backendName:"cpu",kernelFunc:Mre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lre(t){const{inputs:e,backend:n}=t,{data:r,indices:o,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${o.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(o.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values,[u,c]=sI(s,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const Bre={kernelName:HP,backendName:"cpu",kernelFunc:Lre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zre(t){const{inputs:e,backend:n}=t,{data:r,indices:o,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${o.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(o.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values,[u,c]=sI(s,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const jre={kernelName:KP,backendName:"cpu",kernelFunc:zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wre(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:o,sparseValues:i,defaultValue:s}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:f,outputSize:h}=bl(i,o,a),d=!1,p=n.bufferSync(o);let m;switch(i.dtype){case"bool":{const g=n.bufferSync(i),y=!!n.data.get(s.dataId).values[0];m=_a(p,g,a,h,c,u,l,f,y,d);break}case"float32":{const g=n.bufferSync(i),y=n.data.get(s.dataId).values[0];m=_a(p,g,a,h,c,u,l,f,y,d);break}case"int32":{const g=n.bufferSync(i),y=n.data.get(s.dataId).values[0];m=_a(p,g,a,h,c,u,l,f,y,d);break}case"string":{const g=n.bufferSync(i),y=Us(n.data.get(s.dataId).values[0]);m=_a(p,g,a,h,c,u,l,f,y,d);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const Vre={kernelName:qP,backendName:"cpu",kernelFunc:Wre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ure(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{numOrSizeSplits:i,axis:s}=r,a=Fe(s,o.shape)[0],l=Ak(o,i,a),u=new Array(o.shape.length).fill(0),c=o.shape.slice();return l.map(f=>{const h=[...c];h[a]=f;const d=al({inputs:{x:o},backend:n,attrs:{begin:u,size:h}});return u[a]+=f,d})}const Gre={kernelName:qv,backendName:"cpu",kernelFunc:Ure};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hre={kernelName:mC,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;we(n,"square");const o=r.data.get(n.dataId).values,i=new Float32Array(o.length);for(let a=0;a<o.length;++a){const l=o[a];i[a]=l*l}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kre=it(Yd,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),qre={kernelName:Yd,backendName:"cpu",kernelFunc:Kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{begin:i,end:s,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:h}=r;we(o,"stridedSlice");const{finalShapeSparse:d,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:x,strides:b}=hk(o.shape,i,s,a,l,u,c,f,h);let w;if(m)w=mt({inputs:{x:o},backend:n,attrs:{shape:p}});else if(g||y){E(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);const S=uk(v,x,b),$=al({inputs:{x:o},backend:n,attrs:{begin:v,size:S}});w=mt({inputs:{x:$},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo($)}else{const S=n.bufferSync(o),$=KB(d,S,b,v);w=n.makeTensorInfo(p,$.dtype,$.values)}return w}const Yre={kernelName:yC,backendName:"cpu",kernelFunc:Xre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(t){const{inputs:e,backend:n,attrs:r}=t,{separator:o,nGramWidths:i,leftPad:s,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:f}=e,h=n.data.get(c.dataId).values,d=n.data.get(f.dataId).values,[p,m]=qB(h,d,o,i,s,a,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",m)]}const Zre={kernelName:XP,backendName:"cpu",kernelFunc:Qre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jre(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:o}=r,{input:i,delimiter:s}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values[0],[u,c,f]=XB(a,l,o),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const eoe={kernelName:YP,backendName:"cpu",kernelFunc:Jre};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function toe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:o}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const s=n.data.get(i.dataId).values,a=YB(s,o);return n.makeTensorInfo(i.shape,"int32",a)}const noe={kernelName:QP,backendName:"cpu",kernelFunc:toe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const roe=it(Kd,t=>Math.tan(t)),ooe={kernelName:Kd,backendName:"cpu",kernelFunc:roe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ioe=it(qd,t=>Math.tanh(t)),soe={kernelName:qd,backendName:"cpu",kernelFunc:ioe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aoe(t){const{inputs:e,backend:n}=t,{tensor:r,indices:o,updates:i}=e,{sliceRank:s,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=bl(i,o,r.shape),f=!1,h=n.bufferSync(o),d=n.bufferSync(i),p=n.bufferSync(r),m=_a(h,d,r.shape,c,l,a,s,u,p,f);return n.makeTensorInfo(r.shape,m.dtype,m.values)}const loe={kernelName:WP,backendName:"cpu",kernelFunc:aoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{reps:i}=r;we(o,"tile");const s=ZB(n.bufferSync(o),i);return n.makeTensorInfo(s.shape,s.dtype,s.values)}const coe={kernelName:Xd,backendName:"cpu",kernelFunc:uoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function foe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{k:i,sorted:s}=r;we(o,"topk");const a=n.data.get(o.dataId).values,[l,u]=ez(a,o.shape,o.dtype,i,s);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const hoe={kernelName:vC,backendName:"cpu",kernelFunc:foe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(t){const{inputs:e,attrs:n,backend:r}=t,{image:o,transforms:i}=e,{interpolation:s,fillMode:a,fillValue:l,outputShape:u}=n,[c,f,h,d]=o.shape,[p,m]=u??[f,h],g=[c,p,m,d],y=ke(o.shape),v=y[0],x=y[1],b=y[2],w=ke(g),S=w[0],$=w[1],C=w[2],k=On(o.dtype,Q(g));k.fill(l);const I=r.data.get(o.dataId).values,T=r.data.get(i.dataId).values;for(let _=0;_<c;++_){const D=i.shape[0]===1?T:T.subarray(_*8,_*8+8);for(let O=0;O<p;++O)for(let R=0;R<m;++R)for(let F=0;F<d;++F){let A;const P=D[6]*R+D[7]*O+1;if(P===0)continue;const z=(D[0]*R+D[1]*O+D[2])/P,U=(D[3]*R+D[4]*O+D[5])/P,H=HE(z,h,a),X=HE(U,f,a);switch(s){case"nearest":A=xoe(I,f,h,v,x,b,_,X,H,F,l);break;case"bilinear":A=boe(I,f,h,v,x,b,_,X,H,F,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${s}`)}const ne=_*S+O*$+R*C+F;k[ne]=A}return r.makeTensorInfo(g,o.dtype,k)}return{dataId:r.write(k,g,o.dtype),shape:o.shape,dtype:o.dtype}}const poe={kernelName:xC,backendName:"cpu",kernelFunc:doe};function HE(t,e,n){switch(n){case"reflect":return moe(t,e);case"wrap":return goe(t,e);case"nearest":return voe(t,e);case"constant":default:return yoe(t)}}function moe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return Xa(0,n,e-1)}function goe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return Xa(0,n,e-1)}function yoe(t,e){return t}function voe(t,e){return Xa(0,t,e-1)}function wf(t,e,n,r,o,i,s,a,l,u,c){const f=s*r+a*o+l*i+u;return 0<=a&&a<e&&0<=l&&l<n?t[f]:c}function xoe(t,e,n,r,o,i,s,a,l,u,c){const f=Math.round(a),h=Math.round(l);return wf(t,e,n,r,o,i,s,f,h,u,c)}function boe(t,e,n,r,o,i,s,a,l,u,c){const f=Math.floor(a),h=Math.floor(l),d=f+1,p=h+1,m=(p-l)*wf(t,e,n,r,o,i,s,f,h,u,c)+(l-h)*wf(t,e,n,r,o,i,s,f,p,u,c),g=(p-l)*wf(t,e,n,r,o,i,s,d,h,u,c)+(l-h)*wf(t,e,n,r,o,i,s,d,p,u,c);return(d-a)*m+(a-f)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:o}=n,{x:i}=e;we(i,"unique");const s=r.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:u}=tz(s,o,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const Soe={kernelName:bC,backendName:"cpu",kernelFunc:woe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $oe(t){const{inputs:e,backend:n,attrs:r}=t,{value:o}=e;let{axis:i}=r;i<0&&(i+=o.shape.length);const s=o.shape.length,a=o.shape[i],l=new Array(s-1);let u=0;for(let d=0;d<s;d++)d!==i&&(l[u++]=o.shape[d]);const c=new Array(s).fill(0),f=o.shape.slice();f[i]=1;const h=new Array(a);for(let d=0;d<h.length;d++){c[i]=d;const p=al({inputs:{x:o},backend:n,attrs:{begin:c,size:f}});h[d]=mt({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const Coe={kernelName:Yv,backendName:"cpu",kernelFunc:$oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,segmentIds:i}=e,{numSegments:s}=r;we(o,"unsortedSegmentSum");const a=o.shape.length,l=i.shape.length,u=[],c=[],f=a-l;let h=i;for(let p=0;p<f;++p){const m=_g({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,c.push(m)}for(let p=0;p<s;++p){const m=ea(p,"int32"),g=n.makeTensorInfo([],"int32",m),y=gB({inputs:{a:g,b:h},backend:n}),v=Xs({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),x=w0({inputs:{a:v,b:o},backend:n}),b=mp({inputs:{x},backend:n,attrs:{axis:0,keepDims:!1}});u.push(b),c.push(g),c.push(y),c.push(v),c.push(x),c.push(b)}const d=gz({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(p=>n.disposeIntermediateTensorInfo(p)),d}const Ioe={kernelName:Qv,backendName:"cpu",kernelFunc:koe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Toe=[wJ,tZ,$J,kJ,aZ,TJ,NJ,OJ,DJ,PJ,FJ,BJ,jJ,UJ,HJ,XJ,QJ,JJ,tee,xJ,ree,iee,aee,uZ,uee,iZ,fZ,fee,nZ,dee,mee,gee,vee,bee,See,Cee,Iee,Eee,Aee,_ee,Ree,Mee,Lee,zee,jee,Vee,Gee,Kee,qee,Xee,Yee,Zee,tte,hJ,rte,hZ,fte,dZ,hte,mZ,vte,xte,wte,yZ,xZ,$te,kte,Tte,Nte,wZ,$Z,rZ,Ote,pee,Dte,Pte,Fte,dJ,kZ,TZ,Bte,NZ,jte,Ute,Hte,Xte,Qte,Jte,ene,OZ,nne,one,sne,lne,cne,hne,pne,DZ,gne,xne,Sne,PZ,FZ,kne,Ene,One,BZ,Dne,Pne,Mne,yz,zne,mJ,WZ,Wne,Une,Hne,qne,oZ,rw,Yne,gJ,yJ,vJ,Zne,ere,nre,ore,sre,are,ure,YZ,fre,gre,vre,Sre,ZZ,Cre,Ire,Ere,JZ,bne,Ore,Dre,Pre,Fre,Bre,jre,Vre,Gre,nJ,Hre,oJ,sJ,qre,Yre,Zre,eoe,noe,cJ,Jee,ooe,soe,loe,coe,hoe,poe,zZ,Soe,Coe,Ioe,Rne];for(const t of Toe)JP(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ia={},tm={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Eoe(t,e){Ia[t]=e}function qo(t,e){if(!(t in Ia)||e!=null){const r=Aoe(t,e);if(r!==null)Ia[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Ia[t];return n==null||n.isContextLost()?(delete Ia[t],qo(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ia[t])}function Noe(t){if(!q().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Aoe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??Noe(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Ia[t]},!1),q().getBool("SOFTWARE_WEBGL_ENABLED")&&(tm.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",tm)||n.getContext("experimental-webgl",tm):n.getContext("webgl2",tm)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fh;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(fh||(fh={}));var Mr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Mr||(Mr={}));var xn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(xn||(xn={}));function gp(t,e){return[e,t]}function Ooe(t,e){return t*e}function nm(t){const e=Q(t),n=Math.ceil(e/4);return k1(n)}function $c(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function _oe(t,e){const[n,r]=$c(t,e);return n*r*4}function fI(t,e){const n=t;let r,o,i,s,a,l,u,c,f,h;return q().getNumber("WEBGL_VERSION")===2?(r=n.R32F,o=n.R16F,i=n.RGBA16F,s=n.RGBA32F,a=n.RED,u=4,c=1,f=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=t.RGBA,o=t.RGBA,i=t.RGBA,s=n.RGBA,a=t.RGBA,u=4,c=4,f=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:s,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function me(t,e){const n=e();return q().getBool("DEBUG")&&Doe(t),n}function Doe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+Foe(t,e))}const Roe=596e-10,Poe=65504;function Moe(t){return!!(q().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||Roe<Math.abs(t)&&Math.abs(t)<Poe)}function Foe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function rm(t,e){return ss(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Loe(t,e){const n=ss(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(me(t,()=>t.shaderSource(n,e)),me(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Boe(t,e){const n=ss(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(me(t,()=>t.shaderSource(n,e)),me(t,()=>t.compileShader(n)),q().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw vz(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const zoe=/ERROR: [0-9]+:([0-9]+):/g;function vz(t,e){const n=zoe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],o=t.split(`
`),i=o.length.toString().length+2,s=o.map((f,h)=>du((h+1).toString(),i)+f);let a=0;for(let f=0;f<s.length;f++)a=Math.max(s[f].length,a);const l=s.slice(0,r-1),u=s.slice(r-1,r),c=s.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${du(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function joe(t){return ss(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function Woe(t,e){if(me(t,()=>t.linkProgram(e)),!q().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Qx(t,e){if(me(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Voe(t,e){const n=ss(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return me(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),me(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Uoe(t,e){const n=ss(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return me(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),me(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Goe(t){return ss(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function Hoe(t,e){const n=q().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,o=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+o+".")}}function Koe(t){return ss(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function KE(t,e,n,r,o,i,s){const a=t.getAttribLocation(e,n);return a===-1?!1:(me(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),me(t,()=>t.vertexAttribPointer(a,o,t.FLOAT,!1,i,s)),me(t,()=>t.enableVertexAttribArray(a)),!0)}function qoe(t,e,n){Joe(t,n),me(t,()=>t.activeTexture(t.TEXTURE0+n)),me(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Xoe(t,e,n){return ss(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Yoe(t,e,n){return t.getUniformLocation(e,n)}function Qoe(t,e,n,r){me(t,()=>qoe(t,e,r)),me(t,()=>t.uniform1i(n,r))}function Zx(t,e,n){me(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),me(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function qE(t,e){me(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),me(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function om(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Zoe(t,e))}function Zoe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function ss(t,e,n){const r=me(t,()=>e());if(r==null)throw new Error(n);return r}function Joe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const o=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${o}.`)}}function ju(t,e=2){return Q(t.slice(0,t.length-e))}function Wu(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function im(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[ju(t),...Wu(t)]),e}function eie(t,e=!1){let n=q().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=q().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&q().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?N$(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Js(t).newShape);let o=Q(t),i=null;t.length<=1&&o<=n?i=[1,o]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const s=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||s)if(e){const a=ju(t);let l=2,u=2;t.length&&([l,u]=Wu(t)),o=a*(l/2)*(u/2),i=k1(o).map(c=>c*2)}else i=k1(o);return i}function sm(t){return t%2===0}function Rg(t,e){if(t=t.slice(-2),e=e.slice(-2),et(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||sm(n)&&sm(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&sm(t[0])&&sm(e[0])}let Jx,eb;function tie(t){if(Jx==null){const e=qo(t);Jx=e.getParameter(e.MAX_TEXTURE_SIZE)}return Jx}function nie(t){if(eb==null){const e=qo(t);eb=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,eb)}function rie(t){if(t===0)return 0;let e;const n=qo(t);return ao(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:ao(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function ao(t,e){return t.getExtension(e)!=null}function XE(t){try{if(qo(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function oie(t){if(t===0)return!1;const e=qo(t);if(t===1){if(!ao(e,"OES_texture_float"))return!1}else if(!ao(e,"EXT_color_buffer_float"))return!1;return iw(e)}function iie(t){if(t===0)return!1;const e=qo(t);if(t===1){if(!ao(e,"OES_texture_float")||!ao(e,"WEBGL_color_buffer_float"))return!1}else{if(ao(e,"EXT_color_buffer_float"))return iw(e);const r="EXT_color_buffer_half_float";if(ao(e,r)){const o=e.getExtension(r);return sie(e,o)}return!1}return iw(e)}function iw(t){const e=fI(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),s}function sie(t,e){const n=fI(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(s),a}function aie(t){return t!==2?!1:qo(t).fenceSync!=null}function yp(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&E(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Se=q();Se.registerFlag("HAS_WEBGL",()=>Se.getNumber("WEBGL_VERSION")>0);Se.registerFlag("WEBGL_VERSION",()=>XE(2)?2:XE(1)?1:0);Se.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Se.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Se.get("WEBGL_VERSION")===2);Se.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Se.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Se.registerFlag("WEBGL_PACK",()=>Se.getBool("HAS_WEBGL"));Se.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_CLIP",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_REDUCE",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_LAZILY_UNPACK",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_CONV_IM2COL",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>tie(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>nie(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Se.getNumber("WEBGL_VERSION");return t===0?0:rie(t)});Se.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Se.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!gM());Se.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>oie(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Se.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Se.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Se.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>iie(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_FENCE_API_ENABLED",()=>aie(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Se.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Se.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Se.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>gM()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Se.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Se.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Se.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Se.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Se.registerFlag("WEBGL_EXP_CONV",()=>!1);Se.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Se.getBool("IS_TEST"));Se.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Se.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Se.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Se.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jn(){let t,e,n,r,o,i,s,a,l,u;return q().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",o="texture",i="outputColor",s="out vec4 outputColor;",a=q().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",s="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $l(t,e,n="index"){const r=ke(e);return r.map((o,i)=>{const s=`int ${t[i]} = ${n} / ${o}`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${o}`:`index -= ${t[i]} * ${o}`;return`${s}; ${a};`}).join("")}function S0(t,e,n="index"){const r=ke(e);return r.map((o,i)=>{const s=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${s}; ${a};`}).join("")}function lie(t,e){const n=t.length,r=t.map(i=>`${e}[${i}]`),o=new Array(n-1);o[n-2]=r[n-1];for(let i=n-3;i>=0;--i)o[i]=`(${o[i+1]} * ${r[i+1]})`;return o}function uie(t,e,n="index"){const r=t.map((i,s)=>s),o=lie(r,e);return o.map((i,s)=>{const a=`int ${t[s]} = ${n} / ${o[s]}`,l=s===o.length-1?`int ${t[s+1]} = ${n} - ${t[s]} * ${o[s]}`:`index -= ${t[s]} * ${o[s]}`;return`${a}; ${l};`}).join("")}function hI(t){const e=ke(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function dI(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const xz=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:bz}=YX;function cie(t,e,n){const r=[];if(t.forEach(d=>{const p=Q(d.shapeInfo.logicalShape);if(d.shapeInfo.isUniform?r.push(`uniform float ${d.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${d.name};`),r.push(`uniform int offset${d.name};`)),n.enableShapeUniforms){const{uniformShape:m}=pI(n.packedInputs,d.shapeInfo.logicalShape,d.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${d.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${d.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${d.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${d.name}Shape;`);break}r.push(`uniform ivec2 ${d.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(d=>{r.push(`uniform ${d.type} ${d.name}${d.arrayIndex?`[${d.arrayIndex}]`:""};`)});const o=r.join(`
`),i=t.map(d=>fie(d,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),s=e.texShape,a=Jn(),l=pie(a);let u,c,f=yie(a);return e.isPacked?(u=hie(e.logicalShape,s,n.enableShapeUniforms),c=gie(a)):(u=die(e.logicalShape,s,n.enableShapeUniforms),c=mie(a)),n.packedInputs&&(f+=wie),[f,l,c,o,u,i,n.userCode].join(`
`)}function Cc(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return Die(t,e);case 1:return Pie(t,e);case 2:return Fie(t,e);case 3:return Bie(t,e);case 4:return jie(t,e);case 5:return Wie(t);case 6:return Vie(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function wz(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return _ie(t);case 1:return Rie(t,e);case 2:return Mie(t,e);case 3:return Lie(t,e);default:return zie(t,e)}}function fie(t,e,n=!1,r){let o="";n?o+=wz(t,r):o+=Cc(t,r);const i=t.shapeInfo.logicalShape,s=e.logicalShape;return i.length<=s.length&&(n?o+=Uie(t,e):o+=Gie(t,e)),o}function hie(t,e,n){switch(t.length){case 0:return Sz();case 1:return Sie(t,e,n);case 2:return Aie(t,e,n);case 3:return Cie(t,e,n);default:return Iie(t,e,n)}}function die(t,e,n){switch(t.length){case 0:return Sz();case 1:return $ie(t,e,n);case 2:return Oie(t,e,n);case 3:return kie(t,e,n);case 4:return Tie(t,e,n);case 5:return Eie(t,e);case 6:return Nie(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function pie(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function mie(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function gie(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function yie(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${vie}
    ${xie}
    ${bie}
  `}const vie=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,xie=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,bie=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,wie=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Sz(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Sie(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function $ie(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Cie(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(t[2]/2),i=o*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec3(b, r, c);
    }
  `}function kie(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${S0(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=$l(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Iie(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(t[t.length-1]/2),i=o*Math.ceil(t[t.length-2]/2);let s=i,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)s*=t[t.length-u-1],a=`
      int b${u} = index / ${s};
      index -= b${u} * ${s};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec${t.length}(${l});
    }
  `}function Tie(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${S0(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=$l(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function Eie(t,e){const n=$l(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Nie(t,e){const n=$l(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Aie(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(et(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const o=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec2(r, c);
    }
  `}function Oie(t,e,n){return et(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Cl(t){return`offset${t}`}function _ie(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Jn();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function Die(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[o,i]=t.shapeInfo.texShape;if(o===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const s=Cl(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${s});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${s});
      return sampleTexture(${n}, uv);
    }
  `}function Rie(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t.shapeInfo.texShape,i=Jn();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${s[0]}, ${s[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function Pie(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${kc(t)}
      }
    `;const o=t.shapeInfo.texShape,i=o[0],s=o[1];if(s===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Cl(n);return s===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${s}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${s}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function Mie(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,s=i[0],a=i[1],l=Jn();if(i!=null&&et(n,i))return e?`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${s}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${o}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${o}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function Fie(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(i!=null&&et(n,i)){if(e)return`
      float ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=i[0],d=i[1];return`
    float ${o}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:s,keptDims:a}=Js(n),l=s;if(l.length<n.length){const h=Ic(t,l),d=["row","col"];return`
      ${Cc(h,e)}
      float ${o}(int row, int col) {
        return ${o}(${Tc(d,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${kc(t)}
      }
    `;const u=i[0],c=i[1],f=Cl(r);return c===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${o}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${o}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${f};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function Lie(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const h=n.slice(1),d=[1,2],p=Ic(t,h),m=["b","row","col"];return`
        ${wz(p,e)}
        vec4 ${o}(int b, int row, int col) {
          return ${o}(${Tc(m,d)});
        }
      `}const a=Jn();if(e)return`
    vec4 ${o}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=s[0],u=s[1],c=Math.ceil(n[2]/2),f=c*Math.ceil(n[1]/2);return`
    vec4 ${o}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${f}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function Bie(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],s=n[2],{newShape:a,keptDims:l}=Js(n),u=a;if(u.length<n.length){const m=Ic(t,u),g=["row","col","depth"];return`
        ${Cc(m,e)}
        float ${o}(int row, int col, int depth) {
          return ${o}(${Tc(g,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${s}, 1)));
        ${kc(t)}
      }
    `;const c=t.shapeInfo.texShape,f=c[0],h=c[1],d=t.shapeInfo.flatOffset;if(h===i&&d==null)return e?`
      float ${o}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${o}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${s}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${f}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===s&&d==null)return e?`
      float ${o}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Cl(r);return e?`
    float ${o}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${o}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${s} + depth + ${p};
        vec2 uv = uvFromFlat(${f}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function zie(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=Jn();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${o.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,s=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],f=Math.ceil(i[s-1]/2);let h=f*Math.ceil(i[s-2]/2),d="int b, int row, int col",p=`b * ${h} + (row / 2) * ${f} + (col / 2)`;for(let m=2;m<s-1;m++)d=`int b${m}, `+d,h*=i[s-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${r}(${d}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${o.texture2D}(${n}, uv);
    }
  `}function jie(t,e){const n=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],s=n[2]*i,a=n[1]*s,{newShape:l,keptDims:u}=Js(n);if(l.length<n.length){const v=Ic(t,l),x=["row","col","depth","depth2"];return`
      ${Cc(v,e)}
      float ${o}(int row, int col, int depth, int depth2) {
        return ${o}(${Tc(x,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${s}, ${i}, 1)));
        ${kc(t)}
      }
    `;const c=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,h=f[0],d=f[1],p=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(d===a&&c==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${s}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(d===i&&c==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const y=Cl(r);return e?`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${s} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${h}, ${d}, index + ${y});
      return sampleTexture(${r}, uv);
    }
  `}function Wie(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e[4],i=e[3]*o,s=e[2]*i,a=e[1]*s,{newShape:l,keptDims:u}=Js(e);if(l.length<e.length){const m=Ic(t,l),g=["row","col","depth","depth2","depth3"];return`
      ${Cc(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Tc(g,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${s}, ${i}, ${o})) +
          depth3;
        ${kc(t)}
      }
    `;const c=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,h=f[0],d=f[1];if(d===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${s}, ${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(d===o&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Cl(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${s} + depth * ${i} +
          depth2 * ${o} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${d}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Vie(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:o,keptDims:i}=Js(e);if(o.length<e.length){const g=Ic(t,o),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${Cc(g)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Tc(y,i)});
      }
    `}const s=e[5],a=e[4]*s,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${s}, 1)));
        ${kc(t)}
      }
    `;const f=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],p=h[1];if(p===c&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${s})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===s&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Cl(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${s} + depth4 + ${m};
      vec2 uv = uvFromFlat(${d}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function kc(t){const e=t.name,n=Q(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Uie(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),o="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,s=e.logicalShape.length,a=bz(t.shapeInfo.logicalShape,e.logicalShape),l=at(s),u=s-i;let c;const f=["x","y","z","w","u","v"];i===0?c="":s<2&&a.length>=1?c="coords = 0;":c=a.map(v=>`coords.${f[v+u]} = 0;`).join(`
`);let h="";s<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((v,x)=>`coords.${f[x+u]}`).join(", ");let d="return outputValue;";const m=Q(t.shapeInfo.logicalShape)===1,y=Q(e.logicalShape)===1;if(i===1&&!m&&!y)d=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!y)s===1?d=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:d=`
        return vec4(outputValue.x);
      `;else if(a.length){const v=i-2,x=i-1;a.indexOf(v)>-1&&a.indexOf(x)>-1?d="return vec4(outputValue.x);":a.indexOf(v)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(x)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${o}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${h});
      ${d}
    }
  `}function Gie(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),o="get"+r+"AtOutCoords",i=e.texShape,s=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&et(s,i))return`
      float ${o}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=at(l),c=bz(t.shapeInfo.logicalShape,e.logicalShape),f=l-a;let h;const d=["x","y","z","w","u","v"];a===0?h="":l<2&&c.length>=1?h="coords = 0;":h=c.map(m=>`coords.${d[m+f]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,g)=>`coords.${d[g+f]}`).join(", "),`
    float ${o}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${r}(${p});
    }
  `}function at(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function pI(t,e,n){const{newShape:r,keptDims:o}=Js(e),i=e.length,s=t&&i===3&&e[0]===1,a=s?e.slice(1):r,l=!t&&i>1&&!et(e,n)&&r.length<i||s;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:o}}function Ic(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Tc(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hie(t,e,n,r){const o=n.map((c,f)=>{const h={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(h.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[f],shapeInfo:h}}),i=o.map(c=>c.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=cie(o,s,e),l=Boe(t.gl,a),u=t.createProgram(l);return q().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:i,outShapeInfo:s},$z(t,e,u)))}function $z(t,e,n){const r=[],o=[];let i,s,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),q().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const f of e.variableNames){const h={name:f,uniform:t.getUniformLocation(n,f,c),offset:t.getUniformLocation(n,`offset${f}`,c)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${f}Shape`,c),h.texShape=t.getUniformLocation(n,`${f}TexShape`,c)),r.push(h)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),s=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const f of e.customUniforms)o.push(t.getUniformLocation(n,f.name,c));return{variablesLocations:r,customUniformLocations:o,infLoc:l,nanLoc:u,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:s}}function YE(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const o=n.logicalShape,i=e[r],s=i.shape;if(!et(o,s))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${o} and ${s} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!et(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Kie(t,e,n,r,o){e.program.enableShapeUniforms||(YE(e.inShapeInfos,n),YE([e.outShapeInfo],[r]));const i=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,s[0],s[1]):t.setOutputMatrixTexture(i.texture,s[0],s[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),q().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:f,shape:h,texShape:d}=e.variablesLocations[l];if(h){const{uniformShape:p}=pI(e.program.packedInputs,u.shape,u.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(h,new Int32Array(p));break;case 2:t.gl.uniform2iv(h,new Int32Array(p));break;case 3:t.gl.uniform3iv(h,new Int32Array(p));break;case 4:t.gl.uniform4iv(h,new Int32Array(p));break}}if(d&&t.gl.uniform2i(d,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(Q(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let p=u.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(c,p)}continue}u.texData.slice!=null&&f!=null&&t.gl.uniform1i(f,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=ke(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&o)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],f=o[l];if(u.type==="float")t.gl.uniform1fv(c,f);else if(u.type==="vec2")t.gl.uniform2fv(c,f);else if(u.type==="vec3")t.gl.uniform3fv(c,f);else if(u.type==="vec4")t.gl.uniform4fv(c,f);else if(u.type==="int")t.gl.uniform1iv(c,f);else if(u.type==="ivec2")t.gl.uniform2iv(c,f);else if(u.type==="ivec3")t.gl.uniform3iv(c,f);else if(u.type==="ivec4")t.gl.uniform4iv(c,f);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function qie(t,e,n){let r="";e.concat(n).forEach(s=>{const a=s.texData!=null&&s.texData.slice!=null&&s.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!s.isUniform){const l=s.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:f}=pI(t.packedInputs,s.shape,l);let h="",d="",p="";if(c.length===1&&t.packedInputs){const w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${w[0]>1}_${w[1]>1}`}else if(c.length===2&&!t.packedInputs)d=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const w=ke(c);p=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}const m=s.shape.length,g=c.length===2&&et(s.shape,l),y=Q(s.shape)===1,v=Ru(s.shape,n.shape),x=!t.packedInputs&&m===n.shape.length&&et(l,n.texData.texShape),b=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${x}_${u?f:""}_${c.length}_${y}_${v}_${g}_${h}_${d}_${p}_${b}_${a}`}else{const l=s.isUniform?"uniform":s.texData.texShape;r+=`${s.shape}_${l}_${a}`}});const o=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+o+`${q().getNumber("WEBGL_VERSION")}`,i}function Mn(t){return q().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xie{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=fh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Jn();this.outputShape=e,this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?S0(["r","c","d"],e):$l(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yie{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=fh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Jn();this.outputShape=e,this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?S0(["r","c","d"],e):$l(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qie{constructor(e){this.variableNames=["A"],this.outTexUsage=Mr.DOWNLOAD;const n=Jn();this.outputShape=e,this.userCode=`
      ${xz}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zie{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Mr.DOWNLOAD;const n=Jn();this.outputShape=e,this.userCode=`
      ${xz}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jie={R:0,G:1,B:2,A:3};class QE{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const o=Jn();this.outputShape=e,this.enableShapeUniforms=Mn(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let s="";for(let a=0;a<r.length;a++){const l=r[a];s+=`
          if(offset == ${a}) {
            result = values[${Jie[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?dI():hI(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${o.texture2D}(A, uv);
          ${s}
        }
        ${o.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ese{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Jn();this.outputShape=e,this.enableShapeUniforms=Mn(this.outputShape.length);let o="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let s=0;s<=1;s++)for(let a=0;a<=1;a++){const l=s*2+a;o+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${s} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${s};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?dI():hI(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${o}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tse(t){const e=Jn(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Loe(t,n)}function nse(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Voe(t,e)}function rse(t){const e=new Uint16Array([0,1,2,2,1,3]);return Uoe(t,e)}function vp(t,e,n,r,o,i){Hoe(e,n);const s=Goe(t),a=t.TEXTURE_2D;return me(t,()=>t.bindTexture(a,s)),me(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),me(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),me(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),me(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),q().getNumber("WEBGL_VERSION")===1?me(t,()=>t.texImage2D(a,0,r,e,n,0,o,i,null)):me(t,()=>t.texStorage2D(a,1,r,e,n)),me(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:s,texShape:[n,e]}}function Cz(t){return t.internalFormatFloat}function ose(t,e,n,r){const[o,i]=gp(e,n);return vp(t,o,i,Cz(r),r.textureFormatFloat,t.FLOAT)}function kz(t){return t.internalFormatHalfFloat}function ise(t,e,n,r){const[o,i]=gp(e,n);return vp(t,o,i,kz(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function Iz(t){return t.downloadTextureFormat}function sse(t,e,n,r){const[o,i]=gp(e,n);return vp(t,o,i,Iz(r),t.RGBA,t.UNSIGNED_BYTE)}function Tz(t){return t.internalFormatPackedFloat}function ase(t,e,n,r){const[o,i]=$c(e,n);return vp(t,o,i,Tz(r),t.RGBA,t.FLOAT)}function Ez(t){return t.internalFormatPackedHalfFloat}function lse(t,e,n,r){const[o,i]=$c(e,n);return vp(t,o,i,Ez(r),t.RGBA,r.textureTypeHalfFloat)}function use(t,e,n){return me(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),KE(t,e,"clipSpacePos",n,3,20,0)&&KE(t,e,"uv",n,2,20,12)}function cse(t,e,n,r,o,i){me(t,()=>t.bindTexture(t.TEXTURE_2D,e));let s,a,l;o instanceof Uint8Array?(s=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(s=new Float32Array(n*r*4),a=t.FLOAT,l=i.internalFormatPackedFloat),s.set(o),q().getNumber("WEBGL_VERSION")===2?me(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,s)):me(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,s)),me(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function fse(t,e,n){me(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?q().getNumber("WEBGL_VERSION")===2?me(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):me(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):q().getNumber("WEBGL_VERSION")===2?me(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):me(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),me(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function hse(t,e,n,r){const o=t.createBuffer();me(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,o));const a=4*4*e*n;return me(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),me(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),me(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),o}function dse(t,e,n){const r=t,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function pse(t,e,n,r){const[o,i]=gp(e,n),s=4,a=new Uint8Array(Ooe(e*n,s));return me(t,()=>t.readPixels(0,0,o,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function mse(t,e,n,r,o,i,s,a){const l=t,u=new Float32Array(_oe(i,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function gse(t,e,n){const r=new Float32Array(e*n*4);return me(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tb{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=q().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Eoe(n,e)):this.gl=qo(n),e=this.gl,q().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>me(i,()=>i.createVertexArray()),this.bindVertexArray=s=>me(i,()=>i.bindVertexArray(s)),this.deleteVertexArray=s=>me(i,()=>i.deleteVertexArray(s)),this.getVertexArray=()=>me(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>me(e,()=>i.createVertexArrayOES()),this.bindVertexArray=s=>me(e,()=>i.bindVertexArrayOES(s)),this.deleteVertexArray=s=>me(e,()=>i.deleteVertexArrayOES(s)),this.getVertexArray=()=>me(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),q().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",s="OES_texture_half_float";if(this.textureFloatExtension=rm(this.gl,i),ao(this.gl,s))this.textureHalfFloatExtension=rm(this.gl,s);else if(q().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ao(this.gl,o))this.colorBufferHalfFloatExtension=rm(this.gl,o);else if(q().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ao(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(ao(this.gl,o))this.colorBufferHalfFloatExtension=this.gl.getExtension(o);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=nse(this.gl),this.indexBuffer=rse(this.gl),this.framebuffer=Koe(this.gl),this.textureConfig=fI(this.gl,this.textureHalfFloatExtension)}get debug(){return q().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;me(e,()=>e.finish()),me(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),me(e,()=>e.deleteFramebuffer(this.framebuffer)),me(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),me(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),me(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),ose(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),ise(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),sse(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),fse(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,o){this.throwIfDisposed(),cse(this.gl,e,n,r,o,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),lse(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),ase(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(qE(this.gl,this.framebuffer),this.outputTexture=null),me(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>pse(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,o,i,s){return mse(this.gl,e,n,r,o,i,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return dse(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const o=hse(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(q().getBool("WEBGL_FENCE_API_ENABLED")){const o=e,i=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const s=o.clientWaitSync(i,0,0);return s===o.ALREADY_SIGNALED||s===o.CONDITION_SATISFIED},n=i}else q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>gse(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=tse(n));const r=joe(n);me(n,()=>n.attachShader(r,this.vertexShader)),me(n,()=>n.attachShader(r,e)),Woe(n,r);const o=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&Qx(n,o),o}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;me(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),use(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(me(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Qx(this.gl,this.program),me(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?Xoe(this.gl,e,n):Yoe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),me(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),Qoe(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[o,i]=$c(n,r);this.setOutputMatrixTextureDriver(e,o,i)}setOutputMatrixWriteRegion(e,n,r,o){this.setOutputMatrixWriteRegionDriver(r,e,o,n)}setOutputPackedMatrixWriteRegion(e,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Qx(this.gl,this.program),om(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}me(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),me(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=rm(this.gl,q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(o.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await F2(()=>this.disposed||this.isQueryAvailable(e,q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),o=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=yse(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in q().platform&&(r=q().platform.setTimeoutCustom.bind(q().platform)),F2(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Zx(this.gl,e,this.framebuffer),this.debug&&om(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Zx(this.gl,this.outputTexture,this.framebuffer),this.debug&&om(this.gl)):qE(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const o=this.gl;Zx(o,e,this.framebuffer),this.debug&&om(o),this.outputTexture=e,me(o,()=>o.viewport(0,0,n,r)),me(o,()=>o.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,o){this.throwIfDisposed(),me(this.gl,()=>this.gl.scissor(e,n,r,o))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function yse(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:vse,bincountImpl:Nz,bincountReduceImpl:xse,bitwiseAndImpl:bse,castImpl:wse,ceilImpl:Sse,concatImpl:$se,equalImpl:Cse,expImpl:kse,expm1Impl:Ise,floorImpl:Tse,gatherNdImpl:Ese,gatherV2Impl:Nse,greaterImpl:Ase,greaterEqualImpl:Ose,lessImpl:_se,lessEqualImpl:Dse,linSpaceImpl:Rse,logImpl:Pse,maxImpl:Mse,maximumImpl:Fse,minimumImpl:Lse,multiplyImpl:Bse,negImpl:zse,notEqualImpl:jse,prodImpl:Wse,raggedGatherImpl:Vse,raggedRangeImpl:Use,raggedTensorToTensorImpl:Gse,rangeImpl:Hse,rsqrtImpl:Kse,scatterImpl:qse,sigmoidImpl:Xse,simpleAbsImpl:Az,sliceImpl:Yse,sparseFillEmptyRowsImpl:Qse,sparseReshapeImpl:Zse,sparseSegmentReductionImpl:Oz,sqrtImpl:Jse,staticRegexReplaceImpl:eae,stridedSliceImpl:tae,stringNGramsImpl:nae,stringSplitImpl:rae,stringToHashBucketFastImpl:oae,subImpl:iae,tileImpl:sae,topKImpl:aae,transposeImpl:mI,uniqueImpl:lae}=fJ;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _z(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Xn(t,e){return e===1?[t]:_z(t,e)}function uae(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cae{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Mn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Xn("rc",this.rank),r=at(this.rank),o=this.getOutOfBoundsCondition(n),i=this.getSetup(n),s=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${o}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${s}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let o=0;o<=1;o++){let i=`${r===0?"r":"rp1"}, ${o===0?"c":"cp1"}`;for(let s=2;s<this.rank;s++)i=`${e[e.length-1-s]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],o=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${o};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dz{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Mn(this.outputShape.length);let r="";for(let o=0;o<4;o++){let i="thisRC = rc;";o%2===1&&(i+="thisRC.z += 1;"),o>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${o>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${o}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${o>0?"}":""}
      `}this.userCode=`
      ${fae(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?dI():hI(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function fae(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?uie(["r","c","d"],"inputShape"):$l(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hae{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const o=JE(n,r),i=eN(e,o,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const s=ZE(e,o,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return o===xn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===xn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===xn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===xn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===xn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),a}releaseTexture(e,n,r,o){if(this.freeTextures==null)return;const i=JE(r,o),s=eN(n,i,o);s in this.freeTextures||(this.freeTextures[s]=[]);const a=ZE(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,o),l=q().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[s].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[s],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function dae(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function ZE(t,e,n,r,o){const i=pae(e,r);let s;if(o){const[l,u]=$c(t[0],t[1]);s=l*u}else{const[l,u]=gp(t[0],t[1]);s=l*u}const a=dae(n,i);return s*a}function pae(t,e){switch(t){case xn.PACKED_2X2_FLOAT32:return Tz(e);case xn.PACKED_2X2_FLOAT16:return Ez(e);case xn.UNPACKED_FLOAT32:return Cz(e);case xn.UNPACKED_FLOAT16:return kz(e);case xn.PACKED_4X1_UNSIGNED_BYTE:return Iz(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function mae(t){return q().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?xn.PACKED_2X2_FLOAT32:xn.UNPACKED_FLOAT32:t?xn.PACKED_2X2_FLOAT16:xn.UNPACKED_FLOAT16}function JE(t,e){if(t===Mr.UPLOAD)return xn.PACKED_2X2_FLOAT32;if(t===Mr.RENDER||t==null)return mae(e);if(t===Mr.DOWNLOAD||t===Mr.PIXELS)return xn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function eN(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ai{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const bo="if (isnan(x)) return x;",gae="return x;",tN="return abs(x);",yae="return (x >= 0.0) ? x : (exp(x) - 1.0);",vae=bo+`
  return (x < 0.0) ? 0.0 : x;
`,xae=bo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,gs="return x;",bae="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wae="return x;",Sae=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,$ae=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Cae=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,kae="return 1.0 / (1.0 + exp(-1.0 * x));";class ks{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Mn(this.outputShape.length);const n=e.length,r=Xn("rc",n),o=at(n),i=uae(n,r),s=r.slice(-2),a=n<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`
      void main() {
        ${o} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tae=iF,Eae=1e-7,Nae=1e-4,am={};function Aae(t){return t in am||(am[t]={}),am[t]}const Oae=q().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),_ae=600;function Dae(){return q().global.screen==null?1024:q().global.screen.height*q().global.screen.width*window.devicePixelRatio*_ae/1024/1024}class $0 extends E${nextDataId(){return $0.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!q().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof tb)n=e;else{const r=qo(q().getNumber("WEBGL_VERSION"),e);n=new tb(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=qo(q().getNumber("WEBGL_VERSION"));n=new tb(r),this.binaryCache=Aae(q().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new hae(this.gpgpu),this.numMBBeforeWarning=Dae(),this.texData=new kP(this,ti())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,o,i,s){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[o,i]},l.texShape=[o,i];const u=im(n),c=new QE(u,!1,s),f=this.runWebGLProgram(c,[a],r,[[o,i]]);return f.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),f.dataId}write(e,n,r){if((q().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||q().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const o={id:this.nextDataId()};return this.texData.set(o,{shape:n,dtype:r,values:e,usage:Mr.UPLOAD,refCount:1}),o}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,o,i){if(q().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:o,values:n,usage:Mr.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:o,complexTensorInfos:i,slice:s,shape:a,isPacked:l}=n;if(s!=null){let h;l?h=new ks(a,gs):h=new ai(a,gs);const d=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:o}],o),p=this.readSync(d.dataId);return this.disposeIntermediateTensorInfo(d),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(o==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=nr());let f;if(o==="complex64"){const h=this.readSync(i.real.dataId),d=this.readSync(i.imag.dataId);f=Yi(h,d)}else f=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=nr()-c),this.convertAndCacheOnCPU(e,f)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:r,shape:o,slice:i,dtype:s,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new ks(o,gs):p=new ai(o,gs);const m=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:s}],s),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(r!=null)return this.convertAndCacheOnCPU(e);if(q().getBool("DEBUG")&&!q().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&q().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(s!=="complex64"&&q().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...nm(o))}this.pendingRead.set(e,[]),s!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(s==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],g=p[1];f=Yi(m,g)}else if(u==null)f=this.getValuesFromTexture(e);else{const p=Q(o);f=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;me(p,()=>p.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(e,f),d=this.pendingRead.get(e);return this.pendingRead.delete(e),d.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ti().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const r=this.texData.get(e),{values:o,shape:i,slice:s,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(s!=null){let d;l?d=new ks(i,gs):d=new ai(i,gs);const p=this.runWebGLProgram(d,[{dataId:e,shape:i,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(u==null)throw o!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),f=ti().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:f},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(o=>Us(o));return Me(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Me(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!Moe(r))throw q().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:o}=this.texData.get(e),i=Q(n);if(q().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),d=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(d.texture.texture,...nm(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(h),p}const s=q().getBool("WEBGL_PACK")&&o===!0,a=s?im(n):n,l=s?new Zie(a):new Qie(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),f}timerAvailable(){return q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let o=!1;this.programTimersStack==null?(this.programTimersStack=r,o=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=Ya(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),s=Ya(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,o&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=yH(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:s[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:nr(),endMs:null}}endTimer(e){return q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=nr(),e)}async getQueryTime(e){if(q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:o,usage:i,isPacked:s,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(o,r),this.textureManager.releaseTexture(n,o,i,s)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=Oae){return q().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&Q(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Dr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return Tae(e.shape,n)}packedUnaryOp(e,n,r){const o=new ks(e.shape,n),i=this.compileAndRun(o,[e],r);return ti().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const o=Az(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,o)}if(q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,tN,e.dtype);const n=new ai(e.shape,tN),r=this.compileAndRun(n,[e]);return ti().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let o;if(n==="string"&&r!=null&&r.length>0&&td(r[0])){const i=r.map(s=>Fs(s));o=this.write(i,e,n)}else o=this.write(r,e,n);return this.texData.get(o).usage=null,{dataId:o,shape:e,dtype:n}}makeOutput(e,n,r){return ti().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new Iae(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new cae(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[ju(e.shape),...Wu(e.shape)],o={dtype:e.dtype,shape:r,dataId:e.dataId},i=[ju(n),...Wu(n)],s=new Dz(i,r),a=!0,l=[r],u=this.runWebGLProgram(s,[o],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:o,shape:i,dtype:s}=r;if(n!=null){const h=Q(i),d=n[0]*n[1]*4;E(h<=d,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=im(i);let l;o?l=new Yie(a):l=new Xie(a);const u=!0,c=[n??nm(a)],f=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],s,c,u,n);return{dtype:s,shape:i,dataId:f.dataId}}runWebGLProgram(e,n,r,o,i=!1,s){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===fh.DENSE){const y=s??nm(e.outputShape);l.texShape=y.map(v=>v*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Q(a.shape)===0)return l.values=On(a.dtype,0),a;const u=[],c=n.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(y.dataId);if(v.texture==null){if(!e.packedInputs&&Q(y.shape)<=q().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!v.isPacked!=!!e.packedInputs)y=v.isPacked?this.unpackTensor(y):this.packTensor(y),u.push(y),v=this.texData.get(y.dataId);else if(v.isPacked&&!Rg(v.shape,y.shape)){const x=y,b=y.shape;y.shape=v.shape,y=this.packedReshape(y,b),u.push(y),v=this.texData.get(y.dataId),x.shape=b}return{shape:y.shape,texData:v,isUniform:!1}});this.uploadToGPU(a.dataId);const f={shape:a.shape,texData:l,isUniform:!1},h=qie(e,c,f),d=this.getAndSaveBinary(h,()=>Hie(this.gpgpu,e,c,f)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),q().get("ENGINE_COMPILE_ONLY")||Kie(this.gpgpu,d,c,f,o),u.forEach(y=>this.disposeIntermediateTensorInfo(y)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const g=q().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){const y=nr();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!q().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const y=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),y}return a}compileAndRun(e,n,r,o,i=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,o,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(q().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=K(()=>{if(!q().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=q().getBool("DEBUG");q().set("DEBUG",!1);const n=this.abs(Ze(1e-8)).dataSync()[0];if(q().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Eae:Nae}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:o,values:i,texture:s,usage:a,isPacked:l}=n;if(s!=null)return;const u=this.activeTimers!=null;let c;u&&(c=nr());let f=n.texShape;if(f==null&&(f=eie(r,l),n.texShape=f),i!=null){const h=im(r);let d,p=f[1],m=f[0];const g=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!g)&&([p,m]=$c(f[0],f[1])),l?d=new ese(h,g):d=new QE(h,g);const y=g?[m,p]:f,v=this.makeTensorInfo(y,o),x=this.texData.get(v.dataId);g?x.usage=Mr.PIXELS:x.usage=Mr.UPLOAD,x.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,m,i);const b=[[m,p]],S=this.runWebGLProgram(d,[v],o,b,!0),$=this.texData.get(S.dataId);n.texShape=$.texShape,n.isPacked=$.isPacked,n.usage=$.usage,q().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(n.texture=$.texture,n.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(v),u&&(this.uploadWaitMs+=nr()-c)}else{const h=this.acquireTexture(f,a,o,l);n.texture=h}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:o}=r;return n!=null&&(r.values=Rae(n,o)),r.values}acquireTexture(e,n,r,o){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,o)}computeBytes(e,n){return e[0]*e[1]*ug(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(o=>{try{this.checkCompletion_(n),o(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await SF(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(vz(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:o,nanLoc:i,outShapeLocation:s,outShapeStridesLocation:a,outTexShapeLocation:l}=$z(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=o,e.nanLoc=i,e.outShapeLocation=s,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:o,height:i,width:s,channels:a}=e,l=ti().backend;if(!l.gpgpu.gl.isTexture(o))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(o,n,r,i,s,a);return ti().makeTensorFromDataId(u,n,r,l)}}$0.nextDataId=0;function Rae(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */yM()&&wM("webgl",()=>new $0,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gI=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class ll{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=Re(n,r),this.enableShapeUniforms=Mn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Ec{constructor(e,n,r,o=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Re(n,r);const i=this.outputShape.length;this.enableShapeUniforms=Mn(i);let s="";if(o)if(i===0||Q(this.outputShape)===1)s=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(s=`
          ${at(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?s+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:s+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Xn("coords",i);this.enableShapeUniforms?s+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:s+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${s}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kr(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Pae={kernelName:Sd,backendName:"webgl",kernelFunc:kr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function la(t){const{inputs:e,backend:n}=t,{real:r,imag:o}=e,i=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(i.dataId),a=kr({inputs:{x:r},backend:n}),l=kr({inputs:{x:o},backend:n});return s.complexTensorInfos={real:a,imag:l},i}const Mae={kernelName:W$,backendName:"webgl",kernelFunc:la};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rz="return (a < 0.) ? b * a : a;",Pz=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Fae(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{alpha:i}=r,s=n.makeTensorInfo([],"float32",ea(i,"float32")),a=q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ec(Pz,o.shape,s.shape):new ll(Rz,o.shape,s.shape),l=n.runWebGLProgram(a,[o,s],"float32");return n.disposeIntermediateTensorInfo(s),l}const Lae={kernelName:xv,backendName:"webgl",kernelFunc:Fae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mz="return (a < 0.) ? b * a : a;",Fz=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Bae(t){const{inputs:e,backend:n}=t,{x:r,alpha:o}=e,i=q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ec(Fz,r.shape,o.shape):new ll(Mz,r.shape,o.shape);return n.runWebGLProgram(i,[r,o],"float32")}const zae={kernelName:Lv,backendName:"webgl",kernelFunc:Bae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nc="if (isnan(x)) return x;";function He({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:o,backend:i})=>{const{x:s}=o,a=i,l=r||s.dtype;if(a.shouldExecuteOnCPU([s])&&n!=null){const f=a.texData.get(s.dataId),h=n(f.values,l);return a.makeTensorInfo(s.shape,l,h)}const u=q().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new ks(s.shape,e):c=new ai(s.shape,t),a.runWebGLProgram(c,[s],l)}}function Cn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:o,dtype:i}){return({inputs:s,backend:a})=>{const{a:l,b:u}=s,c=a;if(r&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),m=c.texData.get(u.dataId),[g,y]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(x=>{const[b,w]=x,S={dataId:b.dataId,dtype:b.dtype,shape:l.shape},$={dataId:w.dataId,dtype:w.dtype,shape:u.shape},C=new ll(t,l.shape,u.shape);return c.runWebGLProgram(C,[S,$],$r(b.dtype,w.dtype))}),v=la({inputs:{real:g,imag:y},backend:c});return c.disposeIntermediateTensorInfo(g),c.disposeIntermediateTensorInfo(y),v}const f=i||$r(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&o!=null){const p=c.texData.get(l.dataId).values,m=c.texData.get(u.dataId).values,g=l.dtype==="string"?Qi(p):p,y=l.dtype==="string"?Qi(m):m,[v,x]=o(l.shape,u.shape,g,y,f),b=c.makeTensorInfo(x,f),w=c.texData.get(b.dataId);return w.values=v,b}const h=q().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let d;return h?d=new Ec(e,l.shape,u.shape,n):d=new ll(t,l.shape,u.shape),c.runWebGLProgram(d,[l,u],f)}}function hh(t,e=!1){if(t==="linear")return e?wae:gae;if(t==="relu")return e?$ae:vae;if(t==="elu")return e?Sae:yae;if(t==="relu6")return e?Cae:xae;if(t==="prelu")return e?Fz:Mz;if(t==="leakyrelu")return e?Pz:Rz;if(t==="sigmoid")return e?kae:bae;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lz{constructor(e,n,r,o=!1,i=!1,s=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Mn(this.outputShape.length);const c=o?e[1]:e[2],f=Math.ceil(c/2),h=o?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",p=o?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",y="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,y="result = activation(result);");const v=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let x="rc.x",b="rc.x";e[0]<n[0]?x=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(b=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${x};
        int batchB = ${b};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${d});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${y}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nN={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class rN{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Re(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oN="return a * b;";function yI(t){const{inputs:e,backend:n}=t,{a:r,b:o}=e,i=$r(r.dtype,o.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(o.dataId),u=new rN(nN.REAL,r.shape,o.shape),c=new rN(nN.IMAG,r.shape,o.shape),f=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:o.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:o.shape}],h=n.runWebGLProgram(u,f,"float32"),d=n.runWebGLProgram(c,f,"float32"),p=la({inputs:{real:h,imag:d},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),p}if(n.shouldExecuteOnCPU([r,o])){const a=n.texData.get(r.dataId),l=n.texData.get(o.dataId),[u,c]=Bse(r.shape,o.shape,a.values,l.values,i),f=n.makeTensorInfo(c,i),h=n.texData.get(f.dataId);return h.values=u,f}let s;return q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?s=new Ec(oN,r.shape,o.shape):s=new ll(oN,r.shape,o.shape),n.runWebGLProgram(s,[r,o],i)}const jae={kernelName:Od,backendName:"webgl",kernelFunc:yI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wae(t,e,n){const r=[ju(t.shape),...Wu(t.shape)],o={dtype:t.dtype,shape:r,dataId:t.dataId},i=[ju(e),...Wu(e)],s=new Dz(i,r),a=!0,l=[r],u=n.runWebGLProgram(s,[o],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function he(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{shape:i}=r,s=n,a=Q(o.shape),l=IP(i,a),u=Q(l);E(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${o.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=s.texData.get(o.dataId);return c.isPacked&&!Rg(o.shape,l)&&!(c.texture!==null&&Rg(c.shape,l))?Wae(o,l,s):(s.incRef(o.dataId),{dataId:o.dataId,shape:l,dtype:o.dtype})}const Vae={kernelName:zv,backendName:"webgl",kernelFunc:he};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iN{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:o,inSize:i,outSize:s}=e;this.outputShape=[o,s];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const f=1/n;u=`sumValue += dot(values * ${Au(f)?f.toPrecision(2):f}, ones);`}let c="";i%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uae{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:o,inSize:i,outSize:s}=e;this.outputShape=[o,s];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,f=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,d="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${f===2}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${f===3}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gae(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=a0(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function Il(t,e,n,r){const o=Gae(t.shape);let i=t;for(let s=0;s<o.length;s++){const{inSize:a,windowSize:l,outSize:u}=o[s];let c,f;n==="mean"?c=s===0?new iN({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new iN({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new Uae({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),f=i,i=r.runWebGLProgram(c,[i],e),f.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(f)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hae{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[n[s]];this.outputShape=r,this.rank=r.length;const o=at(this.rank),i=Kae(n);this.userCode=`
    void main() {
      ${o} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function Kae(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let o=0;o<t.length;o++)r[t[o]]=n[o];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qae{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const o=at(this.rank),i=_z("rc",this.rank),s=new Array(this.rank);for(let c=0;c<n.length;c++)s[n[c]]=i[c];const a=`vec2(${s.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${s.join()}), ${a})`;this.userCode=`
    void main() {
      ${o} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C0(t,e,n){const r=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new qae(t.shape,e):new Hae(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xae(t,e,n,r){const o=e,i=t.shape.length,s=Fe(o,t.shape);let a=s;const l=Ot(a,i),u=l!=null;let c=t;u&&(c=C0(t,l,r),a=Wt(a.length,i)),$n("sum",a,i);const[f,h]=mn(c.shape,a);let d=f;n&&(d=qt(f,s));const p=Q(h),g=Q(t.shape)/p,y=he({inputs:{x:c},attrs:{shape:[g,p]},backend:r}),v=$C(t.dtype),x=Il(y,v,"sum",r),b=he({inputs:{x},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(x),u&&r.disposeIntermediateTensorInfo(c),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k0(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r;return Xae(o,i,s,n)}const Yae={kernelName:Hv,backendName:"webgl",kernelFunc:k0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zn(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{perm:i}=r,s=n,a=o.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=o.shape[i[c]];let u;if(s.shouldExecuteOnCPU([o])){const f=s.texData.get(o.dataId).values,h=mI(f,o.shape,o.dtype,i,l);u=s.makeTensorInfo(l,o.dtype);const d=s.texData.get(u.dataId);d.values=h}else u=C0(o,i,s);return u}const Qae={kernelName:pu,backendName:"webgl",kernelFunc:Zn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bz=1e3;function Pg({a:t,b:e,transposeA:n,transposeB:r,backend:o,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,f=n?t.shape[u-2]:t.shape[u-1],h=r?e.shape[c-1]:e.shape[c-2],d=n?t.shape[u-1]:t.shape[u-2],p=r?e.shape[c-2]:e.shape[c-1],m=t.shape.slice(0,-2),g=e.shape.slice(0,-2),y=Q(m),v=Q(g),b=Re(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([d,p]);E(f===h,()=>`Error in matMul: inner shapes (${f}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const w=n?[y,f,d]:[y,d,f],S=r?[v,p,h]:[v,h,p],$=he({inputs:{x:t},backend:o,attrs:{shape:w}}),C=he({inputs:{x:e},backend:o,attrs:{shape:S}}),k=[$,C],I=Math.max(y,v),T=n?$.shape[1]:$.shape[2],N=i!=null,_=s!=null,D=l==="leakyrelu",O=l!=null?hh(l,!0):null,R=N||_||D||O!=null;let F;if((d===1||p===1)&&T>Bz&&R===!1){let P=$,z=C;n&&(P=Zn({inputs:{x:$},backend:o,attrs:{perm:[0,2,1]}}),k.push(P)),r&&(z=Zn({inputs:{x:C},backend:o,attrs:{perm:[0,2,1]}}),k.push(z));const U=p!==1,H=p===1;let X=P;U&&(X=he({inputs:{x:P},backend:o,attrs:{shape:[I,T,1]}}),k.push(X));const ne=p===1?2:1;let re=z;H&&(re=he({inputs:{x:z},backend:o,attrs:{shape:[I,1,T]}}),k.push(re));const le=yI({inputs:{a:X,b:re},backend:o});F=k0({inputs:{x:le},backend:o,attrs:{axis:ne,keepDims:!0}}),k.push(le)}else{const P=$r(t.dtype,e.dtype),z=new Lz(w,S,[I,d,p],n,r,N,O,_,D),U=[$,C];if(i!=null&&U.push(i),_&&U.push(s),D){const H=o.makeTensorInfo([],"float32",ea(a,"float32"));U.push(H),k.push(H)}F=o.runWebGLProgram(z,U,P)}const A=he({inputs:{x:F},backend:o,attrs:{shape:b}});k.push(F);for(const P of k)o.disposeIntermediateTensorInfo(P);return A}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zae(t){const{inputs:e,backend:n,attrs:r}=t,{a:o,b:i,bias:s,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:f}=r;return Pg({a:o,b:i,transposeA:l,transposeB:u,backend:n,bias:s,preluActivationWeights:a,leakyreluAlpha:f,activation:c})}const Jae={kernelName:cg,backendName:"webgl",kernelFunc:Zae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sN="return abs(x);";function ele(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=n.texData.get(r.dataId),s=Az(i.values);return n.makeTensorInfo(r.shape,r.dtype,s)}let o;return q().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new ks(r.shape,sN):o=new ai(r.shape,sN),n.runWebGLProgram(o,[r],r.dtype)}const tle={kernelName:Jy,backendName:"webgl",kernelFunc:ele};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nle=bo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,rle=He({opSnippet:nle}),ole={kernelName:nd,backendName:"webgl",kernelFunc:rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ile=bo+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,sle=He({opSnippet:ile}),ale={kernelName:rd,backendName:"webgl",kernelFunc:sle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aN="return a + b;",lle=Cn({opSnippet:aN,packedOpSnippet:aN,supportsComplex:!0,cpuKernelImpl:vse}),ule={kernelName:gc,backendName:"webgl",kernelFunc:lle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cle{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,s)=>`T${s}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const o=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${o};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fle{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,s)=>`T${s}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const o=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${o};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fm(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return kr({inputs:{x:r[0]},backend:n});if(r.length>q().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=Fm({inputs:r.slice(0,l),backend:n}),c=Fm({inputs:r.slice(l),backend:n});return Fm({inputs:[u,c],backend:n})}const o=r.map(l=>l.dtype).reduce((l,u)=>$r(l,u)),i=r.map(l=>l.shape),a=q().getBool("WEBGL_PACK")?new fle(r[0].shape,i):new cle(r[0].shape,i);return n.runWebGLProgram(a,r,o)}const hle={kernelName:P$,backendName:"webgl",kernelFunc:Fm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dle(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r,a=o.shape.length,l=Fe(i,o.shape);let u=l;const c=Ot(u,a);let f=o;c!=null&&(f=Zn({inputs:{x:o},backend:n,attrs:{perm:c}}),u=Wt(u.length,a)),$n("all",u,a);const[h,d]=mn(f.shape,u),p=Q(d),m=he({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),g=Il(m,m.dtype,"all",n);let y;if(s){const v=qt(h,l);y=he({inputs:{x:g},backend:n,attrs:{shape:v}})}else y=he({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(f),y}const ple={kernelName:M$,backendName:"webgl",kernelFunc:dle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mle(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r,a=o.shape.length,l=Fe(i,o.shape);let u=l;const c=Ot(u,a);let f=o;c!=null&&(f=Zn({inputs:{x:o},backend:n,attrs:{perm:c}}),u=Wt(u.length,a)),$n("any",u,a);const[h,d]=mn(f.shape,u),p=Q(d),m=he({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),g=Il(m,m.dtype,"any",n);let y;if(s){const v=qt(h,l);y=he({inputs:{x:g},backend:n,attrs:{shape:v}})}else y=he({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(f),y}const gle={kernelName:F$,backendName:"webgl",kernelFunc:mle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yle{constructor(e,n,r){this.variableNames=["A"];const{windowSize:o,batchSize:i,outSize:s}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,s];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${o}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vle{constructor(e,n,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,E(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],s=Math.ceil(i/n);this.outputShape=e.slice(0,-1),s>1&&this.outputShape.push(s),o||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=at(l),c=Xn("coords",l);let f,h;if(s===1){h=l+1;const C=at(h);f=`
        ${C} sourceLocR = ${C}(${c.join()}, 0);
        ++${c[l-1]};
        ${C} sourceLocG = ${C}(${c.join()}, 0);
        ++${c[l-2]};
        ${C} sourceLocA = ${C}(${c.join()}, 0);
        --${c[l-1]};
        ${C} sourceLocB = ${C}(${c.join()}, 0);
        --${c[l-2]};`}else h=l,f=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],m=d.map(C=>"int "+C),g=Xn("sourceLocR",h-1).concat("inIdx.r"),y=Xn("sourceLocG",h-1).concat("inIdx.g"),v=Xn("sourceLocB",h-1).concat("inIdx.b"),x=Xn("sourceLocA",h-1).concat("inIdx.a"),b=r==="max"?"greaterThan":"lessThan",w=o?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${x.join()})));`,S=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${x.join()}) : 0.)`,$=o?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${d.join()}),
                                          vec2(${d.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${d.join()}),
                               vec2(${d.slice(-2).join()}));
      }
      ${$}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zz(t,e,n,r=null){let o=e.shape[0],i=e.shape[1];r!=null&&(o=r.shape[0],i=r.shape[1]);const s=a0(i),a={windowSize:s,inSize:i,batchSize:o,outSize:Math.ceil(i/s)},l=new yle(a,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const f=zz(t,e,n,c);return t.disposeIntermediateTensorInfo(c),f}function jz(t,e,n,r=null){const o=r!=null?r.shape:e.shape,i=o[o.length-1],s=a0(i),a=new vle(o,s,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=jz(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function Wz(t,e,n,r){const o=[n];if($n("arg"+r.charAt(0).toUpperCase()+r.slice(1),o,e.shape.length),!q().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],s=t.texData.get(e.dataId),a=s!==null&&s.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[u,c]=mn(l.shape,o),f=Q(c),h=he({inputs:{x:l},backend:t,attrs:{shape:[-1,f]}});i.push(h);const d=zz(t,h,r);i.push(d);const p=he({inputs:{x:d},backend:t,attrs:{shape:u}});return i.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return jz(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xle(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i}=r;let s=Fe(i,o.shape);const a=Ot(s,o.shape.length);let l=o;const u=[];a!=null&&(l=Zn({inputs:{x:o},backend:n,attrs:{perm:a}}),u.push(l),s=Wt(s.length,l.shape.length)),$n("argMax",[s[0]],l.shape.length);const c=Wz(n,l,s[0],"max");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const ble={kernelName:ev,backendName:"webgl",kernelFunc:xle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wle(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i}=r;let s=Fe(i,o.shape);const a=Ot(s,o.shape.length);let l=o;const u=[];a!=null&&(l=Zn({inputs:{x:o},backend:n,attrs:{perm:a}}),u.push(l),s=Wt(s.length,l.shape.length)),$n("argMin",[s[0]],l.shape.length);const c=Wz(n,l,s[0],"min");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const Sle={kernelName:tv,backendName:"webgl",kernelFunc:wle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $le=bo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Cle=He({opSnippet:$le}),kle={kernelName:od,backendName:"webgl",kernelFunc:Cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile=bo+"return log(x + sqrt(x * x + 1.0));",Tle=He({opSnippet:Ile}),Ele={kernelName:id,backendName:"webgl",kernelFunc:Tle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nle=bo+`
  return atan(x);
`,Ale=He({opSnippet:Nle}),Ole={kernelName:sd,backendName:"webgl",kernelFunc:Ale};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _le=gI+`
  return atan(a, b);
`,Dle=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+kl+`
  return result;
`,Rle=Cn({opSnippet:_le,packedOpSnippet:Dle}),Ple={kernelName:ld,backendName:"webgl",kernelFunc:Rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mle=bo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Fle=He({opSnippet:Mle}),Lle={kernelName:ad,backendName:"webgl",kernelFunc:Fle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dh{constructor(e,n,r,o=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const s=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,y=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(m||(v="-1.0 / 1e-20"),r){const C=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${d}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${C} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${o?i?g:y:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const x="max";let b=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(b="avgValue / max(count, 1.0)");const w=Math.floor(s/4)*4,S=s%4,$=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${x}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${d}, ${p});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${$}
          }

          int xC = xCCorner + ${w};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${$}
          }
        }
        setOutput(${b});
      }
    `}}class vI{constructor(e,n,r,o=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const s=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,f=e.dilationHeight,h=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,y=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const x=n==="avg";let b="0.0";if(x||(b="-1.0 / 1e-20"),r){const I=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${g}, ${y}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${d};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${I} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${o?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / max(count, 1.0)");const $=Math.floor(s/4)*4,C=s%4,k=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${g}, ${y}, ${v});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${k}
            }

            int xC = xCCorner + ${$};
            if (${C===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${C===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${C===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${k}
            }
          }
        }
        setOutput(${S});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ble(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e;yp(o,"avgPool");const{filterSize:i,strides:s,pad:a,dimRoundingMode:l}=r,u=1;E(Rn(s,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=vo(o.shape,i,s,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&et(c.inShape,c.outShape))return kr({inputs:{x:o},backend:n});const f=new dh(c,"avg",!1);return n.runWebGLProgram(f,[o],"float32")}const zle={kernelName:nv,backendName:"webgl",kernelFunc:Ble};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{filterSize:i,strides:s,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],f=os(o.shape,i,s,c,a,l,u),h=new vI(f,"avg",!1);return n.runWebGLProgram(h,[o],"float32")}const Wle={kernelName:rv,backendName:"webgl",kernelFunc:jle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vle{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,s=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,f=u-1-e.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${f});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Ule{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,o=e.filterWidth,i=e.strideDepth,s=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,f=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=f-1-e.padInfo.front,m=h-1-e.padInfo.top,g=d-1-e.padInfo.left,y=1/(n*r*o);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gle(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:i}=e,s=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],h=os(s.shape,a,l,f,u,c),d=new Ule(h);return n.runWebGLProgram(d,[o],s.dtype)}const Hle={kernelName:B$,backendName:"webgl",kernelFunc:Gle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:i}=e,s=i;yp([o,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=vo(s.shape,a,l,1,u),f=new Vle(c);return n.runWebGLProgram(f,[o],s.dtype)}const qle={kernelName:L$,backendName:"webgl",kernelFunc:Kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xle(t){const{inputs:e,backend:n,attrs:r}=t,{a:o,b:i}=e,{transposeA:s,transposeB:a}=r;return Pg({a:o,b:i,transposeA:s,transposeB:a,backend:n})}const Yle={kernelName:ov,backendName:"webgl",kernelFunc:Xle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qle{constructor(e,n,r,o,i,s){this.outputShape=[],this.variableNames=["x","mean","variance"],Re(e,n),Re(e,r);let a="0.0";o!=null&&(Re(e,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Re(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${s}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zle{constructor(e,n,r,o,i,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Re(e,n),Re(e,r);let a="vec4(0.0)";o!=null&&(Re(e,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Re(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${s}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jle=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:o,variance:i,offset:s,scale:a}=t;E(o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),E(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),E(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,o,i];let c=null;s!=null&&(c=s.shape,u.push(s));let f=null;a!=null&&(f=a.shape,u.push(a));const h=q().getBool("WEBGL_PACK_NORMALIZATION")?new Zle(r.shape,o.shape,i.shape,c,f,l):new Qle(r.shape,o.shape,i.shape,c,f,l);return e.runWebGLProgram(h,u,u[0].dtype)},eue={kernelName:gv,backendName:"webgl",kernelFunc:Jle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tue{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=at(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=nue(this.rank);let o;const i=e.map((s,a)=>`sourceLoc.${sw[a]} = start[${a}] + coords.${sw[a]};`);o=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${o}
        setOutput(getSource(${r}));
      }
    `}}const sw=["x","y","z","w","u","v"];function nue(t){if(t===1)return"sourceLoc";if(t<=6)return sw.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rue{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=at(this.rank),r=Xn("coords",this.rank),o=Xn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${o.slice(-2).join()})`,s=`getChannel(getSource(${o.join()}), ${i})`,a=`
      result.x = ${s};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${o[this.rank-1]};
        result.y = ${s};
        --${o[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${o[this.rank-2]};
        result.z = ${s};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${o[this.rank-1]};
          result.w = ${s};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,f)=>`start[${f}]`).join()});`:e.map((c,f)=>`${o[f]} = ${r[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oue(t,e,n,r){const o=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),s=r.texData.get(i.dataId);Object.assign(s,o),s.refCount=1,s.shape=n,s.dtype=t.dtype;let a=fk(e,ke(t.shape));o.slice&&(a+=o.slice.flatOffset),s.slice={flatOffset:a,origDataId:o.slice&&o.slice.origDataId||t.dataId};const l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),i}function Ac(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{begin:i,size:s}=r,[a,l]=s0(o,i,s);if(lk(o,a,l),Q(l)===0)return n.makeTensorInfo(l,o.dtype,[]);if(n.shouldExecuteOnCPU([o])||o.dtype==="string"){const f=n.texData.get(o.dataId),h=Yse(f.values,a,l,o.shape,o.dtype);return n.makeTensorInfo(l,o.dtype,h)}const{isPacked:u}=n.texData.get(o.dataId),c=ck(o.shape,a,l);if(u||!c){const f=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rue(l):new tue(l),h=[a];return n.runWebGLProgram(f,[o],o.dtype,h)}return n.uploadToGPU(o.dataId),oue(o,a,l,n)}const iue={kernelName:Gv,backendName:"webgl",kernelFunc:Ac};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sue=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockShape:i,crops:s}=r;E(o.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((v,x)=>v*x),l=op(o.shape,i,a),u=ip(l.length,i.length),c=sp(o.shape,i,a),f=gk(s,i.length),h=yk(c,s,i.length),d=[],p=he({inputs:{x:o},backend:n,attrs:{shape:l}}),m=Zn({inputs:{x:p},backend:n,attrs:{perm:u}}),g=he({inputs:{x:m},backend:n,attrs:{shape:c}}),y=Ac({inputs:{x:g},backend:n,attrs:{begin:f,size:h}});return d.push(p),d.push(m),d.push(g),d.forEach(v=>n.disposeIntermediateTensorInfo(v)),y},aue={kernelName:iv,backendName:"webgl",kernelFunc:sue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,weights:i}=e,{size:s}=r,a=n.readSync(o.dataId),l=n.readSync(i.dataId),u=Nz(a,l,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,u)}const uue={kernelName:z$,backendName:"webgl",kernelFunc:lue};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cue=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,fue=`
  return float(int(a.r) & int(b.r));
`;function hue(t){const{inputs:e,backend:n}=t,{a:r,b:o}=e,i=q().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=q().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,o])||s===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(o.dataId).values,[c,f]=bse(r.shape,o.shape,l,u,r.dtype),h=n.makeTensorInfo(f,r.dtype),d=n.texData.get(h.dataId);return d.values=c,h}let a;return i?a=new Ec(cue,r.shape,o.shape,!1):a=new ll(fue,r.shape,o.shape),n.runWebGLProgram(a,[r,o],r.dtype)}const due={kernelName:j$,backendName:"webgl",kernelFunc:hue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(t){const{inputs:e,backend:n}=t,{s0:r,s1:o}=e,i=n.readSync(r.dataId),s=n.readSync(o.dataId),a=Re(Array.from(i),Array.from(s));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const mue={kernelName:_P,backendName:"webgl",kernelFunc:pue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gue="return float(a != b);",Vz=Cn({opSnippet:gue,cpuKernelImpl:jse,dtype:"bool"}),yue={kernelName:Dv,backendName:"webgl",kernelFunc:Vz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xp(t){const{inputs:e,backend:n}=t,{input:r}=e,o=n.texData.get(r.dataId);return kr({inputs:{x:o.complexTensorInfos.real},backend:n})}const vue={kernelName:hC,backendName:"webgl",kernelFunc:xp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xue="return float(int(x));";function bue(t,e){const n=new ai(t.shape,xue),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aw(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{dtype:i}=r;if(i==="complex64"){if(o.dtype==="complex64")return kr({inputs:{x:o},backend:n});const s=fn(o.shape),a=aw({inputs:{x:o},backend:n,attrs:{dtype:"float32"}}),l=la({inputs:{real:a,imag:s},backend:n});return s.dispose(),n.disposeIntermediateTensorInfo(a),l}if(o.dtype==="complex64"){const s=xp({inputs:{input:o},backend:n}),a=aw({inputs:{x:s},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(s),a}if(!TP(o.dtype,i)){const s=kr({inputs:{x:o},backend:n});return{dataId:s.dataId,shape:s.shape,dtype:i}}if(n.shouldExecuteOnCPU([o])){const s=n.texData.get(o.dataId).values,[a,l,u]=wse(s,o.shape,o.dtype,i);return n.makeTensorInfo(a,l,u)}if(i==="int32")return bue(o,n);if(i==="bool"){const s=n.makeTensorInfo([],"bool",On("bool",1)),l=Vz({inputs:{a:o,b:s},backend:n});return n.disposeIntermediateTensorInfo(s),l}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${i}`)}const wue={kernelName:ud,backendName:"webgl",kernelFunc:aw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lN="return ceil(x);",Sue=He({opSnippet:lN,packedOpSnippet:lN,cpuKernelImpl:Sse}),$ue={kernelName:cd,backendName:"webgl",kernelFunc:Sue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cue{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kue{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{clipValueMin:i,clipValueMax:s}=r;let a;q().getBool("WEBGL_PACK_CLIP")?a=new kue(o.shape):a=new Cue(o.shape);const l=[[i],[s]];return n.runWebGLProgram(a,[o],o.dtype,l)}const Tue={kernelName:fd,backendName:"webgl",kernelFunc:Iue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eue{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uN(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function Nue(t){const{inputs:e,backend:n}=t,{x:r}=e,o=n.texData.get(r.dataId),i=new Eue(r.shape),s=[uN(r,o.complexTensorInfos.real),uN(r,o.complexTensorInfos.imag)];return n.runWebGLProgram(i,s,s[0].dtype)}const Aue={kernelName:sv,backendName:"webgl",kernelFunc:Nue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oue{constructor(e){this.outputShape=[],this.outputShape=di(e,1),this.variableNames=e.map((s,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let s=1;s<n.length;s++)n[s]=n[s-1]+e[s][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let s=1;s<n.length;s++){const a=n[s-1];r.push(`else if (yC < ${n[s]}) setOutput(getT${s}(yR, yC-${a}));`)}const o=n.length,i=n[n.length-1];r.push(`else setOutput(getT${o}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ue{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=di(e,n);const r=this.outputShape,o=r.length,i=at(o),s=Xn("coords",o),a=["x","y","z","w","u","v"].slice(0,o);this.variableNames=e.map((m,g)=>`T${g}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const u=a[n],c=a.slice(-2),f=a.join();let h=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${c.join()}));
        }`;for(let m=1;m<l.length;m++){const g=l[m-1];h+=`
        if (${u} < ${l[m]}  && ${u} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${lm(a,u,g)}),
            vec2(${lm(c,u,g)}));
        }`}const d=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${d}(${lm(a,u,p)}),
          vec2(${lm(c,u,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${s}), 0., 0., 0.);

        ${s[o-1]} = ${s[o-1]} + 1;
        if (${s[o-1]} < ${r[o-1]}) {
          result.g = getValue(${s});
        }

        ${s[o-2]} = ${s[o-2]} + 1;
        if (${s[o-2]} < ${r[o-2]}) {
          result.a = getValue(${s});
        }

        ${s[o-1]} = ${s[o-1]} - 1;
        if (${s[o-2]} < ${r[o-2]} &&
            ${s[o-1]} < ${r[o-1]}) {
          result.b = getValue(${s});
        }
        setOutput(result);
      }
    `}}function lm(t,e,n){const r=t.indexOf(e);return t.map((i,s)=>s===r?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I0(t){const{inputs:e,backend:n}=t,{input:r}=e,o=n.texData.get(r.dataId);return kr({inputs:{x:o.complexTensorInfos.imag},backend:n})}const Due={kernelName:oC,backendName:"webgl",kernelFunc:I0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sf(t,e,n){const r=t[0].dtype;if(r==="complex64"){const d=t.map(v=>xp({inputs:{input:v},backend:n})),p=t.map(v=>I0({inputs:{input:v},backend:n})),m=Sf(d,e,n),g=Sf(p,e,n),y=la({inputs:{real:m,imag:g},backend:n});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}let o=n.shouldExecuteOnCPU(t);if(r==="string"&&(o=!0),o){const d=t.map(b=>{const S=[-1,Q(b.shape.slice(e))];return he({inputs:{x:b},backend:n,attrs:{shape:S}})}),p=d.map(b=>({vals:n.readSync(b.dataId),shape:b.shape})),m=di(d.map(b=>b.shape),1),g=d[0].shape[0]===1,y=$se(p,m,r,g),v=di(t.map(b=>b.shape),e),x=n.makeTensorInfo(v,r,y);return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),x}const i=t.filter(d=>Q(d.shape)>0),s=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const d=s?new ai(t[0].shape,gs):new ks(t[0].shape,gs);return n.runWebGLProgram(d,t,r)}const a=q().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const d=[];for(let m=0;m<i.length;m+=a){const g=i.slice(m,m+a);d.push(Sf(g,e,n))}const p=Sf(d,e,n);for(const m of d)n.disposeIntermediateTensorInfo(m);return p}if(s){const d=new _ue(i.map(p=>p.shape),e);return n.runWebGLProgram(d,i,r)}const{tensors2D:l,outShape:u}=Rue(i,e,n),c=new Oue(l.map(d=>d.shape)),f=n.runWebGLProgram(c,l,r);l.forEach(d=>n.disposeIntermediateTensorInfo(d));const h=he({inputs:{x:f},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(f),h}function Rue(t,e,n){const r=di(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>he({inputs:{x:i},attrs:{shape:[-1,Q(i.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(t){const{inputs:e,backend:n,attrs:r}=t,{axis:o}=r,i=Fe(o,e[0].shape)[0],s=e.map(u=>u.shape);dk(s,i);const a=di(e.map(u=>u.shape),i);if(Q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>Q(u.shape)>0);return l.length===1?kr({inputs:{x:l[0]},backend:n}):Sf(l,i,n)}const Pue={kernelName:av,backendName:"webgl",kernelFunc:Uz};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gz{constructor(e,n=!1,r=null,o=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const s=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,g=e.dataFormat==="channelsLast",y=g?1:2,v=g?2:3,x=g?3:1;let b="",w="";r&&(o?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:b=`
          float activation(float x) {
            ${r}
          }
        `,w="result = activation(result);");const S=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${s}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${x}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${d}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${w}
        setOutput(result);
      }
    `}}class Mue{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,o=e.padInfo.left,i=e.strideDepth,s=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,f=e.filterDepth,h=e.filterHeight,d=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${s}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${o});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hz{constructor(e,n=!1,r=null,o=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Mn(this.outputShape.length);const s=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,f=c;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<c;g++)h+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<c;g++)h+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(f+1)/2;g++){const y=g*2;if(h+=`
           xC = xCCorner + ${y*l};
           `,a===1){if(y<c&&(s%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,l===1&&y>0?h+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<c)){const v=s%2===0?N$(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:h+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):v===1?h+=`
                     xC${y+1} = xTexelC${y};
                     `:h+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<c&&(s%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<c&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<c&&(h+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<c&&(h+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<c&&(h+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let d="",p="";r&&(o?d=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?d=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:d=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${d}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fue{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Mn(this.outputShape.length);const{dataFormat:r}=n,o=Jn(),i=r==="channelsLast",s=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let f=0;f<=1;f++)u+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${s}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${o.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mg(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function Kz({x:t,filter:e,convInfo:n,backend:r,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:a=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,f=l[0]*l[1]*l[2],h=n.outChannels,d=n.dataFormat==="channelsLast",p=!1,m=!1;let g;const y=[];if(i!=null){const b=Mg(i.shape,d);b!=null&&(i=he({inputs:{x:i},backend:r,attrs:{shape:b}}),y.push(i))}if(o!=null){const b=Mg(o.shape,d);b!=null&&(o=he({inputs:{x:o},backend:r,attrs:{shape:b}}),y.push(o))}if(!((f===1||h===1)&&c>Bz)&&u.isPacked&&d&&u.texture!=null&&l[2]%2!==0&&et(u.shape.slice(-3),l.slice(-3))){const b=l[0]*l[1]*(l[2]+1),w={dataId:t.dataId,shape:[1,b,n.inChannels],dtype:t.dtype},S=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,E(Rg(u.shape,w.shape),()=>`packed reshape ${u.shape} to ${w.shape} isn't free`);const $=he({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push($);const C=Pg({a:w,b:$,backend:r,transposeA:p,transposeB:m,bias:o,activation:a,preluActivationWeights:i,leakyreluAlpha:s}),k=r.texData.get(C.dataId);E(k.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=S,k.shape=n.outShape,g=kr({inputs:{x:C},backend:r}),g.shape=n.outShape,y.push(C)}else{const b=n.outHeight*n.outWidth,w=he({inputs:{x:t},backend:r,attrs:{shape:d?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),S=he({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),$=Pg({a:d?w:S,b:d?S:w,transposeA:!d,transposeB:m,backend:r,bias:o,activation:a,preluActivationWeights:i,leakyreluAlpha:s});g=he({inputs:{x:$},backend:r,attrs:{shape:n.outShape}}),y.push(w),y.push(S),y.push($)}for(const b of y)r.disposeIntermediateTensorInfo(b);return g}function qz({x:t,filter:e,convInfo:n,backend:r,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:f,outHeight:h,dataFormat:d}=n,p=d==="channelsLast",m=l*u*c,g=h*f,y=[n.batchSize,m,g],v=!0,x=!1,b=[];if(i!=null){const A=Mg(i.shape,p);A!=null&&(i=he({inputs:{x:i},backend:r,attrs:{shape:A}}),b.push(i))}if(o!=null){const A=Mg(o.shape,p);A!=null&&(o=he({inputs:{x:o},backend:r,attrs:{shape:A}}),b.push(o))}const w=he({inputs:{x:e},backend:r,attrs:{shape:[1,m,Q(e.shape)/m]}});b.push(w);const S=new Fue(y,n),$=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],C=r.runWebGLProgram(S,[t],"float32",$),k=he({inputs:{x:C},backend:r,attrs:{shape:y}});b.push(C),b.push(k);const I=o!=null,T=i!=null,N=a==="leakyrelu",_=a?hh(a,!0):null,D=new Lz(p?k.shape:w.shape,p?w.shape:k.shape,p?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],v,x,I,_,T,N),O=p?[k,w]:[w,k];if(o&&O.push(o),T&&O.push(i),N){const A=r.makeTensorInfo([],"float32",ea(s,"float32"));O.push(A),b.push(A)}const R=r.runWebGLProgram(D,O,"float32"),F=he({inputs:{x:R},backend:r,attrs:{shape:n.outShape}});b.push(R);for(const A of b)r.disposeIntermediateTensorInfo(A);return F}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lue(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i}=e,{strides:s,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,f=is(l),h=Sn(o.shape,i.shape,s,u,a,c,!1,f);let d;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))d=Kz({x:o,filter:i,convInfo:h,backend:n});else if(h.strideWidth<=2&&f==="channelsLast"&&q().getBool("WEBGL_EXP_CONV")){const m=new Hz(h),g=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];d=n.runWebGLProgram(m,[o,i],"float32",g)}else if(q().getBool("WEBGL_CONV_IM2COL"))d=qz({x:o,filter:i,convInfo:h,backend:n});else{const m=new Gz(h);d=n.runWebGLProgram(m,[o,i],"float32")}const p=he({inputs:{x:d},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(d),p}const Bue={kernelName:lv,backendName:"webgl",kernelFunc:Lue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zue{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,o=e.padInfo.top,i=e.padInfo.left,s=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${s?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class jue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,s=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=s?1:2,c=s?2:3,f=s?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${s}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Wue{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,o=e.strideWidth,i=e.padInfo.front,s=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${s};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${o} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Vue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,o=e.filterWidth,i=e.strideDepth,s=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=o-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${o}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${o} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:i}=e,{strides:s,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,f=is(l),h=Sn(o.shape,c,s,1,a,u,!1,f),d=new zue(h);return n.runWebGLProgram(d,[o,i],"float32")}const Gue={kernelName:V$,backendName:"webgl",kernelFunc:Uue};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hue{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Mn(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,o=n-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kue(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:i}=e,{inputShape:s,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,f=is(u),h=Sn(s,i.shape,a,1,l,c,!1,f);if(q().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){const d=[[h.strideHeight,h.strideWidth]],p=new Hue(h);return n.runWebGLProgram(p,[o,i],"float32",d)}else{const d=new jue(h);return n.runWebGLProgram(d,[o,i],"float32")}}const que={kernelName:uv,backendName:"webgl",kernelFunc:Kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i}=e,{strides:s,pad:a,dilations:l}=r,u=ta(o.shape,i.shape,s,l,a),c=new Mue(u);return n.runWebGLProgram(c,[o,i],"float32")}const Yue={kernelName:cv,backendName:"webgl",kernelFunc:Xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Que(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:i}=e,{strides:s,pad:a,filterShape:l}=r,u=ta(o.shape,l,s,1,a),c=new Wue(u);return n.runWebGLProgram(c,[o,i],"float32")}const Zue={kernelName:U$,backendName:"webgl",kernelFunc:Que};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jue(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:i}=e,{pad:s,strides:a,inputShape:l}=r,u=ta(l,i.shape,a,1,s),c=new Vue(u);return n.runWebGLProgram(c,[o,i],"float32")}const ece={kernelName:G$,backendName:"webgl",kernelFunc:Jue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tce=Nc+`
  return cos(x);
`,nce=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${kl}
  return result;
`,rce=He({opSnippet:tce,packedOpSnippet:nce}),oce={kernelName:hd,backendName:"webgl",kernelFunc:rce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ice=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,sce=He({opSnippet:ice}),ace={kernelName:dd,backendName:"webgl",kernelFunc:sce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lce{constructor(e,n,r,o,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[s,a,l,u]=e,[c]=n,[f,h]=r;this.outputShape=[c,f,h,u];const d=o==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[g,y,v]=f>1?[`${(a-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[x,b,w]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${x});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${s}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${b};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${d} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uce=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:o,boxes:i,boxInd:s}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new lce(o.shape,i.shape,a,l,u);return n.runWebGLProgram(c,[o,i,s],"float32")},cce={kernelName:K$,backendName:"webgl",kernelFunc:uce};var ph;(function(t){t.Prod="*",t.Sum="+"})(ph||(ph={}));class cN{constructor(e,n,r,o){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,s=this.op===ph.Prod?"1.0":"0.0",a=r?s:`getX(${fN(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=o?`end != ${l-1}`:"end != 0",c=o?"end + 1":"end - 1"):(u=o?`end + pow2 < ${l}`:"end >= pow2",c=o?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${at(i)} coords = getOutputCoords();
        int end = ${hN(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${hN(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${fN(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function fN(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function hN(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(t,e,n,r,o,i){const s=e.shape.length,a=Ot([r],s);let l=e;a!=null&&(l=Zn({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=Wt(1,s)[0];if(u!==s-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let f=kr({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const d=new cN(t,l.shape,!1,i),p=[[h]],m=f;f=n.runWebGLProgram(d,[f],f.dtype,p),n.disposeIntermediateTensorInfo(m)}if(o){const h=new cN(t,l.shape,o,i),d=f;f=n.runWebGLProgram(h,[f],f.dtype),n.disposeIntermediateTensorInfo(d)}if(a!=null){const h=na(a),d=Zn({inputs:{x:f},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(l),d}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,exclusive:s,reverse:a}=r;return Xz(ph.Prod,o,n,i,s,a)}const hce={kernelName:H$,backendName:"webgl",kernelFunc:fce};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,exclusive:s,reverse:a}=r;return Xz(ph.Sum,o,n,i,s,a)}const pce={kernelName:fv,backendName:"webgl",kernelFunc:dce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,weights:i}=e,{size:s,binaryOutput:a}=r;if(o.shape.length===1){const l=n.readSync(o.dataId),u=n.readSync(i.dataId),c=Nz(l,u,i.dtype,i.shape,s);return n.makeTensorInfo([s],i.dtype,c)}else if(o.shape.length===2){const l=n.bufferSync(o),u=n.bufferSync(i),c=xse(l,u,s,a);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}const gce={kernelName:q$,backendName:"webgl",kernelFunc:mce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yce{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vce(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockSize:i,dataFormat:s}=r,a=o.shape[0],l=s==="NHWC"?o.shape[1]:o.shape[2],u=s==="NHWC"?o.shape[2]:o.shape[3],c=s==="NHWC"?o.shape[3]:o.shape[1],f=l*i,h=u*i,d=c/(i*i),p=s==="NHWC"?[a,f,h,d]:[a,d,f,h],m=new yce(p,i,s);return n.runWebGLProgram(m,[o],o.dtype)}const xce={kernelName:X$,backendName:"webgl",kernelFunc:vce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yz{constructor(e,n=!1,r=null,o=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Mn(this.outputShape.length);const s=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(o?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${s}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qz{constructor(e,n=!1,r=null,o=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Mn(this.outputShape.length);const s=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,h=f;let d=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<f;y++)d+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;d+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let y=0;y<f;y++)d+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;d+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(h+1)/2;y++){const v=y*2;if(d+=`
          xC = xCCorner + ${v*u};
          `,l===1){if(v<f&&(a%2===1?(d+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,u===1&&v>0?d+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:d+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):d+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<f)){const x=a%2===0?N$(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(d+=`
                  xCOffset = xC + imod(pads[1], 2) + ${x};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,u>1?d+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:d+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):x===1?d+=`
                    xC${v+1} = xTexelC${v};
                    `:d+=`
                    xCOffset = xC + ${x};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<f&&(a%2===1?(d+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<f&&(d+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(d+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<f&&(d+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<f&&(d+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<f&&(d+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}d+=`
    }
  `,d+=`
      }
    `;let p="",m="";r&&(o?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${s};
        int q = d2 - d1 * ${s};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${d}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i}=e,{strides:s,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),E(Rn(s,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);const f=Sn(o.shape,i.shape,s,c,a,u,!0);let h;q().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?h=new Qz(f):h=new Yz(f);const d=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(h,[o,i],"float32",d)}const wce={kernelName:hv,backendName:"webgl",kernelFunc:bce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sce{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,o=e.padInfo.top,i=e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${s} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class $ce{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,s=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cce(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,dy:i}=e,{strides:s,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,f=Sn(o.shape,c,s,a,l,u,!0),h=new Sce(f);return n.runWebGLProgram(h,[o,i],"float32")}const kce={kernelName:Y$,backendName:"webgl",kernelFunc:Cce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,filter:i}=e,{strides:s,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,f=Sn(c,i.shape,s,a,l,u,!0),h=new $ce(f);return n.runWebGLProgram(h,[o,i],"float32")}const Tce={kernelName:Q$,backendName:"webgl",kernelFunc:Ice};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ece{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nce(t){const{inputs:e,backend:n}=t,{x:r}=e,o=[...r.shape,...r.shape],i=Q(r.shape),s=he({inputs:{x:r},backend:n,attrs:{shape:[i]}}),a=new Ece(i),l=n.runWebGLProgram(a,[s],s.dtype),u=he({inputs:{x:l},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}const Ace={kernelName:DP,backendName:"webgl",kernelFunc:Nce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oce{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:o,strideHeight:i,strideWidth:s,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:f,left:h}=o;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${s});
      const ivec2 pads = ivec2(${f}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i}=e,{strides:s,pad:a,dilations:l}=r,u=Jd(o.shape,i.shape,s,a,"NHWC",l);let c;const f=new Oce(u);c=n.runWebGLProgram(f,[o,i],"float32");const h=he({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),h}const Dce={kernelName:dv,backendName:"webgl",kernelFunc:_ce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(t){const{inputs:e,backend:n,attrs:r}=t,{equation:o}=r,i=e,{allDims:s,summedDims:a,idDims:l}=kk(o,i.length);Tk(s.length,l,i);const{path:u,steps:c}=Ek(a,l),f=c.length;let h=null,d=s.length;const p=[];for(let m=0;m<f;++m){for(const g of c[m]){const{permutationIndices:y,expandDims:v}=Ik(d,l[g]);let x;Nk(y)?x=i[g]:(x=Zn({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),p.push(x));const b=x.shape.slice();for(let w=0;w<v.length;++w)b.splice(v[w],0,1);et(x.shape,b)||(x=he({inputs:{x},backend:n,attrs:{shape:b}}),p.push(x)),h===null?h=x:(h=yI({inputs:{a:x,b:h},backend:n}),p.push(h))}m<f-1&&(u[m]>=0&&(h=k0({inputs:{x:h},backend:n,attrs:{axis:u[m]-(s.length-d),keepDims:!1}}),p.push(h)),d--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const Pce={kernelName:Z$,backendName:"webgl",kernelFunc:Rce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mce="return (x >= 0.0) ? x : (exp(x) - 1.0);",Fce=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Lce=He({opSnippet:Mce,packedOpSnippet:Fce}),Bce={kernelName:md,backendName:"webgl",kernelFunc:Lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zce="return (b >= 0.0) ? a : a * (b + 1.0);",jce=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Wce=t=>{const{inputs:e,backend:n}=t,{dy:r,y:o}=e,i=q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ec(jce,r.shape,o.shape):new ll(zce,r.shape,o.shape);return n.runWebGLProgram(i,[r,o],r.dtype)},Vce={kernelName:J$,backendName:"webgl",kernelFunc:Wce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uce=`
  return vec4(equal(a, b));
`,Gce="return float(a == b);",Hce=Cn({opSnippet:Gce,packedOpSnippet:Uce,dtype:"bool",cpuKernelImpl:Cse}),Kce={kernelName:pv,backendName:"webgl",kernelFunc:Hce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qce=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${vk};
  float a1 = ${xk};
  float a2 = ${bk};
  float a3 = ${wk};
  float a4 = ${Sk};
  float a5 = ${$k};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Xce=He({opSnippet:qce}),Yce={kernelName:gd,backendName:"webgl",kernelFunc:Xce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qce=Nc+`
  return exp(x);
`,Zce=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Zz=He({opSnippet:Qce,packedOpSnippet:Zce,cpuKernelImpl:kse,dtype:"float32"}),Jce={kernelName:yd,backendName:"webgl",kernelFunc:Zz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lw(t){const{inputs:e,attrs:n,backend:r}=t,{dim:o}=n,{input:i}=e,s=i.shape.length,a=i.shape.slice();let l=o;return o<0&&(E(-(s+1)<=o,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+o+1),a.splice(l,0,1),he({inputs:{x:i},backend:r,attrs:{shape:a}})}const efe={kernelName:mv,backendName:"webgl",kernelFunc:lw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dN="return exp(x) - 1.0;",tfe=He({opSnippet:dN,packedOpSnippet:dN,cpuKernelImpl:Ise}),nfe={kernelName:vd,backendName:"webgl",kernelFunc:tfe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pN{constructor(e,n,r){this.variableNames=["real","imag"];const o=n[1];this.outputShape=n;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=r?`${o}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${o});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${o}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${s};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz(t,e,n){const r=n.texData.get(t.dataId),o=Q(t.shape),i=t.shape[t.shape.length-1],s=o/i,a=he({inputs:{x:t},backend:n,attrs:{shape:[s,i]}}),l=a.shape,u=new pN("real",l,e),c=new pN("imag",l,e),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(u,f,"float32"),d=n.runWebGLProgram(c,f,"float32"),p=la({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);const m=he({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(t){const{inputs:e,backend:n}=t,{input:r}=e;return Jz(r,!1,n)}const ofe={kernelName:eC,backendName:"webgl",kernelFunc:rfe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ife{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bp(t){const{backend:e,attrs:n}=t,{shape:r,value:o}=n;let{dtype:i}=n;if(i=i||pc(o),i==="string"){const s=Bt(i,Q(r));return s.fill(o),e.makeTensorInfo(r,i,s)}else{const s=new ife(r,o),a=[[o]];return e.runWebGLProgram(s,[],i,a)}}const sfe={kernelName:tC,backendName:"webgl",kernelFunc:bp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class afe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lfe={kernelName:nC,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,o=new afe(n.shape);return r.runWebGLProgram(o,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mN="return floor(x);",ufe=He({opSnippet:mN,packedOpSnippet:mN,cpuKernelImpl:Tse}),cfe={kernelName:xd,backendName:"webgl",kernelFunc:ufe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ffe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,hfe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,dfe=Cn({opSnippet:ffe,packedOpSnippet:hfe,dtype:"int32"}),pfe={kernelName:bd,backendName:"webgl",kernelFunc:dfe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mfe{constructor(e){this.variableNames=["A"];const n=Jn(),[r,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${o}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gfe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Jn(),[r,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${o}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yfe={kernelName:_H,backendName:"webgl",kernelFunc:vfe};let Fl,nb=q().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function vfe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:o}=e;const{numChannels:i}=r,s=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,[l,u]=s?[o.videoWidth,o.videoHeight]:[o.width,o.height],c=[u,l],f=[u,l,i];if(a||s){const m=q().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Fl==null||m!==nb)&&(nb=m,Fl=document.createElement("canvas").getContext("2d",{willReadFrequently:nb})),Fl.canvas.width=l,Fl.canvas.height=u,Fl.drawImage(o,0,0,l,u),o=Fl.canvas}const h=n.makeTensorInfo(c,"int32");n.texData.get(h.dataId).usage=Mr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);const d=q().getBool("WEBGL_PACK")?new gfe(f):new mfe(f),p=n.runWebGLProgram(d,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i,bias:s,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r,m=is(c),g=Sn(o.shape,i.shape,l,f,u,h,!1,m);let y;const v=[],x=s!=null,b=a!=null,w=d==="leakyrelu",S=()=>{const C=[o,i],k=(I,T)=>{if(T==="NCHW"&&I.shape.length===1&&I.shape[0]!==1){const N=he({inputs:{x:I},backend:n,attrs:{shape:[I.shape[0],1,1]}});return v.push(N),N}return I};if(x&&C.push(k(s,c)),b&&C.push(k(a,c)),w){const I=n.makeTensorInfo([],"float32",ea(p,"float32"));C.push(I),v.push(I)}return C};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=Kz({x:o,filter:i,convInfo:g,backend:n,bias:s,activation:d,preluActivationWeights:a,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&q().getBool("WEBGL_EXP_CONV")){const C=d?hh(d,!0):null,k=new Hz(g,x,C,b,w),I=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],T=S();y=n.runWebGLProgram(k,T,"float32",I)}else if(q().getBool("WEBGL_CONV_IM2COL"))y=qz({x:o,filter:i,convInfo:g,backend:n,bias:s,activation:d,preluActivationWeights:a,leakyreluAlpha:p});else{const C=d?hh(d,!1):null,k=new Gz(g,x,C,b,w),I=S();y=n.runWebGLProgram(k,I,"float32")}const $=he({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return v.push(y),v.forEach(C=>n.disposeIntermediateTensorInfo(C)),$}const bfe={kernelName:fg,backendName:"webgl",kernelFunc:xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,filter:i,bias:s,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:f,activation:h,leakyreluAlpha:d}=r,p=[];let m=c;m==null&&(m=[1,1]),E(Rn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=Sn(o.shape,i.shape,l,m,u,f,!0),y=q().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,v=h?hh(h,y):null,x=[o,i],b=s!=null,w=a!=null,S=h==="leakyrelu";if(b&&x.push(s),w&&x.push(a),S){const I=n.makeTensorInfo([],"float32",ea(d,"float32"));x.push(I),p.push(I)}let $;y?$=new Qz(g,b,v,w,S):$=new Yz(g,b,v,w,S);const C=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],k=n.runWebGLProgram($,x,"float32",C);return p.forEach(I=>n.disposeIntermediateTensorInfo(I)),k}const Sfe={kernelName:ZP,backendName:"webgl",kernelFunc:wfe};class $fe{constructor(e,n,r,o){this.sliceDim=e,this.strides=n,this.paramsShape=o,this.variableNames=["x","indices"],this.outputShape=r;const i=at(r.length);let s=`
    int index;`;for(let a=0;a<this.sliceDim;a++)s+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${s}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cfe(t){const{inputs:e,backend:n}=t,{params:r,indices:o}=e,i=o.shape,s=i[i.length-1],a=Q(r.shape),[l,u,c,f]=ak(r,o),h=he({inputs:{x:o},backend:n,attrs:{shape:[u,s]}}),d=he({inputs:{x:r},backend:n,attrs:{shape:[Q(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,o])||r.dtype==="string"){const y=n.readSync(o.dataId),v=n.bufferSync(r),x=Ese(y,v,r.dtype,u,s,c,f,r.shape,a);return n.makeTensorInfo(l,r.dtype,x.values)}const p=new $fe(s,f,[u,c],r.shape),m=n.runWebGLProgram(p,[d,h],d.dtype),g=he({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),g}const kfe={kernelName:RP,backendName:"webgl",kernelFunc:Cfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ife{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=at(this.rank),o=Tfe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${o}));
      }
    `}}function Tfe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let o=0;o<t.length;o++)o===2?r.push("index"):r.push(`${n[o]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,indices:i}=e,{axis:s,batchDims:a}=r,l=Fe(s,o.shape)[0];if(q().get("DEBUG")){const v=n.readSync(i.dataId),x=o.shape[l];for(let b=0;b<v.length;++b){const w=v[b];E(w<=x-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${x-1}]`)}}const u=Ok(o,i,l,a),c=Q(i.shape),f=[],h=he({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),d=he({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});f.push(h),f.push(d);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([o,i])||o.dtype==="string"){const v=n.bufferSync(d),x=n.bufferSync(h),b=Nse(x,v,p);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(u.outputShape,b.dtype,b.values)}const m=new Ife(h.shape,p),g=n.runWebGLProgram(m,[h,d],h.dtype);f.push(g);const y=he({inputs:{x:g},backend:n,attrs:{shape:u.outputShape}});return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),y}const Efe={kernelName:yv,backendName:"webgl",kernelFunc:e4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nfe="return float(a > b);",Afe=`
  return vec4(greaterThan(a, b));
`,Ofe=Cn({opSnippet:Nfe,packedOpSnippet:Afe,cpuKernelImpl:Ase,dtype:"bool"}),_fe={kernelName:vv,backendName:"webgl",kernelFunc:Ofe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dfe="return float(a >= b);",Rfe=`
  return vec4(greaterThanEqual(a, b));
`,Pfe=Cn({opSnippet:Dfe,packedOpSnippet:Rfe,dtype:"bool",cpuKernelImpl:Ose}),Mfe={kernelName:wd,backendName:"webgl",kernelFunc:Pfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ffe(t){const{inputs:e,backend:n}=t,{input:r}=e;return Jz(r,!0,n)}const Lfe={kernelName:rC,backendName:"webgl",kernelFunc:Ffe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe="return float(!isnan(x) && !isinf(x));",zfe=He({opSnippet:Bfe,dtype:"bool"}),jfe={kernelName:$d,backendName:"webgl",kernelFunc:zfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wfe="return float(isinf(x));",Vfe=He({opSnippet:Wfe,dtype:"bool"}),Ufe={kernelName:Cd,backendName:"webgl",kernelFunc:Vfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gfe="return float(isnan(x));",Hfe=He({opSnippet:Gfe,dtype:"bool"}),Kfe={kernelName:kd,backendName:"webgl",kernelFunc:Hfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qfe="return float(a < b);",Xfe=`
  return vec4(lessThan(a, b));
`,Yfe=Cn({opSnippet:qfe,packedOpSnippet:Xfe,cpuKernelImpl:_se,dtype:"bool"}),Qfe={kernelName:bv,backendName:"webgl",kernelFunc:Yfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zfe="return float(a <= b);",Jfe=`
  return vec4(lessThanEqual(a, b));
`,ehe=Cn({opSnippet:Zfe,packedOpSnippet:Jfe,cpuKernelImpl:Dse,dtype:"bool"}),the={kernelName:wv,backendName:"webgl",kernelFunc:ehe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(t){const{backend:e,attrs:n}=t,{start:r,stop:o,num:i}=n,s=Rse(r,o,i);return e.makeTensorInfo([s.length],"float32",s)}const rhe={kernelName:PP,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ohe=Nc+`
  return x < 0.0 ? 0./0. : log(x);
`,ihe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,she=He({opSnippet:ohe,packedOpSnippet:ihe,cpuKernelImpl:Pse}),ahe={kernelName:Id,backendName:"webgl",kernelFunc:she};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe=Nc+`
  return log(1.0 + x);
`,uhe=He({opSnippet:lhe}),che={kernelName:Td,backendName:"webgl",kernelFunc:uhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fhe="return float(a >= 1.0 && b >= 1.0);",hhe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,dhe=Cn({opSnippet:fhe,packedOpSnippet:hhe,dtype:"bool"}),phe={kernelName:Sv,backendName:"webgl",kernelFunc:dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mhe="return float(!(x >= 1.0));",ghe=He({opSnippet:mhe}),yhe={kernelName:$v,backendName:"webgl",kernelFunc:ghe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vhe="return float(a >= 1.0 || b >= 1.0);",xhe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,bhe=Cn({opSnippet:vhe,packedOpSnippet:xhe,dtype:"bool"}),whe={kernelName:Cv,backendName:"webgl",kernelFunc:bhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class She{constructor(e,n,r,o,i){this.variableNames=["x"],this.outputShape=[];const s=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${o}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${s}; j <= ${s}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $he{constructor(e,n,r,o,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const s=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${o}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${s};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${s}; j <= ${s}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Che=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{depthRadius:i,bias:s,alpha:a,beta:l}=r,u=q().getBool("WEBGL_PACK_NORMALIZATION")?new $he(o.shape,i,s,a,l):new She(o.shape,i,s,a,l);return n.runWebGLProgram(u,[o],o.dtype)},khe={kernelName:kv,backendName:"webgl",kernelFunc:Che};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ihe{constructor(e,n,r,o,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=o,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${o}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${o})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const The=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o,y:i,dy:s}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,f=new Ihe(o.shape,a,l,u,c);return n.runWebGLProgram(f,[o,i,s],o.dtype)},Ehe={kernelName:iC,backendName:"webgl",kernelFunc:The};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nhe(t,e,n,r){const o=Q(e),s=Q(t.shape)/o,a=he({inputs:{x:t},attrs:{shape:[s,o]},backend:r}),l=Il(a,t.dtype,"max",r),u=he({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{reductionIndices:i,keepDims:s}=r,a=o.shape.length,l=Fe(i,o.shape);let u=l;const c=Ot(u,a),f=c!=null,h=n.shouldExecuteOnCPU([o]);let d=o;if(f){if(h){const x=n.texData.get(d.dataId).values,b=new Array(a);for(let $=0;$<b.length;$++)b[$]=o.shape[c[$]];const w=mI(x,o.shape,o.dtype,c,b);d=n.makeTensorInfo(b,o.dtype);const S=n.texData.get(d.dataId);S.values=w}else d=C0(o,c,n);u=Wt(u.length,a)}$n("max",u,a);const[p,m]=mn(d.shape,u);let g=p;s&&(g=qt(p,l));let y;if(h){const x=n.texData.get(d.dataId).values,b=Mse(x,Q(m),g,o.dtype);y=n.makeTensorInfo(g,o.dtype);const w=n.texData.get(y.dataId);w.values=b}else y=Nhe(d,m,g,n);return f&&n.disposeIntermediateTensorInfo(d),y}const Ahe={kernelName:Iv,backendName:"webgl",kernelFunc:t4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ohe=gI+`
  return max(a, b);
`,_he=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+kl+`
  return result;
`,Dhe=Cn({opSnippet:Ohe,packedOpSnippet:_he,cpuKernelImpl:Fse}),Rhe={kernelName:Ed,backendName:"webgl",kernelFunc:Dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Phe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e;yp(o,"maxPool");const{filterSize:i,strides:s,pad:a,dimRoundingMode:l}=r,u=1;E(Rn(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=vo(o.shape,i,s,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&et(c.inShape,c.outShape))return kr({inputs:{x:o},backend:n});const f=new dh(c,"max",!1);return n.runWebGLProgram(f,[o],o.dtype)}const Mhe={kernelName:Tv,backendName:"webgl",kernelFunc:Phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{filterSize:i,strides:s,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],f=os(o.shape,i,s,c,a,u,l),h=new vI(f,"max",!1);return n.runWebGLProgram(h,[o],o.dtype)}const Lhe={kernelName:Ev,backendName:"webgl",kernelFunc:Fhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bhe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,o=e.dilationHeight,i=e.effectiveFilterHeight,s=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=s-1-e.padInfo.left,u=i*s-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${s} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class zhe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,s=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,f=l-1-e.padInfo.front,h=u-1-e.padInfo.top,d=c-1-e.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${h}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${s}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jhe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:i}=e,s=i,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],h=os(s.shape,a,l,f,u,c),d=new vI(h,"max",!0),p=n.runWebGLProgram(d,[s],s.dtype),m=new zhe(h),g=n.runWebGLProgram(m,[o,p],s.dtype);return n.disposeIntermediateTensorInfo(p),g}const Whe={kernelName:aC,backendName:"webgl",kernelFunc:jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:o,input:i,output:s}=e,a=i;yp([i,s],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:f}=r,h=vo(a.shape,l,u,1,c,f),d=!0,p=new dh(h,"max",d),m=n.runWebGLProgram(p,[a],a.dtype),g=new Bhe(h),y=n.runWebGLProgram(g,[o,m],a.dtype);return n.disposeIntermediateTensorInfo(m),y}const Uhe={kernelName:sC,backendName:"webgl",kernelFunc:Vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(t,e,n,r){let o=new dh(n,"max",!1);const i=r.runWebGLProgram(o,[t],"float32");o=new dh(n,"max",!0,!0,e);const s=r.runWebGLProgram(o,[t],"float32");return[i,s]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hhe={kernelName:MP,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:o,strides:i,pad:s,includeBatchInIndex:a}=e,l=n;E(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];E(Rn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=vo(r.shape,o,i,u,s),[f,h]=Ghe(r,a,c,l);return[f,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Khe(t,e,n,r){const o=Q(e),s=Q(t.shape)/o,a=he({inputs:{x:t},attrs:{shape:[s,o]},backend:r}),l=Il(a,"float32","mean",r),u=he({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qhe={kernelName:Nv,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:o,axis:i}=e,s=n,a=r.shape.length,l=Fe(i,r.shape);let u=l;const c=Ot(u,a),f=c!=null,h=s.shouldExecuteOnCPU([r]),d=[];let p=r;if(f){if(h){const b=s.texData.get(p.dataId).values,w=new Array(a);for(let C=0;C<w.length;C++)w[C]=r.shape[c[C]];const S=mI(b,r.shape,r.dtype,c,w);p=s.makeTensorInfo(w,r.dtype);const $=s.texData.get(p.dataId);$.values=S}else p=C0(r,c,s);d.push(p),u=Wt(u.length,a)}$n("sum",u,a);const[m,g]=mn(p.shape,u);let y=m;o&&(y=qt(m,l));const v=Khe(p,g,y,s);for(const x of d)s.disposeIntermediateTensorInfo(x);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r,a=o.shape.length,l=Fe(i,o.shape);let u=l;const c=Ot(u,a);let f=o;c!=null&&(f=Zn({inputs:{x:o},backend:n,attrs:{perm:c}}),u=Wt(u.length,o.shape.length)),$n("min",u,a);const[h,d]=mn(f.shape,u),p=Q(d),m=he({inputs:{x:f},backend:n,attrs:{shape:[-1,p]}}),g=Il(m,m.dtype,"min",n);let y;if(s){const v=qt(h,l);y=he({inputs:{x:g},backend:n,attrs:{shape:v}})}else y=he({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(f),y}const Yhe={kernelName:Av,backendName:"webgl",kernelFunc:Xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qhe=gI+`
  return min(a, b);
`,Zhe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+kl+`
  return result;
`,Jhe=Cn({opSnippet:Qhe,packedOpSnippet:Zhe,cpuKernelImpl:Lse}),ede={kernelName:Nd,backendName:"webgl",kernelFunc:Jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tde{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,f)=>c[0]+e[f]+c[1]);const o=e.length,i=at(o),s=n.map(c=>c[0]).join(","),a=n.map((c,f)=>c[0]+e[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o),u=r==="reflect"?0:1;if(o===1){this.userCode=`
        int start = ${s};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${s});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${o}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nde{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const o=e.length,i=at(o),s=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=Xn("rc",o),u=Xn("source",o),c=`${l[o-1]} < ${this.outputShape[o-1]}`,f=o===1?"source":`vec2(${u.slice(-2).join()})`,h=r==="reflect"?0:1;let d="";if(o===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;d=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[o-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;d=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[o-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
        rc = outputLoc;
        ${l[o-2]} += 1;
        if(${l[o-2]} < ${this.outputShape[o-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${f});
          ${l[o-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${s});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rde=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:o,mode:i}=n,s=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nde(r.shape,o,i):new tde(r.shape,o,i);return e.runWebGLProgram(s,[r],r.dtype)},ode={kernelName:Ov,backendName:"webgl",kernelFunc:rde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ide=`if (b == 0.0) return NAN;
  return mod(a, b);`,sde=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+kl+`
  return result;
`,ade=Cn({opSnippet:ide,packedOpSnippet:sde}),lde={kernelName:Ad,backendName:"webgl",kernelFunc:ade};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ude{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cde=`
if (a == b) {
  return 1.0;
};
return a / b;`,fde=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,n4=Cn({opSnippet:cde,packedOpSnippet:fde,checkOutOfBounds:!0}),hde={kernelName:pd,backendName:"webgl",kernelFunc:n4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gN="return a - b;",r4=Cn({opSnippet:gN,packedOpSnippet:gN,supportsComplex:!0,cpuKernelImpl:iae}),dde={kernelName:Hd,backendName:"webgl",kernelFunc:r4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4(t){const{inputs:e,backend:n,attrs:r}=t,{logits:o}=e,{dim:i}=r,s=Fe([i],o.shape),a=t4({inputs:{x:o},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=qt(a.shape,s),u=he({inputs:{x:a},backend:n,attrs:{shape:l}}),c=r4({inputs:{a:o,b:u},backend:n}),f=Zz({inputs:{x:c},backend:n}),h=k0({inputs:{x:f},backend:n,attrs:{axis:s,keepDims:!1}}),d=he({inputs:{x:h},backend:n,attrs:{shape:l}}),p=n4({inputs:{a:f,b:d},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),p}const pde={kernelName:Xv,backendName:"webgl",kernelFunc:o4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mde(t){const{inputs:e,backend:n,attrs:r}=t,{logits:o}=e,{numSamples:i,seed:s,normalized:a}=r,l=a?o:o4({inputs:{logits:o},backend:n,attrs:{dim:o.shape.length-1}}),u=l.shape[0],c=l.shape[1],f=new ude(u,c,i),h=[[s]],d=n.runWebGLProgram(f,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),d}const gde={kernelName:FP,backendName:"webgl",kernelFunc:mde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yde=bo+`
  return -x;
`,vde=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function xde(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId),[s,a]=zse(i.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,s)}let o;return q().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new ks(r.shape,vde):o=new ai(r.shape,yde),n.runWebGLProgram(o,[r],r.dtype)}const bde={kernelName:_v,backendName:"webgl",kernelFunc:xde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wde=nk;function Sde(t){Dr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:i}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(o.dataId),c=n.readSync(i.dataId),{selectedIndices:f}=wde(u,c,s,a,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const $de={kernelName:lC,backendName:"webgl",kernelFunc:Sde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cde=rk;function kde(t){Dr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:i}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(o.dataId),f=n.readSync(i.dataId),{selectedIndices:h,validOutputs:d}=Cde(c,f,s,a,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}const Ide={kernelName:uC,backendName:"webgl",kernelFunc:kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tde=ok;function Ede(t){Dr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:i}=e,{maxOutputSize:s,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(o.dataId),f=n.readSync(i.dataId),h=s,d=a,p=l,m=u,{selectedIndices:g,selectedScores:y}=Tde(c,f,h,d,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const Nde={kernelName:cC,backendName:"webgl",kernelFunc:Ede};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ade{constructor(e,n,r,o){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${o}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ode=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:o}=e,{dtype:i,depth:s,onValue:a,offValue:l}=r,u=Q(o.shape),c=new Ade(u,s,a,l),f=he({inputs:{x:o},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[f],i);n.disposeIntermediateTensorInfo(f);const d=[...o.shape,s],p=he({inputs:{x:h},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(h),p},_de={kernelName:Pv,backendName:"webgl",kernelFunc:Ode};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fg(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const o=xp({inputs:{input:r},backend:n}),i=Fg({inputs:{x:o},backend:n}),s=I0({inputs:{input:r},backend:n}),a=Fg({inputs:{x:s},backend:n}),l=la({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),l}else return bp({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const Dde={kernelName:Zv,backendName:"webgl",kernelFunc:Fg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const o=xp({inputs:{input:r},backend:n}),i=i4({inputs:{x:o},backend:n}),s=I0({inputs:{input:r},backend:n}),a=Fg({inputs:{x:s},backend:n}),l=la({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),l}else return bp({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const Rde={kernelName:Rv,backendName:"webgl",kernelFunc:i4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pde(t){const{inputs:e,backend:n,attrs:r}=t,{axis:o}=r;if(e.length===1)return lw({inputs:{input:e[0]},backend:n,attrs:{dim:o}});const i=e[0].shape,s=e[0].dtype;e.forEach(c=>{A$(i,c.shape,"All tensors passed to stack must have matching shapes"),E(s===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const f=lw({inputs:{input:c},backend:n,attrs:{dim:o}});return a.push(f),f}),u=Uz({inputs:l,backend:n,attrs:{axis:o}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const Mde={kernelName:Mv,backendName:"webgl",kernelFunc:Pde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fde{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const o=e.length,i=at(o),s=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);if(o===1){this.userCode=`
        int start = ${s};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${s});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lde{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,g)=>m[0]+e[g]+m[1]);const o=e.length,i=at(o),s=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+e[g]).join(","),l=Xn("rc",o),u=Xn("source",o),c=`${l[o-1]} < ${this.outputShape[o-1]}`,f=o===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${l[o-1]} += 1;
       if(${c}) {
      `,o===1?"":`}
       rc = outputLoc;
       ${l[o-2]} += 1;
       if(${l[o-2]} < ${this.outputShape[o-2]}) {`,o===1?"":`  ${l[o-1]} += 1;
         if(${c}) {`],d=o===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=o===1?2:4;m<g;m++)p+=`
        ${h[m]}
        if (${d}) {
          result[${m}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${m}] = getChannel(getX(${u.join()}), ${f});
        }
      `;p+=o===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${s});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s4=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{paddings:i,constantValue:s}=r;if(Q(o.shape)===0){const u=i.map((c,f)=>c[0]+o.shape[f]+c[1]);return bp({backend:n,attrs:{shape:u,value:s,dtype:o.dtype}})}const a=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Lde(o.shape,i,s):new Fde(o.shape,i,s),l=[[s]];return n.runWebGLProgram(a,[o],o.dtype,l)},Bde={kernelName:Fv,backendName:"webgl",kernelFunc:s4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zde=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,jde=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+kl+`
  return result;
`,Wde=Cn({opSnippet:zde,packedOpSnippet:jde}),Vde={kernelName:_d,backendName:"webgl",kernelFunc:Wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ude(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:i,keepDims:s}=r,a=o.shape.length,l=[],u=Fe(i,o.shape);let c=u;const f=Ot(c,a);let h=o;f!=null&&(h=Zn({inputs:{x:o},backend:n,attrs:{perm:f}}),c=Wt(c.length,a),l.push(h)),$n("prod",c,a);let d;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:g,outDtype:y}=Wse(h.shape,h.dtype,p,c);d=n.makeTensorInfo(g,y,m)}else{const[p,m]=mn(h.shape,c),g=Q(m),y=he({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),v=$C(o.dtype),x=Il(y,v,"prod",n);d=he({inputs:{x},backend:n,attrs:{shape:p}}),l.push(y),l.push(x)}if(s){l.push(d);const p=qt(d.shape,u);d=he({inputs:{x:d},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),d}const Gde={kernelName:Bv,backendName:"webgl",kernelFunc:Ude};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hde(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:o,paramsDenseValues:i,indices:s}=e,{outputRaggedRank:a}=r,l=o.map(y=>n.readSync(y.dataId)),u=o.map(y=>y.shape),c=n.readSync(i.dataId),f=n.readSync(s.dataId),[h,d,p]=Vse(l,u,c,i.shape,i.dtype,f,s.shape,a),m=h.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(p,i.dtype,d);return m.concat([g])}const Kde={kernelName:LP,backendName:"webgl",kernelFunc:Hde};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qde(t){const{inputs:e,backend:n}=t,{starts:r,limits:o,deltas:i}=e,s=n.readSync(r.dataId),a=n.readSync(o.dataId),l=n.readSync(i.dataId),[u,c]=Use(s,r.shape,r.dtype,a,o.shape,l,i.shape),f=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],r.dtype,c);return[f,h]}const Xde={kernelName:BP,backendName:"webgl",kernelFunc:qde};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yde(t){const{inputs:e,backend:n,attrs:r}=t,{shape:o,values:i,defaultValue:s,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.readSync(o.dataId),c=n.readSync(i.dataId),f=n.readSync(s.dataId),h=a.map(g=>n.readSync(g.dataId)),d=a.map(g=>g.shape),[p,m]=Gse(u,o.shape,c,i.shape,i.dtype,f,s.shape,h,d,l);return n.makeTensorInfo(p,i.dtype,m)}const Qde={kernelName:zP,backendName:"webgl",kernelFunc:Yde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a4=t=>{const{backend:e,attrs:n}=t,{start:r,stop:o,step:i,dtype:s}=n,a=Hse(r,o,i,s);return e.makeTensorInfo([a.length],s,a)},Zde={kernelName:fC,backendName:"webgl",kernelFunc:a4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jde="return 1.0 / x;",epe=He({opSnippet:Jde}),tpe={kernelName:Dd,backendName:"webgl",kernelFunc:epe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const npe=bo+`
  return (x < 0.0) ? 0.0 : x;
`,rpe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ope=He({opSnippet:npe,packedOpSnippet:rpe}),ipe={kernelName:Rd,backendName:"webgl",kernelFunc:ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const spe=bo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ape=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,lpe=He({opSnippet:spe,packedOpSnippet:ape}),upe={kernelName:Pd,backendName:"webgl",kernelFunc:lpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cpe{constructor(e,n,r,o,i){this.variableNames=["A"],this.outputShape=[];const[s,a,l,u]=e;this.outputShape=[s,n,r,u];const c=[o&&n>1?a-1:a,o&&r>1?l-1:l],f=[o&&n>1?n-1:n,o&&r>1?r-1:r];let h;i?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fpe{constructor(e,n,r,o,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,a,l,u]=e;this.outputShape=[s,n,r,u];const c=[o&&n>1?a-1:a,o&&r>1?l-1:l],f=[o&&n>1?n-1:n,o&&r>1?r-1:r];let h;i?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hpe(t){const{inputs:e,backend:n,attrs:r}=t,{images:o}=e,{alignCorners:i,halfPixelCenters:s,size:a}=r,[l,u]=a,c=q().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new fpe(o.shape,l,u,i,s):new cpe(o.shape,l,u,i,s);return n.runWebGLProgram(c,[o],"float32")}const dpe={kernelName:Wv,backendName:"webgl",kernelFunc:hpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ppe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,o,i]=n,[,s,a]=e,l=[r&&s>1?o-1:o,r&&a>1?i-1:i],u=[r&&s>1?s-1:s,r&&a>1?a-1:a],c=l[0]/u[0],f=l[1]/u[1],h=1/c,d=1/f,p=Math.ceil(h)*2+2,m=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${o-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mpe(t){const{inputs:e,backend:n,attrs:r}=t,{images:o,dy:i}=e,{alignCorners:s}=r,a=new ppe(i.shape,o.shape,s);return n.runWebGLProgram(a,[i],i.dtype)}const gpe={kernelName:pC,backendName:"webgl",kernelFunc:mpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ype{constructor(e,n,r,o,i){this.variableNames=["A"],this.outputShape=[];const[s,a,l,u]=e;this.outputShape=[s,n,r,u];const c=[o&&n>1?a-1:a,o&&r>1?l-1:l],f=[o&&n>1?n-1:n,o&&r>1?r-1:r],h=o?"0.5":"0.0";let d;i?d="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vpe{constructor(e,n,r,o,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,a,l,u]=e;this.outputShape=[s,n,r,u];const c=[o&&n>1?a-1:a,o&&r>1?l-1:l],f=[o&&n>1?n-1:n,o&&r>1?r-1:r],h=o?"0.5":"0.0";let d;i?d="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpe(t){const{inputs:e,backend:n,attrs:r}=t,{images:o}=e,{alignCorners:i,halfPixelCenters:s,size:a}=r,[l,u]=a,c=q().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new vpe(o.shape,l,u,i,s):new ype(o.shape,l,u,i,s);return n.runWebGLProgram(c,[o],o.dtype)}const bpe={kernelName:jv,backendName:"webgl",kernelFunc:xpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wpe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,o,i]=n,[,s,a]=e,l=[r&&s>1?o-1:o,r&&a>1?i-1:i],u=[r&&s>1?s-1:s,r&&a>1?a-1:a],c=l[0]/u[0],f=l[1]/u[1],h=1/c,d=1/f,p=Math.ceil(h)*2+2,m=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Spe(t){const{inputs:e,backend:n,attrs:r}=t,{images:o,dy:i}=e,{alignCorners:s}=r,a=new wpe(i.shape,o.shape,s);return n.runWebGLProgram(a,[i],i.dtype)}const $pe={kernelName:dC,backendName:"webgl",kernelFunc:Spe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cpe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const o=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>o(l)).join(","),s=at(r);this.userCode=`
      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kpe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const o=Xn("rc",r),i=`${o[r-1]} + 1 < ${this.outputShape[r-1]}`,s=`${o[r-2]} + 1 < ${this.outputShape[r-2]}`,a=at(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(o.slice())};
          if(${i}){
            result.g = ${u(o.slice())};
          }
          if(${s}) {
            result.b = ${c(o.slice())};
            if(${i}) {
              result.a = ${f(o.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function u(p){return p[r-1]="("+p[r-1]+" + 1)",h(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",h(p)}function f(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",h(p)}function h(p){const m=e.map((v,x)=>d(x,p)),g=m.join(","),y=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${y}))`}function d(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ipe(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{dims:i}=r,s=o.shape.length,a=Fe(i,o.shape);if(s===0)return kr({inputs:{x:o},backend:n});const l=q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new kpe(o.shape,a):new Cpe(o.shape,a);return n.runWebGLProgram(l,[o],o.dtype)}const Tpe={kernelName:Vv,backendName:"webgl",kernelFunc:Ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Epe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],o=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${o} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npe={kernelName:wC,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:o,fillValue:i,center:s}=e,a=n,l=new Epe(r.shape,i),[u,c]=mk(s,r.shape[1],r.shape[2]),f=[[u,c,Math.sin(o),Math.cos(o)]];return a.runWebGLProgram(l,[r],r.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ape=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Ope=He({opSnippet:Ape}),_pe={kernelName:Md,backendName:"webgl",kernelFunc:Ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dpe="return inversesqrt(x);",Rpe=He({opSnippet:Dpe,cpuKernelImpl:Kse}),Ppe={kernelName:Fd,backendName:"webgl",kernelFunc:Rpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xI{constructor(e,n,r,o,i,s,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;const u=at(i.length),c=at(s.length);let f="";r===1?f="i":r===2&&(f="i, j");const h=`getIndices(${f})`;let d="";o===1?d="i":o===2&&(d="i, coords[1]");const p=`getUpdates(${d})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,y=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mpe{constructor(e,n,r,o,i,s,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s;const u=at(i.length),c=at(s.length);let f="";r===1?f="i":r===2&&(f="i, j");const h=`getIndices(${f})`;let d="";o===1?d="i":o===2&&(d="i, coords[1]");const p=`getUpdates(${d})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,y=n>1?"strides[j]":"strides",v=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${y};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${v};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:o,updates:i}=e,{shape:s}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=bl(i,o,s),h=[f/u,u];if(f===0)return n.makeTensorInfo(s,o.dtype);const d=he({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=he({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;q().getBool("WEBGL_PACK")?g=new Mpe(l,a,d.shape.length,p.shape.length,c,h):g=new xI(l,a,d.shape.length,p.shape.length,c,h);const y=n.runWebGLProgram(g,[p,d,m],p.dtype),v=he({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),v}const Lpe={kernelName:jP,backendName:"webgl",kernelFunc:Fpe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bpe{constructor(e,n,r,o){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",s=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=q().getNumber("WEBGL_VERSION")===2?i:s,l=o==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:o,values:i}=e,{side:s}=r,a=new Bpe(o.shape[0],o.shape[1],i.shape[1],s),l=[[o.shape[1]]];return n.runWebGLProgram(a,[o,i],"int32",l)}const jpe={kernelName:VP,backendName:"webgl",kernelFunc:zpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wpe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let o,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",o="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);o=l.join(),i=u.join()}const s=at(r);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        float cVal = getC(${o});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpe(t){const{inputs:e,backend:n}=t,{condition:r,t:o,e:i}=e,s=new Wpe(r.shape.length,o.shape,o.shape.length);return n.runWebGLProgram(s,[r,o,i],$r(o.dtype,i.dtype))}const Upe={kernelName:Uv,backendName:"webgl",kernelFunc:Vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gpe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${l0};
  float scale = ${u0};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Hpe=He({opSnippet:Gpe}),Kpe={kernelName:Ld,backendName:"webgl",kernelFunc:Hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qpe=Nc+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Xpe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Ype=He({opSnippet:qpe,packedOpSnippet:Xpe,cpuKernelImpl:Xse}),Qpe={kernelName:Wd,backendName:"webgl",kernelFunc:Ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zpe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Jpe=He({opSnippet:Zpe}),eme={kernelName:jd,backendName:"webgl",kernelFunc:Jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tme=Nc+`
  return sin(x);
`,nme=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${kl}
  return result;
`,rme=He({opSnippet:tme,packedOpSnippet:nme}),ome={kernelName:Bd,backendName:"webgl",kernelFunc:rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ime=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,sme=He({opSnippet:ime}),ame={kernelName:zd,backendName:"webgl",kernelFunc:sme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lme=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,ume=He({opSnippet:lme}),cme={kernelName:Vd,backendName:"webgl",kernelFunc:ume};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fme=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{blockShape:i,paddings:s}=r;E(o.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((y,v)=>y*v),l=[[0,0]];l.push(...s);for(let y=1+i.length;y<o.shape.length;++y)l.push([0,0]);const u=[],c=s4({inputs:{x:o},backend:n,attrs:{paddings:l,constantValue:0}}),f=op(c.shape,i,a,!1),h=ip(f.length,i.length,!1),d=sp(c.shape,i,a,!1),p=he({inputs:{x:c},backend:n,attrs:{shape:f}}),m=Zn({inputs:{x:p},backend:n,attrs:{perm:h}}),g=he({inputs:{x:m},backend:n,attrs:{shape:d}});return u.push(c),u.push(p),u.push(m),u.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},hme={kernelName:Kv,backendName:"webgl",kernelFunc:fme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dme(t){const{inputs:e,backend:n}=t,{indices:r,values:o,denseShape:i,defaultValue:s}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${o.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);const a=n.readSync(r.dataId),l=n.readSync(o.dataId),u=n.readSync(i.dataId),c=n.readSync(s.dataId)[0],[f,h,d,p,m]=Qse(a,r.shape,r.dtype,l,o.dtype,u,c);return[n.makeTensorInfo(h,r.dtype,f),n.makeTensorInfo([h[0]],o.dtype,d),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const pme={kernelName:UP,backendName:"webgl",kernelFunc:dme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mme(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:o,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${o.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const s=Array.from(n.readSync(o.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[u,c,f]=Zse(a,r.shape,r.dtype,s,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([f.length],i.dtype,new Int32Array(f))]}const gme={kernelName:GP,backendName:"webgl",kernelFunc:mme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yme(t){const{inputs:e,backend:n}=t,{data:r,indices:o,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${o.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const s=n.readSync(r.dataId),a=n.readSync(o.dataId),l=n.readSync(i.dataId),[u,c]=Oz(s,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const vme={kernelName:HP,backendName:"webgl",kernelFunc:yme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xme(t){const{inputs:e,backend:n}=t,{data:r,indices:o,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${o.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const s=n.readSync(r.dataId),a=n.readSync(o.dataId),l=n.readSync(i.dataId),[u,c]=Oz(s,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const bme={kernelName:KP,backendName:"webgl",kernelFunc:xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wme(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:o,sparseValues:i,defaultValue:s}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:f,outputSize:h}=bl(i,o,a),d=!1;if(i.dtype==="string"){const y=n.bufferSync(o),v=n.bufferSync(i),x=Us(n.readSync(s.dataId)[0]),b=qse(y,v,a,h,c,u,l,f,x,d);return n.makeTensorInfo(a,b.dtype,b.values)}const p=new xI(u,l,o.shape.length,i.shape.length,f,[h,1],d),m=n.runWebGLProgram(p,[i,o,s],i.dtype),g=he({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),g}const Sme={kernelName:qP,backendName:"webgl",kernelFunc:wme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $me(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{numOrSizeSplits:i,axis:s}=r,a=Fe(s,o.shape)[0],l=Ak(o,i,a),u=o.shape.length,c=new Array(u).fill(0),f=o.shape.slice();return l.map(h=>{const d=[...f];d[a]=h;const p=Ac({inputs:{x:o},backend:n,attrs:{begin:c,size:d}});return c[a]+=h,p})}const Cme={kernelName:qv,backendName:"webgl",kernelFunc:$me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yN="return sqrt(x);",kme=He({opSnippet:yN,packedOpSnippet:yN,cpuKernelImpl:Jse}),Ime={kernelName:Ud,backendName:"webgl",kernelFunc:kme};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tme="return x * x;",Eme=He({opSnippet:Tme}),Nme={kernelName:mC,backendName:"webgl",kernelFunc:Eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vN="return (a - b) * (a - b);",Ame=Cn({opSnippet:vN,packedOpSnippet:vN}),Ome={kernelName:Gd,backendName:"webgl",kernelFunc:Ame};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _me(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(o.dataId),s=Qi(i),a=eae(s,"string",r);return n.makeTensorInfo(o.shape,"string",a)}const Dme={kernelName:gC,backendName:"webgl",kernelFunc:_me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rme({inputs:t,attrs:e,backend:n}){const{x:r}=t,o=bo+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new ai(r.shape,o);return n.runWebGLProgram(i,[r],r.dtype)}const Pme={kernelName:Yd,backendName:"webgl",kernelFunc:Rme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mme{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const o=r.length,i=at(r.length),s=at(r.length);let a="";if(o===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fme(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{begin:i,end:s,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:h}=r,{finalShapeSparse:d,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:x,strides:b}=hk(o.shape,i,s,a,l,u,c,f,h);let w;if(m)w=he({inputs:{x:o},backend:n,attrs:{shape:p}});else if(g||y){E(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);const $=uk(v,x,b),C=Ac({inputs:{x:o},backend:n,attrs:{begin:v,size:$}});w=he({inputs:{x:C},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(C)}else if(n.shouldExecuteOnCPU([o])){const C=n.readSync(o.dataId),k=Me(o.shape,o.dtype,C),I=tae(d,k,b,v);w=n.makeTensorInfo(p,o.dtype,I.values)}else{const C=new Mme(v,b,d);w=n.runWebGLProgram(C,[o],o.dtype)}const S=he({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),S}const Lme={kernelName:yC,backendName:"webgl",kernelFunc:Fme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bme(t){const{inputs:e,backend:n,attrs:r}=t,{separator:o,nGramWidths:i,leftPad:s,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:f}=e,h=n.readSync(c.dataId),d=n.readSync(f.dataId),[p,m]=nae(h,d,o,i,s,a,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",m)]}const zme={kernelName:XP,backendName:"webgl",kernelFunc:Bme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jme(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:o}=r,{input:i,delimiter:s}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);const a=n.readSync(i.dataId),l=n.readSync(s.dataId)[0],[u,c,f]=rae(a,l,o),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const Wme={kernelName:YP,backendName:"webgl",kernelFunc:jme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vme(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:o}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const s=n.readSync(i.dataId),a=oae(s,o);return n.makeTensorInfo(i.shape,"int32",a)}const Ume={kernelName:QP,backendName:"webgl",kernelFunc:Vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gme="return tan(x);",Hme=He({opSnippet:Gme}),Kme={kernelName:Kd,backendName:"webgl",kernelFunc:Hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qme=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Xme=He({opSnippet:qme}),Yme={kernelName:qd,backendName:"webgl",kernelFunc:Xme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qme(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:o,indices:i,updates:s}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=bl(s,i,o.shape),h=[f/u,u];if(f===0)return n.makeTensorInfo(o.shape,i.dtype);const d=he({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),p=he({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),m=he({inputs:{x:o},backend:n,attrs:{shape:h}}),g=new xI(l,a,d.shape.length,p.shape.length,c,h,!1,!0),y=n.runWebGLProgram(g,[p,d,m],m.dtype),v=he({inputs:{x:y},backend:n,attrs:{shape:o.shape}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),v}const Zme={kernelName:WP,backendName:"webgl",kernelFunc:Qme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jme{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[s]*n[s];this.outputShape=r,this.rank=r.length;const o=at(this.rank),i=ege(e);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function ege(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let o=0;o<t.length;o++)r.push(`imod(${n[o]}, ${t[o]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{reps:i}=r;if(o.dtype==="string"||o.shape.length>5){const l=n.readSync(o.dataId),u=o.dtype==="string"?l.map(h=>Us(h)):l,c=Me(o.shape,o.dtype,u),f=sae(c,i);return n.makeTensorInfo(f.shape,f.dtype,f.values)}const s=new Jme(o.shape,i);return n.runWebGLProgram(s,[o],o.dtype)}const tge={kernelName:Xd,backendName:"webgl",kernelFunc:l4};class nge{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class rge{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ga(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function xN(t){let e=1;for(;e<t;)e*=2;return e}function oge(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{k:i,sorted:s}=r,a=q().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=q().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=o.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([o])||c<a||i>l){const I=n.readSync(o.dataId),[T,N]=aae(I,u,o.dtype,i,s);return[n.makeTensorInfo(T.shape,T.dtype,T.values),n.makeTensorInfo(N.shape,N.dtype,N.values)]}if(i===0)return u[u.length-1]=0,[n.makeTensorInfo(u,o.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[o,bp({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const f=n.texData.get(o.dataId),h=f!==null&&f.isPacked,d=h?n.unpackTensor(o):o,m=Q(u)/c,g=he({inputs:{x:d},attrs:{shape:[m,c]},backend:n});h&&ga(n,d);const y=xN(i),v=xN(c);let x=null;const b=()=>x===null?[g,g]:[g,x],w=(I,T,N)=>{const _=b(),D=new nge(N),R=[[c],[x===null?1:0],[Number.NEGATIVE_INFINITY],[I],[T]],F=x;x=n.runWebGLProgram(D,_,"int32",R),ga(n,F)};for(let I=1;I<y;I*=2){const T=I*2;for(let N=I;N>=1;N/=2)w(T,N,[m,v])}for(let I=v;I>y;I/=2){const T=b(),N=new rge([m,I/2]),D=[[c],[x===null?1:0],[y]],O=x;x=n.runWebGLProgram(N,T,"int32",D),ga(n,O);const R=y/2,F=R*2;for(let A=R;A>=1;A/=2)w(F,A,x.shape)}let S=x;x=Ac({inputs:{x},backend:n,attrs:{begin:0,size:[m,i]}}),ga(n,S);let $=e4({inputs:{x:g,indices:x},backend:n,attrs:{axis:1,batchDims:1}});ga(n,g);const C=u.slice(0,-1);C.push(i),S=x,x=he({inputs:{x},attrs:{shape:C},backend:n}),ga(n,S);const k=$;return $=he({inputs:{x:$},attrs:{shape:C},backend:n}),ga(n,k),[$,x]}const ige={kernelName:vC,backendName:"webgl",kernelFunc:oge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sge{constructor(e,n,r,o,i,s){this.variableNames=["Image","Transforms"],this.outputShape=s;const a=r==="nearest"?1:2;let l;switch(o){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function age(t){const{inputs:e,backend:n,attrs:r}=t,{image:o,transforms:i}=e,{interpolation:s,fillMode:a,fillValue:l,outputShape:u}=r,[c,f,h,d]=o.shape,[p,m]=u??[f,h],g=[c,p,m,d],y=new sge(f,h,s,a,l,g);return n.runWebGLProgram(y,[o,i],"float32")}const lge={kernelName:xC,backendName:"webgl",kernelFunc:age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uge(t){const{inputs:e,attrs:n,backend:r}=t,{axis:o}=n,{x:i}=e;yp(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const s=r.readSync(i.dataId),{outputValues:a,outputShape:l,indices:u}=lae(s,o,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const cge={kernelName:bC,backendName:"webgl",kernelFunc:uge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fge(t){const{inputs:e,backend:n,attrs:r}=t,{value:o}=e;let{axis:i}=r;i<0&&(i+=o.shape.length);const s=o,a=s.shape.length,l=o.shape[i],u=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==i&&(u[c++]=s.shape[m]);const f=[],h=new Array(a).fill(0),d=s.shape.slice();d[i]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[i]=m;const g=Ac({inputs:{x:s},backend:n,attrs:{begin:h,size:d}}),y=he({inputs:{x:g},backend:n,attrs:{shape:u}});p[m]=y,f.push(g)}return f.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const hge={kernelName:Yv,backendName:"webgl",kernelFunc:fge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dge{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,o=e.batchSize,i=e.inSize,s=e.numSegments,a=s*Math.ceil(i/r);this.outputShape=[o,a];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,f=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let d="";i%r>0&&(d=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${s})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${s})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pge(t){const{inputs:e,backend:n,attrs:r}=t,{x:o,segmentIds:i}=e,{numSegments:s}=r,a=o.shape.length,l=[];let u=0;const c=Ot([u],a);let f=o;c!=null&&(f=Zn({inputs:{x:o},backend:n,attrs:{perm:c}}),l.push(f),u=Wt(1,a)[0]);const h=GF(f.shape,u,s),d=Q([f.shape[u]]),p=he({inputs:{x:f},backend:n,attrs:{shape:[-1,d]}});l.push(p);const m=$C(o.dtype),g=(b,w,S,$,C)=>{const k=b.shape[0],I=b.shape[1],T=UF(I,C),N={windowSize:T,inSize:I,batchSize:k,numSegments:C},_=new dge(N,w),D=n.compileAndRun(_,[b,S],$);if(l.push(D),D.shape[1]===C)return D;const O=a4({backend:n,attrs:{start:0,stop:C,step:1,dtype:"float32"}}),R=l4({inputs:{x:O},backend:n,attrs:{reps:[I/T]}});return l.push(O),l.push(R),g(D,w,R,$,C)},y=g(p,"unsortedSegmentSum",i,m,s),v=he({inputs:{x:y},backend:n,attrs:{shape:h}});let x=v;if(c!=null){l.push(v);const b=na(c);x=Zn({inputs:{x},backend:n,attrs:{perm:b}})}return l.forEach(b=>n.disposeIntermediateTensorInfo(b)),x}const mge={kernelName:Qv,backendName:"webgl",kernelFunc:pge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gge=[Jae,tle,ole,ale,ule,hle,ple,gle,ble,Sle,kle,Ele,Ole,Ple,Lle,zle,Wle,Hle,qle,Yle,eue,aue,uue,due,mue,wue,$ue,Tue,Mae,Aue,Pue,Bue,Gue,que,Yue,Zue,ece,oce,ace,cce,hce,pce,gce,xce,wce,kce,Tce,Ace,Dce,Pce,Bce,Vce,Kce,Yce,Jce,efe,nfe,ofe,sfe,lfe,cfe,pfe,yfe,bfe,Sfe,kfe,Efe,_fe,Mfe,Pae,Lfe,Due,jfe,Ufe,Kfe,Lae,Qfe,the,rhe,ahe,che,phe,yhe,whe,khe,Ehe,Ahe,Rhe,Mhe,Lhe,Whe,Uhe,Hhe,qhe,Yhe,ede,ode,lde,gde,jae,bde,$de,Ide,Nde,yue,_de,Rde,Mde,Bde,Vde,zae,Gde,Kde,Xde,Qde,Zde,vue,hde,tpe,ipe,upe,Vae,dpe,gpe,bpe,$pe,Tpe,Npe,_pe,Ppe,Lpe,jpe,Upe,Kpe,Qpe,eme,ome,ame,iue,pde,cme,hme,pme,gme,vme,bme,Sme,Cme,Ime,Nme,Ome,Dme,Pme,Lme,zme,Wme,Ume,dde,Yae,Kme,Yme,Zme,tge,ige,lge,Qae,cge,hge,mge,Dde];for(const t of gge)JP(t);function u4(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=u4(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Je(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=u4(t))&&(r&&(r+=" "),r+=e);return r}var yge=Array.isArray,Tr=yge,vge=typeof Fo=="object"&&Fo&&Fo.Object===Object&&Fo,c4=vge,xge=c4,bge=typeof self=="object"&&self&&self.Object===Object&&self,wge=xge||bge||Function("return this")(),ki=wge,Sge=ki,$ge=Sge.Symbol,wp=$ge,bN=wp,f4=Object.prototype,Cge=f4.hasOwnProperty,kge=f4.toString,nf=bN?bN.toStringTag:void 0;function Ige(t){var e=Cge.call(t,nf),n=t[nf];try{t[nf]=void 0;var r=!0}catch{}var o=kge.call(t);return r&&(e?t[nf]=n:delete t[nf]),o}var Tge=Ige,Ege=Object.prototype,Nge=Ege.toString;function Age(t){return Nge.call(t)}var Oge=Age,wN=wp,_ge=Tge,Dge=Oge,Rge="[object Null]",Pge="[object Undefined]",SN=wN?wN.toStringTag:void 0;function Mge(t){return t==null?t===void 0?Pge:Rge:SN&&SN in Object(t)?_ge(t):Dge(t)}var as=Mge;function Fge(t){return t!=null&&typeof t=="object"}var ls=Fge,Lge=as,Bge=ls,zge="[object Symbol]";function jge(t){return typeof t=="symbol"||Bge(t)&&Lge(t)==zge}var Oc=jge,Wge=Tr,Vge=Oc,Uge=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Gge=/^\w*$/;function Hge(t,e){if(Wge(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||Vge(t)?!0:Gge.test(t)||!Uge.test(t)||e!=null&&t in Object(e)}var bI=Hge;function Kge(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ua=Kge;const _c=ft(ua);var qge=as,Xge=ua,Yge="[object AsyncFunction]",Qge="[object Function]",Zge="[object GeneratorFunction]",Jge="[object Proxy]";function eye(t){if(!Xge(t))return!1;var e=qge(t);return e==Qge||e==Zge||e==Yge||e==Jge}var wI=eye;const Be=ft(wI);var tye=ki,nye=tye["__core-js_shared__"],rye=nye,rb=rye,$N=function(){var t=/[^.]+$/.exec(rb&&rb.keys&&rb.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function oye(t){return!!$N&&$N in t}var iye=oye,sye=Function.prototype,aye=sye.toString;function lye(t){if(t!=null){try{return aye.call(t)}catch{}try{return t+""}catch{}}return""}var h4=lye,uye=wI,cye=iye,fye=ua,hye=h4,dye=/[\\^$.*+?()[\]{}|]/g,pye=/^\[object .+?Constructor\]$/,mye=Function.prototype,gye=Object.prototype,yye=mye.toString,vye=gye.hasOwnProperty,xye=RegExp("^"+yye.call(vye).replace(dye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bye(t){if(!fye(t)||cye(t))return!1;var e=uye(t)?xye:pye;return e.test(hye(t))}var wye=bye;function Sye(t,e){return t==null?void 0:t[e]}var $ye=Sye,Cye=wye,kye=$ye;function Iye(t,e){var n=kye(t,e);return Cye(n)?n:void 0}var Tl=Iye,Tye=Tl,Eye=Tye(Object,"create"),T0=Eye,CN=T0;function Nye(){this.__data__=CN?CN(null):{},this.size=0}var Aye=Nye;function Oye(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var _ye=Oye,Dye=T0,Rye="__lodash_hash_undefined__",Pye=Object.prototype,Mye=Pye.hasOwnProperty;function Fye(t){var e=this.__data__;if(Dye){var n=e[t];return n===Rye?void 0:n}return Mye.call(e,t)?e[t]:void 0}var Lye=Fye,Bye=T0,zye=Object.prototype,jye=zye.hasOwnProperty;function Wye(t){var e=this.__data__;return Bye?e[t]!==void 0:jye.call(e,t)}var Vye=Wye,Uye=T0,Gye="__lodash_hash_undefined__";function Hye(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Uye&&e===void 0?Gye:e,this}var Kye=Hye,qye=Aye,Xye=_ye,Yye=Lye,Qye=Vye,Zye=Kye;function Dc(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Dc.prototype.clear=qye;Dc.prototype.delete=Xye;Dc.prototype.get=Yye;Dc.prototype.has=Qye;Dc.prototype.set=Zye;var Jye=Dc;function eve(){this.__data__=[],this.size=0}var tve=eve;function nve(t,e){return t===e||t!==t&&e!==e}var SI=nve,rve=SI;function ove(t,e){for(var n=t.length;n--;)if(rve(t[n][0],e))return n;return-1}var E0=ove,ive=E0,sve=Array.prototype,ave=sve.splice;function lve(t){var e=this.__data__,n=ive(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():ave.call(e,n,1),--this.size,!0}var uve=lve,cve=E0;function fve(t){var e=this.__data__,n=cve(e,t);return n<0?void 0:e[n][1]}var hve=fve,dve=E0;function pve(t){return dve(this.__data__,t)>-1}var mve=pve,gve=E0;function yve(t,e){var n=this.__data__,r=gve(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var vve=yve,xve=tve,bve=uve,wve=hve,Sve=mve,$ve=vve;function Rc(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Rc.prototype.clear=xve;Rc.prototype.delete=bve;Rc.prototype.get=wve;Rc.prototype.has=Sve;Rc.prototype.set=$ve;var N0=Rc,Cve=Tl,kve=ki,Ive=Cve(kve,"Map"),$I=Ive,kN=Jye,Tve=N0,Eve=$I;function Nve(){this.size=0,this.__data__={hash:new kN,map:new(Eve||Tve),string:new kN}}var Ave=Nve;function Ove(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var _ve=Ove,Dve=_ve;function Rve(t,e){var n=t.__data__;return Dve(e)?n[typeof e=="string"?"string":"hash"]:n.map}var A0=Rve,Pve=A0;function Mve(t){var e=Pve(this,t).delete(t);return this.size-=e?1:0,e}var Fve=Mve,Lve=A0;function Bve(t){return Lve(this,t).get(t)}var zve=Bve,jve=A0;function Wve(t){return jve(this,t).has(t)}var Vve=Wve,Uve=A0;function Gve(t,e){var n=Uve(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var Hve=Gve,Kve=Ave,qve=Fve,Xve=zve,Yve=Vve,Qve=Hve;function Pc(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Pc.prototype.clear=Kve;Pc.prototype.delete=qve;Pc.prototype.get=Xve;Pc.prototype.has=Yve;Pc.prototype.set=Qve;var CI=Pc,d4=CI,Zve="Expected a function";function kI(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Zve);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=t.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(kI.Cache||d4),n}kI.Cache=d4;var p4=kI;const Jve=ft(p4);var e0e=p4,t0e=500;function n0e(t){var e=e0e(t,function(r){return n.size===t0e&&n.clear(),r}),n=e.cache;return e}var r0e=n0e,o0e=r0e,i0e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s0e=/\\(\\)?/g,a0e=o0e(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(i0e,function(n,r,o,i){e.push(o?i.replace(s0e,"$1"):r||n)}),e}),l0e=a0e;function u0e(t,e){for(var n=-1,r=t==null?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}var II=u0e,IN=wp,c0e=II,f0e=Tr,h0e=Oc,d0e=1/0,TN=IN?IN.prototype:void 0,EN=TN?TN.toString:void 0;function m4(t){if(typeof t=="string")return t;if(f0e(t))return c0e(t,m4)+"";if(h0e(t))return EN?EN.call(t):"";var e=t+"";return e=="0"&&1/t==-d0e?"-0":e}var p0e=m4,m0e=p0e;function g0e(t){return t==null?"":m0e(t)}var g4=g0e,y0e=Tr,v0e=bI,x0e=l0e,b0e=g4;function w0e(t,e){return y0e(t)?t:v0e(t,e)?[t]:x0e(b0e(t))}var y4=w0e,S0e=Oc,$0e=1/0;function C0e(t){if(typeof t=="string"||S0e(t))return t;var e=t+"";return e=="0"&&1/t==-$0e?"-0":e}var O0=C0e,k0e=y4,I0e=O0;function T0e(t,e){e=k0e(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[I0e(e[n++])];return n&&n==r?t:void 0}var TI=T0e,E0e=TI;function N0e(t,e,n){var r=t==null?void 0:E0e(t,e);return r===void 0?n:r}var v4=N0e;const co=ft(v4);function A0e(t){return t==null}var O0e=A0e;const We=ft(O0e);var _0e=as,D0e=Tr,R0e=ls,P0e="[object String]";function M0e(t){return typeof t=="string"||!D0e(t)&&R0e(t)&&_0e(t)==P0e}var F0e=M0e;const Sp=ft(F0e);var x4={exports:{}},lt={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EI=Symbol.for("react.element"),NI=Symbol.for("react.portal"),_0=Symbol.for("react.fragment"),D0=Symbol.for("react.strict_mode"),R0=Symbol.for("react.profiler"),P0=Symbol.for("react.provider"),M0=Symbol.for("react.context"),L0e=Symbol.for("react.server_context"),F0=Symbol.for("react.forward_ref"),L0=Symbol.for("react.suspense"),B0=Symbol.for("react.suspense_list"),z0=Symbol.for("react.memo"),j0=Symbol.for("react.lazy"),B0e=Symbol.for("react.offscreen"),b4;b4=Symbol.for("react.module.reference");function wo(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case EI:switch(t=t.type,t){case _0:case R0:case D0:case L0:case B0:return t;default:switch(t=t&&t.$$typeof,t){case L0e:case M0:case F0:case j0:case z0:case P0:return t;default:return e}}case NI:return e}}}lt.ContextConsumer=M0;lt.ContextProvider=P0;lt.Element=EI;lt.ForwardRef=F0;lt.Fragment=_0;lt.Lazy=j0;lt.Memo=z0;lt.Portal=NI;lt.Profiler=R0;lt.StrictMode=D0;lt.Suspense=L0;lt.SuspenseList=B0;lt.isAsyncMode=function(){return!1};lt.isConcurrentMode=function(){return!1};lt.isContextConsumer=function(t){return wo(t)===M0};lt.isContextProvider=function(t){return wo(t)===P0};lt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===EI};lt.isForwardRef=function(t){return wo(t)===F0};lt.isFragment=function(t){return wo(t)===_0};lt.isLazy=function(t){return wo(t)===j0};lt.isMemo=function(t){return wo(t)===z0};lt.isPortal=function(t){return wo(t)===NI};lt.isProfiler=function(t){return wo(t)===R0};lt.isStrictMode=function(t){return wo(t)===D0};lt.isSuspense=function(t){return wo(t)===L0};lt.isSuspenseList=function(t){return wo(t)===B0};lt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===_0||t===R0||t===D0||t===L0||t===B0||t===B0e||typeof t=="object"&&t!==null&&(t.$$typeof===j0||t.$$typeof===z0||t.$$typeof===P0||t.$$typeof===M0||t.$$typeof===F0||t.$$typeof===b4||t.getModuleId!==void 0)};lt.typeOf=wo;x4.exports=lt;var z0e=x4.exports,j0e=as,W0e=ls,V0e="[object Number]";function U0e(t){return typeof t=="number"||W0e(t)&&j0e(t)==V0e}var w4=U0e;const G0e=ft(w4);var H0e=w4;function K0e(t){return H0e(t)&&t!=+t}var q0e=K0e;const $p=ft(q0e);var Bo=function(e){return e===0?0:e>0?1:-1},Da=function(e){return Sp(e)&&e.indexOf("%")===e.length-1},pe=function(e){return G0e(e)&&!$p(e)},pn=function(e){return pe(e)||Sp(e)},X0e=0,Cp=function(e){var n=++X0e;return"".concat(e||"").concat(n)},ul=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!pe(e)&&!Sp(e))return r;var i;if(Da(e)){var s=e.indexOf("%");i=n*parseFloat(e.slice(0,s))/100}else i=+e;return $p(i)&&(i=r),o&&i>n&&(i=n),i},bs=function(e){if(!e)return null;var n=Object.keys(e);return n&&n.length?e[n[0]]:null},Y0e=function(e){if(!Array.isArray(e))return!1;for(var n=e.length,r={},o=0;o<n;o++)if(!r[e[o]])r[e[o]]=!0;else return!0;return!1},Po=function(e,n){return pe(e)&&pe(n)?function(r){return e+r*(n-e)}:function(){return n}};function Lg(t,e,n){return!t||!t.length?null:t.find(function(r){return r&&(typeof e=="function"?e(r):co(r,e))===n})}function vu(t,e){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(e,n)||t[n]!==e[n]))return!1;for(var r in e)if({}.hasOwnProperty.call(e,r)&&!{}.hasOwnProperty.call(t,r))return!1;return!0}function uw(t){"@babel/helpers - typeof";return uw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uw(t)}var Q0e=["viewBox","children"],Z0e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],NN=["points","pathLength"],ob={svg:Q0e,polygon:NN,polyline:NN},AI=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Bg=function(e,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(se.isValidElement(e)&&(r=e.props),!_c(r))return null;var o={};return Object.keys(r).forEach(function(i){AI.includes(i)&&(o[i]=n||function(s){return r[i](r,s)})}),o},J0e=function(e,n,r){return function(o){return e(n,r,o),null}},zg=function(e,n,r){if(!_c(e)||uw(e)!=="object")return null;var o=null;return Object.keys(e).forEach(function(i){var s=e[i];AI.includes(i)&&typeof s=="function"&&(o||(o={}),o[i]=J0e(s,n,r))}),o},exe=["children"],txe=["children"];function AN(t,e){if(t==null)return{};var n=nxe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function nxe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function cw(t){"@babel/helpers - typeof";return cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cw(t)}var ON={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Bi=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},_N=null,ib=null,OI=function t(e){if(e===_N&&Array.isArray(ib))return ib;var n=[];return se.Children.forEach(e,function(r){We(r)||(z0e.isFragment(r)?n=n.concat(t(r.props.children)):n.push(r))}),ib=n,_N=e,n};function fo(t,e){var n=[],r=[];return Array.isArray(e)?r=e.map(function(o){return Bi(o)}):r=[Bi(e)],OI(t).forEach(function(o){var i=co(o,"type.displayName")||co(o,"type.name");r.indexOf(i)!==-1&&n.push(o)}),n}function _r(t,e){var n=fo(t,e);return n&&n[0]}var DN=function(e){if(!e||!e.props)return!1;var n=e.props,r=n.width,o=n.height;return!(!pe(r)||r<=0||!pe(o)||o<=0)},rxe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],oxe=function(e){return e&&e.type&&Sp(e.type)&&rxe.indexOf(e.type)>=0},ixe=function(e){return e&&cw(e)==="object"&&"clipDot"in e},sxe=function(e,n,r,o){var i,s=(i=ob==null?void 0:ob[o])!==null&&i!==void 0?i:[];return!Be(e)&&(o&&s.includes(n)||Z0e.includes(n))||r&&AI.includes(n)},Ve=function(e,n,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var o=e;if(se.isValidElement(e)&&(o=e.props),!_c(o))return null;var i={};return Object.keys(o).forEach(function(s){var a;sxe((a=o)===null||a===void 0?void 0:a[s],s,n,r)&&(i[s]=o[s])}),i},fw=function t(e,n){if(e===n)return!0;var r=se.Children.count(e);if(r!==se.Children.count(n))return!1;if(r===0)return!0;if(r===1)return RN(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n);for(var o=0;o<r;o++){var i=e[o],s=n[o];if(Array.isArray(i)||Array.isArray(s)){if(!t(i,s))return!1}else if(!RN(i,s))return!1}return!0},RN=function(e,n){if(We(e)&&We(n))return!0;if(!We(e)&&!We(n)){var r=e.props||{},o=r.children,i=AN(r,exe),s=n.props||{},a=s.children,l=AN(s,txe);return o&&a?vu(i,l)&&fw(o,a):!o&&!a?vu(i,l):!1}return!1},PN=function(e,n){var r=[],o={};return OI(e).forEach(function(i,s){if(oxe(i))r.push(i);else if(i){var a=Bi(i.type),l=n[a]||{},u=l.handler,c=l.once;if(u&&(!c||!o[a])){var f=u(i,a,s);r.push(f),o[a]=!0}}}),r},axe=function(e){var n=e&&e.type;return n&&ON[n]?ON[n]:null},lxe=function(e,n){return OI(n).indexOf(e)},uxe=["children","width","height","viewBox","className","style","title","desc"];function hw(){return hw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hw.apply(this,arguments)}function cxe(t,e){if(t==null)return{};var n=fxe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function fxe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function dw(t){var e=t.children,n=t.width,r=t.height,o=t.viewBox,i=t.className,s=t.style,a=t.title,l=t.desc,u=cxe(t,uxe),c=o||{width:n,height:r,x:0,y:0},f=Je("recharts-surface",i);return W.createElement("svg",hw({},Ve(u,!0,"svg"),{className:f,width:n,height:r,style:s,viewBox:"".concat(c.x," ").concat(c.y," ").concat(c.width," ").concat(c.height)}),W.createElement("title",null,a),W.createElement("desc",null,l),e)}var hxe=["children","className"];function pw(){return pw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pw.apply(this,arguments)}function dxe(t,e){if(t==null)return{};var n=pxe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function pxe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var Kt=W.forwardRef(function(t,e){var n=t.children,r=t.className,o=dxe(t,hxe),i=Je("recharts-layer",r);return W.createElement("g",pw({className:i},Ve(o,!0),{ref:e}),n)}),zi=function(e,n){for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i]};function mxe(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),n=n>o?o:n,n<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i}var gxe=mxe,yxe=gxe;function vxe(t,e,n){var r=t.length;return n=n===void 0?r:n,!e&&n>=r?t:yxe(t,e,n)}var xxe=vxe,bxe="\\ud800-\\udfff",wxe="\\u0300-\\u036f",Sxe="\\ufe20-\\ufe2f",$xe="\\u20d0-\\u20ff",Cxe=wxe+Sxe+$xe,kxe="\\ufe0e\\ufe0f",Ixe="\\u200d",Txe=RegExp("["+Ixe+bxe+Cxe+kxe+"]");function Exe(t){return Txe.test(t)}var S4=Exe;function Nxe(t){return t.split("")}var Axe=Nxe,$4="\\ud800-\\udfff",Oxe="\\u0300-\\u036f",_xe="\\ufe20-\\ufe2f",Dxe="\\u20d0-\\u20ff",Rxe=Oxe+_xe+Dxe,Pxe="\\ufe0e\\ufe0f",Mxe="["+$4+"]",mw="["+Rxe+"]",gw="\\ud83c[\\udffb-\\udfff]",Fxe="(?:"+mw+"|"+gw+")",C4="[^"+$4+"]",k4="(?:\\ud83c[\\udde6-\\uddff]){2}",I4="[\\ud800-\\udbff][\\udc00-\\udfff]",Lxe="\\u200d",T4=Fxe+"?",E4="["+Pxe+"]?",Bxe="(?:"+Lxe+"(?:"+[C4,k4,I4].join("|")+")"+E4+T4+")*",zxe=E4+T4+Bxe,jxe="(?:"+[C4+mw+"?",mw,k4,I4,Mxe].join("|")+")",Wxe=RegExp(gw+"(?="+gw+")|"+jxe+zxe,"g");function Vxe(t){return t.match(Wxe)||[]}var Uxe=Vxe,Gxe=Axe,Hxe=S4,Kxe=Uxe;function qxe(t){return Hxe(t)?Kxe(t):Gxe(t)}var Xxe=qxe,Yxe=xxe,Qxe=S4,Zxe=Xxe,Jxe=g4;function ebe(t){return function(e){e=Jxe(e);var n=Qxe(e)?Zxe(e):void 0,r=n?n[0]:e.charAt(0),o=n?Yxe(n,1).join(""):e.slice(1);return r[t]()+o}}var tbe=ebe,nbe=tbe,rbe=nbe("toUpperCase"),obe=rbe;const W0=ft(obe);function yt(t){return function(){return t}}const N4=Math.cos,jg=Math.sin,Qo=Math.sqrt,Wg=Math.PI,V0=2*Wg,yw=Math.PI,vw=2*yw,wa=1e-6,ibe=vw-wa;function A4(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function sbe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return A4;const n=10**e;return function(r){this._+=r[0];for(let o=1,i=r.length;o<i;++o)this._+=Math.round(arguments[o]*n)/n+r[o]}}class abe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?A4:sbe(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,o){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+o}`}bezierCurveTo(e,n,r,o,i,s){this._append`C${+e},${+n},${+r},${+o},${this._x1=+i},${this._y1=+s}`}arcTo(e,n,r,o,i){if(e=+e,n=+n,r=+r,o=+o,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,a=this._y1,l=r-e,u=o-n,c=s-e,f=a-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>wa)if(!(Math.abs(f*l-u*c)>wa)||!i)this._append`L${this._x1=e},${this._y1=n}`;else{let d=r-s,p=o-a,m=l*l+u*u,g=d*d+p*p,y=Math.sqrt(m),v=Math.sqrt(h),x=i*Math.tan((yw-Math.acos((m+h-g)/(2*y*v)))/2),b=x/v,w=x/y;Math.abs(b-1)>wa&&this._append`L${e+b*c},${n+b*f}`,this._append`A${i},${i},0,0,${+(f*d>c*p)},${this._x1=e+w*l},${this._y1=n+w*u}`}}arc(e,n,r,o,i,s){if(e=+e,n=+n,r=+r,s=!!s,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(o),l=r*Math.sin(o),u=e+a,c=n+l,f=1^s,h=s?o-i:i-o;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>wa||Math.abs(this._y1-c)>wa)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%vw+vw),h>ibe?this._append`A${r},${r},0,1,${f},${e-a},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>wa&&this._append`A${r},${r},0,${+(h>=yw)},${f},${this._x1=e+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(e,n,r,o){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+o}h${-r}Z`}toString(){return this._}}function _I(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new abe(e)}function DI(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function O4(t){this._context=t}O4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function U0(t){return new O4(t)}function _4(t){return t[0]}function D4(t){return t[1]}function R4(t,e){var n=yt(!0),r=null,o=U0,i=null,s=_I(a);t=typeof t=="function"?t:t===void 0?_4:yt(t),e=typeof e=="function"?e:e===void 0?D4:yt(e);function a(l){var u,c=(l=DI(l)).length,f,h=!1,d;for(r==null&&(i=o(d=s())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+t(f,u,l),+e(f,u,l));if(d)return i=null,d+""||null}return a.x=function(l){return arguments.length?(t=typeof l=="function"?l:yt(+l),a):t},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:yt(+l),a):e},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:yt(!!l),a):n},a.curve=function(l){return arguments.length?(o=l,r!=null&&(i=o(r)),a):o},a.context=function(l){return arguments.length?(l==null?r=i=null:i=o(r=l),a):r},a}function um(t,e,n){var r=null,o=yt(!0),i=null,s=U0,a=null,l=_I(u);t=typeof t=="function"?t:t===void 0?_4:yt(+t),e=typeof e=="function"?e:yt(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?D4:yt(+n);function u(f){var h,d,p,m=(f=DI(f)).length,g,y=!1,v,x=new Array(m),b=new Array(m);for(i==null&&(a=s(v=l())),h=0;h<=m;++h){if(!(h<m&&o(g=f[h],h,f))===y)if(y=!y)d=h,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=h-1;p>=d;--p)a.point(x[p],b[p]);a.lineEnd(),a.areaEnd()}y&&(x[h]=+t(g,h,f),b[h]=+e(g,h,f),a.point(r?+r(g,h,f):x[h],n?+n(g,h,f):b[h]))}if(v)return a=null,v+""||null}function c(){return R4().defined(o).curve(s).context(i)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:yt(+f),r=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:yt(+f),u):t},u.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:yt(+f),u):r},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:yt(+f),n=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:yt(+f),u):e},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:yt(+f),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(f){return arguments.length?(o=typeof f=="function"?f:yt(!!f),u):o},u.curve=function(f){return arguments.length?(s=f,i!=null&&(a=s(i)),u):s},u.context=function(f){return arguments.length?(f==null?i=a=null:a=s(i=f),u):i},u}class P4{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function lbe(t){return new P4(t,!0)}function ube(t){return new P4(t,!1)}const RI={draw(t,e){const n=Qo(e/Wg);t.moveTo(n,0),t.arc(0,0,n,0,V0)}},cbe={draw(t,e){const n=Qo(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},M4=Qo(1/3),fbe=M4*2,hbe={draw(t,e){const n=Qo(e/fbe),r=n*M4;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},dbe={draw(t,e){const n=Qo(e),r=-n/2;t.rect(r,r,n,n)}},pbe=.8908130915292852,F4=jg(Wg/10)/jg(7*Wg/10),mbe=jg(V0/10)*F4,gbe=-N4(V0/10)*F4,ybe={draw(t,e){const n=Qo(e*pbe),r=mbe*n,o=gbe*n;t.moveTo(0,-n),t.lineTo(r,o);for(let i=1;i<5;++i){const s=V0*i/5,a=N4(s),l=jg(s);t.lineTo(l*n,-a*n),t.lineTo(a*r-l*o,l*r+a*o)}t.closePath()}},sb=Qo(3),vbe={draw(t,e){const n=-Qo(e/(sb*3));t.moveTo(0,n*2),t.lineTo(-sb*n,-n),t.lineTo(sb*n,-n),t.closePath()}},qr=-.5,Xr=Qo(3)/2,xw=1/Qo(12),xbe=(xw/2+1)*3,bbe={draw(t,e){const n=Qo(e/xbe),r=n/2,o=n*xw,i=r,s=n*xw+n,a=-i,l=s;t.moveTo(r,o),t.lineTo(i,s),t.lineTo(a,l),t.lineTo(qr*r-Xr*o,Xr*r+qr*o),t.lineTo(qr*i-Xr*s,Xr*i+qr*s),t.lineTo(qr*a-Xr*l,Xr*a+qr*l),t.lineTo(qr*r+Xr*o,qr*o-Xr*r),t.lineTo(qr*i+Xr*s,qr*s-Xr*i),t.lineTo(qr*a+Xr*l,qr*l-Xr*a),t.closePath()}};function wbe(t,e){let n=null,r=_I(o);t=typeof t=="function"?t:yt(t||RI),e=typeof e=="function"?e:yt(e===void 0?64:+e);function o(){let i;if(n||(n=i=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return o.type=function(i){return arguments.length?(t=typeof i=="function"?i:yt(i),o):t},o.size=function(i){return arguments.length?(e=typeof i=="function"?i:yt(+i),o):e},o.context=function(i){return arguments.length?(n=i??null,o):n},o}function Vg(){}function Ug(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function L4(t){this._context=t}L4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ug(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ug(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Sbe(t){return new L4(t)}function B4(t){this._context=t}B4.prototype={areaStart:Vg,areaEnd:Vg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Ug(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function $be(t){return new B4(t)}function z4(t){this._context=t}z4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Ug(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Cbe(t){return new z4(t)}function j4(t){this._context=t}j4.prototype={areaStart:Vg,areaEnd:Vg,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function kbe(t){return new j4(t)}function MN(t){return t<0?-1:1}function FN(t,e,n){var r=t._x1-t._x0,o=e-t._x1,i=(t._y1-t._y0)/(r||o<0&&-0),s=(n-t._y1)/(o||r<0&&-0),a=(i*o+s*r)/(r+o);return(MN(i)+MN(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(a))||0}function LN(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function ab(t,e,n){var r=t._x0,o=t._y0,i=t._x1,s=t._y1,a=(i-r)/3;t._context.bezierCurveTo(r+a,o+a*e,i-a,s-a*n,i,s)}function Gg(t){this._context=t}Gg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ab(this,this._t0,LN(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,ab(this,LN(this,n=FN(this,t,e)),n);break;default:ab(this,this._t0,n=FN(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function W4(t){this._context=new V4(t)}(W4.prototype=Object.create(Gg.prototype)).point=function(t,e){Gg.prototype.point.call(this,e,t)};function V4(t){this._context=t}V4.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,o,i){this._context.bezierCurveTo(e,t,r,n,i,o)}};function Ibe(t){return new Gg(t)}function Tbe(t){return new W4(t)}function U4(t){this._context=t}U4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=BN(t),o=BN(e),i=0,s=1;s<n;++i,++s)this._context.bezierCurveTo(r[0][i],o[0][i],r[1][i],o[1][i],t[s],e[s]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function BN(t){var e,n=t.length-1,r,o=new Array(n),i=new Array(n),s=new Array(n);for(o[0]=0,i[0]=2,s[0]=t[0]+2*t[1],e=1;e<n-1;++e)o[e]=1,i[e]=4,s[e]=4*t[e]+2*t[e+1];for(o[n-1]=2,i[n-1]=7,s[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=o[e]/i[e-1],i[e]-=r,s[e]-=r*s[e-1];for(o[n-1]=s[n-1]/i[n-1],e=n-2;e>=0;--e)o[e]=(s[e]-o[e+1])/i[e];for(i[n-1]=(t[n]+o[n-1])/2,e=0;e<n-1;++e)i[e]=2*t[e+1]-o[e+1];return[o,i]}function Ebe(t){return new U4(t)}function G0(t,e){this._context=t,this._t=e}G0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function Nbe(t){return new G0(t,.5)}function Abe(t){return new G0(t,0)}function Obe(t){return new G0(t,1)}function Vu(t,e){if((s=t.length)>1)for(var n=1,r,o,i=t[e[0]],s,a=i.length;n<s;++n)for(o=i,i=t[e[n]],r=0;r<a;++r)i[r][1]+=i[r][0]=isNaN(o[r][1])?o[r][0]:o[r][1]}function bw(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function _be(t,e){return t[e]}function Dbe(t){const e=[];return e.key=t,e}function Rbe(){var t=yt([]),e=bw,n=Vu,r=_be;function o(i){var s=Array.from(t.apply(this,arguments),Dbe),a,l=s.length,u=-1,c;for(const f of i)for(a=0,++u;a<l;++a)(s[a][u]=[0,+r(f,s[a].key,u,i)]).data=f;for(a=0,c=DI(e(s));a<l;++a)s[c[a]].index=a;return n(s,c),s}return o.keys=function(i){return arguments.length?(t=typeof i=="function"?i:yt(Array.from(i)),o):t},o.value=function(i){return arguments.length?(r=typeof i=="function"?i:yt(+i),o):r},o.order=function(i){return arguments.length?(e=i==null?bw:typeof i=="function"?i:yt(Array.from(i)),o):e},o.offset=function(i){return arguments.length?(n=i??Vu,o):n},o}function Pbe(t,e){if((r=t.length)>0){for(var n,r,o=0,i=t[0].length,s;o<i;++o){for(s=n=0;n<r;++n)s+=t[n][o][1]||0;if(s)for(n=0;n<r;++n)t[n][o][1]/=s}Vu(t,e)}}function Mbe(t,e){if((o=t.length)>0){for(var n=0,r=t[e[0]],o,i=r.length;n<i;++n){for(var s=0,a=0;s<o;++s)a+=t[s][n][1]||0;r[n][1]+=r[n][0]=-a/2}Vu(t,e)}}function Fbe(t,e){if(!(!((s=t.length)>0)||!((i=(o=t[e[0]]).length)>0))){for(var n=0,r=1,o,i,s;r<i;++r){for(var a=0,l=0,u=0;a<s;++a){for(var c=t[e[a]],f=c[r][1]||0,h=c[r-1][1]||0,d=(f-h)/2,p=0;p<a;++p){var m=t[e[p]],g=m[r][1]||0,y=m[r-1][1]||0;d+=g-y}l+=f,u+=d*f}o[r-1][1]+=o[r-1][0]=n,l&&(n-=u/l)}o[r-1][1]+=o[r-1][0]=n,Vu(t,e)}}function mh(t){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mh(t)}var Lbe=["type","size","sizeType"];function ww(){return ww=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ww.apply(this,arguments)}function zN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function jN(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?zN(Object(n),!0).forEach(function(r){Bbe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Bbe(t,e,n){return e=zbe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zbe(t){var e=jbe(t,"string");return mh(e)=="symbol"?e:e+""}function jbe(t,e){if(mh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(mh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wbe(t,e){if(t==null)return{};var n=Vbe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Vbe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var G4={symbolCircle:RI,symbolCross:cbe,symbolDiamond:hbe,symbolSquare:dbe,symbolStar:ybe,symbolTriangle:vbe,symbolWye:bbe},Ube=Math.PI/180,Gbe=function(e){var n="symbol".concat(W0(e));return G4[n]||RI},Hbe=function(e,n,r){if(n==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var o=18*Ube;return 1.25*e*e*(Math.tan(o)-Math.tan(o*2)*Math.pow(Math.tan(o),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},Kbe=function(e,n){G4["symbol".concat(W0(e))]=n},PI=function(e){var n=e.type,r=n===void 0?"circle":n,o=e.size,i=o===void 0?64:o,s=e.sizeType,a=s===void 0?"area":s,l=Wbe(e,Lbe),u=jN(jN({},l),{},{type:r,size:i,sizeType:a}),c=function(){var g=Gbe(r),y=wbe().type(g).size(Hbe(i,a,r));return y()},f=u.className,h=u.cx,d=u.cy,p=Ve(u,!0);return h===+h&&d===+d&&i===+i?W.createElement("path",ww({},p,{className:Je("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(d,")"),d:c()})):null};PI.registerSymbol=Kbe;function Uu(t){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uu(t)}function Sw(){return Sw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Sw.apply(this,arguments)}function WN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function qbe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?WN(Object(n),!0).forEach(function(r){gh(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WN(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Xbe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ybe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,K4(r.key),r)}}function Qbe(t,e,n){return e&&Ybe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zbe(t,e,n){return e=Hg(e),Jbe(t,H4()?Reflect.construct(e,n||[],Hg(t).constructor):e.apply(t,n))}function Jbe(t,e){if(e&&(Uu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e1e(t)}function e1e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H4(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(H4=function(){return!!t})()}function Hg(t){return Hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Hg(t)}function t1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$w(t,e)}function $w(t,e){return $w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},$w(t,e)}function gh(t,e,n){return e=K4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K4(t){var e=n1e(t,"string");return Uu(e)=="symbol"?e:e+""}function n1e(t,e){if(Uu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Uu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Yr=32,MI=function(t){function e(){return Xbe(this,e),Zbe(this,e,arguments)}return t1e(e,t),Qbe(e,[{key:"renderIcon",value:function(r){var o=this.props.inactiveColor,i=Yr/2,s=Yr/6,a=Yr/3,l=r.inactive?o:r.color;if(r.type==="plainline")return W.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:i,x2:Yr,y2:i,className:"recharts-legend-icon"});if(r.type==="line")return W.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*a,",").concat(i,`
            H`).concat(Yr,"M").concat(2*a,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(a,",").concat(i),className:"recharts-legend-icon"});if(r.type==="rect")return W.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Yr/8,"h").concat(Yr,"v").concat(Yr*3/4,"h").concat(-Yr,"z"),className:"recharts-legend-icon"});if(W.isValidElement(r.legendIcon)){var u=qbe({},r);return delete u.legendIcon,W.cloneElement(r.legendIcon,u)}return W.createElement(PI,{fill:l,cx:i,cy:i,size:Yr,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,o=this.props,i=o.payload,s=o.iconSize,a=o.layout,l=o.formatter,u=o.inactiveColor,c={x:0,y:0,width:Yr,height:Yr},f={display:a==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(d,p){var m=d.formatter||l,g=Je(gh(gh({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",d.inactive));if(d.type==="none")return null;var y=Be(d.value)?null:d.value;zi(!Be(d.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var v=d.inactive?u:d.color;return W.createElement("li",Sw({className:g,style:f,key:"legend-item-".concat(p)},zg(r.props,d,p)),W.createElement(dw,{width:s,height:s,viewBox:c,style:h},r.renderIcon(d)),W.createElement("span",{className:"recharts-legend-item-text",style:{color:v}},m?m(y,d,p):y))})}},{key:"render",value:function(){var r=this.props,o=r.payload,i=r.layout,s=r.align;if(!o||!o.length)return null;var a={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return W.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}])}(se.PureComponent);gh(MI,"displayName","Legend");gh(MI,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var r1e=N0;function o1e(){this.__data__=new r1e,this.size=0}var i1e=o1e;function s1e(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var a1e=s1e;function l1e(t){return this.__data__.get(t)}var u1e=l1e;function c1e(t){return this.__data__.has(t)}var f1e=c1e,h1e=N0,d1e=$I,p1e=CI,m1e=200;function g1e(t,e){var n=this.__data__;if(n instanceof h1e){var r=n.__data__;if(!d1e||r.length<m1e-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new p1e(r)}return n.set(t,e),this.size=n.size,this}var y1e=g1e,v1e=N0,x1e=i1e,b1e=a1e,w1e=u1e,S1e=f1e,$1e=y1e;function Mc(t){var e=this.__data__=new v1e(t);this.size=e.size}Mc.prototype.clear=x1e;Mc.prototype.delete=b1e;Mc.prototype.get=w1e;Mc.prototype.has=S1e;Mc.prototype.set=$1e;var q4=Mc,C1e="__lodash_hash_undefined__";function k1e(t){return this.__data__.set(t,C1e),this}var I1e=k1e;function T1e(t){return this.__data__.has(t)}var E1e=T1e,N1e=CI,A1e=I1e,O1e=E1e;function Kg(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new N1e;++e<n;)this.add(t[e])}Kg.prototype.add=Kg.prototype.push=A1e;Kg.prototype.has=O1e;var X4=Kg;function _1e(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Y4=_1e;function D1e(t,e){return t.has(e)}var Q4=D1e,R1e=X4,P1e=Y4,M1e=Q4,F1e=1,L1e=2;function B1e(t,e,n,r,o,i){var s=n&F1e,a=t.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var u=i.get(t),c=i.get(e);if(u&&c)return u==e&&c==t;var f=-1,h=!0,d=n&L1e?new R1e:void 0;for(i.set(t,e),i.set(e,t);++f<a;){var p=t[f],m=e[f];if(r)var g=s?r(m,p,f,e,t,i):r(p,m,f,t,e,i);if(g!==void 0){if(g)continue;h=!1;break}if(d){if(!P1e(e,function(y,v){if(!M1e(d,v)&&(p===y||o(p,y,n,r,i)))return d.push(v)})){h=!1;break}}else if(!(p===m||o(p,m,n,r,i))){h=!1;break}}return i.delete(t),i.delete(e),h}var Z4=B1e,z1e=ki,j1e=z1e.Uint8Array,W1e=j1e;function V1e(t){var e=-1,n=Array(t.size);return t.forEach(function(r,o){n[++e]=[o,r]}),n}var U1e=V1e;function G1e(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var FI=G1e,VN=wp,UN=W1e,H1e=SI,K1e=Z4,q1e=U1e,X1e=FI,Y1e=1,Q1e=2,Z1e="[object Boolean]",J1e="[object Date]",ewe="[object Error]",twe="[object Map]",nwe="[object Number]",rwe="[object RegExp]",owe="[object Set]",iwe="[object String]",swe="[object Symbol]",awe="[object ArrayBuffer]",lwe="[object DataView]",GN=VN?VN.prototype:void 0,lb=GN?GN.valueOf:void 0;function uwe(t,e,n,r,o,i,s){switch(n){case lwe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case awe:return!(t.byteLength!=e.byteLength||!i(new UN(t),new UN(e)));case Z1e:case J1e:case nwe:return H1e(+t,+e);case ewe:return t.name==e.name&&t.message==e.message;case rwe:case iwe:return t==e+"";case twe:var a=q1e;case owe:var l=r&Y1e;if(a||(a=X1e),t.size!=e.size&&!l)return!1;var u=s.get(t);if(u)return u==e;r|=Q1e,s.set(t,e);var c=K1e(a(t),a(e),r,o,i,s);return s.delete(t),c;case swe:if(lb)return lb.call(t)==lb.call(e)}return!1}var cwe=uwe;function fwe(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}var J4=fwe,hwe=J4,dwe=Tr;function pwe(t,e,n){var r=e(t);return dwe(t)?r:hwe(r,n(t))}var mwe=pwe;function gwe(t,e){for(var n=-1,r=t==null?0:t.length,o=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[o++]=s)}return i}var ywe=gwe;function vwe(){return[]}var xwe=vwe,bwe=ywe,wwe=xwe,Swe=Object.prototype,$we=Swe.propertyIsEnumerable,HN=Object.getOwnPropertySymbols,Cwe=HN?function(t){return t==null?[]:(t=Object(t),bwe(HN(t),function(e){return $we.call(t,e)}))}:wwe,kwe=Cwe;function Iwe(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var Twe=Iwe,Ewe=as,Nwe=ls,Awe="[object Arguments]";function Owe(t){return Nwe(t)&&Ewe(t)==Awe}var _we=Owe,KN=_we,Dwe=ls,ej=Object.prototype,Rwe=ej.hasOwnProperty,Pwe=ej.propertyIsEnumerable,Mwe=KN(function(){return arguments}())?KN:function(t){return Dwe(t)&&Rwe.call(t,"callee")&&!Pwe.call(t,"callee")},LI=Mwe,qg={exports:{}};function Fwe(){return!1}var Lwe=Fwe;qg.exports;(function(t,e){var n=ki,r=Lwe,o=e&&!e.nodeType&&e,i=o&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===o,a=s?n.Buffer:void 0,l=a?a.isBuffer:void 0,u=l||r;t.exports=u})(qg,qg.exports);var tj=qg.exports,Bwe=9007199254740991,zwe=/^(?:0|[1-9]\d*)$/;function jwe(t,e){var n=typeof t;return e=e??Bwe,!!e&&(n=="number"||n!="symbol"&&zwe.test(t))&&t>-1&&t%1==0&&t<e}var BI=jwe,Wwe=9007199254740991;function Vwe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Wwe}var zI=Vwe,Uwe=as,Gwe=zI,Hwe=ls,Kwe="[object Arguments]",qwe="[object Array]",Xwe="[object Boolean]",Ywe="[object Date]",Qwe="[object Error]",Zwe="[object Function]",Jwe="[object Map]",eSe="[object Number]",tSe="[object Object]",nSe="[object RegExp]",rSe="[object Set]",oSe="[object String]",iSe="[object WeakMap]",sSe="[object ArrayBuffer]",aSe="[object DataView]",lSe="[object Float32Array]",uSe="[object Float64Array]",cSe="[object Int8Array]",fSe="[object Int16Array]",hSe="[object Int32Array]",dSe="[object Uint8Array]",pSe="[object Uint8ClampedArray]",mSe="[object Uint16Array]",gSe="[object Uint32Array]",$t={};$t[lSe]=$t[uSe]=$t[cSe]=$t[fSe]=$t[hSe]=$t[dSe]=$t[pSe]=$t[mSe]=$t[gSe]=!0;$t[Kwe]=$t[qwe]=$t[sSe]=$t[Xwe]=$t[aSe]=$t[Ywe]=$t[Qwe]=$t[Zwe]=$t[Jwe]=$t[eSe]=$t[tSe]=$t[nSe]=$t[rSe]=$t[oSe]=$t[iSe]=!1;function ySe(t){return Hwe(t)&&Gwe(t.length)&&!!$t[Uwe(t)]}var vSe=ySe;function xSe(t){return function(e){return t(e)}}var nj=xSe,Xg={exports:{}};Xg.exports;(function(t,e){var n=c4,r=e&&!e.nodeType&&e,o=r&&!0&&t&&!t.nodeType&&t,i=o&&o.exports===r,s=i&&n.process,a=function(){try{var l=o&&o.require&&o.require("util").types;return l||s&&s.binding&&s.binding("util")}catch{}}();t.exports=a})(Xg,Xg.exports);var bSe=Xg.exports,wSe=vSe,SSe=nj,qN=bSe,XN=qN&&qN.isTypedArray,$Se=XN?SSe(XN):wSe,rj=$Se,CSe=Twe,kSe=LI,ISe=Tr,TSe=tj,ESe=BI,NSe=rj,ASe=Object.prototype,OSe=ASe.hasOwnProperty;function _Se(t,e){var n=ISe(t),r=!n&&kSe(t),o=!n&&!r&&TSe(t),i=!n&&!r&&!o&&NSe(t),s=n||r||o||i,a=s?CSe(t.length,String):[],l=a.length;for(var u in t)(e||OSe.call(t,u))&&!(s&&(u=="length"||o&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||ESe(u,l)))&&a.push(u);return a}var DSe=_Se,RSe=Object.prototype;function PSe(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||RSe;return t===n}var MSe=PSe;function FSe(t,e){return function(n){return t(e(n))}}var oj=FSe,LSe=oj,BSe=LSe(Object.keys,Object),zSe=BSe,jSe=MSe,WSe=zSe,VSe=Object.prototype,USe=VSe.hasOwnProperty;function GSe(t){if(!jSe(t))return WSe(t);var e=[];for(var n in Object(t))USe.call(t,n)&&n!="constructor"&&e.push(n);return e}var HSe=GSe,KSe=wI,qSe=zI;function XSe(t){return t!=null&&qSe(t.length)&&!KSe(t)}var kp=XSe,YSe=DSe,QSe=HSe,ZSe=kp;function JSe(t){return ZSe(t)?YSe(t):QSe(t)}var H0=JSe,e$e=mwe,t$e=kwe,n$e=H0;function r$e(t){return e$e(t,n$e,t$e)}var o$e=r$e,YN=o$e,i$e=1,s$e=Object.prototype,a$e=s$e.hasOwnProperty;function l$e(t,e,n,r,o,i){var s=n&i$e,a=YN(t),l=a.length,u=YN(e),c=u.length;if(l!=c&&!s)return!1;for(var f=l;f--;){var h=a[f];if(!(s?h in e:a$e.call(e,h)))return!1}var d=i.get(t),p=i.get(e);if(d&&p)return d==e&&p==t;var m=!0;i.set(t,e),i.set(e,t);for(var g=s;++f<l;){h=a[f];var y=t[h],v=e[h];if(r)var x=s?r(v,y,h,e,t,i):r(y,v,h,t,e,i);if(!(x===void 0?y===v||o(y,v,n,r,i):x)){m=!1;break}g||(g=h=="constructor")}if(m&&!g){var b=t.constructor,w=e.constructor;b!=w&&"constructor"in t&&"constructor"in e&&!(typeof b=="function"&&b instanceof b&&typeof w=="function"&&w instanceof w)&&(m=!1)}return i.delete(t),i.delete(e),m}var u$e=l$e,c$e=Tl,f$e=ki,h$e=c$e(f$e,"DataView"),d$e=h$e,p$e=Tl,m$e=ki,g$e=p$e(m$e,"Promise"),y$e=g$e,v$e=Tl,x$e=ki,b$e=v$e(x$e,"Set"),ij=b$e,w$e=Tl,S$e=ki,$$e=w$e(S$e,"WeakMap"),C$e=$$e,Cw=d$e,kw=$I,Iw=y$e,Tw=ij,Ew=C$e,sj=as,Fc=h4,QN="[object Map]",k$e="[object Object]",ZN="[object Promise]",JN="[object Set]",eA="[object WeakMap]",tA="[object DataView]",I$e=Fc(Cw),T$e=Fc(kw),E$e=Fc(Iw),N$e=Fc(Tw),A$e=Fc(Ew),Sa=sj;(Cw&&Sa(new Cw(new ArrayBuffer(1)))!=tA||kw&&Sa(new kw)!=QN||Iw&&Sa(Iw.resolve())!=ZN||Tw&&Sa(new Tw)!=JN||Ew&&Sa(new Ew)!=eA)&&(Sa=function(t){var e=sj(t),n=e==k$e?t.constructor:void 0,r=n?Fc(n):"";if(r)switch(r){case I$e:return tA;case T$e:return QN;case E$e:return ZN;case N$e:return JN;case A$e:return eA}return e});var O$e=Sa,ub=q4,_$e=Z4,D$e=cwe,R$e=u$e,nA=O$e,rA=Tr,oA=tj,P$e=rj,M$e=1,iA="[object Arguments]",sA="[object Array]",cm="[object Object]",F$e=Object.prototype,aA=F$e.hasOwnProperty;function L$e(t,e,n,r,o,i){var s=rA(t),a=rA(e),l=s?sA:nA(t),u=a?sA:nA(e);l=l==iA?cm:l,u=u==iA?cm:u;var c=l==cm,f=u==cm,h=l==u;if(h&&oA(t)){if(!oA(e))return!1;s=!0,c=!1}if(h&&!c)return i||(i=new ub),s||P$e(t)?_$e(t,e,n,r,o,i):D$e(t,e,l,n,r,o,i);if(!(n&M$e)){var d=c&&aA.call(t,"__wrapped__"),p=f&&aA.call(e,"__wrapped__");if(d||p){var m=d?t.value():t,g=p?e.value():e;return i||(i=new ub),o(m,g,n,r,i)}}return h?(i||(i=new ub),R$e(t,e,n,r,o,i)):!1}var B$e=L$e,z$e=B$e,lA=ls;function aj(t,e,n,r,o){return t===e?!0:t==null||e==null||!lA(t)&&!lA(e)?t!==t&&e!==e:z$e(t,e,n,r,aj,o)}var jI=aj,j$e=q4,W$e=jI,V$e=1,U$e=2;function G$e(t,e,n,r){var o=n.length,i=o,s=!r;if(t==null)return!i;for(t=Object(t);o--;){var a=n[o];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){a=n[o];var l=a[0],u=t[l],c=a[1];if(s&&a[2]){if(u===void 0&&!(l in t))return!1}else{var f=new j$e;if(r)var h=r(u,c,l,t,e,f);if(!(h===void 0?W$e(c,u,V$e|U$e,r,f):h))return!1}}return!0}var H$e=G$e,K$e=ua;function q$e(t){return t===t&&!K$e(t)}var lj=q$e,X$e=lj,Y$e=H0;function Q$e(t){for(var e=Y$e(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,X$e(o)]}return e}var Z$e=Q$e;function J$e(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var uj=J$e,eCe=H$e,tCe=Z$e,nCe=uj;function rCe(t){var e=tCe(t);return e.length==1&&e[0][2]?nCe(e[0][0],e[0][1]):function(n){return n===t||eCe(n,t,e)}}var oCe=rCe;function iCe(t,e){return t!=null&&e in Object(t)}var sCe=iCe,aCe=y4,lCe=LI,uCe=Tr,cCe=BI,fCe=zI,hCe=O0;function dCe(t,e,n){e=aCe(e,t);for(var r=-1,o=e.length,i=!1;++r<o;){var s=hCe(e[r]);if(!(i=t!=null&&n(t,s)))break;t=t[s]}return i||++r!=o?i:(o=t==null?0:t.length,!!o&&fCe(o)&&cCe(s,o)&&(uCe(t)||lCe(t)))}var pCe=dCe,mCe=sCe,gCe=pCe;function yCe(t,e){return t!=null&&gCe(t,e,mCe)}var vCe=yCe,xCe=jI,bCe=v4,wCe=vCe,SCe=bI,$Ce=lj,CCe=uj,kCe=O0,ICe=1,TCe=2;function ECe(t,e){return SCe(t)&&$Ce(e)?CCe(kCe(t),e):function(n){var r=bCe(n,t);return r===void 0&&r===e?wCe(n,t):xCe(e,r,ICe|TCe)}}var NCe=ECe;function ACe(t){return t}var Lc=ACe;function OCe(t){return function(e){return e==null?void 0:e[t]}}var _Ce=OCe,DCe=TI;function RCe(t){return function(e){return DCe(e,t)}}var PCe=RCe,MCe=_Ce,FCe=PCe,LCe=bI,BCe=O0;function zCe(t){return LCe(t)?MCe(BCe(t)):FCe(t)}var jCe=zCe,WCe=oCe,VCe=NCe,UCe=Lc,GCe=Tr,HCe=jCe;function KCe(t){return typeof t=="function"?t:t==null?UCe:typeof t=="object"?GCe(t)?VCe(t[0],t[1]):WCe(t):HCe(t)}var ca=KCe;function qCe(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}var cj=qCe;function XCe(t){return t!==t}var YCe=XCe;function QCe(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}var ZCe=QCe,JCe=cj,eke=YCe,tke=ZCe;function nke(t,e,n){return e===e?tke(t,e,n):JCe(t,eke,n)}var rke=nke,oke=rke;function ike(t,e){var n=t==null?0:t.length;return!!n&&oke(t,e,0)>-1}var ske=ike;function ake(t,e,n){for(var r=-1,o=t==null?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}var lke=ake;function uke(){}var cke=uke,cb=ij,fke=cke,hke=FI,dke=1/0,pke=cb&&1/hke(new cb([,-0]))[1]==dke?function(t){return new cb(t)}:fke,mke=pke,gke=X4,yke=ske,vke=lke,xke=Q4,bke=mke,wke=FI,Ske=200;function $ke(t,e,n){var r=-1,o=yke,i=t.length,s=!0,a=[],l=a;if(n)s=!1,o=vke;else if(i>=Ske){var u=e?null:bke(t);if(u)return wke(u);s=!1,o=xke,l=new gke}else l=e?[]:a;e:for(;++r<i;){var c=t[r],f=e?e(c):c;if(c=n||c!==0?c:0,s&&f===f){for(var h=l.length;h--;)if(l[h]===f)continue e;e&&l.push(f),a.push(c)}else o(l,f,n)||(l!==a&&l.push(f),a.push(c))}return a}var Cke=$ke,kke=ca,Ike=Cke;function Tke(t,e){return t&&t.length?Ike(t,kke(e)):[]}var Eke=Tke;const uA=ft(Eke);function fj(t,e,n){return e===!0?uA(t,n):Be(e)?uA(t,e):t}function Gu(t){"@babel/helpers - typeof";return Gu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gu(t)}var Nke=["ref"];function cA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Ii(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?cA(Object(n),!0).forEach(function(r){K0(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ake(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dj(r.key),r)}}function Oke(t,e,n){return e&&fA(t.prototype,e),n&&fA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _ke(t,e,n){return e=Yg(e),Dke(t,hj()?Reflect.construct(e,n||[],Yg(t).constructor):e.apply(t,n))}function Dke(t,e){if(e&&(Gu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rke(t)}function Rke(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hj(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hj=function(){return!!t})()}function Yg(t){return Yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Yg(t)}function Pke(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nw(t,e)}function Nw(t,e){return Nw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},Nw(t,e)}function K0(t,e,n){return e=dj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dj(t){var e=Mke(t,"string");return Gu(e)=="symbol"?e:e+""}function Mke(t,e){if(Gu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Gu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fke(t,e){if(t==null)return{};var n=Lke(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Lke(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Bke(t){return t.value}function zke(t,e){if(W.isValidElement(t))return W.cloneElement(t,e);if(typeof t=="function")return W.createElement(t,e);e.ref;var n=Fke(e,Nke);return W.createElement(MI,n)}var hA=1,ji=function(t){function e(){var n;Ake(this,e);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=_ke(this,e,[].concat(o)),K0(n,"lastBoundingBox",{width:-1,height:-1}),n}return Pke(e,t),Oke(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,o=this.getBBox();o?(Math.abs(o.width-this.lastBoundingBox.width)>hA||Math.abs(o.height-this.lastBoundingBox.height)>hA)&&(this.lastBoundingBox.width=o.width,this.lastBoundingBox.height=o.height,r&&r(o)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Ii({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var o=this.props,i=o.layout,s=o.align,a=o.verticalAlign,l=o.margin,u=o.chartWidth,c=o.chartHeight,f,h;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(s==="center"&&i==="vertical"){var d=this.getBBoxSnapshot();f={left:((u||0)-d.width)/2}}else f=s==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(a==="middle"){var p=this.getBBoxSnapshot();h={top:((c||0)-p.height)/2}}else h=a==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return Ii(Ii({},f),h)}},{key:"render",value:function(){var r=this,o=this.props,i=o.content,s=o.width,a=o.height,l=o.wrapperStyle,u=o.payloadUniqBy,c=o.payload,f=Ii(Ii({position:"absolute",width:s||"auto",height:a||"auto"},this.getDefaultPosition(l)),l);return W.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(d){r.wrapperNode=d}},zke(i,Ii(Ii({},this.props),{},{payload:fj(c,u,Bke)})))}}],[{key:"getWithHeight",value:function(r,o){var i=Ii(Ii({},this.defaultProps),r.props),s=i.layout;return s==="vertical"&&pe(r.props.height)?{height:r.props.height}:s==="horizontal"?{width:r.props.width||o}:null}}])}(se.PureComponent);K0(ji,"displayName","Legend");K0(ji,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var dA=wp,jke=LI,Wke=Tr,pA=dA?dA.isConcatSpreadable:void 0;function Vke(t){return Wke(t)||jke(t)||!!(pA&&t&&t[pA])}var Uke=Vke,Gke=J4,Hke=Uke;function pj(t,e,n,r,o){var i=-1,s=t.length;for(n||(n=Hke),o||(o=[]);++i<s;){var a=t[i];e>0&&n(a)?e>1?pj(a,e-1,n,r,o):Gke(o,a):r||(o[o.length]=a)}return o}var mj=pj;function Kke(t){return function(e,n,r){for(var o=-1,i=Object(e),s=r(e),a=s.length;a--;){var l=s[t?a:++o];if(n(i[l],l,i)===!1)break}return e}}var qke=Kke,Xke=qke,Yke=Xke(),Qke=Yke,Zke=Qke,Jke=H0;function eIe(t,e){return t&&Zke(t,e,Jke)}var gj=eIe,tIe=kp;function nIe(t,e){return function(n,r){if(n==null)return n;if(!tIe(n))return t(n,r);for(var o=n.length,i=e?o:-1,s=Object(n);(e?i--:++i<o)&&r(s[i],i,s)!==!1;);return n}}var rIe=nIe,oIe=gj,iIe=rIe,sIe=iIe(oIe),WI=sIe,aIe=WI,lIe=kp;function uIe(t,e){var n=-1,r=lIe(t)?Array(t.length):[];return aIe(t,function(o,i,s){r[++n]=e(o,i,s)}),r}var yj=uIe;function cIe(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var fIe=cIe,mA=Oc;function hIe(t,e){if(t!==e){var n=t!==void 0,r=t===null,o=t===t,i=mA(t),s=e!==void 0,a=e===null,l=e===e,u=mA(e);if(!a&&!u&&!i&&t>e||i&&s&&l&&!a&&!u||r&&s&&l||!n&&l||!o)return 1;if(!r&&!i&&!u&&t<e||u&&n&&o&&!r&&!i||a&&n&&o||!s&&o||!l)return-1}return 0}var dIe=hIe,pIe=dIe;function mIe(t,e,n){for(var r=-1,o=t.criteria,i=e.criteria,s=o.length,a=n.length;++r<s;){var l=pIe(o[r],i[r]);if(l){if(r>=a)return l;var u=n[r];return l*(u=="desc"?-1:1)}}return t.index-e.index}var gIe=mIe,fb=II,yIe=TI,vIe=ca,xIe=yj,bIe=fIe,wIe=nj,SIe=gIe,$Ie=Lc,CIe=Tr;function kIe(t,e,n){e.length?e=fb(e,function(i){return CIe(i)?function(s){return yIe(s,i.length===1?i[0]:i)}:i}):e=[$Ie];var r=-1;e=fb(e,wIe(vIe));var o=xIe(t,function(i,s,a){var l=fb(e,function(u){return u(i)});return{criteria:l,index:++r,value:i}});return bIe(o,function(i,s){return SIe(i,s,n)})}var IIe=kIe;function TIe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var EIe=TIe,NIe=EIe,gA=Math.max;function AIe(t,e,n){return e=gA(e===void 0?t.length-1:e,0),function(){for(var r=arguments,o=-1,i=gA(r.length-e,0),s=Array(i);++o<i;)s[o]=r[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=r[o];return a[e]=n(s),NIe(t,this,a)}}var OIe=AIe;function _Ie(t){return function(){return t}}var DIe=_Ie,RIe=Tl,PIe=function(){try{var t=RIe(Object,"defineProperty");return t({},"",{}),t}catch{}}(),vj=PIe,MIe=DIe,yA=vj,FIe=Lc,LIe=yA?function(t,e){return yA(t,"toString",{configurable:!0,enumerable:!1,value:MIe(e),writable:!0})}:FIe,BIe=LIe,zIe=800,jIe=16,WIe=Date.now;function VIe(t){var e=0,n=0;return function(){var r=WIe(),o=jIe-(r-n);if(n=r,o>0){if(++e>=zIe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var UIe=VIe,GIe=BIe,HIe=UIe,KIe=HIe(GIe),qIe=KIe,XIe=Lc,YIe=OIe,QIe=qIe;function ZIe(t,e){return QIe(YIe(t,e,XIe),t+"")}var JIe=ZIe,eTe=SI,tTe=kp,nTe=BI,rTe=ua;function oTe(t,e,n){if(!rTe(n))return!1;var r=typeof e;return(r=="number"?tTe(n)&&nTe(e,n.length):r=="string"&&e in n)?eTe(n[e],t):!1}var q0=oTe,iTe=mj,sTe=IIe,aTe=JIe,vA=q0,lTe=aTe(function(t,e){if(t==null)return[];var n=e.length;return n>1&&vA(t,e[0],e[1])?e=[]:n>2&&vA(e[0],e[1],e[2])&&(e=[e[0]]),sTe(t,iTe(e,1),[])}),uTe=lTe;const VI=ft(uTe);function yh(t){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yh(t)}function Aw(){return Aw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Aw.apply(this,arguments)}function cTe(t,e){return pTe(t)||dTe(t,e)||hTe(t,e)||fTe()}function fTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hTe(t,e){if(t){if(typeof t=="string")return xA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xA(t,e)}}function xA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dTe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function pTe(t){if(Array.isArray(t))return t}function bA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function hb(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bA(Object(n),!0).forEach(function(r){mTe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function mTe(t,e,n){return e=gTe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gTe(t){var e=yTe(t,"string");return yh(e)=="symbol"?e:e+""}function yTe(t,e){if(yh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(yh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vTe(t){return Array.isArray(t)&&pn(t[0])&&pn(t[1])?t.join(" ~ "):t}var xTe=function(e){var n=e.separator,r=n===void 0?" : ":n,o=e.contentStyle,i=o===void 0?{}:o,s=e.itemStyle,a=s===void 0?{}:s,l=e.labelStyle,u=l===void 0?{}:l,c=e.payload,f=e.formatter,h=e.itemSorter,d=e.wrapperClassName,p=e.labelClassName,m=e.label,g=e.labelFormatter,y=e.accessibilityLayer,v=y===void 0?!1:y,x=function(){if(c&&c.length){var N={padding:0,margin:0},_=(h?VI(c,h):c).map(function(D,O){if(D.type==="none")return null;var R=hb({display:"block",paddingTop:4,paddingBottom:4,color:D.color||"#000"},a),F=D.formatter||f||vTe,A=D.value,P=D.name,z=A,U=P;if(F&&z!=null&&U!=null){var H=F(A,P,D,O,c);if(Array.isArray(H)){var X=cTe(H,2);z=X[0],U=X[1]}else z=H}return W.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(O),style:R},pn(U)?W.createElement("span",{className:"recharts-tooltip-item-name"},U):null,pn(U)?W.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,W.createElement("span",{className:"recharts-tooltip-item-value"},z),W.createElement("span",{className:"recharts-tooltip-item-unit"},D.unit||""))});return W.createElement("ul",{className:"recharts-tooltip-item-list",style:N},_)}return null},b=hb({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),w=hb({margin:0},u),S=!We(m),$=S?m:"",C=Je("recharts-default-tooltip",d),k=Je("recharts-tooltip-label",p);S&&g&&c!==void 0&&c!==null&&($=g(m,c));var I=v?{role:"status","aria-live":"assertive"}:{};return W.createElement("div",Aw({className:C,style:b},I),W.createElement("p",{className:k,style:w},W.isValidElement($)?$:"".concat($)),x())};function vh(t){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vh(t)}function fm(t,e,n){return e=bTe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bTe(t){var e=wTe(t,"string");return vh(e)=="symbol"?e:e+""}function wTe(t,e){if(vh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(vh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rf="recharts-tooltip-wrapper",STe={visibility:"hidden"};function $Te(t){var e=t.coordinate,n=t.translateX,r=t.translateY;return Je(rf,fm(fm(fm(fm({},"".concat(rf,"-right"),pe(n)&&e&&pe(e.x)&&n>=e.x),"".concat(rf,"-left"),pe(n)&&e&&pe(e.x)&&n<e.x),"".concat(rf,"-bottom"),pe(r)&&e&&pe(e.y)&&r>=e.y),"".concat(rf,"-top"),pe(r)&&e&&pe(e.y)&&r<e.y))}function wA(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.key,o=t.offsetTopLeft,i=t.position,s=t.reverseDirection,a=t.tooltipDimension,l=t.viewBox,u=t.viewBoxDimension;if(i&&pe(i[r]))return i[r];var c=n[r]-a-o,f=n[r]+o;if(e[r])return s[r]?c:f;if(s[r]){var h=c,d=l[r];return h<d?Math.max(f,l[r]):Math.max(c,l[r])}var p=f+a,m=l[r]+u;return p>m?Math.max(c,l[r]):Math.max(f,l[r])}function CTe(t){var e=t.translateX,n=t.translateY,r=t.useTranslate3d;return{transform:r?"translate3d(".concat(e,"px, ").concat(n,"px, 0)"):"translate(".concat(e,"px, ").concat(n,"px)")}}function kTe(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.offsetTopLeft,o=t.position,i=t.reverseDirection,s=t.tooltipBox,a=t.useTranslate3d,l=t.viewBox,u,c,f;return s.height>0&&s.width>0&&n?(c=wA({allowEscapeViewBox:e,coordinate:n,key:"x",offsetTopLeft:r,position:o,reverseDirection:i,tooltipDimension:s.width,viewBox:l,viewBoxDimension:l.width}),f=wA({allowEscapeViewBox:e,coordinate:n,key:"y",offsetTopLeft:r,position:o,reverseDirection:i,tooltipDimension:s.height,viewBox:l,viewBoxDimension:l.height}),u=CTe({translateX:c,translateY:f,useTranslate3d:a})):u=STe,{cssProperties:u,cssClasses:$Te({translateX:c,translateY:f,coordinate:n})}}function Hu(t){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hu(t)}function SA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function $A(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?SA(Object(n),!0).forEach(function(r){_w(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):SA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ITe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TTe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bj(r.key),r)}}function ETe(t,e,n){return e&&TTe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function NTe(t,e,n){return e=Qg(e),ATe(t,xj()?Reflect.construct(e,n||[],Qg(t).constructor):e.apply(t,n))}function ATe(t,e){if(e&&(Hu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OTe(t)}function OTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xj(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xj=function(){return!!t})()}function Qg(t){return Qg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Qg(t)}function _Te(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ow(t,e)}function Ow(t,e){return Ow=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},Ow(t,e)}function _w(t,e,n){return e=bj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bj(t){var e=DTe(t,"string");return Hu(e)=="symbol"?e:e+""}function DTe(t,e){if(Hu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Hu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var CA=1,RTe=function(t){function e(){var n;ITe(this,e);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=NTe(this,e,[].concat(o)),_w(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),_w(n,"handleKeyDown",function(s){if(s.key==="Escape"){var a,l,u,c;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(l=n.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&a!==void 0?a:0,y:(u=(c=n.props.coordinate)===null||c===void 0?void 0:c.y)!==null&&u!==void 0?u:0}})}}),n}return _Te(e,t),ETe(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>CA||Math.abs(r.height-this.state.lastBoundingBox.height)>CA)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,o;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,o=this.props,i=o.active,s=o.allowEscapeViewBox,a=o.animationDuration,l=o.animationEasing,u=o.children,c=o.coordinate,f=o.hasPayload,h=o.isAnimationActive,d=o.offset,p=o.position,m=o.reverseDirection,g=o.useTranslate3d,y=o.viewBox,v=o.wrapperStyle,x=kTe({allowEscapeViewBox:s,coordinate:c,offsetTopLeft:d,position:p,reverseDirection:m,tooltipBox:this.state.lastBoundingBox,useTranslate3d:g,viewBox:y}),b=x.cssClasses,w=x.cssProperties,S=$A($A({transition:h&&i?"transform ".concat(a,"ms ").concat(l):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},v);return W.createElement("div",{tabIndex:-1,className:b,style:S,ref:function(C){r.wrapperNode=C}},u)}}])}(se.PureComponent),PTe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Wi={isSsr:PTe(),get:function(e){return Wi[e]},set:function(e,n){if(typeof e=="string")Wi[e]=n;else{var r=Object.keys(e);r&&r.length&&r.forEach(function(o){Wi[o]=e[o]})}}};function Ku(t){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ku(t)}function kA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function IA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kA(Object(n),!0).forEach(function(r){UI(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function MTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FTe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Sj(r.key),r)}}function LTe(t,e,n){return e&&FTe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function BTe(t,e,n){return e=Zg(e),zTe(t,wj()?Reflect.construct(e,n||[],Zg(t).constructor):e.apply(t,n))}function zTe(t,e){if(e&&(Ku(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jTe(t)}function jTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wj(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wj=function(){return!!t})()}function Zg(t){return Zg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Zg(t)}function WTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Dw(t,e)}function Dw(t,e){return Dw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},Dw(t,e)}function UI(t,e,n){return e=Sj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sj(t){var e=VTe(t,"string");return Ku(e)=="symbol"?e:e+""}function VTe(t,e){if(Ku(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ku(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UTe(t){return t.dataKey}function GTe(t,e){return W.isValidElement(t)?W.cloneElement(t,e):typeof t=="function"?W.createElement(t,e):W.createElement(xTe,e)}var Zr=function(t){function e(){return MTe(this,e),BTe(this,e,arguments)}return WTe(e,t),LTe(e,[{key:"render",value:function(){var r=this,o=this.props,i=o.active,s=o.allowEscapeViewBox,a=o.animationDuration,l=o.animationEasing,u=o.content,c=o.coordinate,f=o.filterNull,h=o.isAnimationActive,d=o.offset,p=o.payload,m=o.payloadUniqBy,g=o.position,y=o.reverseDirection,v=o.useTranslate3d,x=o.viewBox,b=o.wrapperStyle,w=p??[];f&&w.length&&(w=fj(p.filter(function($){return $.value!=null&&($.hide!==!0||r.props.includeHidden)}),m,UTe));var S=w.length>0;return W.createElement(RTe,{allowEscapeViewBox:s,animationDuration:a,animationEasing:l,isAnimationActive:h,active:i,coordinate:c,hasPayload:S,offset:d,position:g,reverseDirection:y,useTranslate3d:v,viewBox:x,wrapperStyle:b},GTe(u,IA(IA({},this.props),{},{payload:w})))}}])}(se.PureComponent);UI(Zr,"displayName","Tooltip");UI(Zr,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Wi.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var HTe=ki,KTe=function(){return HTe.Date.now()},qTe=KTe,XTe=/\s/;function YTe(t){for(var e=t.length;e--&&XTe.test(t.charAt(e)););return e}var QTe=YTe,ZTe=QTe,JTe=/^\s+/;function e2e(t){return t&&t.slice(0,ZTe(t)+1).replace(JTe,"")}var t2e=e2e,n2e=t2e,TA=ua,r2e=Oc,EA=NaN,o2e=/^[-+]0x[0-9a-f]+$/i,i2e=/^0b[01]+$/i,s2e=/^0o[0-7]+$/i,a2e=parseInt;function l2e(t){if(typeof t=="number")return t;if(r2e(t))return EA;if(TA(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=TA(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=n2e(t);var n=i2e.test(t);return n||s2e.test(t)?a2e(t.slice(2),n?2:8):o2e.test(t)?EA:+t}var $j=l2e,u2e=ua,db=qTe,NA=$j,c2e="Expected a function",f2e=Math.max,h2e=Math.min;function d2e(t,e,n){var r,o,i,s,a,l,u=0,c=!1,f=!1,h=!0;if(typeof t!="function")throw new TypeError(c2e);e=NA(e)||0,u2e(n)&&(c=!!n.leading,f="maxWait"in n,i=f?f2e(NA(n.maxWait)||0,e):i,h="trailing"in n?!!n.trailing:h);function d(S){var $=r,C=o;return r=o=void 0,u=S,s=t.apply(C,$),s}function p(S){return u=S,a=setTimeout(y,e),c?d(S):s}function m(S){var $=S-l,C=S-u,k=e-$;return f?h2e(k,i-C):k}function g(S){var $=S-l,C=S-u;return l===void 0||$>=e||$<0||f&&C>=i}function y(){var S=db();if(g(S))return v(S);a=setTimeout(y,m(S))}function v(S){return a=void 0,h&&r?d(S):(r=o=void 0,s)}function x(){a!==void 0&&clearTimeout(a),u=0,r=l=o=a=void 0}function b(){return a===void 0?s:v(db())}function w(){var S=db(),$=g(S);if(r=arguments,o=this,l=S,$){if(a===void 0)return p(l);if(f)return clearTimeout(a),a=setTimeout(y,e),d(l)}return a===void 0&&(a=setTimeout(y,e)),s}return w.cancel=x,w.flush=b,w}var p2e=d2e,m2e=p2e,g2e=ua,y2e="Expected a function";function v2e(t,e,n){var r=!0,o=!0;if(typeof t!="function")throw new TypeError(y2e);return g2e(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),m2e(t,e,{leading:r,maxWait:e,trailing:o})}var x2e=v2e;const Cj=ft(x2e);function xh(t){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xh(t)}function AA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function hm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AA(Object(n),!0).forEach(function(r){b2e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function b2e(t,e,n){return e=w2e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w2e(t){var e=S2e(t,"string");return xh(e)=="symbol"?e:e+""}function S2e(t,e){if(xh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(xh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $2e(t,e){return T2e(t)||I2e(t,e)||k2e(t,e)||C2e()}function C2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k2e(t,e){if(t){if(typeof t=="string")return OA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return OA(t,e)}}function OA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function I2e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function T2e(t){if(Array.isArray(t))return t}var pb=se.forwardRef(function(t,e){var n=t.aspect,r=t.initialDimension,o=r===void 0?{width:-1,height:-1}:r,i=t.width,s=i===void 0?"100%":i,a=t.height,l=a===void 0?"100%":a,u=t.minWidth,c=u===void 0?0:u,f=t.minHeight,h=t.maxHeight,d=t.children,p=t.debounce,m=p===void 0?0:p,g=t.id,y=t.className,v=t.onResize,x=t.style,b=x===void 0?{}:x,w=se.useRef(null),S=se.useRef();S.current=v,se.useImperativeHandle(e,function(){return Object.defineProperty(w.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),w.current},configurable:!0})});var $=se.useState({containerWidth:o.width,containerHeight:o.height}),C=$2e($,2),k=C[0],I=C[1],T=se.useCallback(function(_,D){I(function(O){var R=Math.round(_),F=Math.round(D);return O.containerWidth===R&&O.containerHeight===F?O:{containerWidth:R,containerHeight:F}})},[]);se.useEffect(function(){var _=function(P){var z,U=P[0].contentRect,H=U.width,X=U.height;T(H,X),(z=S.current)===null||z===void 0||z.call(S,H,X)};m>0&&(_=Cj(_,m,{trailing:!0,leading:!1}));var D=new ResizeObserver(_),O=w.current.getBoundingClientRect(),R=O.width,F=O.height;return T(R,F),D.observe(w.current),function(){D.disconnect()}},[T,m]);var N=se.useMemo(function(){var _=k.containerWidth,D=k.containerHeight;if(_<0||D<0)return null;zi(Da(s)||Da(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,l),zi(!n||n>0,"The aspect(%s) must be greater than zero.",n);var O=Da(s)?_:s,R=Da(l)?D:l;n&&n>0&&(O?R=O/n:R&&(O=R*n),h&&R>h&&(R=h)),zi(O>0||R>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,O,R,s,l,c,f,n);var F=!Array.isArray(d)&&Bi(d.type).endsWith("Chart");return W.Children.map(d,function(A){return W.isValidElement(A)?se.cloneElement(A,hm({width:O,height:R},F?{style:hm({height:"100%",width:"100%",maxHeight:R,maxWidth:O},A.props.style)}:{})):A})},[n,d,l,h,f,c,k,s]);return W.createElement("div",{id:g?"".concat(g):void 0,className:Je("recharts-responsive-container",y),style:hm(hm({},b),{},{width:s,height:l,minWidth:c,minHeight:f,maxHeight:h}),ref:w},N)}),kj=function(e){return null};kj.displayName="Cell";function bh(t){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bh(t)}function _A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Rw(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_A(Object(n),!0).forEach(function(r){E2e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_A(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function E2e(t,e,n){return e=N2e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N2e(t){var e=A2e(t,"string");return bh(e)=="symbol"?e:e+""}function A2e(t,e){if(bh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(bh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ll={widthCache:{},cacheCount:0},O2e=2e3,_2e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},DA="recharts_measurement_span";function D2e(t){var e=Rw({},t);return Object.keys(e).forEach(function(n){e[n]||delete e[n]}),e}var Pf=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Wi.isSsr)return{width:0,height:0};var r=D2e(n),o=JSON.stringify({text:e,copyStyle:r});if(Ll.widthCache[o])return Ll.widthCache[o];try{var i=document.getElementById(DA);i||(i=document.createElement("span"),i.setAttribute("id",DA),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=Rw(Rw({},_2e),r);Object.assign(i.style,s),i.textContent="".concat(e);var a=i.getBoundingClientRect(),l={width:a.width,height:a.height};return Ll.widthCache[o]=l,++Ll.cacheCount>O2e&&(Ll.cacheCount=0,Ll.widthCache={}),l}catch{return{width:0,height:0}}},R2e=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function wh(t){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wh(t)}function Jg(t,e){return L2e(t)||F2e(t,e)||M2e(t,e)||P2e()}function P2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M2e(t,e){if(t){if(typeof t=="string")return RA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return RA(t,e)}}function RA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function F2e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function L2e(t){if(Array.isArray(t))return t}function B2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,j2e(r.key),r)}}function z2e(t,e,n){return e&&PA(t.prototype,e),n&&PA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function j2e(t){var e=W2e(t,"string");return wh(e)=="symbol"?e:e+""}function W2e(t,e){if(wh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(wh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var MA=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,FA=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,V2e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,U2e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Ij={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},G2e=Object.keys(Ij),ou="NaN";function H2e(t,e){return t*Ij[e]}var dm=function(){function t(e,n){B2e(this,t),this.num=e,this.unit=n,this.num=e,this.unit=n,Number.isNaN(e)&&(this.unit=""),n!==""&&!V2e.test(n)&&(this.num=NaN,this.unit=""),G2e.includes(n)&&(this.num=H2e(e,n),this.unit="px")}return z2e(t,[{key:"add",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,o=(r=U2e.exec(n))!==null&&r!==void 0?r:[],i=Jg(o,3),s=i[1],a=i[2];return new t(parseFloat(s),a??"")}}])}();function Tj(t){if(t.includes(ou))return ou;for(var e=t;e.includes("*")||e.includes("/");){var n,r=(n=MA.exec(e))!==null&&n!==void 0?n:[],o=Jg(r,4),i=o[1],s=o[2],a=o[3],l=dm.parse(i??""),u=dm.parse(a??""),c=s==="*"?l.multiply(u):l.divide(u);if(c.isNaN())return ou;e=e.replace(MA,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var f,h=(f=FA.exec(e))!==null&&f!==void 0?f:[],d=Jg(h,4),p=d[1],m=d[2],g=d[3],y=dm.parse(p??""),v=dm.parse(g??""),x=m==="+"?y.add(v):y.subtract(v);if(x.isNaN())return ou;e=e.replace(FA,x.toString())}return e}var LA=/\(([^()]*)\)/;function K2e(t){for(var e=t;e.includes("(");){var n=LA.exec(e),r=Jg(n,2),o=r[1];e=e.replace(LA,Tj(o))}return e}function q2e(t){var e=t.replace(/\s+/g,"");return e=K2e(e),e=Tj(e),e}function X2e(t){try{return q2e(t)}catch{return ou}}function mb(t){var e=X2e(t.slice(5,-1));return e===ou?"":e}var Y2e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Q2e=["dx","dy","angle","className","breakAll"];function Pw(){return Pw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pw.apply(this,arguments)}function BA(t,e){if(t==null)return{};var n=Z2e(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Z2e(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function zA(t,e){return nEe(t)||tEe(t,e)||eEe(t,e)||J2e()}function J2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eEe(t,e){if(t){if(typeof t=="string")return jA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jA(t,e)}}function jA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tEe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function nEe(t){if(Array.isArray(t))return t}var Ej=/[ \f\n\r\t\v\u2028\u2029]+/,Nj=function(e){var n=e.children,r=e.breakAll,o=e.style;try{var i=[];We(n)||(r?i=n.toString().split(""):i=n.toString().split(Ej));var s=i.map(function(l){return{word:l,width:Pf(l,o).width}}),a=r?0:Pf(" ",o).width;return{wordsWithComputedWidth:s,spaceWidth:a}}catch{return null}},rEe=function(e,n,r,o,i){var s=e.maxLines,a=e.children,l=e.style,u=e.breakAll,c=pe(s),f=a,h=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return O.reduce(function(R,F){var A=F.word,P=F.width,z=R[R.length-1];if(z&&(o==null||i||z.width+P+r<Number(o)))z.words.push(A),z.width+=P+r;else{var U={words:[A],width:P};R.push(U)}return R},[])},d=h(n),p=function(O){return O.reduce(function(R,F){return R.width>F.width?R:F})};if(!c)return d;for(var m="…",g=function(O){var R=f.slice(0,O),F=Nj({breakAll:u,style:l,children:R+m}).wordsWithComputedWidth,A=h(F),P=A.length>s||p(A).width>Number(o);return[P,A]},y=0,v=f.length-1,x=0,b;y<=v&&x<=f.length-1;){var w=Math.floor((y+v)/2),S=w-1,$=g(S),C=zA($,2),k=C[0],I=C[1],T=g(w),N=zA(T,1),_=N[0];if(!k&&!_&&(y=w+1),k&&_&&(v=w-1),!k&&_){b=I;break}x++}return b||d},WA=function(e){var n=We(e)?[]:e.toString().split(Ej);return[{words:n}]},oEe=function(e){var n=e.width,r=e.scaleToFit,o=e.children,i=e.style,s=e.breakAll,a=e.maxLines;if((n||r)&&!Wi.isSsr){var l,u,c=Nj({breakAll:s,children:o,style:i});if(c){var f=c.wordsWithComputedWidth,h=c.spaceWidth;l=f,u=h}else return WA(o);return rEe({breakAll:s,children:o,maxLines:a,style:i},l,u,n,r)}return WA(o)},VA="#808080",ey=function(e){var n=e.x,r=n===void 0?0:n,o=e.y,i=o===void 0?0:o,s=e.lineHeight,a=s===void 0?"1em":s,l=e.capHeight,u=l===void 0?"0.71em":l,c=e.scaleToFit,f=c===void 0?!1:c,h=e.textAnchor,d=h===void 0?"start":h,p=e.verticalAnchor,m=p===void 0?"end":p,g=e.fill,y=g===void 0?VA:g,v=BA(e,Y2e),x=se.useMemo(function(){return oEe({breakAll:v.breakAll,children:v.children,maxLines:v.maxLines,scaleToFit:f,style:v.style,width:v.width})},[v.breakAll,v.children,v.maxLines,f,v.style,v.width]),b=v.dx,w=v.dy,S=v.angle,$=v.className,C=v.breakAll,k=BA(v,Q2e);if(!pn(r)||!pn(i))return null;var I=r+(pe(b)?b:0),T=i+(pe(w)?w:0),N;switch(m){case"start":N=mb("calc(".concat(u,")"));break;case"middle":N=mb("calc(".concat((x.length-1)/2," * -").concat(a," + (").concat(u," / 2))"));break;default:N=mb("calc(".concat(x.length-1," * -").concat(a,")"));break}var _=[];if(f){var D=x[0].width,O=v.width;_.push("scale(".concat((pe(O)?O/D:1)/D,")"))}return S&&_.push("rotate(".concat(S,", ").concat(I,", ").concat(T,")")),_.length&&(k.transform=_.join(" ")),W.createElement("text",Pw({},Ve(k,!0),{x:I,y:T,className:Je("recharts-text",$),textAnchor:d,fill:y.includes("url")?VA:y}),x.map(function(R,F){var A=R.words.join(C?"":" ");return W.createElement("tspan",{x:I,dy:F===0?N:a,key:"".concat(A,"-").concat(F)},A)}))};function zs(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function iEe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function GI(t){let e,n,r;t.length!==2?(e=zs,n=(a,l)=>zs(t(a),l),r=(a,l)=>t(a)-l):(e=t===zs||t===iEe?t:sEe,n=t,r=t);function o(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const f=u+c>>>1;n(a[f],l)<0?u=f+1:c=f}while(u<c)}return u}function i(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const f=u+c>>>1;n(a[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function s(a,l,u=0,c=a.length){const f=o(a,l,u,c-1);return f>u&&r(a[f-1],l)>-r(a[f],l)?f-1:f}return{left:o,center:s,right:i}}function sEe(){return 0}function Aj(t){return t===null?NaN:+t}function*aEe(t,e){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const lEe=GI(zs),Ip=lEe.right;GI(Aj).center;class UA extends Map{constructor(e,n=fEe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,o]of e)this.set(r,o)}get(e){return super.get(GA(this,e))}has(e){return super.has(GA(this,e))}set(e,n){return super.set(uEe(this,e),n)}delete(e){return super.delete(cEe(this,e))}}function GA({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function uEe({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function cEe({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function fEe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function hEe(t=zs){if(t===zs)return Oj;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function Oj(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const dEe=Math.sqrt(50),pEe=Math.sqrt(10),mEe=Math.sqrt(2);function ty(t,e,n){const r=(e-t)/Math.max(0,n),o=Math.floor(Math.log10(r)),i=r/Math.pow(10,o),s=i>=dEe?10:i>=pEe?5:i>=mEe?2:1;let a,l,u;return o<0?(u=Math.pow(10,-o)/s,a=Math.round(t*u),l=Math.round(e*u),a/u<t&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,o)*s,a=Math.round(t/u),l=Math.round(e/u),a*u<t&&++a,l*u>e&&--l),l<a&&.5<=n&&n<2?ty(t,e,n*2):[a,l,u]}function Mw(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[o,i,s]=r?ty(e,t,n):ty(t,e,n);if(!(i>=o))return[];const a=i-o+1,l=new Array(a);if(r)if(s<0)for(let u=0;u<a;++u)l[u]=(i-u)/-s;else for(let u=0;u<a;++u)l[u]=(i-u)*s;else if(s<0)for(let u=0;u<a;++u)l[u]=(o+u)/-s;else for(let u=0;u<a;++u)l[u]=(o+u)*s;return l}function Fw(t,e,n){return e=+e,t=+t,n=+n,ty(t,e,n)[2]}function Lw(t,e,n){e=+e,t=+t,n=+n;const r=e<t,o=r?Fw(e,t,n):Fw(t,e,n);return(r?-1:1)*(o<0?1/-o:o)}function HA(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function KA(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function _j(t,e,n=0,r=1/0,o){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(o=o===void 0?Oj:hEe(o);r>n;){if(r-n>600){const l=r-n+1,u=e-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1),d=Math.max(n,Math.floor(e-u*f/l+h)),p=Math.min(r,Math.floor(e+(l-u)*f/l+h));_j(t,e,d,p,o)}const i=t[e];let s=n,a=r;for(of(t,n,e),o(t[r],i)>0&&of(t,n,r);s<a;){for(of(t,s,a),++s,--a;o(t[s],i)<0;)++s;for(;o(t[a],i)>0;)--a}o(t[n],i)===0?of(t,n,a):(++a,of(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function of(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function gEe(t,e,n){if(t=Float64Array.from(aEe(t)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return KA(t);if(e>=1)return HA(t);var r,o=(r-1)*e,i=Math.floor(o),s=HA(_j(t,i).subarray(0,i+1)),a=KA(t.subarray(i+1));return s+(a-s)*(o-i)}}function yEe(t,e,n=Aj){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,o=(r-1)*e,i=Math.floor(o),s=+n(t[i],i,t),a=+n(t[i+1],i+1,t);return s+(a-s)*(o-i)}}function vEe(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var r=-1,o=Math.max(0,Math.ceil((e-t)/n))|0,i=new Array(o);++r<o;)i[r]=t+r*n;return i}function So(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function us(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Bw=Symbol("implicit");function HI(){var t=new UA,e=[],n=[],r=Bw;function o(i){let s=t.get(i);if(s===void 0){if(r!==Bw)return r;t.set(i,s=e.push(i)-1)}return n[s%n.length]}return o.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new UA;for(const s of i)t.has(s)||t.set(s,e.push(s)-1);return o},o.range=function(i){return arguments.length?(n=Array.from(i),o):n.slice()},o.unknown=function(i){return arguments.length?(r=i,o):r},o.copy=function(){return HI(e,n).unknown(r)},So.apply(o,arguments),o}function Sh(){var t=HI().unknown(void 0),e=t.domain,n=t.range,r=0,o=1,i,s,a=!1,l=0,u=0,c=.5;delete t.unknown;function f(){var h=e().length,d=o<r,p=d?o:r,m=d?r:o;i=(m-p)/Math.max(1,h-l+u*2),a&&(i=Math.floor(i)),p+=(m-p-i*(h-l))*c,s=i*(1-l),a&&(p=Math.round(p),s=Math.round(s));var g=vEe(h).map(function(y){return p+i*y});return n(d?g.reverse():g)}return t.domain=function(h){return arguments.length?(e(h),f()):e()},t.range=function(h){return arguments.length?([r,o]=h,r=+r,o=+o,f()):[r,o]},t.rangeRound=function(h){return[r,o]=h,r=+r,o=+o,a=!0,f()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(h){return arguments.length?(a=!!h,f()):a},t.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),f()):l},t.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),f()):l},t.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},t.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),f()):c},t.copy=function(){return Sh(e(),[r,o]).round(a).paddingInner(l).paddingOuter(u).align(c)},So.apply(f(),arguments)}function Dj(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Dj(e())},t}function Mf(){return Dj(Sh.apply(null,arguments).paddingInner(1))}function KI(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Rj(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Tp(){}var $h=.7,ny=1/$h,xu="\\s*([+-]?\\d+)\\s*",Ch="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xEe=/^#([0-9a-f]{3,8})$/,bEe=new RegExp(`^rgb\\(${xu},${xu},${xu}\\)$`),wEe=new RegExp(`^rgb\\(${gi},${gi},${gi}\\)$`),SEe=new RegExp(`^rgba\\(${xu},${xu},${xu},${Ch}\\)$`),$Ee=new RegExp(`^rgba\\(${gi},${gi},${gi},${Ch}\\)$`),CEe=new RegExp(`^hsl\\(${Ch},${gi},${gi}\\)$`),kEe=new RegExp(`^hsla\\(${Ch},${gi},${gi},${Ch}\\)$`),qA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};KI(Tp,kh,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:XA,formatHex:XA,formatHex8:IEe,formatHsl:TEe,formatRgb:YA,toString:YA});function XA(){return this.rgb().formatHex()}function IEe(){return this.rgb().formatHex8()}function TEe(){return Pj(this).formatHsl()}function YA(){return this.rgb().formatRgb()}function kh(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=xEe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?QA(e):n===3?new xr(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?pm(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?pm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=bEe.exec(t))?new xr(e[1],e[2],e[3],1):(e=wEe.exec(t))?new xr(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=SEe.exec(t))?pm(e[1],e[2],e[3],e[4]):(e=$Ee.exec(t))?pm(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=CEe.exec(t))?eO(e[1],e[2]/100,e[3]/100,1):(e=kEe.exec(t))?eO(e[1],e[2]/100,e[3]/100,e[4]):qA.hasOwnProperty(t)?QA(qA[t]):t==="transparent"?new xr(NaN,NaN,NaN,0):null}function QA(t){return new xr(t>>16&255,t>>8&255,t&255,1)}function pm(t,e,n,r){return r<=0&&(t=e=n=NaN),new xr(t,e,n,r)}function EEe(t){return t instanceof Tp||(t=kh(t)),t?(t=t.rgb(),new xr(t.r,t.g,t.b,t.opacity)):new xr}function zw(t,e,n,r){return arguments.length===1?EEe(t):new xr(t,e,n,r??1)}function xr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}KI(xr,zw,Rj(Tp,{brighter(t){return t=t==null?ny:Math.pow(ny,t),new xr(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?$h:Math.pow($h,t),new xr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new xr(Wa(this.r),Wa(this.g),Wa(this.b),ry(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ZA,formatHex:ZA,formatHex8:NEe,formatRgb:JA,toString:JA}));function ZA(){return`#${Ra(this.r)}${Ra(this.g)}${Ra(this.b)}`}function NEe(){return`#${Ra(this.r)}${Ra(this.g)}${Ra(this.b)}${Ra((isNaN(this.opacity)?1:this.opacity)*255)}`}function JA(){const t=ry(this.opacity);return`${t===1?"rgb(":"rgba("}${Wa(this.r)}, ${Wa(this.g)}, ${Wa(this.b)}${t===1?")":`, ${t})`}`}function ry(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Wa(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ra(t){return t=Wa(t),(t<16?"0":"")+t.toString(16)}function eO(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Mo(t,e,n,r)}function Pj(t){if(t instanceof Mo)return new Mo(t.h,t.s,t.l,t.opacity);if(t instanceof Tp||(t=kh(t)),!t)return new Mo;if(t instanceof Mo)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),i=Math.max(e,n,r),s=NaN,a=i-o,l=(i+o)/2;return a?(e===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-e)/a+2:s=(e-n)/a+4,a/=l<.5?i+o:2-i-o,s*=60):a=l>0&&l<1?0:s,new Mo(s,a,l,t.opacity)}function AEe(t,e,n,r){return arguments.length===1?Pj(t):new Mo(t,e,n,r??1)}function Mo(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}KI(Mo,AEe,Rj(Tp,{brighter(t){return t=t==null?ny:Math.pow(ny,t),new Mo(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?$h:Math.pow($h,t),new Mo(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new xr(gb(t>=240?t-240:t+120,o,r),gb(t,o,r),gb(t<120?t+240:t-120,o,r),this.opacity)},clamp(){return new Mo(tO(this.h),mm(this.s),mm(this.l),ry(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ry(this.opacity);return`${t===1?"hsl(":"hsla("}${tO(this.h)}, ${mm(this.s)*100}%, ${mm(this.l)*100}%${t===1?")":`, ${t})`}`}}));function tO(t){return t=(t||0)%360,t<0?t+360:t}function mm(t){return Math.max(0,Math.min(1,t||0))}function gb(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const qI=t=>()=>t;function OEe(t,e){return function(n){return t+n*e}}function _Ee(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function DEe(t){return(t=+t)==1?Mj:function(e,n){return n-e?_Ee(e,n,t):qI(isNaN(e)?n:e)}}function Mj(t,e){var n=e-t;return n?OEe(t,n):qI(isNaN(t)?e:t)}const nO=function t(e){var n=DEe(e);function r(o,i){var s=n((o=zw(o)).r,(i=zw(i)).r),a=n(o.g,i.g),l=n(o.b,i.b),u=Mj(o.opacity,i.opacity);return function(c){return o.r=s(c),o.g=a(c),o.b=l(c),o.opacity=u(c),o+""}}return r.gamma=t,r}(1);function REe(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),o;return function(i){for(o=0;o<n;++o)r[o]=t[o]*(1-i)+e[o]*i;return r}}function PEe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function MEe(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,o=new Array(r),i=new Array(n),s;for(s=0;s<r;++s)o[s]=Bc(t[s],e[s]);for(;s<n;++s)i[s]=e[s];return function(a){for(s=0;s<r;++s)i[s]=o[s](a);return i}}function FEe(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function oy(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function LEe(t,e){var n={},r={},o;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(o in e)o in t?n[o]=Bc(t[o],e[o]):r[o]=e[o];return function(i){for(o in n)r[o]=n[o](i);return r}}var jw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yb=new RegExp(jw.source,"g");function BEe(t){return function(){return t}}function zEe(t){return function(e){return t(e)+""}}function jEe(t,e){var n=jw.lastIndex=yb.lastIndex=0,r,o,i,s=-1,a=[],l=[];for(t=t+"",e=e+"";(r=jw.exec(t))&&(o=yb.exec(e));)(i=o.index)>n&&(i=e.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,l.push({i:s,x:oy(r,o)})),n=yb.lastIndex;return n<e.length&&(i=e.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?zEe(l[0].x):BEe(e):(e=l.length,function(u){for(var c=0,f;c<e;++c)a[(f=l[c]).i]=f.x(u);return a.join("")})}function Bc(t,e){var n=typeof e,r;return e==null||n==="boolean"?qI(e):(n==="number"?oy:n==="string"?(r=kh(e))?(e=r,nO):jEe:e instanceof kh?nO:e instanceof Date?FEe:PEe(e)?REe:Array.isArray(e)?MEe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?LEe:oy)(t,e)}function XI(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function WEe(t,e){e===void 0&&(e=t,t=Bc);for(var n=0,r=e.length-1,o=e[0],i=new Array(r<0?0:r);n<r;)i[n]=t(o,o=e[++n]);return function(s){var a=Math.max(0,Math.min(r-1,Math.floor(s*=r)));return i[a](s-a)}}function VEe(t){return function(){return t}}function iy(t){return+t}var rO=[0,1];function ir(t){return t}function Ww(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:VEe(isNaN(e)?NaN:.5)}function UEe(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function GEe(t,e,n){var r=t[0],o=t[1],i=e[0],s=e[1];return o<r?(r=Ww(o,r),i=n(s,i)):(r=Ww(r,o),i=n(i,s)),function(a){return i(r(a))}}function HEe(t,e,n){var r=Math.min(t.length,e.length)-1,o=new Array(r),i=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)o[s]=Ww(t[s],t[s+1]),i[s]=n(e[s],e[s+1]);return function(a){var l=Ip(t,a,1,r)-1;return i[l](o[l](a))}}function Ep(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function X0(){var t=rO,e=rO,n=Bc,r,o,i,s=ir,a,l,u;function c(){var h=Math.min(t.length,e.length);return s!==ir&&(s=UEe(t[0],t[h-1])),a=h>2?HEe:GEe,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?i:(l||(l=a(t.map(r),e,n)))(r(s(h)))}return f.invert=function(h){return s(o((u||(u=a(e,t.map(r),oy)))(h)))},f.domain=function(h){return arguments.length?(t=Array.from(h,iy),c()):t.slice()},f.range=function(h){return arguments.length?(e=Array.from(h),c()):e.slice()},f.rangeRound=function(h){return e=Array.from(h),n=XI,c()},f.clamp=function(h){return arguments.length?(s=h?!0:ir,c()):s!==ir},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,d){return r=h,o=d,c()}}function YI(){return X0()(ir,ir)}function KEe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function sy(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function qu(t){return t=sy(Math.abs(t)),t?t[1]:NaN}function qEe(t,e){return function(n,r){for(var o=n.length,i=[],s=0,a=t[0],l=0;o>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),i.push(n.substring(o-=a,o+a)),!((l+=a+1)>r));)a=t[s=(s+1)%t.length];return i.reverse().join(e)}}function XEe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var YEe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ih(t){if(!(e=YEe.exec(t)))throw new Error("invalid format: "+t);var e;return new QI({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Ih.prototype=QI.prototype;function QI(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}QI.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function QEe(t){e:for(var e=t.length,n=1,r=-1,o;n<e;++n)switch(t[n]){case".":r=o=n;break;case"0":r===0&&(r=n),o=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(o+1):t}var Fj;function ZEe(t,e){var n=sy(t,e);if(!n)return t+"";var r=n[0],o=n[1],i=o-(Fj=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,s=r.length;return i===s?r:i>s?r+new Array(i-s+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+sy(t,Math.max(0,e+i-1))[0]}function oO(t,e){var n=sy(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}const iO={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:KEe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>oO(t*100,e),r:oO,s:ZEe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function sO(t){return t}var aO=Array.prototype.map,lO=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function JEe(t){var e=t.grouping===void 0||t.thousands===void 0?sO:qEe(aO.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",o=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?sO:XEe(aO.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(f){f=Ih(f);var h=f.fill,d=f.align,p=f.sign,m=f.symbol,g=f.zero,y=f.width,v=f.comma,x=f.precision,b=f.trim,w=f.type;w==="n"?(v=!0,w="g"):iO[w]||(x===void 0&&(x=12),b=!0,w="g"),(g||h==="0"&&d==="=")&&(g=!0,h="0",d="=");var S=m==="$"?n:m==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",$=m==="$"?r:/[%p]/.test(w)?s:"",C=iO[w],k=/[defgprs%]/.test(w);x=x===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function I(T){var N=S,_=$,D,O,R;if(w==="c")_=C(T)+_,T="";else{T=+T;var F=T<0||1/T<0;if(T=isNaN(T)?l:C(Math.abs(T),x),b&&(T=QEe(T)),F&&+T==0&&p!=="+"&&(F=!1),N=(F?p==="("?p:a:p==="-"||p==="("?"":p)+N,_=(w==="s"?lO[8+Fj/3]:"")+_+(F&&p==="("?")":""),k){for(D=-1,O=T.length;++D<O;)if(R=T.charCodeAt(D),48>R||R>57){_=(R===46?o+T.slice(D+1):T.slice(D))+_,T=T.slice(0,D);break}}}v&&!g&&(T=e(T,1/0));var A=N.length+T.length+_.length,P=A<y?new Array(y-A+1).join(h):"";switch(v&&g&&(T=e(P+T,P.length?y-_.length:1/0),P=""),d){case"<":T=N+T+_+P;break;case"=":T=N+P+T+_;break;case"^":T=P.slice(0,A=P.length>>1)+N+T+_+P.slice(A);break;default:T=P+N+T+_;break}return i(T)}return I.toString=function(){return f+""},I}function c(f,h){var d=u((f=Ih(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(qu(h)/3)))*3,m=Math.pow(10,-p),g=lO[8+p/3];return function(y){return d(m*y)+g}}return{format:u,formatPrefix:c}}var gm,ZI,Lj;eNe({thousands:",",grouping:[3],currency:["$",""]});function eNe(t){return gm=JEe(t),ZI=gm.format,Lj=gm.formatPrefix,gm}function tNe(t){return Math.max(0,-qu(Math.abs(t)))}function nNe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qu(e)/3)))*3-qu(Math.abs(t)))}function rNe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,qu(e)-qu(t))+1}function Bj(t,e,n,r){var o=Lw(t,e,n),i;switch(r=Ih(r??",f"),r.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(i=nNe(o,s))&&(r.precision=i),Lj(r,s)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(i=rNe(o,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=i-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(i=tNe(o))&&(r.precision=i-(r.type==="%")*2);break}}return ZI(r)}function fa(t){var e=t.domain;return t.ticks=function(n){var r=e();return Mw(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var o=e();return Bj(o[0],o[o.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),o=0,i=r.length-1,s=r[o],a=r[i],l,u,c=10;for(a<s&&(u=s,s=a,a=u,u=o,o=i,i=u);c-- >0;){if(u=Fw(s,a,n),u===l)return r[o]=s,r[i]=a,e(r);if(u>0)s=Math.floor(s/u)*u,a=Math.ceil(a/u)*u;else if(u<0)s=Math.ceil(s*u)/u,a=Math.floor(a*u)/u;else break;l=u}return t},t}function ay(){var t=YI();return t.copy=function(){return Ep(t,ay())},So.apply(t,arguments),fa(t)}function zj(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,iy),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return zj(t).unknown(e)},t=arguments.length?Array.from(t,iy):[0,1],fa(n)}function jj(t,e){t=t.slice();var n=0,r=t.length-1,o=t[n],i=t[r],s;return i<o&&(s=n,n=r,r=s,s=o,o=i,i=s),t[n]=e.floor(o),t[r]=e.ceil(i),t}function uO(t){return Math.log(t)}function cO(t){return Math.exp(t)}function oNe(t){return-Math.log(-t)}function iNe(t){return-Math.exp(-t)}function sNe(t){return isFinite(t)?+("1e"+t):t<0?0:t}function aNe(t){return t===10?sNe:t===Math.E?Math.exp:e=>Math.pow(t,e)}function lNe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function fO(t){return(e,n)=>-t(-e,n)}function JI(t){const e=t(uO,cO),n=e.domain;let r=10,o,i;function s(){return o=lNe(r),i=aNe(r),n()[0]<0?(o=fO(o),i=fO(i),t(oNe,iNe)):t(uO,cO),e}return e.base=function(a){return arguments.length?(r=+a,s()):r},e.domain=function(a){return arguments.length?(n(a),s()):n()},e.ticks=a=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let h=o(u),d=o(c),p,m;const g=a==null?10:+a;let y=[];if(!(r%1)&&d-h<g){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(p=1;p<r;++p)if(m=h<0?p/i(-h):p*i(h),!(m<u)){if(m>c)break;y.push(m)}}else for(;h<=d;++h)for(p=r-1;p>=1;--p)if(m=h>0?p/i(-h):p*i(h),!(m<u)){if(m>c)break;y.push(m)}y.length*2<g&&(y=Mw(u,c,g))}else y=Mw(h,d,Math.min(d-h,g)).map(i);return f?y.reverse():y},e.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=Ih(l)).precision==null&&(l.trim=!0),l=ZI(l)),a===1/0)return l;const u=Math.max(1,r*a/e.ticks().length);return c=>{let f=c/i(Math.round(o(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},e.nice=()=>n(jj(n(),{floor:a=>i(Math.floor(o(a))),ceil:a=>i(Math.ceil(o(a)))})),e}function Wj(){const t=JI(X0()).domain([1,10]);return t.copy=()=>Ep(t,Wj()).base(t.base()),So.apply(t,arguments),t}function hO(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function dO(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function eT(t){var e=1,n=t(hO(e),dO(e));return n.constant=function(r){return arguments.length?t(hO(e=+r),dO(e)):e},fa(n)}function Vj(){var t=eT(X0());return t.copy=function(){return Ep(t,Vj()).constant(t.constant())},So.apply(t,arguments)}function pO(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function uNe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function cNe(t){return t<0?-t*t:t*t}function tT(t){var e=t(ir,ir),n=1;function r(){return n===1?t(ir,ir):n===.5?t(uNe,cNe):t(pO(n),pO(1/n))}return e.exponent=function(o){return arguments.length?(n=+o,r()):n},fa(e)}function nT(){var t=tT(X0());return t.copy=function(){return Ep(t,nT()).exponent(t.exponent())},So.apply(t,arguments),t}function fNe(){return nT.apply(null,arguments).exponent(.5)}function mO(t){return Math.sign(t)*t*t}function hNe(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function Uj(){var t=YI(),e=[0,1],n=!1,r;function o(i){var s=hNe(t(i));return isNaN(s)?r:n?Math.round(s):s}return o.invert=function(i){return t.invert(mO(i))},o.domain=function(i){return arguments.length?(t.domain(i),o):t.domain()},o.range=function(i){return arguments.length?(t.range((e=Array.from(i,iy)).map(mO)),o):e.slice()},o.rangeRound=function(i){return o.range(i).round(!0)},o.round=function(i){return arguments.length?(n=!!i,o):n},o.clamp=function(i){return arguments.length?(t.clamp(i),o):t.clamp()},o.unknown=function(i){return arguments.length?(r=i,o):r},o.copy=function(){return Uj(t.domain(),e).round(n).clamp(t.clamp()).unknown(r)},So.apply(o,arguments),fa(o)}function Gj(){var t=[],e=[],n=[],r;function o(){var s=0,a=Math.max(1,e.length);for(n=new Array(a-1);++s<a;)n[s-1]=yEe(t,s/a);return i}function i(s){return s==null||isNaN(s=+s)?r:e[Ip(n,s)]}return i.invertExtent=function(s){var a=e.indexOf(s);return a<0?[NaN,NaN]:[a>0?n[a-1]:t[0],a<n.length?n[a]:t[t.length-1]]},i.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let a of s)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(zs),o()},i.range=function(s){return arguments.length?(e=Array.from(s),o()):e.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.quantiles=function(){return n.slice()},i.copy=function(){return Gj().domain(t).range(e).unknown(r)},So.apply(i,arguments)}function Hj(){var t=0,e=1,n=1,r=[.5],o=[0,1],i;function s(l){return l!=null&&l<=l?o[Ip(r,l,0,n)]:i}function a(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*e-(l-n)*t)/(n+1);return s}return s.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,a()):[t,e]},s.range=function(l){return arguments.length?(n=(o=Array.from(l)).length-1,a()):o.slice()},s.invertExtent=function(l){var u=o.indexOf(l);return u<0?[NaN,NaN]:u<1?[t,r[0]]:u>=n?[r[n-1],e]:[r[u-1],r[u]]},s.unknown=function(l){return arguments.length&&(i=l),s},s.thresholds=function(){return r.slice()},s.copy=function(){return Hj().domain([t,e]).range(o).unknown(i)},So.apply(fa(s),arguments)}function Kj(){var t=[.5],e=[0,1],n,r=1;function o(i){return i!=null&&i<=i?e[Ip(t,i,0,r)]:n}return o.domain=function(i){return arguments.length?(t=Array.from(i),r=Math.min(t.length,e.length-1),o):t.slice()},o.range=function(i){return arguments.length?(e=Array.from(i),r=Math.min(t.length,e.length-1),o):e.slice()},o.invertExtent=function(i){var s=e.indexOf(i);return[t[s-1],t[s]]},o.unknown=function(i){return arguments.length?(n=i,o):n},o.copy=function(){return Kj().domain(t).range(e).unknown(n)},So.apply(o,arguments)}const vb=new Date,xb=new Date;function gn(t,e,n,r){function o(i){return t(i=arguments.length===0?new Date:new Date(+i)),i}return o.floor=i=>(t(i=new Date(+i)),i),o.ceil=i=>(t(i=new Date(i-1)),e(i,1),t(i),i),o.round=i=>{const s=o(i),a=o.ceil(i);return i-s<a-i?s:a},o.offset=(i,s)=>(e(i=new Date(+i),s==null?1:Math.floor(s)),i),o.range=(i,s,a)=>{const l=[];if(i=o.ceil(i),a=a==null?1:Math.floor(a),!(i<s)||!(a>0))return l;let u;do l.push(u=new Date(+i)),e(i,a),t(i);while(u<i&&i<s);return l},o.filter=i=>gn(s=>{if(s>=s)for(;t(s),!i(s);)s.setTime(s-1)},(s,a)=>{if(s>=s)if(a<0)for(;++a<=0;)for(;e(s,-1),!i(s););else for(;--a>=0;)for(;e(s,1),!i(s););}),n&&(o.count=(i,s)=>(vb.setTime(+i),xb.setTime(+s),t(vb),t(xb),Math.floor(n(vb,xb))),o.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?o.filter(r?s=>r(s)%i===0:s=>o.count(0,s)%i===0):o)),o}const ly=gn(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);ly.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?gn(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):ly);ly.range;const Ri=1e3,lo=Ri*60,Pi=lo*60,Zi=Pi*24,rT=Zi*7,gO=Zi*30,bb=Zi*365,Pa=gn(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Ri)},(t,e)=>(e-t)/Ri,t=>t.getUTCSeconds());Pa.range;const oT=gn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ri)},(t,e)=>{t.setTime(+t+e*lo)},(t,e)=>(e-t)/lo,t=>t.getMinutes());oT.range;const iT=gn(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*lo)},(t,e)=>(e-t)/lo,t=>t.getUTCMinutes());iT.range;const sT=gn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ri-t.getMinutes()*lo)},(t,e)=>{t.setTime(+t+e*Pi)},(t,e)=>(e-t)/Pi,t=>t.getHours());sT.range;const aT=gn(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Pi)},(t,e)=>(e-t)/Pi,t=>t.getUTCHours());aT.range;const Np=gn(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*lo)/Zi,t=>t.getDate()-1);Np.range;const Y0=gn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Zi,t=>t.getUTCDate()-1);Y0.range;const qj=gn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Zi,t=>Math.floor(t/Zi));qj.range;function El(t){return gn(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*lo)/rT)}const Q0=El(0),uy=El(1),dNe=El(2),pNe=El(3),Xu=El(4),mNe=El(5),gNe=El(6);Q0.range;uy.range;dNe.range;pNe.range;Xu.range;mNe.range;gNe.range;function Nl(t){return gn(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/rT)}const Z0=Nl(0),cy=Nl(1),yNe=Nl(2),vNe=Nl(3),Yu=Nl(4),xNe=Nl(5),bNe=Nl(6);Z0.range;cy.range;yNe.range;vNe.range;Yu.range;xNe.range;bNe.range;const lT=gn(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());lT.range;const uT=gn(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());uT.range;const Ji=gn(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Ji.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:gn(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Ji.range;const es=gn(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());es.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:gn(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});es.range;function Xj(t,e,n,r,o,i){const s=[[Pa,1,Ri],[Pa,5,5*Ri],[Pa,15,15*Ri],[Pa,30,30*Ri],[i,1,lo],[i,5,5*lo],[i,15,15*lo],[i,30,30*lo],[o,1,Pi],[o,3,3*Pi],[o,6,6*Pi],[o,12,12*Pi],[r,1,Zi],[r,2,2*Zi],[n,1,rT],[e,1,gO],[e,3,3*gO],[t,1,bb]];function a(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=GI(([,,g])=>g).right(s,h);if(d===s.length)return t.every(Lw(u/bb,c/bb,f));if(d===0)return ly.every(Math.max(Lw(u,c,f),1));const[p,m]=s[h/s[d-1][2]<s[d][2]/h?d-1:d];return p.every(m)}return[a,l]}const[wNe,SNe]=Xj(es,uT,Z0,qj,aT,iT),[$Ne,CNe]=Xj(Ji,lT,Q0,Np,sT,oT);function wb(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Sb(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function sf(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function kNe(t){var e=t.dateTime,n=t.date,r=t.time,o=t.periods,i=t.days,s=t.shortDays,a=t.months,l=t.shortMonths,u=af(o),c=lf(o),f=af(i),h=lf(i),d=af(s),p=lf(s),m=af(a),g=lf(a),y=af(l),v=lf(l),x={a:F,A,b:P,B:z,c:null,d:SO,e:SO,f:qNe,g:oAe,G:sAe,H:GNe,I:HNe,j:KNe,L:Yj,m:XNe,M:YNe,p:U,q:H,Q:kO,s:IO,S:QNe,u:ZNe,U:JNe,V:eAe,w:tAe,W:nAe,x:null,X:null,y:rAe,Y:iAe,Z:aAe,"%":CO},b={a:X,A:ne,b:re,B:le,c:null,d:$O,e:$O,f:fAe,g:wAe,G:$Ae,H:lAe,I:uAe,j:cAe,L:Zj,m:hAe,M:dAe,p:ye,q:ve,Q:kO,s:IO,S:pAe,u:mAe,U:gAe,V:yAe,w:vAe,W:xAe,x:null,X:null,y:bAe,Y:SAe,Z:CAe,"%":CO},w={a:I,A:T,b:N,B:_,c:D,d:bO,e:bO,f:jNe,g:xO,G:vO,H:wO,I:wO,j:FNe,L:zNe,m:MNe,M:LNe,p:k,q:PNe,Q:VNe,s:UNe,S:BNe,u:ANe,U:ONe,V:_Ne,w:NNe,W:DNe,x:O,X:R,y:xO,Y:vO,Z:RNe,"%":WNe};x.x=S(n,x),x.X=S(r,x),x.c=S(e,x),b.x=S(n,b),b.X=S(r,b),b.c=S(e,b);function S(J,ce){return function(fe){var Z=[],Ne=-1,$e=0,Oe=J.length,te,Ce,Ee;for(fe instanceof Date||(fe=new Date(+fe));++Ne<Oe;)J.charCodeAt(Ne)===37&&(Z.push(J.slice($e,Ne)),(Ce=yO[te=J.charAt(++Ne)])!=null?te=J.charAt(++Ne):Ce=te==="e"?" ":"0",(Ee=ce[te])&&(te=Ee(fe,Ce)),Z.push(te),$e=Ne+1);return Z.push(J.slice($e,Ne)),Z.join("")}}function $(J,ce){return function(fe){var Z=sf(1900,void 0,1),Ne=C(Z,J,fe+="",0),$e,Oe;if(Ne!=fe.length)return null;if("Q"in Z)return new Date(Z.Q);if("s"in Z)return new Date(Z.s*1e3+("L"in Z?Z.L:0));if(ce&&!("Z"in Z)&&(Z.Z=0),"p"in Z&&(Z.H=Z.H%12+Z.p*12),Z.m===void 0&&(Z.m="q"in Z?Z.q:0),"V"in Z){if(Z.V<1||Z.V>53)return null;"w"in Z||(Z.w=1),"Z"in Z?($e=Sb(sf(Z.y,0,1)),Oe=$e.getUTCDay(),$e=Oe>4||Oe===0?cy.ceil($e):cy($e),$e=Y0.offset($e,(Z.V-1)*7),Z.y=$e.getUTCFullYear(),Z.m=$e.getUTCMonth(),Z.d=$e.getUTCDate()+(Z.w+6)%7):($e=wb(sf(Z.y,0,1)),Oe=$e.getDay(),$e=Oe>4||Oe===0?uy.ceil($e):uy($e),$e=Np.offset($e,(Z.V-1)*7),Z.y=$e.getFullYear(),Z.m=$e.getMonth(),Z.d=$e.getDate()+(Z.w+6)%7)}else("W"in Z||"U"in Z)&&("w"in Z||(Z.w="u"in Z?Z.u%7:"W"in Z?1:0),Oe="Z"in Z?Sb(sf(Z.y,0,1)).getUTCDay():wb(sf(Z.y,0,1)).getDay(),Z.m=0,Z.d="W"in Z?(Z.w+6)%7+Z.W*7-(Oe+5)%7:Z.w+Z.U*7-(Oe+6)%7);return"Z"in Z?(Z.H+=Z.Z/100|0,Z.M+=Z.Z%100,Sb(Z)):wb(Z)}}function C(J,ce,fe,Z){for(var Ne=0,$e=ce.length,Oe=fe.length,te,Ce;Ne<$e;){if(Z>=Oe)return-1;if(te=ce.charCodeAt(Ne++),te===37){if(te=ce.charAt(Ne++),Ce=w[te in yO?ce.charAt(Ne++):te],!Ce||(Z=Ce(J,fe,Z))<0)return-1}else if(te!=fe.charCodeAt(Z++))return-1}return Z}function k(J,ce,fe){var Z=u.exec(ce.slice(fe));return Z?(J.p=c.get(Z[0].toLowerCase()),fe+Z[0].length):-1}function I(J,ce,fe){var Z=d.exec(ce.slice(fe));return Z?(J.w=p.get(Z[0].toLowerCase()),fe+Z[0].length):-1}function T(J,ce,fe){var Z=f.exec(ce.slice(fe));return Z?(J.w=h.get(Z[0].toLowerCase()),fe+Z[0].length):-1}function N(J,ce,fe){var Z=y.exec(ce.slice(fe));return Z?(J.m=v.get(Z[0].toLowerCase()),fe+Z[0].length):-1}function _(J,ce,fe){var Z=m.exec(ce.slice(fe));return Z?(J.m=g.get(Z[0].toLowerCase()),fe+Z[0].length):-1}function D(J,ce,fe){return C(J,e,ce,fe)}function O(J,ce,fe){return C(J,n,ce,fe)}function R(J,ce,fe){return C(J,r,ce,fe)}function F(J){return s[J.getDay()]}function A(J){return i[J.getDay()]}function P(J){return l[J.getMonth()]}function z(J){return a[J.getMonth()]}function U(J){return o[+(J.getHours()>=12)]}function H(J){return 1+~~(J.getMonth()/3)}function X(J){return s[J.getUTCDay()]}function ne(J){return i[J.getUTCDay()]}function re(J){return l[J.getUTCMonth()]}function le(J){return a[J.getUTCMonth()]}function ye(J){return o[+(J.getUTCHours()>=12)]}function ve(J){return 1+~~(J.getUTCMonth()/3)}return{format:function(J){var ce=S(J+="",x);return ce.toString=function(){return J},ce},parse:function(J){var ce=$(J+="",!1);return ce.toString=function(){return J},ce},utcFormat:function(J){var ce=S(J+="",b);return ce.toString=function(){return J},ce},utcParse:function(J){var ce=$(J+="",!0);return ce.toString=function(){return J},ce}}}var yO={"-":"",_:" ",0:"0"},kn=/^\s*\d+/,INe=/^%/,TNe=/[\\^$*+?|[\]().{}]/g;function tt(t,e,n){var r=t<0?"-":"",o=(r?-t:t)+"",i=o.length;return r+(i<n?new Array(n-i+1).join(e)+o:o)}function ENe(t){return t.replace(TNe,"\\$&")}function af(t){return new RegExp("^(?:"+t.map(ENe).join("|")+")","i")}function lf(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function NNe(t,e,n){var r=kn.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function ANe(t,e,n){var r=kn.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function ONe(t,e,n){var r=kn.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function _Ne(t,e,n){var r=kn.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function DNe(t,e,n){var r=kn.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function vO(t,e,n){var r=kn.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function xO(t,e,n){var r=kn.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function RNe(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function PNe(t,e,n){var r=kn.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function MNe(t,e,n){var r=kn.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function bO(t,e,n){var r=kn.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function FNe(t,e,n){var r=kn.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function wO(t,e,n){var r=kn.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function LNe(t,e,n){var r=kn.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function BNe(t,e,n){var r=kn.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function zNe(t,e,n){var r=kn.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function jNe(t,e,n){var r=kn.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function WNe(t,e,n){var r=INe.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function VNe(t,e,n){var r=kn.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function UNe(t,e,n){var r=kn.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function SO(t,e){return tt(t.getDate(),e,2)}function GNe(t,e){return tt(t.getHours(),e,2)}function HNe(t,e){return tt(t.getHours()%12||12,e,2)}function KNe(t,e){return tt(1+Np.count(Ji(t),t),e,3)}function Yj(t,e){return tt(t.getMilliseconds(),e,3)}function qNe(t,e){return Yj(t,e)+"000"}function XNe(t,e){return tt(t.getMonth()+1,e,2)}function YNe(t,e){return tt(t.getMinutes(),e,2)}function QNe(t,e){return tt(t.getSeconds(),e,2)}function ZNe(t){var e=t.getDay();return e===0?7:e}function JNe(t,e){return tt(Q0.count(Ji(t)-1,t),e,2)}function Qj(t){var e=t.getDay();return e>=4||e===0?Xu(t):Xu.ceil(t)}function eAe(t,e){return t=Qj(t),tt(Xu.count(Ji(t),t)+(Ji(t).getDay()===4),e,2)}function tAe(t){return t.getDay()}function nAe(t,e){return tt(uy.count(Ji(t)-1,t),e,2)}function rAe(t,e){return tt(t.getFullYear()%100,e,2)}function oAe(t,e){return t=Qj(t),tt(t.getFullYear()%100,e,2)}function iAe(t,e){return tt(t.getFullYear()%1e4,e,4)}function sAe(t,e){var n=t.getDay();return t=n>=4||n===0?Xu(t):Xu.ceil(t),tt(t.getFullYear()%1e4,e,4)}function aAe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+tt(e/60|0,"0",2)+tt(e%60,"0",2)}function $O(t,e){return tt(t.getUTCDate(),e,2)}function lAe(t,e){return tt(t.getUTCHours(),e,2)}function uAe(t,e){return tt(t.getUTCHours()%12||12,e,2)}function cAe(t,e){return tt(1+Y0.count(es(t),t),e,3)}function Zj(t,e){return tt(t.getUTCMilliseconds(),e,3)}function fAe(t,e){return Zj(t,e)+"000"}function hAe(t,e){return tt(t.getUTCMonth()+1,e,2)}function dAe(t,e){return tt(t.getUTCMinutes(),e,2)}function pAe(t,e){return tt(t.getUTCSeconds(),e,2)}function mAe(t){var e=t.getUTCDay();return e===0?7:e}function gAe(t,e){return tt(Z0.count(es(t)-1,t),e,2)}function Jj(t){var e=t.getUTCDay();return e>=4||e===0?Yu(t):Yu.ceil(t)}function yAe(t,e){return t=Jj(t),tt(Yu.count(es(t),t)+(es(t).getUTCDay()===4),e,2)}function vAe(t){return t.getUTCDay()}function xAe(t,e){return tt(cy.count(es(t)-1,t),e,2)}function bAe(t,e){return tt(t.getUTCFullYear()%100,e,2)}function wAe(t,e){return t=Jj(t),tt(t.getUTCFullYear()%100,e,2)}function SAe(t,e){return tt(t.getUTCFullYear()%1e4,e,4)}function $Ae(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Yu(t):Yu.ceil(t),tt(t.getUTCFullYear()%1e4,e,4)}function CAe(){return"+0000"}function CO(){return"%"}function kO(t){return+t}function IO(t){return Math.floor(+t/1e3)}var Bl,eW,tW;kAe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function kAe(t){return Bl=kNe(t),eW=Bl.format,Bl.parse,tW=Bl.utcFormat,Bl.utcParse,Bl}function IAe(t){return new Date(t)}function TAe(t){return t instanceof Date?+t:+new Date(+t)}function cT(t,e,n,r,o,i,s,a,l,u){var c=YI(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),y=u("%a %d"),v=u("%b %d"),x=u("%B"),b=u("%Y");function w(S){return(l(S)<S?d:a(S)<S?p:s(S)<S?m:i(S)<S?g:r(S)<S?o(S)<S?y:v:n(S)<S?x:b)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?h(Array.from(S,TAe)):h().map(IAe)},c.ticks=function(S){var $=h();return t($[0],$[$.length-1],S??10)},c.tickFormat=function(S,$){return $==null?w:u($)},c.nice=function(S){var $=h();return(!S||typeof S.range!="function")&&(S=e($[0],$[$.length-1],S??10)),S?h(jj($,S)):c},c.copy=function(){return Ep(c,cT(t,e,n,r,o,i,s,a,l,u))},c}function EAe(){return So.apply(cT($Ne,CNe,Ji,lT,Q0,Np,sT,oT,Pa,eW).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function NAe(){return So.apply(cT(wNe,SNe,es,uT,Z0,Y0,aT,iT,Pa,tW).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function J0(){var t=0,e=1,n,r,o,i,s=ir,a=!1,l;function u(f){return f==null||isNaN(f=+f)?l:s(o===0?.5:(f=(i(f)-n)*o,a?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,n=i(t=+t),r=i(e=+e),o=n===r?0:1/(r-n),u):[t,e]},u.clamp=function(f){return arguments.length?(a=!!f,u):a},u.interpolator=function(f){return arguments.length?(s=f,u):s};function c(f){return function(h){var d,p;return arguments.length?([d,p]=h,s=f(d,p),u):[s(0),s(1)]}}return u.range=c(Bc),u.rangeRound=c(XI),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return i=f,n=f(t),r=f(e),o=n===r?0:1/(r-n),u}}function ha(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function nW(){var t=fa(J0()(ir));return t.copy=function(){return ha(t,nW())},us.apply(t,arguments)}function rW(){var t=JI(J0()).domain([1,10]);return t.copy=function(){return ha(t,rW()).base(t.base())},us.apply(t,arguments)}function oW(){var t=eT(J0());return t.copy=function(){return ha(t,oW()).constant(t.constant())},us.apply(t,arguments)}function fT(){var t=tT(J0());return t.copy=function(){return ha(t,fT()).exponent(t.exponent())},us.apply(t,arguments)}function AAe(){return fT.apply(null,arguments).exponent(.5)}function iW(){var t=[],e=ir;function n(r){if(r!=null&&!isNaN(r=+r))return e((Ip(t,r,1)-1)/(t.length-1))}return n.domain=function(r){if(!arguments.length)return t.slice();t=[];for(let o of r)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(zs),n},n.interpolator=function(r){return arguments.length?(e=r,n):e},n.range=function(){return t.map((r,o)=>e(o/(t.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(o,i)=>gEe(t,i/r))},n.copy=function(){return iW(e).domain(t)},us.apply(n,arguments)}function ex(){var t=0,e=.5,n=1,r=1,o,i,s,a,l,u=ir,c,f=!1,h;function d(m){return isNaN(m=+m)?h:(m=.5+((m=+c(m))-i)*(r*m<r*i?a:l),u(f?Math.max(0,Math.min(1,m)):m))}d.domain=function(m){return arguments.length?([t,e,n]=m,o=c(t=+t),i=c(e=+e),s=c(n=+n),a=o===i?0:.5/(i-o),l=i===s?0:.5/(s-i),r=i<o?-1:1,d):[t,e,n]},d.clamp=function(m){return arguments.length?(f=!!m,d):f},d.interpolator=function(m){return arguments.length?(u=m,d):u};function p(m){return function(g){var y,v,x;return arguments.length?([y,v,x]=g,u=WEe(m,[y,v,x]),d):[u(0),u(.5),u(1)]}}return d.range=p(Bc),d.rangeRound=p(XI),d.unknown=function(m){return arguments.length?(h=m,d):h},function(m){return c=m,o=m(t),i=m(e),s=m(n),a=o===i?0:.5/(i-o),l=i===s?0:.5/(s-i),r=i<o?-1:1,d}}function sW(){var t=fa(ex()(ir));return t.copy=function(){return ha(t,sW())},us.apply(t,arguments)}function aW(){var t=JI(ex()).domain([.1,1,10]);return t.copy=function(){return ha(t,aW()).base(t.base())},us.apply(t,arguments)}function lW(){var t=eT(ex());return t.copy=function(){return ha(t,lW()).constant(t.constant())},us.apply(t,arguments)}function hT(){var t=tT(ex());return t.copy=function(){return ha(t,hT()).exponent(t.exponent())},us.apply(t,arguments)}function OAe(){return hT.apply(null,arguments).exponent(.5)}const TO=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Sh,scaleDiverging:sW,scaleDivergingLog:aW,scaleDivergingPow:hT,scaleDivergingSqrt:OAe,scaleDivergingSymlog:lW,scaleIdentity:zj,scaleImplicit:Bw,scaleLinear:ay,scaleLog:Wj,scaleOrdinal:HI,scalePoint:Mf,scalePow:nT,scaleQuantile:Gj,scaleQuantize:Hj,scaleRadial:Uj,scaleSequential:nW,scaleSequentialLog:rW,scaleSequentialPow:fT,scaleSequentialQuantile:iW,scaleSequentialSqrt:AAe,scaleSequentialSymlog:oW,scaleSqrt:fNe,scaleSymlog:Vj,scaleThreshold:Kj,scaleTime:EAe,scaleUtc:NAe,tickFormat:Bj},Symbol.toStringTag,{value:"Module"}));var _Ae=Oc;function DAe(t,e,n){for(var r=-1,o=t.length;++r<o;){var i=t[r],s=e(i);if(s!=null&&(a===void 0?s===s&&!_Ae(s):n(s,a)))var a=s,l=i}return l}var uW=DAe;function RAe(t,e){return t>e}var PAe=RAe,MAe=uW,FAe=PAe,LAe=Lc;function BAe(t){return t&&t.length?MAe(t,LAe,FAe):void 0}var zAe=BAe;const tx=ft(zAe);function jAe(t,e){return t<e}var WAe=jAe,VAe=uW,UAe=WAe,GAe=Lc;function HAe(t){return t&&t.length?VAe(t,GAe,UAe):void 0}var KAe=HAe;const nx=ft(KAe);var qAe=II,XAe=ca,YAe=yj,QAe=Tr;function ZAe(t,e){var n=QAe(t)?qAe:YAe;return n(t,XAe(e))}var JAe=ZAe,eOe=mj,tOe=JAe;function nOe(t,e){return eOe(tOe(t,e),1)}var rOe=nOe;const oOe=ft(rOe);var iOe=jI;function sOe(t,e){return iOe(t,e)}var aOe=sOe;const rx=ft(aOe);var zc=1e9,lOe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},pT,At=!0,yo="[DecimalError] ",Va=yo+"Invalid argument: ",dT=yo+"Exponent out of range: ",jc=Math.floor,$a=Math.pow,uOe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Rr,yn=1e7,Ct=7,cW=9007199254740991,fy=jc(cW/Ct),be={};be.absoluteValue=be.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};be.comparedTo=be.cmp=function(t){var e,n,r,o,i=this;if(t=new i.constructor(t),i.s!==t.s)return i.s||-t.s;if(i.e!==t.e)return i.e>t.e^i.s<0?1:-1;for(r=i.d.length,o=t.d.length,e=0,n=r<o?r:o;e<n;++e)if(i.d[e]!==t.d[e])return i.d[e]>t.d[e]^i.s<0?1:-1;return r===o?0:r>o^i.s<0?1:-1};be.decimalPlaces=be.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*Ct;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};be.dividedBy=be.div=function(t){return Vi(this,new this.constructor(t))};be.dividedToIntegerBy=be.idiv=function(t){var e=this,n=e.constructor;return pt(Vi(e,new n(t),0,1),n.precision)};be.equals=be.eq=function(t){return!this.cmp(t)};be.exponent=function(){return rn(this)};be.greaterThan=be.gt=function(t){return this.cmp(t)>0};be.greaterThanOrEqualTo=be.gte=function(t){return this.cmp(t)>=0};be.isInteger=be.isint=function(){return this.e>this.d.length-2};be.isNegative=be.isneg=function(){return this.s<0};be.isPositive=be.ispos=function(){return this.s>0};be.isZero=function(){return this.s===0};be.lessThan=be.lt=function(t){return this.cmp(t)<0};be.lessThanOrEqualTo=be.lte=function(t){return this.cmp(t)<1};be.logarithm=be.log=function(t){var e,n=this,r=n.constructor,o=r.precision,i=o+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(Rr))throw Error(yo+"NaN");if(n.s<1)throw Error(yo+(n.s?"NaN":"-Infinity"));return n.eq(Rr)?new r(0):(At=!1,e=Vi(Th(n,i),Th(t,i),i),At=!0,pt(e,o))};be.minus=be.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?dW(e,t):fW(e,(t.s=-t.s,t))};be.modulo=be.mod=function(t){var e,n=this,r=n.constructor,o=r.precision;if(t=new r(t),!t.s)throw Error(yo+"NaN");return n.s?(At=!1,e=Vi(n,t,0,1).times(t),At=!0,n.minus(e)):pt(new r(n),o)};be.naturalExponential=be.exp=function(){return hW(this)};be.naturalLogarithm=be.ln=function(){return Th(this)};be.negated=be.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};be.plus=be.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?fW(e,t):dW(e,(t.s=-t.s,t))};be.precision=be.sd=function(t){var e,n,r,o=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Va+t);if(e=rn(o)+1,r=o.d.length-1,n=r*Ct+1,r=o.d[r],r){for(;r%10==0;r/=10)n--;for(r=o.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};be.squareRoot=be.sqrt=function(){var t,e,n,r,o,i,s,a=this,l=a.constructor;if(a.s<1){if(!a.s)return new l(0);throw Error(yo+"NaN")}for(t=rn(a),At=!1,o=Math.sqrt(+a),o==0||o==1/0?(e=li(a.d),(e.length+t)%2==0&&(e+="0"),o=Math.sqrt(e),t=jc((t+1)/2)-(t<0||t%2),o==1/0?e="5e"+t:(e=o.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new l(e)):r=new l(o.toString()),n=l.precision,o=s=n+3;;)if(i=r,r=i.plus(Vi(a,i,s+2)).times(.5),li(i.d).slice(0,s)===(e=li(r.d)).slice(0,s)){if(e=e.slice(s-3,s+1),o==s&&e=="4999"){if(pt(i,n+1,0),i.times(i).eq(a)){r=i;break}}else if(e!="9999")break;s+=4}return At=!0,pt(r,n)};be.times=be.mul=function(t){var e,n,r,o,i,s,a,l,u,c=this,f=c.constructor,h=c.d,d=(t=new f(t)).d;if(!c.s||!t.s)return new f(0);for(t.s*=c.s,n=c.e+t.e,l=h.length,u=d.length,l<u&&(i=h,h=d,d=i,s=l,l=u,u=s),i=[],s=l+u,r=s;r--;)i.push(0);for(r=u;--r>=0;){for(e=0,o=l+r;o>r;)a=i[o]+d[r]*h[o-r-1]+e,i[o--]=a%yn|0,e=a/yn|0;i[o]=(i[o]+e)%yn|0}for(;!i[--s];)i.pop();return e?++n:i.shift(),t.d=i,t.e=n,At?pt(t,f.precision):t};be.toDecimalPlaces=be.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:($i(t,0,zc),e===void 0?e=r.rounding:$i(e,0,8),pt(n,t+rn(n)+1,e))};be.toExponential=function(t,e){var n,r=this,o=r.constructor;return t===void 0?n=cl(r,!0):($i(t,0,zc),e===void 0?e=o.rounding:$i(e,0,8),r=pt(new o(r),t+1,e),n=cl(r,!0,t+1)),n};be.toFixed=function(t,e){var n,r,o=this,i=o.constructor;return t===void 0?cl(o):($i(t,0,zc),e===void 0?e=i.rounding:$i(e,0,8),r=pt(new i(o),t+rn(o)+1,e),n=cl(r.abs(),!1,t+rn(r)+1),o.isneg()&&!o.isZero()?"-"+n:n)};be.toInteger=be.toint=function(){var t=this,e=t.constructor;return pt(new e(t),rn(t)+1,e.rounding)};be.toNumber=function(){return+this};be.toPower=be.pow=function(t){var e,n,r,o,i,s,a=this,l=a.constructor,u=12,c=+(t=new l(t));if(!t.s)return new l(Rr);if(a=new l(a),!a.s){if(t.s<1)throw Error(yo+"Infinity");return a}if(a.eq(Rr))return a;if(r=l.precision,t.eq(Rr))return pt(a,r);if(e=t.e,n=t.d.length-1,s=e>=n,i=a.s,s){if((n=c<0?-c:c)<=cW){for(o=new l(Rr),e=Math.ceil(r/Ct+4),At=!1;n%2&&(o=o.times(a),NO(o.d,e)),n=jc(n/2),n!==0;)a=a.times(a),NO(a.d,e);return At=!0,t.s<0?new l(Rr).div(o):pt(o,r)}}else if(i<0)throw Error(yo+"NaN");return i=i<0&&t.d[Math.max(e,n)]&1?-1:1,a.s=1,At=!1,o=t.times(Th(a,r+u)),At=!0,o=hW(o),o.s=i,o};be.toPrecision=function(t,e){var n,r,o=this,i=o.constructor;return t===void 0?(n=rn(o),r=cl(o,n<=i.toExpNeg||n>=i.toExpPos)):($i(t,1,zc),e===void 0?e=i.rounding:$i(e,0,8),o=pt(new i(o),t,e),n=rn(o),r=cl(o,t<=n||n<=i.toExpNeg,t)),r};be.toSignificantDigits=be.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):($i(t,1,zc),e===void 0?e=r.rounding:$i(e,0,8)),pt(new r(n),t,e)};be.toString=be.valueOf=be.val=be.toJSON=be[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=rn(t),n=t.constructor;return cl(t,e<=n.toExpNeg||e>=n.toExpPos)};function fW(t,e){var n,r,o,i,s,a,l,u,c=t.constructor,f=c.precision;if(!t.s||!e.s)return e.s||(e=new c(t)),At?pt(e,f):e;if(l=t.d,u=e.d,s=t.e,o=e.e,l=l.slice(),i=s-o,i){for(i<0?(r=l,i=-i,a=u.length):(r=u,o=s,a=l.length),s=Math.ceil(f/Ct),a=s>a?s+1:a+1,i>a&&(i=a,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(a=l.length,i=u.length,a-i<0&&(i=a,r=u,u=l,l=r),n=0;i;)n=(l[--i]=l[i]+u[i]+n)/yn|0,l[i]%=yn;for(n&&(l.unshift(n),++o),a=l.length;l[--a]==0;)l.pop();return e.d=l,e.e=o,At?pt(e,f):e}function $i(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Va+t)}function li(t){var e,n,r,o=t.length-1,i="",s=t[0];if(o>0){for(i+=s,e=1;e<o;e++)r=t[e]+"",n=Ct-r.length,n&&(i+=ys(n)),i+=r;s=t[e],r=s+"",n=Ct-r.length,n&&(i+=ys(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Vi=function(){function t(r,o){var i,s=0,a=r.length;for(r=r.slice();a--;)i=r[a]*o+s,r[a]=i%yn|0,s=i/yn|0;return s&&r.unshift(s),r}function e(r,o,i,s){var a,l;if(i!=s)l=i>s?1:-1;else for(a=l=0;a<i;a++)if(r[a]!=o[a]){l=r[a]>o[a]?1:-1;break}return l}function n(r,o,i){for(var s=0;i--;)r[i]-=s,s=r[i]<o[i]?1:0,r[i]=s*yn+r[i]-o[i];for(;!r[0]&&r.length>1;)r.shift()}return function(r,o,i,s){var a,l,u,c,f,h,d,p,m,g,y,v,x,b,w,S,$,C,k=r.constructor,I=r.s==o.s?1:-1,T=r.d,N=o.d;if(!r.s)return new k(r);if(!o.s)throw Error(yo+"Division by zero");for(l=r.e-o.e,$=N.length,w=T.length,d=new k(I),p=d.d=[],u=0;N[u]==(T[u]||0);)++u;if(N[u]>(T[u]||0)&&--l,i==null?v=i=k.precision:s?v=i+(rn(r)-rn(o))+1:v=i,v<0)return new k(0);if(v=v/Ct+2|0,u=0,$==1)for(c=0,N=N[0],v++;(u<w||c)&&v--;u++)x=c*yn+(T[u]||0),p[u]=x/N|0,c=x%N|0;else{for(c=yn/(N[0]+1)|0,c>1&&(N=t(N,c),T=t(T,c),$=N.length,w=T.length),b=$,m=T.slice(0,$),g=m.length;g<$;)m[g++]=0;C=N.slice(),C.unshift(0),S=N[0],N[1]>=yn/2&&++S;do c=0,a=e(N,m,$,g),a<0?(y=m[0],$!=g&&(y=y*yn+(m[1]||0)),c=y/S|0,c>1?(c>=yn&&(c=yn-1),f=t(N,c),h=f.length,g=m.length,a=e(f,m,h,g),a==1&&(c--,n(f,$<h?C:N,h))):(c==0&&(a=c=1),f=N.slice()),h=f.length,h<g&&f.unshift(0),n(m,f,g),a==-1&&(g=m.length,a=e(N,m,$,g),a<1&&(c++,n(m,$<g?C:N,g))),g=m.length):a===0&&(c++,m=[0]),p[u++]=c,a&&m[0]?m[g++]=T[b]||0:(m=[T[b]],g=1);while((b++<w||m[0]!==void 0)&&v--)}return p[0]||p.shift(),d.e=l,pt(d,s?i+rn(d)+1:i)}}();function hW(t,e){var n,r,o,i,s,a,l=0,u=0,c=t.constructor,f=c.precision;if(rn(t)>16)throw Error(dT+rn(t));if(!t.s)return new c(Rr);for(e==null?(At=!1,a=f):a=e,s=new c(.03125);t.abs().gte(.1);)t=t.times(s),u+=5;for(r=Math.log($a(2,u))/Math.LN10*2+5|0,a+=r,n=o=i=new c(Rr),c.precision=a;;){if(o=pt(o.times(t),a),n=n.times(++l),s=i.plus(Vi(o,n,a)),li(s.d).slice(0,a)===li(i.d).slice(0,a)){for(;u--;)i=pt(i.times(i),a);return c.precision=f,e==null?(At=!0,pt(i,f)):i}i=s}}function rn(t){for(var e=t.e*Ct,n=t.d[0];n>=10;n/=10)e++;return e}function $b(t,e,n){if(e>t.LN10.sd())throw At=!0,n&&(t.precision=n),Error(yo+"LN10 precision limit exceeded");return pt(new t(t.LN10),e)}function ys(t){for(var e="";t--;)e+="0";return e}function Th(t,e){var n,r,o,i,s,a,l,u,c,f=1,h=10,d=t,p=d.d,m=d.constructor,g=m.precision;if(d.s<1)throw Error(yo+(d.s?"NaN":"-Infinity"));if(d.eq(Rr))return new m(0);if(e==null?(At=!1,u=g):u=e,d.eq(10))return e==null&&(At=!0),$b(m,u);if(u+=h,m.precision=u,n=li(p),r=n.charAt(0),i=rn(d),Math.abs(i)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)d=d.times(t),n=li(d.d),r=n.charAt(0),f++;i=rn(d),r>1?(d=new m("0."+n),i++):d=new m(r+"."+n.slice(1))}else return l=$b(m,u+2,g).times(i+""),d=Th(new m(r+"."+n.slice(1)),u-h).plus(l),m.precision=g,e==null?(At=!0,pt(d,g)):d;for(a=s=d=Vi(d.minus(Rr),d.plus(Rr),u),c=pt(d.times(d),u),o=3;;){if(s=pt(s.times(c),u),l=a.plus(Vi(s,new m(o),u)),li(l.d).slice(0,u)===li(a.d).slice(0,u))return a=a.times(2),i!==0&&(a=a.plus($b(m,u+2,g).times(i+""))),a=Vi(a,new m(f),u),m.precision=g,e==null?(At=!0,pt(a,g)):a;a=l,o+=2}}function EO(t,e){var n,r,o;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(o=e.length;e.charCodeAt(o-1)===48;)--o;if(e=e.slice(r,o),e){if(o-=r,n=n-r-1,t.e=jc(n/Ct),t.d=[],r=(n+1)%Ct,n<0&&(r+=Ct),r<o){for(r&&t.d.push(+e.slice(0,r)),o-=Ct;r<o;)t.d.push(+e.slice(r,r+=Ct));e=e.slice(r),r=Ct-e.length}else r-=o;for(;r--;)e+="0";if(t.d.push(+e),At&&(t.e>fy||t.e<-fy))throw Error(dT+n)}else t.s=0,t.e=0,t.d=[0];return t}function pt(t,e,n){var r,o,i,s,a,l,u,c,f=t.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(r=e-s,r<0)r+=Ct,o=e,u=f[c=0];else{if(c=Math.ceil((r+1)/Ct),i=f.length,c>=i)return t;for(u=i=f[c],s=1;i>=10;i/=10)s++;r%=Ct,o=r-Ct+s}if(n!==void 0&&(i=$a(10,s-o-1),a=u/i%10|0,l=e<0||f[c+1]!==void 0||u%i,l=n<4?(a||l)&&(n==0||n==(t.s<0?3:2)):a>5||a==5&&(n==4||l||n==6&&(r>0?o>0?u/$a(10,s-o):0:f[c-1])%10&1||n==(t.s<0?8:7))),e<1||!f[0])return l?(i=rn(t),f.length=1,e=e-i-1,f[0]=$a(10,(Ct-e%Ct)%Ct),t.e=jc(-e/Ct)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(r==0?(f.length=c,i=1,c--):(f.length=c+1,i=$a(10,Ct-r),f[c]=o>0?(u/$a(10,s-o)%$a(10,o)|0)*i:0),l)for(;;)if(c==0){(f[0]+=i)==yn&&(f[0]=1,++t.e);break}else{if(f[c]+=i,f[c]!=yn)break;f[c--]=0,i=1}for(r=f.length;f[--r]===0;)f.pop();if(At&&(t.e>fy||t.e<-fy))throw Error(dT+rn(t));return t}function dW(t,e){var n,r,o,i,s,a,l,u,c,f,h=t.constructor,d=h.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new h(t),At?pt(e,d):e;if(l=t.d,f=e.d,r=e.e,u=t.e,l=l.slice(),s=u-r,s){for(c=s<0,c?(n=l,s=-s,a=f.length):(n=f,r=u,a=l.length),o=Math.max(Math.ceil(d/Ct),a)+2,s>o&&(s=o,n.length=1),n.reverse(),o=s;o--;)n.push(0);n.reverse()}else{for(o=l.length,a=f.length,c=o<a,c&&(a=o),o=0;o<a;o++)if(l[o]!=f[o]){c=l[o]<f[o];break}s=0}for(c&&(n=l,l=f,f=n,e.s=-e.s),a=l.length,o=f.length-a;o>0;--o)l[a++]=0;for(o=f.length;o>s;){if(l[--o]<f[o]){for(i=o;i&&l[--i]===0;)l[i]=yn-1;--l[i],l[o]+=yn}l[o]-=f[o]}for(;l[--a]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(e.d=l,e.e=r,At?pt(e,d):e):new h(0)}function cl(t,e,n){var r,o=rn(t),i=li(t.d),s=i.length;return e?(n&&(r=n-s)>0?i=i.charAt(0)+"."+i.slice(1)+ys(r):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(o<0?"e":"e+")+o):o<0?(i="0."+ys(-o-1)+i,n&&(r=n-s)>0&&(i+=ys(r))):o>=s?(i+=ys(o+1-s),n&&(r=n-o-1)>0&&(i=i+"."+ys(r))):((r=o+1)<s&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-s)>0&&(o+1===s&&(i+="."),i+=ys(r))),t.s<0?"-"+i:i}function NO(t,e){if(t.length>e)return t.length=e,!0}function pW(t){var e,n,r;function o(i){var s=this;if(!(s instanceof o))return new o(i);if(s.constructor=o,i instanceof o){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Va+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return EO(s,i.toString())}else if(typeof i!="string")throw Error(Va+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,uOe.test(i))EO(s,i);else throw Error(Va+i)}if(o.prototype=be,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=pW,o.config=o.set=cOe,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return o.config(t),o}function cOe(t){if(!t||typeof t!="object")throw Error(yo+"Object expected");var e,n,r,o=["precision",1,zc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<o.length;e+=3)if((r=t[n=o[e]])!==void 0)if(jc(r)===r&&r>=o[e+1]&&r<=o[e+2])this[n]=r;else throw Error(Va+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Va+n+": "+r);return this}var pT=pW(lOe);Rr=new pT(1);const ut=pT;function fOe(t){return mOe(t)||pOe(t)||dOe(t)||hOe()}function hOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dOe(t,e){if(t){if(typeof t=="string")return Vw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vw(t,e)}}function pOe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function mOe(t){if(Array.isArray(t))return Vw(t)}function Vw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var gOe=function(e){return e},mW={"@@functional/placeholder":!0},gW=function(e){return e===mW},AO=function(e){return function n(){return arguments.length===0||arguments.length===1&&gW(arguments.length<=0?void 0:arguments[0])?n:e.apply(void 0,arguments)}},yOe=function t(e,n){return e===1?n:AO(function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var s=o.filter(function(a){return a!==mW}).length;return s>=e?n.apply(void 0,o):t(e-s,AO(function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];var c=o.map(function(f){return gW(f)?l.shift():f});return n.apply(void 0,fOe(c).concat(l))}))})},ox=function(e){return yOe(e.length,e)},Uw=function(e,n){for(var r=[],o=e;o<n;++o)r[o-e]=o;return r},vOe=ox(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(n){return e[n]}).map(t)}),xOe=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.length)return gOe;var o=n.reverse(),i=o[0],s=o.slice(1);return function(){return s.reduce(function(a,l){return l(a)},i.apply(void 0,arguments))}},Gw=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},yW=function(e){var n=null,r=null;return function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return n&&i.every(function(a,l){return a===n[l]})||(n=i,r=e.apply(void 0,i)),r}};function bOe(t){var e;return t===0?e=1:e=Math.floor(new ut(t).abs().log(10).toNumber())+1,e}function wOe(t,e,n){for(var r=new ut(t),o=0,i=[];r.lt(e)&&o<1e5;)i.push(r.toNumber()),r=r.add(n),o++;return i}var SOe=ox(function(t,e,n){var r=+t,o=+e;return r+n*(o-r)}),$Oe=ox(function(t,e,n){var r=e-+t;return r=r||1/0,(n-t)/r}),COe=ox(function(t,e,n){var r=e-+t;return r=r||1/0,Math.max(0,Math.min(1,(n-t)/r))});const ix={rangeStep:wOe,getDigitCount:bOe,interpolateNumber:SOe,uninterpolateNumber:$Oe,uninterpolateTruncation:COe};function Hw(t){return TOe(t)||IOe(t)||vW(t)||kOe()}function kOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IOe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function TOe(t){if(Array.isArray(t))return Kw(t)}function Eh(t,e){return AOe(t)||NOe(t,e)||vW(t,e)||EOe()}function EOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vW(t,e){if(t){if(typeof t=="string")return Kw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kw(t,e)}}function Kw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function NOe(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,o=!1,i=void 0;try{for(var s=t[Symbol.iterator](),a;!(r=(a=s.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(l){o=!0,i=l}finally{try{!r&&s.return!=null&&s.return()}finally{if(o)throw i}}return n}}function AOe(t){if(Array.isArray(t))return t}function xW(t){var e=Eh(t,2),n=e[0],r=e[1],o=n,i=r;return n>r&&(o=r,i=n),[o,i]}function bW(t,e,n){if(t.lte(0))return new ut(0);var r=ix.getDigitCount(t.toNumber()),o=new ut(10).pow(r),i=t.div(o),s=r!==1?.05:.1,a=new ut(Math.ceil(i.div(s).toNumber())).add(n).mul(s),l=a.mul(o);return e?l:new ut(Math.ceil(l))}function OOe(t,e,n){var r=1,o=new ut(t);if(!o.isint()&&n){var i=Math.abs(t);i<1?(r=new ut(10).pow(ix.getDigitCount(t)-1),o=new ut(Math.floor(o.div(r).toNumber())).mul(r)):i>1&&(o=new ut(Math.floor(t)))}else t===0?o=new ut(Math.floor((e-1)/2)):n||(o=new ut(Math.floor(t)));var s=Math.floor((e-1)/2),a=xOe(vOe(function(l){return o.add(new ut(l-s).mul(r)).toNumber()}),Uw);return a(0,e)}function wW(t,e,n,r){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(n-1)))return{step:new ut(0),tickMin:new ut(0),tickMax:new ut(0)};var i=bW(new ut(e).sub(t).div(n-1),r,o),s;t<=0&&e>=0?s=new ut(0):(s=new ut(t).add(e).div(2),s=s.sub(new ut(s).mod(i)));var a=Math.ceil(s.sub(t).div(i).toNumber()),l=Math.ceil(new ut(e).sub(s).div(i).toNumber()),u=a+l+1;return u>n?wW(t,e,n,r,o+1):(u<n&&(l=e>0?l+(n-u):l,a=e>0?a:a+(n-u)),{step:i,tickMin:s.sub(new ut(a).mul(i)),tickMax:s.add(new ut(l).mul(i))})}function _Oe(t){var e=Eh(t,2),n=e[0],r=e[1],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(o,2),a=xW([n,r]),l=Eh(a,2),u=l[0],c=l[1];if(u===-1/0||c===1/0){var f=c===1/0?[u].concat(Hw(Uw(0,o-1).map(function(){return 1/0}))):[].concat(Hw(Uw(0,o-1).map(function(){return-1/0})),[c]);return n>r?Gw(f):f}if(u===c)return OOe(u,o,i);var h=wW(u,c,s,i),d=h.step,p=h.tickMin,m=h.tickMax,g=ix.rangeStep(p,m.add(new ut(.1).mul(d)),d);return n>r?Gw(g):g}function DOe(t,e){var n=Eh(t,2),r=n[0],o=n[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=xW([r,o]),a=Eh(s,2),l=a[0],u=a[1];if(l===-1/0||u===1/0)return[r,o];if(l===u)return[l];var c=Math.max(e,2),f=bW(new ut(u).sub(l).div(c-1),i,0),h=[].concat(Hw(ix.rangeStep(new ut(l),new ut(u).sub(new ut(.99).mul(f)),f)),[u]);return r>o?Gw(h):h}var ROe=yW(_Oe),POe=yW(DOe),MOe="Invariant failed";function fl(t,e){throw new Error(MOe)}var FOe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Qu(t){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qu(t)}function hy(){return hy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hy.apply(this,arguments)}function LOe(t,e){return WOe(t)||jOe(t,e)||zOe(t,e)||BOe()}function BOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zOe(t,e){if(t){if(typeof t=="string")return OO(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return OO(t,e)}}function OO(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function jOe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function WOe(t){if(Array.isArray(t))return t}function VOe(t,e){if(t==null)return{};var n=UOe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function UOe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function GOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HOe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,CW(r.key),r)}}function KOe(t,e,n){return e&&HOe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function qOe(t,e,n){return e=dy(e),XOe(t,SW()?Reflect.construct(e,n||[],dy(t).constructor):e.apply(t,n))}function XOe(t,e){if(e&&(Qu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YOe(t)}function YOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function SW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SW=function(){return!!t})()}function dy(t){return dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},dy(t)}function QOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qw(t,e)}function qw(t,e){return qw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},qw(t,e)}function $W(t,e,n){return e=CW(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CW(t){var e=ZOe(t,"string");return Qu(e)=="symbol"?e:e+""}function ZOe(t,e){if(Qu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Qu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ap=function(t){function e(){return GOe(this,e),qOe(this,e,arguments)}return QOe(e,t),KOe(e,[{key:"render",value:function(){var r=this.props,o=r.offset,i=r.layout,s=r.width,a=r.dataKey,l=r.data,u=r.dataPointFormatter,c=r.xAxis,f=r.yAxis,h=VOe(r,FOe),d=Ve(h,!1);this.props.direction==="x"&&c.type!=="number"&&fl();var p=l.map(function(m){var g=u(m,a),y=g.x,v=g.y,x=g.value,b=g.errorVal;if(!b)return null;var w=[],S,$;if(Array.isArray(b)){var C=LOe(b,2);S=C[0],$=C[1]}else S=$=b;if(i==="vertical"){var k=c.scale,I=v+o,T=I+s,N=I-s,_=k(x-S),D=k(x+$);w.push({x1:D,y1:T,x2:D,y2:N}),w.push({x1:_,y1:I,x2:D,y2:I}),w.push({x1:_,y1:T,x2:_,y2:N})}else if(i==="horizontal"){var O=f.scale,R=y+o,F=R-s,A=R+s,P=O(x-S),z=O(x+$);w.push({x1:F,y1:z,x2:A,y2:z}),w.push({x1:R,y1:P,x2:R,y2:z}),w.push({x1:F,y1:P,x2:A,y2:P})}return W.createElement(Kt,hy({className:"recharts-errorBar",key:"bar-".concat(w.map(function(U){return"".concat(U.x1,"-").concat(U.x2,"-").concat(U.y1,"-").concat(U.y2)}))},d),w.map(function(U){return W.createElement("line",hy({},U,{key:"line-".concat(U.x1,"-").concat(U.x2,"-").concat(U.y1,"-").concat(U.y2)}))}))});return W.createElement(Kt,{className:"recharts-errorBars"},p)}}])}(W.Component);$W(Ap,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});$W(Ap,"displayName","ErrorBar");function Nh(t){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nh(t)}function _O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ya(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_O(Object(n),!0).forEach(function(r){JOe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_O(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function JOe(t,e,n){return e=e_e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e_e(t){var e=t_e(t,"string");return Nh(e)=="symbol"?e:e+""}function t_e(t,e){if(Nh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Nh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var kW=function(e){var n=e.children,r=e.formattedGraphicalItems,o=e.legendWidth,i=e.legendContent,s=_r(n,ji);if(!s)return null;var a=ji.defaultProps,l=a!==void 0?ya(ya({},a),s.props):{},u;return s.props&&s.props.payload?u=s.props&&s.props.payload:i==="children"?u=(r||[]).reduce(function(c,f){var h=f.item,d=f.props,p=d.sectors||d.data||[];return c.concat(p.map(function(m){return{type:s.props.iconType||h.props.legendType,value:m.name,color:m.fill,payload:m}}))},[]):u=(r||[]).map(function(c){var f=c.item,h=f.type.defaultProps,d=h!==void 0?ya(ya({},h),f.props):{},p=d.dataKey,m=d.name,g=d.legendType,y=d.hide;return{inactive:y,dataKey:p,type:l.iconType||g||"square",color:mT(f),value:m||p,payload:d}}),ya(ya(ya({},l),ji.getWithHeight(s,o)),{},{payload:u,item:s})};function Ah(t){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ah(t)}function DO(t){return i_e(t)||o_e(t)||r_e(t)||n_e()}function n_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r_e(t,e){if(t){if(typeof t=="string")return Xw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xw(t,e)}}function o_e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function i_e(t){if(Array.isArray(t))return Xw(t)}function Xw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function RO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Lt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?RO(Object(n),!0).forEach(function(r){bu(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RO(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function bu(t,e,n){return e=s_e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s_e(t){var e=a_e(t,"string");return Ah(e)=="symbol"?e:e+""}function a_e(t,e){if(Ah(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ah(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jr(t,e,n){return We(t)||We(e)?n:pn(e)?co(t,e,n):Be(e)?e(t):n}function Ff(t,e,n,r){var o=oOe(t,function(a){return jr(a,e)});if(n==="number"){var i=o.filter(function(a){return pe(a)||parseFloat(a)});return i.length?[nx(i),tx(i)]:[1/0,-1/0]}var s=r?o.filter(function(a){return!We(a)}):o;return s.map(function(a){return pn(a)||a instanceof Date?a:""})}var l_e=function(e){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=-1,a=(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0;if(a<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var l=i.range,u=0;u<a;u++){var c=u>0?o[u-1].coordinate:o[a-1].coordinate,f=o[u].coordinate,h=u>=a-1?o[0].coordinate:o[u+1].coordinate,d=void 0;if(Bo(f-c)!==Bo(h-f)){var p=[];if(Bo(h-f)===Bo(l[1]-l[0])){d=h;var m=f+l[1]-l[0];p[0]=Math.min(m,(m+c)/2),p[1]=Math.max(m,(m+c)/2)}else{d=c;var g=h+l[1]-l[0];p[0]=Math.min(f,(g+f)/2),p[1]=Math.max(f,(g+f)/2)}var y=[Math.min(f,(d+f)/2),Math.max(f,(d+f)/2)];if(e>y[0]&&e<=y[1]||e>=p[0]&&e<=p[1]){s=o[u].index;break}}else{var v=Math.min(c,h),x=Math.max(c,h);if(e>(v+f)/2&&e<=(x+f)/2){s=o[u].index;break}}}else for(var b=0;b<a;b++)if(b===0&&e<=(r[b].coordinate+r[b+1].coordinate)/2||b>0&&b<a-1&&e>(r[b].coordinate+r[b-1].coordinate)/2&&e<=(r[b].coordinate+r[b+1].coordinate)/2||b===a-1&&e>(r[b].coordinate+r[b-1].coordinate)/2){s=r[b].index;break}return s},mT=function(e){var n,r=e,o=r.type.displayName,i=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Lt(Lt({},e.type.defaultProps),e.props):e.props,s=i.stroke,a=i.fill,l;switch(o){case"Line":l=s;break;case"Area":case"Radar":l=s&&s!=="none"?s:a;break;default:l=a;break}return l},u_e=function(e){var n=e.barSize,r=e.totalSize,o=e.stackGroups,i=o===void 0?{}:o;if(!i)return{};for(var s={},a=Object.keys(i),l=0,u=a.length;l<u;l++)for(var c=i[a[l]].stackGroups,f=Object.keys(c),h=0,d=f.length;h<d;h++){var p=c[f[h]],m=p.items,g=p.cateAxisId,y=m.filter(function($){return Bi($.type).indexOf("Bar")>=0});if(y&&y.length){var v=y[0].type.defaultProps,x=v!==void 0?Lt(Lt({},v),y[0].props):y[0].props,b=x.barSize,w=x[g];s[w]||(s[w]=[]);var S=We(b)?n:b;s[w].push({item:y[0],stackList:y.slice(1),barSize:We(S)?void 0:ul(S,r,0)})}}return s},c_e=function(e){var n=e.barGap,r=e.barCategoryGap,o=e.bandSize,i=e.sizeList,s=i===void 0?[]:i,a=e.maxBarSize,l=s.length;if(l<1)return null;var u=ul(n,o,0,!0),c,f=[];if(s[0].barSize===+s[0].barSize){var h=!1,d=o/l,p=s.reduce(function(b,w){return b+w.barSize||0},0);p+=(l-1)*u,p>=o&&(p-=(l-1)*u,u=0),p>=o&&d>0&&(h=!0,d*=.9,p=l*d);var m=(o-p)/2>>0,g={offset:m-u,size:0};c=s.reduce(function(b,w){var S={item:w.item,position:{offset:g.offset+g.size+u,size:h?d:w.barSize}},$=[].concat(DO(b),[S]);return g=$[$.length-1].position,w.stackList&&w.stackList.length&&w.stackList.forEach(function(C){$.push({item:C,position:g})}),$},f)}else{var y=ul(r,o,0,!0);o-2*y-(l-1)*u<=0&&(u=0);var v=(o-2*y-(l-1)*u)/l;v>1&&(v>>=0);var x=a===+a?Math.min(v,a):v;c=s.reduce(function(b,w,S){var $=[].concat(DO(b),[{item:w.item,position:{offset:y+(v+u)*S+(v-x)/2,size:x}}]);return w.stackList&&w.stackList.length&&w.stackList.forEach(function(C){$.push({item:C,position:$[$.length-1].position})}),$},f)}return c},f_e=function(e,n,r,o){var i=r.children,s=r.width,a=r.margin,l=s-(a.left||0)-(a.right||0),u=kW({children:i,legendWidth:l});if(u){var c=o||{},f=c.width,h=c.height,d=u.align,p=u.verticalAlign,m=u.layout;if((m==="vertical"||m==="horizontal"&&p==="middle")&&d!=="center"&&pe(e[d]))return Lt(Lt({},e),{},bu({},d,e[d]+(f||0)));if((m==="horizontal"||m==="vertical"&&d==="center")&&p!=="middle"&&pe(e[p]))return Lt(Lt({},e),{},bu({},p,e[p]+(h||0)))}return e},h_e=function(e,n,r){return We(n)?!0:e==="horizontal"?n==="yAxis":e==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},IW=function(e,n,r,o,i){var s=n.props.children,a=fo(s,Ap).filter(function(u){return h_e(o,i,u.props.direction)});if(a&&a.length){var l=a.map(function(u){return u.props.dataKey});return e.reduce(function(u,c){var f=jr(c,r);if(We(f))return u;var h=Array.isArray(f)?[nx(f),tx(f)]:[f,f],d=l.reduce(function(p,m){var g=jr(c,m,0),y=h[0]-Math.abs(Array.isArray(g)?g[0]:g),v=h[1]+Math.abs(Array.isArray(g)?g[1]:g);return[Math.min(y,p[0]),Math.max(v,p[1])]},[1/0,-1/0]);return[Math.min(d[0],u[0]),Math.max(d[1],u[1])]},[1/0,-1/0])}return null},d_e=function(e,n,r,o,i){var s=n.map(function(a){return IW(e,a,r,i,o)}).filter(function(a){return!We(a)});return s&&s.length?s.reduce(function(a,l){return[Math.min(a[0],l[0]),Math.max(a[1],l[1])]},[1/0,-1/0]):null},TW=function(e,n,r,o,i){var s=n.map(function(l){var u=l.props.dataKey;return r==="number"&&u&&IW(e,l,u,o)||Ff(e,u,r,i)});if(r==="number")return s.reduce(function(l,u){return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);var a={};return s.reduce(function(l,u){for(var c=0,f=u.length;c<f;c++)a[u[c]]||(a[u[c]]=!0,l.push(u[c]));return l},[])},EW=function(e,n){return e==="horizontal"&&n==="xAxis"||e==="vertical"&&n==="yAxis"||e==="centric"&&n==="angleAxis"||e==="radial"&&n==="radiusAxis"},NW=function(e,n,r,o){if(o)return e.map(function(l){return l.coordinate});var i,s,a=e.map(function(l){return l.coordinate===n&&(i=!0),l.coordinate===r&&(s=!0),l.coordinate});return i||a.push(n),s||a.push(r),a},Mi=function(e,n,r){if(!e)return null;var o=e.scale,i=e.duplicateDomain,s=e.type,a=e.range,l=e.realScaleType==="scaleBand"?o.bandwidth()/2:2,u=(n||r)&&s==="category"&&o.bandwidth?o.bandwidth()/l:0;if(u=e.axisType==="angleAxis"&&(a==null?void 0:a.length)>=2?Bo(a[0]-a[1])*2*u:u,n&&(e.ticks||e.niceTicks)){var c=(e.ticks||e.niceTicks).map(function(f){var h=i?i.indexOf(f):f;return{coordinate:o(h)+u,value:f,offset:u}});return c.filter(function(f){return!$p(f.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(f,h){return{coordinate:o(f)+u,value:f,index:h,offset:u}}):o.ticks&&!r?o.ticks(e.tickCount).map(function(f){return{coordinate:o(f)+u,value:f,offset:u}}):o.domain().map(function(f,h){return{coordinate:o(f)+u,value:i?i[f]:f,index:h,offset:u}})},Cb=new WeakMap,ym=function(e,n){if(typeof n!="function")return e;Cb.has(e)||Cb.set(e,new WeakMap);var r=Cb.get(e);if(r.has(n))return r.get(n);var o=function(){e.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,o),o},p_e=function(e,n,r){var o=e.scale,i=e.type,s=e.layout,a=e.axisType;if(o==="auto")return s==="radial"&&a==="radiusAxis"?{scale:Sh(),realScaleType:"band"}:s==="radial"&&a==="angleAxis"?{scale:ay(),realScaleType:"linear"}:i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:Mf(),realScaleType:"point"}:i==="category"?{scale:Sh(),realScaleType:"band"}:{scale:ay(),realScaleType:"linear"};if(Sp(o)){var l="scale".concat(W0(o));return{scale:(TO[l]||Mf)(),realScaleType:TO[l]?l:"point"}}return Be(o)?{scale:o}:{scale:Mf(),realScaleType:"point"}},PO=1e-4,m_e=function(e){var n=e.domain();if(!(!n||n.length<=2)){var r=n.length,o=e.range(),i=Math.min(o[0],o[1])-PO,s=Math.max(o[0],o[1])+PO,a=e(n[0]),l=e(n[r-1]);(a<i||a>s||l<i||l>s)&&e.domain([n[0],n[r-1]])}},g_e=function(e,n){if(!e)return null;for(var r=0,o=e.length;r<o;r++)if(e[r].item===n)return e[r].position;return null},y_e=function(e,n){if(!n||n.length!==2||!pe(n[0])||!pe(n[1]))return e;var r=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]),i=[e[0],e[1]];return(!pe(e[0])||e[0]<r)&&(i[0]=r),(!pe(e[1])||e[1]>o)&&(i[1]=o),i[0]>o&&(i[0]=o),i[1]<r&&(i[1]=r),i},v_e=function(e){var n=e.length;if(!(n<=0))for(var r=0,o=e[0].length;r<o;++r)for(var i=0,s=0,a=0;a<n;++a){var l=$p(e[a][r][1])?e[a][r][0]:e[a][r][1];l>=0?(e[a][r][0]=i,e[a][r][1]=i+l,i=e[a][r][1]):(e[a][r][0]=s,e[a][r][1]=s+l,s=e[a][r][1])}},x_e=function(e){var n=e.length;if(!(n<=0))for(var r=0,o=e[0].length;r<o;++r)for(var i=0,s=0;s<n;++s){var a=$p(e[s][r][1])?e[s][r][0]:e[s][r][1];a>=0?(e[s][r][0]=i,e[s][r][1]=i+a,i=e[s][r][1]):(e[s][r][0]=0,e[s][r][1]=0)}},b_e={sign:v_e,expand:Pbe,none:Vu,silhouette:Mbe,wiggle:Fbe,positive:x_e},w_e=function(e,n,r){var o=n.map(function(a){return a.props.dataKey}),i=b_e[r],s=Rbe().keys(o).value(function(a,l){return+jr(a,l,0)}).order(bw).offset(i);return s(e)},S_e=function(e,n,r,o,i,s){if(!e)return null;var a=s?n.reverse():n,l={},u=a.reduce(function(f,h){var d,p=(d=h.type)!==null&&d!==void 0&&d.defaultProps?Lt(Lt({},h.type.defaultProps),h.props):h.props,m=p.stackId,g=p.hide;if(g)return f;var y=p[r],v=f[y]||{hasStack:!1,stackGroups:{}};if(pn(m)){var x=v.stackGroups[m]||{numericAxisId:r,cateAxisId:o,items:[]};x.items.push(h),v.hasStack=!0,v.stackGroups[m]=x}else v.stackGroups[Cp("_stackId_")]={numericAxisId:r,cateAxisId:o,items:[h]};return Lt(Lt({},f),{},bu({},y,v))},l),c={};return Object.keys(u).reduce(function(f,h){var d=u[h];if(d.hasStack){var p={};d.stackGroups=Object.keys(d.stackGroups).reduce(function(m,g){var y=d.stackGroups[g];return Lt(Lt({},m),{},bu({},g,{numericAxisId:r,cateAxisId:o,items:y.items,stackedData:w_e(e,y.items,i)}))},p)}return Lt(Lt({},f),{},bu({},h,d))},c)},$_e=function(e,n){var r=n.realScaleType,o=n.type,i=n.tickCount,s=n.originalDomain,a=n.allowDecimals,l=r||n.scale;if(l!=="auto"&&l!=="linear")return null;if(i&&o==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var u=e.domain();if(!u.length)return null;var c=ROe(u,i,a);return e.domain([nx(c),tx(c)]),{niceTicks:c}}if(i&&o==="number"){var f=e.domain(),h=POe(f,i,a);return{niceTicks:h}}return null};function MO(t){var e=t.axis,n=t.ticks,r=t.bandSize,o=t.entry,i=t.index,s=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!We(o[e.dataKey])){var a=Lg(n,"value",o[e.dataKey]);if(a)return a.coordinate+r/2}return n[i]?n[i].coordinate+r/2:null}var l=jr(o,We(s)?e.dataKey:s);return We(l)?null:e.scale(l)}var FO=function(e){var n=e.axis,r=e.ticks,o=e.offset,i=e.bandSize,s=e.entry,a=e.index;if(n.type==="category")return r[a]?r[a].coordinate+o:null;var l=jr(s,n.dataKey,n.domain[a]);return We(l)?null:n.scale(l)-i/2+o},C_e=function(e){var n=e.numericAxis,r=n.scale.domain();if(n.type==="number"){var o=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return o<=0&&i>=0?0:i<0?i:o}return r[0]},k_e=function(e,n){var r,o=(r=e.type)!==null&&r!==void 0&&r.defaultProps?Lt(Lt({},e.type.defaultProps),e.props):e.props,i=o.stackId;if(pn(i)){var s=n[i];if(s){var a=s.items.indexOf(e);return a>=0?s.stackedData[a]:null}}return null},I_e=function(e){return e.reduce(function(n,r){return[nx(r.concat([n[0]]).filter(pe)),tx(r.concat([n[1]]).filter(pe))]},[1/0,-1/0])},AW=function(e,n,r){return Object.keys(e).reduce(function(o,i){var s=e[i],a=s.stackedData,l=a.reduce(function(u,c){var f=I_e(c.slice(n,r+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],o[0]),Math.max(l[1],o[1])]},[1/0,-1/0]).map(function(o){return o===1/0||o===-1/0?0:o})},LO=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,BO=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Yw=function(e,n,r){if(Be(e))return e(n,r);if(!Array.isArray(e))return n;var o=[];if(pe(e[0]))o[0]=r?e[0]:Math.min(e[0],n[0]);else if(LO.test(e[0])){var i=+LO.exec(e[0])[1];o[0]=n[0]-i}else Be(e[0])?o[0]=e[0](n[0]):o[0]=n[0];if(pe(e[1]))o[1]=r?e[1]:Math.max(e[1],n[1]);else if(BO.test(e[1])){var s=+BO.exec(e[1])[1];o[1]=n[1]+s}else Be(e[1])?o[1]=e[1](n[1]):o[1]=n[1];return o},py=function(e,n,r){if(e&&e.scale&&e.scale.bandwidth){var o=e.scale.bandwidth();if(!r||o>0)return o}if(e&&n&&n.length>=2){for(var i=VI(n,function(f){return f.coordinate}),s=1/0,a=1,l=i.length;a<l;a++){var u=i[a],c=i[a-1];s=Math.min((u.coordinate||0)-(c.coordinate||0),s)}return s===1/0?0:s}return r?void 0:0},zO=function(e,n,r){return!e||!e.length||rx(e,co(r,"type.defaultProps.domain"))?n:e},OW=function(e,n){var r=e.type.defaultProps?Lt(Lt({},e.type.defaultProps),e.props):e.props,o=r.dataKey,i=r.name,s=r.unit,a=r.formatter,l=r.tooltipType,u=r.chartType,c=r.hide;return Lt(Lt({},Ve(e,!1)),{},{dataKey:o,unit:s,formatter:a,name:i||o,color:mT(e),value:jr(n,o),type:l,payload:n,chartType:u,hide:c})};function Oh(t){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oh(t)}function jO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function WO(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?jO(Object(n),!0).forEach(function(r){T_e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jO(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function T_e(t,e,n){return e=E_e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E_e(t){var e=N_e(t,"string");return Oh(e)=="symbol"?e:e+""}function N_e(t,e){if(Oh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Oh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var my=Math.PI/180,A_e=function(e){return e*180/Math.PI},En=function(e,n,r,o){return{x:e+Math.cos(-my*o)*r,y:n+Math.sin(-my*o)*r}},O_e=function(e,n){var r=e.x,o=e.y,i=n.x,s=n.y;return Math.sqrt(Math.pow(r-i,2)+Math.pow(o-s,2))},__e=function(e,n){var r=e.x,o=e.y,i=n.cx,s=n.cy,a=O_e({x:r,y:o},{x:i,y:s});if(a<=0)return{radius:a};var l=(r-i)/a,u=Math.acos(l);return o>s&&(u=2*Math.PI-u),{radius:a,angle:A_e(u),angleInRadian:u}},D_e=function(e){var n=e.startAngle,r=e.endAngle,o=Math.floor(n/360),i=Math.floor(r/360),s=Math.min(o,i);return{startAngle:n-s*360,endAngle:r-s*360}},R_e=function(e,n){var r=n.startAngle,o=n.endAngle,i=Math.floor(r/360),s=Math.floor(o/360),a=Math.min(i,s);return e+a*360},VO=function(e,n){var r=e.x,o=e.y,i=__e({x:r,y:o},n),s=i.radius,a=i.angle,l=n.innerRadius,u=n.outerRadius;if(s<l||s>u)return!1;if(s===0)return!0;var c=D_e(n),f=c.startAngle,h=c.endAngle,d=a,p;if(f<=h){for(;d>h;)d-=360;for(;d<f;)d+=360;p=d>=f&&d<=h}else{for(;d>f;)d-=360;for(;d<h;)d+=360;p=d>=h&&d<=f}return p?WO(WO({},n),{},{radius:s,angle:R_e(d,n)}):null};function _h(t){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_h(t)}var P_e=["offset"];function M_e(t){return z_e(t)||B_e(t)||L_e(t)||F_e()}function F_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L_e(t,e){if(t){if(typeof t=="string")return Qw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qw(t,e)}}function B_e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function z_e(t){if(Array.isArray(t))return Qw(t)}function Qw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function j_e(t,e){if(t==null)return{};var n=W_e(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function W_e(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function UO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ln(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UO(Object(n),!0).forEach(function(r){V_e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UO(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function V_e(t,e,n){return e=U_e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U_e(t){var e=G_e(t,"string");return _h(e)=="symbol"?e:e+""}function G_e(t,e){if(_h(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(_h(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dh(){return Dh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dh.apply(this,arguments)}var H_e=function(e){var n=e.value,r=e.formatter,o=We(e.children)?n:e.children;return Be(r)?r(o):o},K_e=function(e,n){var r=Bo(n-e),o=Math.min(Math.abs(n-e),360);return r*o},q_e=function(e,n,r){var o=e.position,i=e.viewBox,s=e.offset,a=e.className,l=i,u=l.cx,c=l.cy,f=l.innerRadius,h=l.outerRadius,d=l.startAngle,p=l.endAngle,m=l.clockWise,g=(f+h)/2,y=K_e(d,p),v=y>=0?1:-1,x,b;o==="insideStart"?(x=d+v*s,b=m):o==="insideEnd"?(x=p-v*s,b=!m):o==="end"&&(x=p+v*s,b=m),b=y<=0?b:!b;var w=En(u,c,g,x),S=En(u,c,g,x+(b?1:-1)*359),$="M".concat(w.x,",").concat(w.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(b?0:1,`,
    `).concat(S.x,",").concat(S.y),C=We(e.id)?Cp("recharts-radial-line-"):e.id;return W.createElement("text",Dh({},r,{dominantBaseline:"central",className:Je("recharts-radial-bar-label",a)}),W.createElement("defs",null,W.createElement("path",{id:C,d:$})),W.createElement("textPath",{xlinkHref:"#".concat(C)},n))},X_e=function(e){var n=e.viewBox,r=e.offset,o=e.position,i=n,s=i.cx,a=i.cy,l=i.innerRadius,u=i.outerRadius,c=i.startAngle,f=i.endAngle,h=(c+f)/2;if(o==="outside"){var d=En(s,a,u+r,h),p=d.x,m=d.y;return{x:p,y:m,textAnchor:p>=s?"start":"end",verticalAnchor:"middle"}}if(o==="center")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(o==="centerTop")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"start"};if(o==="centerBottom")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"end"};var g=(l+u)/2,y=En(s,a,g,h),v=y.x,x=y.y;return{x:v,y:x,textAnchor:"middle",verticalAnchor:"middle"}},Y_e=function(e){var n=e.viewBox,r=e.parentViewBox,o=e.offset,i=e.position,s=n,a=s.x,l=s.y,u=s.width,c=s.height,f=c>=0?1:-1,h=f*o,d=f>0?"end":"start",p=f>0?"start":"end",m=u>=0?1:-1,g=m*o,y=m>0?"end":"start",v=m>0?"start":"end";if(i==="top"){var x={x:a+u/2,y:l-f*o,textAnchor:"middle",verticalAnchor:d};return ln(ln({},x),r?{height:Math.max(l-r.y,0),width:u}:{})}if(i==="bottom"){var b={x:a+u/2,y:l+c+h,textAnchor:"middle",verticalAnchor:p};return ln(ln({},b),r?{height:Math.max(r.y+r.height-(l+c),0),width:u}:{})}if(i==="left"){var w={x:a-g,y:l+c/2,textAnchor:y,verticalAnchor:"middle"};return ln(ln({},w),r?{width:Math.max(w.x-r.x,0),height:c}:{})}if(i==="right"){var S={x:a+u+g,y:l+c/2,textAnchor:v,verticalAnchor:"middle"};return ln(ln({},S),r?{width:Math.max(r.x+r.width-S.x,0),height:c}:{})}var $=r?{width:u,height:c}:{};return i==="insideLeft"?ln({x:a+g,y:l+c/2,textAnchor:v,verticalAnchor:"middle"},$):i==="insideRight"?ln({x:a+u-g,y:l+c/2,textAnchor:y,verticalAnchor:"middle"},$):i==="insideTop"?ln({x:a+u/2,y:l+h,textAnchor:"middle",verticalAnchor:p},$):i==="insideBottom"?ln({x:a+u/2,y:l+c-h,textAnchor:"middle",verticalAnchor:d},$):i==="insideTopLeft"?ln({x:a+g,y:l+h,textAnchor:v,verticalAnchor:p},$):i==="insideTopRight"?ln({x:a+u-g,y:l+h,textAnchor:y,verticalAnchor:p},$):i==="insideBottomLeft"?ln({x:a+g,y:l+c-h,textAnchor:v,verticalAnchor:d},$):i==="insideBottomRight"?ln({x:a+u-g,y:l+c-h,textAnchor:y,verticalAnchor:d},$):_c(i)&&(pe(i.x)||Da(i.x))&&(pe(i.y)||Da(i.y))?ln({x:a+ul(i.x,u),y:l+ul(i.y,c),textAnchor:"end",verticalAnchor:"end"},$):ln({x:a+u/2,y:l+c/2,textAnchor:"middle",verticalAnchor:"middle"},$)},Q_e=function(e){return"cx"in e&&pe(e.cx)};function Kn(t){var e=t.offset,n=e===void 0?5:e,r=j_e(t,P_e),o=ln({offset:n},r),i=o.viewBox,s=o.position,a=o.value,l=o.children,u=o.content,c=o.className,f=c===void 0?"":c,h=o.textBreakAll;if(!i||We(a)&&We(l)&&!se.isValidElement(u)&&!Be(u))return null;if(se.isValidElement(u))return se.cloneElement(u,o);var d;if(Be(u)){if(d=se.createElement(u,o),se.isValidElement(d))return d}else d=H_e(o);var p=Q_e(i),m=Ve(o,!0);if(p&&(s==="insideStart"||s==="insideEnd"||s==="end"))return q_e(o,d,m);var g=p?X_e(o):Y_e(o);return W.createElement(ey,Dh({className:Je("recharts-label",f)},m,g,{breakAll:h}),d)}Kn.displayName="Label";var _W=function(e){var n=e.cx,r=e.cy,o=e.angle,i=e.startAngle,s=e.endAngle,a=e.r,l=e.radius,u=e.innerRadius,c=e.outerRadius,f=e.x,h=e.y,d=e.top,p=e.left,m=e.width,g=e.height,y=e.clockWise,v=e.labelViewBox;if(v)return v;if(pe(m)&&pe(g)){if(pe(f)&&pe(h))return{x:f,y:h,width:m,height:g};if(pe(d)&&pe(p))return{x:d,y:p,width:m,height:g}}return pe(f)&&pe(h)?{x:f,y:h,width:0,height:0}:pe(n)&&pe(r)?{cx:n,cy:r,startAngle:i||o||0,endAngle:s||o||0,innerRadius:u||0,outerRadius:c||l||a||0,clockWise:y}:e.viewBox?e.viewBox:{}},Z_e=function(e,n){return e?e===!0?W.createElement(Kn,{key:"label-implicit",viewBox:n}):pn(e)?W.createElement(Kn,{key:"label-implicit",viewBox:n,value:e}):se.isValidElement(e)?e.type===Kn?se.cloneElement(e,{key:"label-implicit",viewBox:n}):W.createElement(Kn,{key:"label-implicit",content:e,viewBox:n}):Be(e)?W.createElement(Kn,{key:"label-implicit",content:e,viewBox:n}):_c(e)?W.createElement(Kn,Dh({viewBox:n},e,{key:"label-implicit"})):null:null},J_e=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var o=e.children,i=_W(e),s=fo(o,Kn).map(function(l,u){return se.cloneElement(l,{viewBox:n||i,key:"label-".concat(u)})});if(!r)return s;var a=Z_e(e.label,n||i);return[a].concat(M_e(s))};Kn.parseViewBox=_W;Kn.renderCallByParent=J_e;function eDe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var tDe=eDe;const nDe=ft(tDe);function Rh(t){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rh(t)}var rDe=["valueAccessor"],oDe=["data","dataKey","clockWise","id","textBreakAll"];function iDe(t){return uDe(t)||lDe(t)||aDe(t)||sDe()}function sDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aDe(t,e){if(t){if(typeof t=="string")return Zw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zw(t,e)}}function lDe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function uDe(t){if(Array.isArray(t))return Zw(t)}function Zw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function gy(){return gy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gy.apply(this,arguments)}function GO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function HO(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?GO(Object(n),!0).forEach(function(r){cDe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):GO(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function cDe(t,e,n){return e=fDe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fDe(t){var e=hDe(t,"string");return Rh(e)=="symbol"?e:e+""}function hDe(t,e){if(Rh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Rh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KO(t,e){if(t==null)return{};var n=dDe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function dDe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var pDe=function(e){return Array.isArray(e.value)?nDe(e.value):e.value};function js(t){var e=t.valueAccessor,n=e===void 0?pDe:e,r=KO(t,rDe),o=r.data,i=r.dataKey,s=r.clockWise,a=r.id,l=r.textBreakAll,u=KO(r,oDe);return!o||!o.length?null:W.createElement(Kt,{className:"recharts-label-list"},o.map(function(c,f){var h=We(i)?n(c,f):jr(c&&c.payload,i),d=We(a)?{}:{id:"".concat(a,"-").concat(f)};return W.createElement(Kn,gy({},Ve(c,!0),u,d,{parentViewBox:c.parentViewBox,value:h,textBreakAll:l,viewBox:Kn.parseViewBox(We(s)?c:HO(HO({},c),{},{clockWise:s})),key:"label-".concat(f),index:f}))}))}js.displayName="LabelList";function mDe(t,e){return t?t===!0?W.createElement(js,{key:"labelList-implicit",data:e}):W.isValidElement(t)||Be(t)?W.createElement(js,{key:"labelList-implicit",data:e,content:t}):_c(t)?W.createElement(js,gy({data:e},t,{key:"labelList-implicit"})):null:null}function gDe(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var r=t.children,o=fo(r,js).map(function(s,a){return se.cloneElement(s,{data:e,key:"labelList-".concat(a)})});if(!n)return o;var i=mDe(t.label,e);return[i].concat(iDe(o))}js.renderCallByParent=gDe;function Ph(t){"@babel/helpers - typeof";return Ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ph(t)}function Jw(){return Jw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Jw.apply(this,arguments)}function qO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function XO(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qO(Object(n),!0).forEach(function(r){yDe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qO(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function yDe(t,e,n){return e=vDe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vDe(t){var e=xDe(t,"string");return Ph(e)=="symbol"?e:e+""}function xDe(t,e){if(Ph(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ph(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bDe=function(e,n){var r=Bo(n-e),o=Math.min(Math.abs(n-e),359.999);return r*o},vm=function(e){var n=e.cx,r=e.cy,o=e.radius,i=e.angle,s=e.sign,a=e.isExternal,l=e.cornerRadius,u=e.cornerIsExternal,c=l*(a?1:-1)+o,f=Math.asin(l/c)/my,h=u?i:i+s*f,d=En(n,r,c,h),p=En(n,r,o,h),m=u?i-s*f:i,g=En(n,r,c*Math.cos(f*my),m);return{center:d,circleTangency:p,lineTangency:g,theta:f}},DW=function(e){var n=e.cx,r=e.cy,o=e.innerRadius,i=e.outerRadius,s=e.startAngle,a=e.endAngle,l=bDe(s,a),u=s+l,c=En(n,r,i,s),f=En(n,r,i,u),h="M ".concat(c.x,",").concat(c.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(s>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(o>0){var d=En(n,r,o,s),p=En(n,r,o,u);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(o,",").concat(o,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(s<=u),`,
            `).concat(d.x,",").concat(d.y," Z")}else h+="L ".concat(n,",").concat(r," Z");return h},wDe=function(e){var n=e.cx,r=e.cy,o=e.innerRadius,i=e.outerRadius,s=e.cornerRadius,a=e.forceCornerRadius,l=e.cornerIsExternal,u=e.startAngle,c=e.endAngle,f=Bo(c-u),h=vm({cx:n,cy:r,radius:i,angle:u,sign:f,cornerRadius:s,cornerIsExternal:l}),d=h.circleTangency,p=h.lineTangency,m=h.theta,g=vm({cx:n,cy:r,radius:i,angle:c,sign:-f,cornerRadius:s,cornerIsExternal:l}),y=g.circleTangency,v=g.lineTangency,x=g.theta,b=l?Math.abs(u-c):Math.abs(u-c)-m-x;if(b<0)return a?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):DW({cx:n,cy:r,innerRadius:o,outerRadius:i,startAngle:u,endAngle:c});var w="M ".concat(p.x,",").concat(p.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(d.x,",").concat(d.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(b>180),",").concat(+(f<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(v.x,",").concat(v.y,`
  `);if(o>0){var S=vm({cx:n,cy:r,radius:o,angle:u,sign:f,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),$=S.circleTangency,C=S.lineTangency,k=S.theta,I=vm({cx:n,cy:r,radius:o,angle:c,sign:-f,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),T=I.circleTangency,N=I.lineTangency,_=I.theta,D=l?Math.abs(u-c):Math.abs(u-c)-k-_;if(D<0&&s===0)return"".concat(w,"L").concat(n,",").concat(r,"Z");w+="L".concat(N.x,",").concat(N.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(T.x,",").concat(T.y,`
      A`).concat(o,",").concat(o,",0,").concat(+(D>180),",").concat(+(f>0),",").concat($.x,",").concat($.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(C.x,",").concat(C.y,"Z")}else w+="L".concat(n,",").concat(r,"Z");return w},SDe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},RW=function(e){var n=XO(XO({},SDe),e),r=n.cx,o=n.cy,i=n.innerRadius,s=n.outerRadius,a=n.cornerRadius,l=n.forceCornerRadius,u=n.cornerIsExternal,c=n.startAngle,f=n.endAngle,h=n.className;if(s<i||c===f)return null;var d=Je("recharts-sector",h),p=s-i,m=ul(a,p,0,!0),g;return m>0&&Math.abs(c-f)<360?g=wDe({cx:r,cy:o,innerRadius:i,outerRadius:s,cornerRadius:Math.min(m,p/2),forceCornerRadius:l,cornerIsExternal:u,startAngle:c,endAngle:f}):g=DW({cx:r,cy:o,innerRadius:i,outerRadius:s,startAngle:c,endAngle:f}),W.createElement("path",Jw({},Ve(n,!0),{className:d,d:g,role:"img"}))};function Mh(t){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mh(t)}function eS(){return eS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},eS.apply(this,arguments)}function YO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function QO(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?YO(Object(n),!0).forEach(function(r){$De(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YO(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function $De(t,e,n){return e=CDe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CDe(t){var e=kDe(t,"string");return Mh(e)=="symbol"?e:e+""}function kDe(t,e){if(Mh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Mh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZO={curveBasisClosed:$be,curveBasisOpen:Cbe,curveBasis:Sbe,curveBumpX:lbe,curveBumpY:ube,curveLinearClosed:kbe,curveLinear:U0,curveMonotoneX:Ibe,curveMonotoneY:Tbe,curveNatural:Ebe,curveStep:Nbe,curveStepAfter:Obe,curveStepBefore:Abe},xm=function(e){return e.x===+e.x&&e.y===+e.y},uf=function(e){return e.x},cf=function(e){return e.y},IDe=function(e,n){if(Be(e))return e;var r="curve".concat(W0(e));return(r==="curveMonotone"||r==="curveBump")&&n?ZO["".concat(r).concat(n==="vertical"?"Y":"X")]:ZO[r]||U0},TDe=function(e){var n=e.type,r=n===void 0?"linear":n,o=e.points,i=o===void 0?[]:o,s=e.baseLine,a=e.layout,l=e.connectNulls,u=l===void 0?!1:l,c=IDe(r,a),f=u?i.filter(function(m){return xm(m)}):i,h;if(Array.isArray(s)){var d=u?s.filter(function(m){return xm(m)}):s,p=f.map(function(m,g){return QO(QO({},m),{},{base:d[g]})});return a==="vertical"?h=um().y(cf).x1(uf).x0(function(m){return m.base.x}):h=um().x(uf).y1(cf).y0(function(m){return m.base.y}),h.defined(xm).curve(c),h(p)}return a==="vertical"&&pe(s)?h=um().y(cf).x1(uf).x0(s):pe(s)?h=um().x(uf).y1(cf).y0(s):h=R4().x(uf).y(cf),h.defined(xm).curve(c),h(f)},tS=function(e){var n=e.className,r=e.points,o=e.path,i=e.pathRef;if((!r||!r.length)&&!o)return null;var s=r&&r.length?TDe(e):o;return W.createElement("path",eS({},Ve(e,!1),Bg(e),{className:Je("recharts-curve",n),d:s,ref:i}))},PW={exports:{}},EDe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",NDe=EDe,ADe=NDe;function MW(){}function FW(){}FW.resetWarningCache=MW;var ODe=function(){function t(r,o,i,s,a,l){if(l!==ADe){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:FW,resetWarningCache:MW};return n.PropTypes=n,n};PW.exports=ODe();var _De=PW.exports;const rt=ft(_De);var DDe=Object.getOwnPropertyNames,RDe=Object.getOwnPropertySymbols,PDe=Object.prototype.hasOwnProperty;function JO(t,e){return function(r,o,i){return t(r,o,i)&&e(r,o,i)}}function bm(t){return function(n,r,o){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,o);var i=o.cache,s=i.get(n),a=i.get(r);if(s&&a)return s===r&&a===n;i.set(n,r),i.set(r,n);var l=t(n,r,o);return i.delete(n),i.delete(r),l}}function e_(t){return DDe(t).concat(RDe(t))}var MDe=Object.hasOwn||function(t,e){return PDe.call(t,e)};function Al(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var FDe="__v",LDe="__o",BDe="_owner",t_=Object.getOwnPropertyDescriptor,n_=Object.keys;function zDe(t,e,n){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function jDe(t,e){return Al(t.getTime(),e.getTime())}function WDe(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function VDe(t,e){return t===e}function r_(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var o=new Array(r),i=t.entries(),s,a,l=0;(s=i.next())&&!s.done;){for(var u=e.entries(),c=!1,f=0;(a=u.next())&&!a.done;){if(o[f]){f++;continue}var h=s.value,d=a.value;if(n.equals(h[0],d[0],l,f,t,e,n)&&n.equals(h[1],d[1],h[0],d[0],t,e,n)){c=o[f]=!0;break}f++}if(!c)return!1;l++}return!0}var UDe=Al;function GDe(t,e,n){var r=n_(t),o=r.length;if(n_(e).length!==o)return!1;for(;o-- >0;)if(!LW(t,e,n,r[o]))return!1;return!0}function ff(t,e,n){var r=e_(t),o=r.length;if(e_(e).length!==o)return!1;for(var i,s,a;o-- >0;)if(i=r[o],!LW(t,e,n,i)||(s=t_(t,i),a=t_(e,i),(s||a)&&(!s||!a||s.configurable!==a.configurable||s.enumerable!==a.enumerable||s.writable!==a.writable)))return!1;return!0}function HDe(t,e){return Al(t.valueOf(),e.valueOf())}function KDe(t,e){return t.source===e.source&&t.flags===e.flags}function o_(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var o=new Array(r),i=t.values(),s,a;(s=i.next())&&!s.done;){for(var l=e.values(),u=!1,c=0;(a=l.next())&&!a.done;){if(!o[c]&&n.equals(s.value,a.value,s.value,a.value,t,e,n)){u=o[c]=!0;break}c++}if(!u)return!1}return!0}function qDe(t,e){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function XDe(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function LW(t,e,n,r){return(r===BDe||r===LDe||r===FDe)&&(t.$$typeof||e.$$typeof)?!0:MDe(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}var YDe="[object Arguments]",QDe="[object Boolean]",ZDe="[object Date]",JDe="[object Error]",eRe="[object Map]",tRe="[object Number]",nRe="[object Object]",rRe="[object RegExp]",oRe="[object Set]",iRe="[object String]",sRe="[object URL]",aRe=Array.isArray,i_=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,s_=Object.assign,lRe=Object.prototype.toString.call.bind(Object.prototype.toString);function uRe(t){var e=t.areArraysEqual,n=t.areDatesEqual,r=t.areErrorsEqual,o=t.areFunctionsEqual,i=t.areMapsEqual,s=t.areNumbersEqual,a=t.areObjectsEqual,l=t.arePrimitiveWrappersEqual,u=t.areRegExpsEqual,c=t.areSetsEqual,f=t.areTypedArraysEqual,h=t.areUrlsEqual;return function(p,m,g){if(p===m)return!0;if(p==null||m==null)return!1;var y=typeof p;if(y!==typeof m)return!1;if(y!=="object")return y==="number"?s(p,m,g):y==="function"?o(p,m,g):!1;var v=p.constructor;if(v!==m.constructor)return!1;if(v===Object)return a(p,m,g);if(aRe(p))return e(p,m,g);if(i_!=null&&i_(p))return f(p,m,g);if(v===Date)return n(p,m,g);if(v===RegExp)return u(p,m,g);if(v===Map)return i(p,m,g);if(v===Set)return c(p,m,g);var x=lRe(p);return x===ZDe?n(p,m,g):x===rRe?u(p,m,g):x===eRe?i(p,m,g):x===oRe?c(p,m,g):x===nRe?typeof p.then!="function"&&typeof m.then!="function"&&a(p,m,g):x===sRe?h(p,m,g):x===JDe?r(p,m,g):x===YDe?a(p,m,g):x===QDe||x===tRe||x===iRe?l(p,m,g):!1}}function cRe(t){var e=t.circular,n=t.createCustomConfig,r=t.strict,o={areArraysEqual:r?ff:zDe,areDatesEqual:jDe,areErrorsEqual:WDe,areFunctionsEqual:VDe,areMapsEqual:r?JO(r_,ff):r_,areNumbersEqual:UDe,areObjectsEqual:r?ff:GDe,arePrimitiveWrappersEqual:HDe,areRegExpsEqual:KDe,areSetsEqual:r?JO(o_,ff):o_,areTypedArraysEqual:r?ff:qDe,areUrlsEqual:XDe};if(n&&(o=s_({},o,n(o))),e){var i=bm(o.areArraysEqual),s=bm(o.areMapsEqual),a=bm(o.areObjectsEqual),l=bm(o.areSetsEqual);o=s_({},o,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:a,areSetsEqual:l})}return o}function fRe(t){return function(e,n,r,o,i,s,a){return t(e,n,a)}}function hRe(t){var e=t.circular,n=t.comparator,r=t.createState,o=t.equals,i=t.strict;if(r)return function(l,u){var c=r(),f=c.cache,h=f===void 0?e?new WeakMap:void 0:f,d=c.meta;return n(l,u,{cache:h,equals:o,meta:d,strict:i})};if(e)return function(l,u){return n(l,u,{cache:new WeakMap,equals:o,meta:void 0,strict:i})};var s={cache:void 0,equals:o,meta:void 0,strict:i};return function(l,u){return n(l,u,s)}}var dRe=da();da({strict:!0});da({circular:!0});da({circular:!0,strict:!0});da({createInternalComparator:function(){return Al}});da({strict:!0,createInternalComparator:function(){return Al}});da({circular:!0,createInternalComparator:function(){return Al}});da({circular:!0,createInternalComparator:function(){return Al},strict:!0});function da(t){t===void 0&&(t={});var e=t.circular,n=e===void 0?!1:e,r=t.createInternalComparator,o=t.createState,i=t.strict,s=i===void 0?!1:i,a=cRe(t),l=uRe(a),u=r?r(l):fRe(l);return hRe({circular:n,comparator:l,createState:o,equals:u,strict:s})}function pRe(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function a_(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function o(i){n<0&&(n=i),i-n>e?(t(i),n=-1):pRe(o)};requestAnimationFrame(r)}function nS(t){"@babel/helpers - typeof";return nS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nS(t)}function mRe(t){return xRe(t)||vRe(t)||yRe(t)||gRe()}function gRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yRe(t,e){if(t){if(typeof t=="string")return l_(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l_(t,e)}}function l_(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vRe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xRe(t){if(Array.isArray(t))return t}function bRe(){var t={},e=function(){return null},n=!1,r=function o(i){if(!n){if(Array.isArray(i)){if(!i.length)return;var s=i,a=mRe(s),l=a[0],u=a.slice(1);if(typeof l=="number"){a_(o.bind(null,u),l);return}o(l),a_(o.bind(null,u));return}nS(i)==="object"&&(t=i,e(t)),typeof i=="function"&&i()}};return{stop:function(){n=!0},start:function(i){n=!1,r(i)},subscribe:function(i){return e=i,function(){e=function(){return null}}}}}function Fh(t){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fh(t)}function u_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function c_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?u_(Object(n),!0).forEach(function(r){BW(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function BW(t,e,n){return e=wRe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wRe(t){var e=SRe(t,"string");return Fh(e)==="symbol"?e:String(e)}function SRe(t,e){if(Fh(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Fh(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $Re=function(e,n){return[Object.keys(e),Object.keys(n)].reduce(function(r,o){return r.filter(function(i){return o.includes(i)})})},CRe=function(e){return e},kRe=function(e){return e.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},Lf=function(e,n){return Object.keys(n).reduce(function(r,o){return c_(c_({},r),{},BW({},o,e(o,n[o])))},{})},f_=function(e,n,r){return e.map(function(o){return"".concat(kRe(o)," ").concat(n,"ms ").concat(r)}).join(",")};function IRe(t,e){return NRe(t)||ERe(t,e)||zW(t,e)||TRe()}function TRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ERe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function NRe(t){if(Array.isArray(t))return t}function ARe(t){return DRe(t)||_Re(t)||zW(t)||ORe()}function ORe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zW(t,e){if(t){if(typeof t=="string")return rS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rS(t,e)}}function _Re(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function DRe(t){if(Array.isArray(t))return rS(t)}function rS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var yy=1e-4,jW=function(e,n){return[0,3*e,3*n-6*e,3*e-3*n+1]},WW=function(e,n){return e.map(function(r,o){return r*Math.pow(n,o)}).reduce(function(r,o){return r+o})},h_=function(e,n){return function(r){var o=jW(e,n);return WW(o,r)}},RRe=function(e,n){return function(r){var o=jW(e,n),i=[].concat(ARe(o.map(function(s,a){return s*a}).slice(1)),[0]);return WW(i,r)}},d_=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n[0],i=n[1],s=n[2],a=n[3];if(n.length===1)switch(n[0]){case"linear":o=0,i=0,s=1,a=1;break;case"ease":o=.25,i=.1,s=.25,a=1;break;case"ease-in":o=.42,i=0,s=1,a=1;break;case"ease-out":o=.42,i=0,s=.58,a=1;break;case"ease-in-out":o=0,i=0,s=.58,a=1;break;default:{var l=n[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var u=l[1].split(")")[0].split(",").map(function(g){return parseFloat(g)}),c=IRe(u,4);o=c[0],i=c[1],s=c[2],a=c[3]}}}var f=h_(o,s),h=h_(i,a),d=RRe(o,s),p=function(y){return y>1?1:y<0?0:y},m=function(y){for(var v=y>1?1:y,x=v,b=0;b<8;++b){var w=f(x)-v,S=d(x);if(Math.abs(w-v)<yy||S<yy)return h(x);x=p(x-w/S)}return h(x)};return m.isStepper=!1,m},PRe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.stiff,r=n===void 0?100:n,o=e.damping,i=o===void 0?8:o,s=e.dt,a=s===void 0?17:s,l=function(c,f,h){var d=-(c-f)*r,p=h*i,m=h+(d-p)*a/1e3,g=h*a/1e3+c;return Math.abs(g-f)<yy&&Math.abs(m)<yy?[f,0]:[g,m]};return l.isStepper=!0,l.dt=a,l},MRe=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n[0];if(typeof o=="string")switch(o){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return d_(o);case"spring":return PRe();default:if(o.split("(")[0]==="cubic-bezier")return d_(o)}return typeof o=="function"?o:null};function Lh(t){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lh(t)}function p_(t){return BRe(t)||LRe(t)||VW(t)||FRe()}function FRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LRe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function BRe(t){if(Array.isArray(t))return iS(t)}function m_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function In(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?m_(Object(n),!0).forEach(function(r){oS(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function oS(t,e,n){return e=zRe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zRe(t){var e=jRe(t,"string");return Lh(e)==="symbol"?e:String(e)}function jRe(t,e){if(Lh(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Lh(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WRe(t,e){return GRe(t)||URe(t,e)||VW(t,e)||VRe()}function VRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VW(t,e){if(t){if(typeof t=="string")return iS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iS(t,e)}}function iS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function URe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function GRe(t){if(Array.isArray(t))return t}var vy=function(e,n,r){return e+(n-e)*r},sS=function(e){var n=e.from,r=e.to;return n!==r},HRe=function t(e,n,r){var o=Lf(function(i,s){if(sS(s)){var a=e(s.from,s.to,s.velocity),l=WRe(a,2),u=l[0],c=l[1];return In(In({},s),{},{from:u,velocity:c})}return s},n);return r<1?Lf(function(i,s){return sS(s)?In(In({},s),{},{velocity:vy(s.velocity,o[i].velocity,r),from:vy(s.from,o[i].from,r)}):s},n):t(e,o,r-1)};const KRe=function(t,e,n,r,o){var i=$Re(t,e),s=i.reduce(function(g,y){return In(In({},g),{},oS({},y,[t[y],e[y]]))},{}),a=i.reduce(function(g,y){return In(In({},g),{},oS({},y,{from:t[y],velocity:0,to:e[y]}))},{}),l=-1,u,c,f=function(){return null},h=function(){return Lf(function(y,v){return v.from},a)},d=function(){return!Object.values(a).filter(sS).length},p=function(y){u||(u=y);var v=y-u,x=v/n.dt;a=HRe(n,a,x),o(In(In(In({},t),e),h())),u=y,d()||(l=requestAnimationFrame(f))},m=function(y){c||(c=y);var v=(y-c)/r,x=Lf(function(w,S){return vy.apply(void 0,p_(S).concat([n(v)]))},s);if(o(In(In(In({},t),e),x)),v<1)l=requestAnimationFrame(f);else{var b=Lf(function(w,S){return vy.apply(void 0,p_(S).concat([n(1)]))},s);o(In(In(In({},t),e),b))}};return f=n.isStepper?p:m,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(l)}}};function Zu(t){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zu(t)}var qRe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function XRe(t,e){if(t==null)return{};var n=YRe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function YRe(t,e){if(t==null)return{};var n={},r=Object.keys(t),o,i;for(i=0;i<r.length;i++)o=r[i],!(e.indexOf(o)>=0)&&(n[o]=t[o]);return n}function kb(t){return ePe(t)||JRe(t)||ZRe(t)||QRe()}function QRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZRe(t,e){if(t){if(typeof t=="string")return aS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aS(t,e)}}function JRe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ePe(t){if(Array.isArray(t))return aS(t)}function aS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Io(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?g_(Object(n),!0).forEach(function(r){$f(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function $f(t,e,n){return e=UW(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nPe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,UW(r.key),r)}}function rPe(t,e,n){return e&&nPe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function UW(t){var e=oPe(t,"string");return Zu(e)==="symbol"?e:String(e)}function oPe(t,e){if(Zu(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Zu(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iPe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lS(t,e)}function lS(t,e){return lS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},lS(t,e)}function sPe(t){var e=aPe();return function(){var r=xy(t),o;if(e){var i=xy(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return uS(this,o)}}function uS(t,e){if(e&&(Zu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cS(t)}function cS(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xy(t){return xy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},xy(t)}var ts=function(t){iPe(n,t);var e=sPe(n);function n(r,o){var i;tPe(this,n),i=e.call(this,r,o);var s=i.props,a=s.isActive,l=s.attributeName,u=s.from,c=s.to,f=s.steps,h=s.children,d=s.duration;if(i.handleStyleChange=i.handleStyleChange.bind(cS(i)),i.changeStyle=i.changeStyle.bind(cS(i)),!a||d<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:c}),uS(i);if(f&&f.length)i.state={style:f[0].style};else if(u){if(typeof h=="function")return i.state={style:u},uS(i);i.state={style:l?$f({},l,u):u}}else i.state={style:{}};return i}return rPe(n,[{key:"componentDidMount",value:function(){var o=this.props,i=o.isActive,s=o.canBegin;this.mounted=!0,!(!i||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(o){var i=this.props,s=i.isActive,a=i.canBegin,l=i.attributeName,u=i.shouldReAnimate,c=i.to,f=i.from,h=this.state.style;if(a){if(!s){var d={style:l?$f({},l,c):c};this.state&&h&&(l&&h[l]!==c||!l&&h!==c)&&this.setState(d);return}if(!(dRe(o.to,c)&&o.canBegin&&o.isActive)){var p=!o.canBegin||!o.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var m=p||u?f:o.to;if(this.state&&h){var g={style:l?$f({},l,m):m};(l&&h[l]!==m||!l&&h!==m)&&this.setState(g)}this.runAnimation(Io(Io({},this.props),{},{from:m,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var o=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),o&&o()}},{key:"handleStyleChange",value:function(o){this.changeStyle(o)}},{key:"changeStyle",value:function(o){this.mounted&&this.setState({style:o})}},{key:"runJSAnimation",value:function(o){var i=this,s=o.from,a=o.to,l=o.duration,u=o.easing,c=o.begin,f=o.onAnimationEnd,h=o.onAnimationStart,d=KRe(s,a,MRe(u),l,this.changeStyle),p=function(){i.stopJSAnimation=d()};this.manager.start([h,c,p,l,f])}},{key:"runStepAnimation",value:function(o){var i=this,s=o.steps,a=o.begin,l=o.onAnimationStart,u=s[0],c=u.style,f=u.duration,h=f===void 0?0:f,d=function(m,g,y){if(y===0)return m;var v=g.duration,x=g.easing,b=x===void 0?"ease":x,w=g.style,S=g.properties,$=g.onAnimationEnd,C=y>0?s[y-1]:g,k=S||Object.keys(w);if(typeof b=="function"||b==="spring")return[].concat(kb(m),[i.runJSAnimation.bind(i,{from:C.style,to:w,duration:v,easing:b}),v]);var I=f_(k,v,b),T=Io(Io(Io({},C.style),w),{},{transition:I});return[].concat(kb(m),[T,v,$]).filter(CRe)};return this.manager.start([l].concat(kb(s.reduce(d,[c,Math.max(h,a)])),[o.onAnimationEnd]))}},{key:"runAnimation",value:function(o){this.manager||(this.manager=bRe());var i=o.begin,s=o.duration,a=o.attributeName,l=o.to,u=o.easing,c=o.onAnimationStart,f=o.onAnimationEnd,h=o.steps,d=o.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof u=="function"||typeof d=="function"||u==="spring"){this.runJSAnimation(o);return}if(h.length>1){this.runStepAnimation(o);return}var m=a?$f({},a,l):l,g=f_(Object.keys(m),s,u);p.start([c,i,Io(Io({},m),{},{transition:g}),s,f])}},{key:"render",value:function(){var o=this.props,i=o.children;o.begin;var s=o.duration;o.attributeName,o.easing;var a=o.isActive;o.steps,o.from,o.to,o.canBegin,o.onAnimationEnd,o.shouldReAnimate,o.onAnimationReStart;var l=XRe(o,qRe),u=se.Children.count(i),c=this.state.style;if(typeof i=="function")return i(c);if(!a||u===0||s<=0)return i;var f=function(d){var p=d.props,m=p.style,g=m===void 0?{}:m,y=p.className,v=se.cloneElement(d,Io(Io({},l),{},{style:Io(Io({},g),c),className:y}));return v};return u===1?f(se.Children.only(i)):W.createElement("div",null,se.Children.map(i,function(h){return f(h)}))}}]),n}(se.PureComponent);ts.displayName="Animate";ts.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ts.propTypes={from:rt.oneOfType([rt.object,rt.string]),to:rt.oneOfType([rt.object,rt.string]),attributeName:rt.string,duration:rt.number,begin:rt.number,easing:rt.oneOfType([rt.string,rt.func]),steps:rt.arrayOf(rt.shape({duration:rt.number.isRequired,style:rt.object.isRequired,easing:rt.oneOfType([rt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),rt.func]),properties:rt.arrayOf("string"),onAnimationEnd:rt.func})),children:rt.oneOfType([rt.node,rt.func]),isActive:rt.bool,canBegin:rt.bool,onAnimationEnd:rt.func,shouldReAnimate:rt.bool,onAnimationStart:rt.func,onAnimationReStart:rt.func};function Bh(t){"@babel/helpers - typeof";return Bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bh(t)}function by(){return by=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},by.apply(this,arguments)}function lPe(t,e){return hPe(t)||fPe(t,e)||cPe(t,e)||uPe()}function uPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cPe(t,e){if(t){if(typeof t=="string")return y_(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y_(t,e)}}function y_(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fPe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function hPe(t){if(Array.isArray(t))return t}function v_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function x_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?v_(Object(n),!0).forEach(function(r){dPe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function dPe(t,e,n){return e=pPe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pPe(t){var e=mPe(t,"string");return Bh(e)=="symbol"?e:e+""}function mPe(t,e){if(Bh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Bh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var b_=function(e,n,r,o,i){var s=Math.min(Math.abs(r)/2,Math.abs(o)/2),a=o>=0?1:-1,l=r>=0?1:-1,u=o>=0&&r>=0||o<0&&r<0?1:0,c;if(s>0&&i instanceof Array){for(var f=[0,0,0,0],h=0,d=4;h<d;h++)f[h]=i[h]>s?s:i[h];c="M".concat(e,",").concat(n+a*f[0]),f[0]>0&&(c+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(e+l*f[0],",").concat(n)),c+="L ".concat(e+r-l*f[1],",").concat(n),f[1]>0&&(c+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(e+r,",").concat(n+a*f[1])),c+="L ".concat(e+r,",").concat(n+o-a*f[2]),f[2]>0&&(c+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(e+r-l*f[2],",").concat(n+o)),c+="L ".concat(e+l*f[3],",").concat(n+o),f[3]>0&&(c+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(e,",").concat(n+o-a*f[3])),c+="Z"}else if(s>0&&i===+i&&i>0){var p=Math.min(s,i);c="M ".concat(e,",").concat(n+a*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(u,",").concat(e+l*p,",").concat(n,`
            L `).concat(e+r-l*p,",").concat(n,`
            A `).concat(p,",").concat(p,",0,0,").concat(u,",").concat(e+r,",").concat(n+a*p,`
            L `).concat(e+r,",").concat(n+o-a*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(u,",").concat(e+r-l*p,",").concat(n+o,`
            L `).concat(e+l*p,",").concat(n+o,`
            A `).concat(p,",").concat(p,",0,0,").concat(u,",").concat(e,",").concat(n+o-a*p," Z")}else c="M ".concat(e,",").concat(n," h ").concat(r," v ").concat(o," h ").concat(-r," Z");return c},gPe=function(e,n){if(!e||!n)return!1;var r=e.x,o=e.y,i=n.x,s=n.y,a=n.width,l=n.height;if(Math.abs(a)>0&&Math.abs(l)>0){var u=Math.min(i,i+a),c=Math.max(i,i+a),f=Math.min(s,s+l),h=Math.max(s,s+l);return r>=u&&r<=c&&o>=f&&o<=h}return!1},yPe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},gT=function(e){var n=x_(x_({},yPe),e),r=se.useRef(),o=se.useState(-1),i=lPe(o,2),s=i[0],a=i[1];se.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var b=r.current.getTotalLength();b&&a(b)}catch{}},[]);var l=n.x,u=n.y,c=n.width,f=n.height,h=n.radius,d=n.className,p=n.animationEasing,m=n.animationDuration,g=n.animationBegin,y=n.isAnimationActive,v=n.isUpdateAnimationActive;if(l!==+l||u!==+u||c!==+c||f!==+f||c===0||f===0)return null;var x=Je("recharts-rectangle",d);return v?W.createElement(ts,{canBegin:s>0,from:{width:c,height:f,x:l,y:u},to:{width:c,height:f,x:l,y:u},duration:m,animationEasing:p,isActive:v},function(b){var w=b.width,S=b.height,$=b.x,C=b.y;return W.createElement(ts,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:m,isActive:y,easing:p},W.createElement("path",by({},Ve(n,!0),{className:x,d:b_($,C,w,S,h),ref:r})))}):W.createElement("path",by({},Ve(n,!0),{className:x,d:b_(l,u,c,f,h)}))};function fS(){return fS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fS.apply(this,arguments)}var yT=function(e){var n=e.cx,r=e.cy,o=e.r,i=e.className,s=Je("recharts-dot",i);return n===+n&&r===+r&&o===+o?W.createElement("circle",fS({},Ve(e,!1),Bg(e),{className:s,cx:n,cy:r,r:o})):null};function zh(t){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zh(t)}var vPe=["x","y","top","left","width","height","className"];function hS(){return hS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hS.apply(this,arguments)}function w_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function xPe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?w_(Object(n),!0).forEach(function(r){bPe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function bPe(t,e,n){return e=wPe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wPe(t){var e=SPe(t,"string");return zh(e)=="symbol"?e:e+""}function SPe(t,e){if(zh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(zh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Pe(t,e){if(t==null)return{};var n=CPe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function CPe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var kPe=function(e,n,r,o,i,s){return"M".concat(e,",").concat(i,"v").concat(o,"M").concat(s,",").concat(n,"h").concat(r)},IPe=function(e){var n=e.x,r=n===void 0?0:n,o=e.y,i=o===void 0?0:o,s=e.top,a=s===void 0?0:s,l=e.left,u=l===void 0?0:l,c=e.width,f=c===void 0?0:c,h=e.height,d=h===void 0?0:h,p=e.className,m=$Pe(e,vPe),g=xPe({x:r,y:i,top:a,left:u,width:f,height:d},m);return!pe(r)||!pe(i)||!pe(f)||!pe(d)||!pe(a)||!pe(u)?null:W.createElement("path",hS({},Ve(g,!0),{className:Je("recharts-cross",p),d:kPe(r,i,f,d,a,u)}))},TPe=oj,EPe=TPe(Object.getPrototypeOf,Object),NPe=EPe,APe=as,OPe=NPe,_Pe=ls,DPe="[object Object]",RPe=Function.prototype,PPe=Object.prototype,GW=RPe.toString,MPe=PPe.hasOwnProperty,FPe=GW.call(Object);function LPe(t){if(!_Pe(t)||APe(t)!=DPe)return!1;var e=OPe(t);if(e===null)return!0;var n=MPe.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&GW.call(n)==FPe}var BPe=LPe;const zPe=ft(BPe);var jPe=as,WPe=ls,VPe="[object Boolean]";function UPe(t){return t===!0||t===!1||WPe(t)&&jPe(t)==VPe}var GPe=UPe;const HPe=ft(GPe);function jh(t){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jh(t)}function wy(){return wy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wy.apply(this,arguments)}function KPe(t,e){return QPe(t)||YPe(t,e)||XPe(t,e)||qPe()}function qPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XPe(t,e){if(t){if(typeof t=="string")return S_(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S_(t,e)}}function S_(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function YPe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function QPe(t){if(Array.isArray(t))return t}function $_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function C_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$_(Object(n),!0).forEach(function(r){ZPe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ZPe(t,e,n){return e=JPe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JPe(t){var e=eMe(t,"string");return jh(e)=="symbol"?e:e+""}function eMe(t,e){if(jh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(jh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var k_=function(e,n,r,o,i){var s=r-o,a;return a="M ".concat(e,",").concat(n),a+="L ".concat(e+r,",").concat(n),a+="L ".concat(e+r-s/2,",").concat(n+i),a+="L ".concat(e+r-s/2-o,",").concat(n+i),a+="L ".concat(e,",").concat(n," Z"),a},tMe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},nMe=function(e){var n=C_(C_({},tMe),e),r=se.useRef(),o=se.useState(-1),i=KPe(o,2),s=i[0],a=i[1];se.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var x=r.current.getTotalLength();x&&a(x)}catch{}},[]);var l=n.x,u=n.y,c=n.upperWidth,f=n.lowerWidth,h=n.height,d=n.className,p=n.animationEasing,m=n.animationDuration,g=n.animationBegin,y=n.isUpdateAnimationActive;if(l!==+l||u!==+u||c!==+c||f!==+f||h!==+h||c===0&&f===0||h===0)return null;var v=Je("recharts-trapezoid",d);return y?W.createElement(ts,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:h,x:l,y:u},to:{upperWidth:c,lowerWidth:f,height:h,x:l,y:u},duration:m,animationEasing:p,isActive:y},function(x){var b=x.upperWidth,w=x.lowerWidth,S=x.height,$=x.x,C=x.y;return W.createElement(ts,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:m,easing:p},W.createElement("path",wy({},Ve(n,!0),{className:v,d:k_($,C,b,w,S),ref:r})))}):W.createElement("g",null,W.createElement("path",wy({},Ve(n,!0),{className:v,d:k_(l,u,c,f,h)})))},rMe=["option","shapeType","propTransformer","activeClassName","isActive"];function Wh(t){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wh(t)}function oMe(t,e){if(t==null)return{};var n=iMe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function iMe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function I_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Sy(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?I_(Object(n),!0).forEach(function(r){sMe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function sMe(t,e,n){return e=aMe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aMe(t){var e=lMe(t,"string");return Wh(e)=="symbol"?e:e+""}function lMe(t,e){if(Wh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Wh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uMe(t,e){return Sy(Sy({},e),t)}function cMe(t,e){return t==="symbols"}function T_(t){var e=t.shapeType,n=t.elementProps;switch(e){case"rectangle":return W.createElement(gT,n);case"trapezoid":return W.createElement(nMe,n);case"sector":return W.createElement(RW,n);case"symbols":if(cMe(e))return W.createElement(PI,n);break;default:return null}}function fMe(t){return se.isValidElement(t)?t.props:t}function hMe(t){var e=t.option,n=t.shapeType,r=t.propTransformer,o=r===void 0?uMe:r,i=t.activeClassName,s=i===void 0?"recharts-active-shape":i,a=t.isActive,l=oMe(t,rMe),u;if(se.isValidElement(e))u=se.cloneElement(e,Sy(Sy({},l),fMe(e)));else if(Be(e))u=e(l);else if(zPe(e)&&!HPe(e)){var c=o(e,l);u=W.createElement(T_,{shapeType:n,elementProps:c})}else{var f=l;u=W.createElement(T_,{shapeType:n,elementProps:f})}return a?W.createElement(Kt,{className:s},u):u}function sx(t,e){return e!=null&&"trapezoids"in t.props}function ax(t,e){return e!=null&&"sectors"in t.props}function Vh(t,e){return e!=null&&"points"in t.props}function dMe(t,e){var n,r,o=t.x===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.x)||t.x===e.x,i=t.y===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.y)||t.y===e.y;return o&&i}function pMe(t,e){var n=t.endAngle===e.endAngle,r=t.startAngle===e.startAngle;return n&&r}function mMe(t,e){var n=t.x===e.x,r=t.y===e.y,o=t.z===e.z;return n&&r&&o}function gMe(t,e){var n;return sx(t,e)?n=dMe:ax(t,e)?n=pMe:Vh(t,e)&&(n=mMe),n}function yMe(t,e){var n;return sx(t,e)?n="trapezoids":ax(t,e)?n="sectors":Vh(t,e)&&(n="points"),n}function vMe(t,e){if(sx(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(ax(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return Vh(t,e)?e.payload:{}}function xMe(t){var e=t.activeTooltipItem,n=t.graphicalItem,r=t.itemData,o=yMe(n,e),i=vMe(n,e),s=r.filter(function(l,u){var c=rx(i,l),f=n.props[o].filter(function(p){var m=gMe(n,e);return m(p,e)}),h=n.props[o].indexOf(f[f.length-1]),d=u===h;return c&&d}),a=r.indexOf(s[s.length-1]);return a}var bMe=Math.ceil,wMe=Math.max;function SMe(t,e,n,r){for(var o=-1,i=wMe(bMe((e-t)/(n||1)),0),s=Array(i);i--;)s[r?i:++o]=t,t+=n;return s}var $Me=SMe,CMe=$j,E_=1/0,kMe=17976931348623157e292;function IMe(t){if(!t)return t===0?t:0;if(t=CMe(t),t===E_||t===-E_){var e=t<0?-1:1;return e*kMe}return t===t?t:0}var HW=IMe,TMe=$Me,EMe=q0,Ib=HW;function NMe(t){return function(e,n,r){return r&&typeof r!="number"&&EMe(e,n,r)&&(n=r=void 0),e=Ib(e),n===void 0?(n=e,e=0):n=Ib(n),r=r===void 0?e<n?1:-1:Ib(r),TMe(e,n,r,t)}}var AMe=NMe,OMe=AMe,_Me=OMe(),DMe=_Me;const $y=ft(DMe);function Uh(t){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uh(t)}function N_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function A_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?N_(Object(n),!0).forEach(function(r){KW(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function KW(t,e,n){return e=RMe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RMe(t){var e=PMe(t,"string");return Uh(e)=="symbol"?e:e+""}function PMe(t,e){if(Uh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Uh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var MMe=["Webkit","Moz","O","ms"],FMe=function(e,n){var r=e.replace(/(\w)/,function(i){return i.toUpperCase()}),o=MMe.reduce(function(i,s){return A_(A_({},i),{},KW({},s+r,n))},{});return o[e]=n,o};function Ju(t){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ju(t)}function Cy(){return Cy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Cy.apply(this,arguments)}function O_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Tb(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?O_(Object(n),!0).forEach(function(r){Ar(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function LMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function __(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,XW(r.key),r)}}function BMe(t,e,n){return e&&__(t.prototype,e),n&&__(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zMe(t,e,n){return e=ky(e),jMe(t,qW()?Reflect.construct(e,n||[],ky(t).constructor):e.apply(t,n))}function jMe(t,e){if(e&&(Ju(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WMe(t)}function WMe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qW=function(){return!!t})()}function ky(t){return ky=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ky(t)}function VMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dS(t,e)}function dS(t,e){return dS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},dS(t,e)}function Ar(t,e,n){return e=XW(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XW(t){var e=UMe(t,"string");return Ju(e)=="symbol"?e:e+""}function UMe(t,e){if(Ju(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ju(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var GMe=function(e){var n=e.data,r=e.startIndex,o=e.endIndex,i=e.x,s=e.width,a=e.travellerWidth;if(!n||!n.length)return{};var l=n.length,u=Mf().domain($y(0,l)).range([i,i+s-a]),c=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(r),endX:u(o),scale:u,scaleValues:c}},D_=function(e){return e.changedTouches&&!!e.changedTouches.length},ec=function(t){function e(n){var r;return LMe(this,e),r=zMe(this,e,[n]),Ar(r,"handleDrag",function(o){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(o):r.state.isSlideMoving&&r.handleSlideDrag(o)}),Ar(r,"handleTouchMove",function(o){o.changedTouches!=null&&o.changedTouches.length>0&&r.handleDrag(o.changedTouches[0])}),Ar(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var o=r.props,i=o.endIndex,s=o.onDragEnd,a=o.startIndex;s==null||s({endIndex:i,startIndex:a})}),r.detachDragEndListener()}),Ar(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),Ar(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),Ar(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),Ar(r,"handleSlideDragStart",function(o){var i=D_(o)?o.changedTouches[0]:o;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return VMe(e,t),BMe(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var o=r.startX,i=r.endX,s=this.state.scaleValues,a=this.props,l=a.gap,u=a.data,c=u.length-1,f=Math.min(o,i),h=Math.max(o,i),d=e.getIndexInRange(s,f),p=e.getIndexInRange(s,h);return{startIndex:d-d%l,endIndex:p===c?c:p-p%l}}},{key:"getTextOfTick",value:function(r){var o=this.props,i=o.data,s=o.tickFormatter,a=o.dataKey,l=jr(i[r],a,r);return Be(s)?s(l,r):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var o=this.state,i=o.slideMoveStartX,s=o.startX,a=o.endX,l=this.props,u=l.x,c=l.width,f=l.travellerWidth,h=l.startIndex,d=l.endIndex,p=l.onChange,m=r.pageX-i;m>0?m=Math.min(m,u+c-f-a,u+c-f-s):m<0&&(m=Math.max(m,u-s,u-a));var g=this.getIndex({startX:s+m,endX:a+m});(g.startIndex!==h||g.endIndex!==d)&&p&&p(g),this.setState({startX:s+m,endX:a+m,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,o){var i=D_(o)?o.changedTouches[0]:o;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var o=this.state,i=o.brushMoveStartX,s=o.movingTravellerId,a=o.endX,l=o.startX,u=this.state[s],c=this.props,f=c.x,h=c.width,d=c.travellerWidth,p=c.onChange,m=c.gap,g=c.data,y={startX:this.state.startX,endX:this.state.endX},v=r.pageX-i;v>0?v=Math.min(v,f+h-d-u):v<0&&(v=Math.max(v,f-u)),y[s]=u+v;var x=this.getIndex(y),b=x.startIndex,w=x.endIndex,S=function(){var C=g.length-1;return s==="startX"&&(a>l?b%m===0:w%m===0)||a<l&&w===C||s==="endX"&&(a>l?w%m===0:b%m===0)||a>l&&w===C};this.setState(Ar(Ar({},s,u+v),"brushMoveStartX",r.pageX),function(){p&&S()&&p(x)})}},{key:"handleTravellerMoveKeyboard",value:function(r,o){var i=this,s=this.state,a=s.scaleValues,l=s.startX,u=s.endX,c=this.state[o],f=a.indexOf(c);if(f!==-1){var h=f+r;if(!(h===-1||h>=a.length)){var d=a[h];o==="startX"&&d>=u||o==="endX"&&d<=l||this.setState(Ar({},o,d),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,o=r.x,i=r.y,s=r.width,a=r.height,l=r.fill,u=r.stroke;return W.createElement("rect",{stroke:u,fill:l,x:o,y:i,width:s,height:a})}},{key:"renderPanorama",value:function(){var r=this.props,o=r.x,i=r.y,s=r.width,a=r.height,l=r.data,u=r.children,c=r.padding,f=se.Children.only(u);return f?W.cloneElement(f,{x:o,y:i,width:s,height:a,margin:c,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(r,o){var i,s,a=this,l=this.props,u=l.y,c=l.travellerWidth,f=l.height,h=l.traveller,d=l.ariaLabel,p=l.data,m=l.startIndex,g=l.endIndex,y=Math.max(r,this.props.x),v=Tb(Tb({},Ve(this.props,!1)),{},{x:y,y:u,width:c,height:f}),x=d||"Min value: ".concat((i=p[m])===null||i===void 0?void 0:i.name,", Max value: ").concat((s=p[g])===null||s===void 0?void 0:s.name);return W.createElement(Kt,{tabIndex:0,role:"slider","aria-label":x,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[o],onTouchStart:this.travellerDragStartHandlers[o],onKeyDown:function(w){["ArrowLeft","ArrowRight"].includes(w.key)&&(w.preventDefault(),w.stopPropagation(),a.handleTravellerMoveKeyboard(w.key==="ArrowRight"?1:-1,o))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(h,v))}},{key:"renderSlide",value:function(r,o){var i=this.props,s=i.y,a=i.height,l=i.stroke,u=i.travellerWidth,c=Math.min(r,o)+u,f=Math.max(Math.abs(o-r)-u,0);return W.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:c,y:s,width:f,height:a})}},{key:"renderText",value:function(){var r=this.props,o=r.startIndex,i=r.endIndex,s=r.y,a=r.height,l=r.travellerWidth,u=r.stroke,c=this.state,f=c.startX,h=c.endX,d=5,p={pointerEvents:"none",fill:u};return W.createElement(Kt,{className:"recharts-brush-texts"},W.createElement(ey,Cy({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-d,y:s+a/2},p),this.getTextOfTick(o)),W.createElement(ey,Cy({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+l+d,y:s+a/2},p),this.getTextOfTick(i)))}},{key:"render",value:function(){var r=this.props,o=r.data,i=r.className,s=r.children,a=r.x,l=r.y,u=r.width,c=r.height,f=r.alwaysShowText,h=this.state,d=h.startX,p=h.endX,m=h.isTextActive,g=h.isSlideMoving,y=h.isTravellerMoving,v=h.isTravellerFocused;if(!o||!o.length||!pe(a)||!pe(l)||!pe(u)||!pe(c)||u<=0||c<=0)return null;var x=Je("recharts-brush",i),b=W.Children.count(s)===1,w=FMe("userSelect","none");return W.createElement(Kt,{className:x,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:w},this.renderBackground(),b&&this.renderPanorama(),this.renderSlide(d,p),this.renderTravellerLayer(d,"startX"),this.renderTravellerLayer(p,"endX"),(m||g||y||v||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var o=r.x,i=r.y,s=r.width,a=r.height,l=r.stroke,u=Math.floor(i+a/2)-1;return W.createElement(W.Fragment,null,W.createElement("rect",{x:o,y:i,width:s,height:a,fill:l,stroke:"none"}),W.createElement("line",{x1:o+1,y1:u,x2:o+s-1,y2:u,fill:"none",stroke:"#fff"}),W.createElement("line",{x1:o+1,y1:u+2,x2:o+s-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,o){var i;return W.isValidElement(r)?i=W.cloneElement(r,o):Be(r)?i=r(o):i=e.renderDefaultTraveller(o),i}},{key:"getDerivedStateFromProps",value:function(r,o){var i=r.data,s=r.width,a=r.x,l=r.travellerWidth,u=r.updateId,c=r.startIndex,f=r.endIndex;if(i!==o.prevData||u!==o.prevUpdateId)return Tb({prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:a,prevWidth:s},i&&i.length?GMe({data:i,width:s,x:a,travellerWidth:l,startIndex:c,endIndex:f}):{scale:null,scaleValues:null});if(o.scale&&(s!==o.prevWidth||a!==o.prevX||l!==o.prevTravellerWidth)){o.scale.range([a,a+s-l]);var h=o.scale.domain().map(function(d){return o.scale(d)});return{prevData:i,prevTravellerWidth:l,prevUpdateId:u,prevX:a,prevWidth:s,startX:o.scale(r.startIndex),endX:o.scale(r.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(r,o){for(var i=r.length,s=0,a=i-1;a-s>1;){var l=Math.floor((s+a)/2);r[l]>o?a=l:s=l}return o>=r[a]?a:s}}])}(se.PureComponent);Ar(ec,"displayName","Brush");Ar(ec,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var HMe=WI;function KMe(t,e){var n;return HMe(t,function(r,o,i){return n=e(r,o,i),!n}),!!n}var qMe=KMe,XMe=Y4,YMe=ca,QMe=qMe,ZMe=Tr,JMe=q0;function eFe(t,e,n){var r=ZMe(t)?XMe:QMe;return n&&JMe(t,e,n)&&(e=void 0),r(t,YMe(e))}var tFe=eFe;const nFe=ft(tFe);var yi=function(e,n){var r=e.alwaysShow,o=e.ifOverflow;return r&&(o="extendDomain"),o===n},R_=vj;function rFe(t,e,n){e=="__proto__"&&R_?R_(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var oFe=rFe,iFe=oFe,sFe=gj,aFe=ca;function lFe(t,e){var n={};return e=aFe(e),sFe(t,function(r,o,i){iFe(n,o,e(r,o,i))}),n}var uFe=lFe;const cFe=ft(uFe);function fFe(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}var hFe=fFe,dFe=WI;function pFe(t,e){var n=!0;return dFe(t,function(r,o,i){return n=!!e(r,o,i),n}),n}var mFe=pFe,gFe=hFe,yFe=mFe,vFe=ca,xFe=Tr,bFe=q0;function wFe(t,e,n){var r=xFe(t)?gFe:yFe;return n&&bFe(t,e,n)&&(e=void 0),r(t,vFe(e))}var SFe=wFe;const YW=ft(SFe);var $Fe=["x","y"];function Gh(t){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gh(t)}function pS(){return pS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pS.apply(this,arguments)}function P_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function hf(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?P_(Object(n),!0).forEach(function(r){CFe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function CFe(t,e,n){return e=kFe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kFe(t){var e=IFe(t,"string");return Gh(e)=="symbol"?e:e+""}function IFe(t,e){if(Gh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Gh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TFe(t,e){if(t==null)return{};var n=EFe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function EFe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function NFe(t,e){var n=t.x,r=t.y,o=TFe(t,$Fe),i="".concat(n),s=parseInt(i,10),a="".concat(r),l=parseInt(a,10),u="".concat(e.height||o.height),c=parseInt(u,10),f="".concat(e.width||o.width),h=parseInt(f,10);return hf(hf(hf(hf(hf({},e),o),s?{x:s}:{}),l?{y:l}:{}),{},{height:c,width:h,name:e.name,radius:e.radius})}function M_(t){return W.createElement(hMe,pS({shapeType:"rectangle",propTransformer:NFe,activeClassName:"recharts-active-bar"},t))}var AFe=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,o){if(typeof e=="number")return e;var i=typeof r=="number";return i?e(r,o):(i||fl(),n)}},OFe=["value","background"],QW;function tc(t){"@babel/helpers - typeof";return tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tc(t)}function _Fe(t,e){if(t==null)return{};var n=DFe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function DFe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Iy(){return Iy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Iy.apply(this,arguments)}function F_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Yt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?F_(Object(n),!0).forEach(function(r){Is(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function RFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,JW(r.key),r)}}function PFe(t,e,n){return e&&L_(t.prototype,e),n&&L_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function MFe(t,e,n){return e=Ty(e),FFe(t,ZW()?Reflect.construct(e,n||[],Ty(t).constructor):e.apply(t,n))}function FFe(t,e){if(e&&(tc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LFe(t)}function LFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZW=function(){return!!t})()}function Ty(t){return Ty=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ty(t)}function BFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mS(t,e)}function mS(t,e){return mS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},mS(t,e)}function Is(t,e,n){return e=JW(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JW(t){var e=zFe(t,"string");return tc(e)=="symbol"?e:e+""}function zFe(t,e){if(tc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(tc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Op=function(t){function e(){var n;RFe(this,e);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=MFe(this,e,[].concat(o)),Is(n,"state",{isAnimationFinished:!1}),Is(n,"id",Cp("recharts-bar-")),Is(n,"handleAnimationEnd",function(){var s=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),s&&s()}),Is(n,"handleAnimationStart",function(){var s=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),s&&s()}),n}return BFe(e,t),PFe(e,[{key:"renderRectanglesStatically",value:function(r){var o=this,i=this.props,s=i.shape,a=i.dataKey,l=i.activeIndex,u=i.activeBar,c=Ve(this.props,!1);return r&&r.map(function(f,h){var d=h===l,p=d?u:s,m=Yt(Yt(Yt({},c),f),{},{isActive:d,option:p,index:h,dataKey:a,onAnimationStart:o.handleAnimationStart,onAnimationEnd:o.handleAnimationEnd});return W.createElement(Kt,Iy({className:"recharts-bar-rectangle"},zg(o.props,f,h),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value)}),W.createElement(M_,m))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,o=this.props,i=o.data,s=o.layout,a=o.isAnimationActive,l=o.animationBegin,u=o.animationDuration,c=o.animationEasing,f=o.animationId,h=this.state.prevData;return W.createElement(ts,{begin:l,duration:u,isActive:a,easing:c,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(d){var p=d.t,m=i.map(function(g,y){var v=h&&h[y];if(v){var x=Po(v.x,g.x),b=Po(v.y,g.y),w=Po(v.width,g.width),S=Po(v.height,g.height);return Yt(Yt({},g),{},{x:x(p),y:b(p),width:w(p),height:S(p)})}if(s==="horizontal"){var $=Po(0,g.height),C=$(p);return Yt(Yt({},g),{},{y:g.y+g.height-C,height:C})}var k=Po(0,g.width),I=k(p);return Yt(Yt({},g),{},{width:I})});return W.createElement(Kt,null,r.renderRectanglesStatically(m))})}},{key:"renderRectangles",value:function(){var r=this.props,o=r.data,i=r.isAnimationActive,s=this.state.prevData;return i&&o&&o.length&&(!s||!rx(s,o))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(o)}},{key:"renderBackground",value:function(){var r=this,o=this.props,i=o.data,s=o.dataKey,a=o.activeIndex,l=Ve(this.props.background,!1);return i.map(function(u,c){u.value;var f=u.background,h=_Fe(u,OFe);if(!f)return null;var d=Yt(Yt(Yt(Yt(Yt({},h),{},{fill:"#eee"},f),l),zg(r.props,u,c)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:s,index:c,className:"recharts-bar-background-rectangle"});return W.createElement(M_,Iy({key:"background-bar-".concat(c),option:r.props.background,isActive:c===a},d))})}},{key:"renderErrorBar",value:function(r,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.data,a=i.xAxis,l=i.yAxis,u=i.layout,c=i.children,f=fo(c,Ap);if(!f)return null;var h=u==="vertical"?s[0].height/2:s[0].width/2,d=function(g,y){var v=Array.isArray(g.value)?g.value[1]:g.value;return{x:g.x,y:g.y,value:v,errorVal:jr(g,y)}},p={clipPath:r?"url(#clipPath-".concat(o,")"):null};return W.createElement(Kt,p,f.map(function(m){return W.cloneElement(m,{key:"error-bar-".concat(o,"-").concat(m.props.dataKey),data:s,xAxis:a,yAxis:l,layout:u,offset:h,dataPointFormatter:d})}))}},{key:"render",value:function(){var r=this.props,o=r.hide,i=r.data,s=r.className,a=r.xAxis,l=r.yAxis,u=r.left,c=r.top,f=r.width,h=r.height,d=r.isAnimationActive,p=r.background,m=r.id;if(o||!i||!i.length)return null;var g=this.state.isAnimationFinished,y=Je("recharts-bar",s),v=a&&a.allowDataOverflow,x=l&&l.allowDataOverflow,b=v||x,w=We(m)?this.id:m;return W.createElement(Kt,{className:y},v||x?W.createElement("defs",null,W.createElement("clipPath",{id:"clipPath-".concat(w)},W.createElement("rect",{x:v?u:u-f/2,y:x?c:c-h/2,width:v?f:f*2,height:x?h:h*2}))):null,W.createElement(Kt,{className:"recharts-bar-rectangles",clipPath:b?"url(#clipPath-".concat(w,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(b,w),(!d||g)&&js.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(r,o){return r.animationId!==o.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:o.curData}:r.data!==o.curData?{curData:r.data}:null}}])}(se.PureComponent);QW=Op;Is(Op,"displayName","Bar");Is(Op,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Wi.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Is(Op,"getComposedData",function(t){var e=t.props,n=t.item,r=t.barPosition,o=t.bandSize,i=t.xAxis,s=t.yAxis,a=t.xAxisTicks,l=t.yAxisTicks,u=t.stackedData,c=t.dataStartIndex,f=t.displayedData,h=t.offset,d=g_e(r,n);if(!d)return null;var p=e.layout,m=n.type.defaultProps,g=m!==void 0?Yt(Yt({},m),n.props):n.props,y=g.dataKey,v=g.children,x=g.minPointSize,b=p==="horizontal"?s:i,w=u?b.scale.domain():null,S=C_e({numericAxis:b}),$=fo(v,kj),C=f.map(function(k,I){var T,N,_,D,O,R;u?T=y_e(u[c+I],w):(T=jr(k,y),Array.isArray(T)||(T=[S,T]));var F=AFe(x,QW.defaultProps.minPointSize)(T[1],I);if(p==="horizontal"){var A,P=[s.scale(T[0]),s.scale(T[1])],z=P[0],U=P[1];N=FO({axis:i,ticks:a,bandSize:o,offset:d.offset,entry:k,index:I}),_=(A=U??z)!==null&&A!==void 0?A:void 0,D=d.size;var H=z-U;if(O=Number.isNaN(H)?0:H,R={x:N,y:s.y,width:D,height:s.height},Math.abs(F)>0&&Math.abs(O)<Math.abs(F)){var X=Bo(O||F)*(Math.abs(F)-Math.abs(O));_-=X,O+=X}}else{var ne=[i.scale(T[0]),i.scale(T[1])],re=ne[0],le=ne[1];if(N=re,_=FO({axis:s,ticks:l,bandSize:o,offset:d.offset,entry:k,index:I}),D=le-re,O=d.size,R={x:i.x,y:_,width:i.width,height:O},Math.abs(F)>0&&Math.abs(D)<Math.abs(F)){var ye=Bo(D||F)*(Math.abs(F)-Math.abs(D));D+=ye}}return Yt(Yt(Yt({},k),{},{x:N,y:_,width:D,height:O,value:u?T:T[1],payload:k,background:R},$&&$[I]&&$[I].props),{},{tooltipPayload:[OW(n,k)],tooltipPosition:{x:N+D/2,y:_+O/2}})});return Yt({data:C,layout:p},h)});function Hh(t){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hh(t)}function jFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,eV(r.key),r)}}function WFe(t,e,n){return e&&B_(t.prototype,e),n&&B_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function z_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Ao(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?z_(Object(n),!0).forEach(function(r){lx(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function lx(t,e,n){return e=eV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eV(t){var e=VFe(t,"string");return Hh(e)=="symbol"?e:e+""}function VFe(t,e){if(Hh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Hh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var UFe=function(e,n,r,o,i){var s=e.width,a=e.height,l=e.layout,u=e.children,c=Object.keys(n),f={left:r.left,leftMirror:r.left,right:s-r.right,rightMirror:s-r.right,top:r.top,topMirror:r.top,bottom:a-r.bottom,bottomMirror:a-r.bottom},h=!!_r(u,Op);return c.reduce(function(d,p){var m=n[p],g=m.orientation,y=m.domain,v=m.padding,x=v===void 0?{}:v,b=m.mirror,w=m.reversed,S="".concat(g).concat(b?"Mirror":""),$,C,k,I,T;if(m.type==="number"&&(m.padding==="gap"||m.padding==="no-gap")){var N=y[1]-y[0],_=1/0,D=m.categoricalDomain.sort();if(D.forEach(function(ne,re){re>0&&(_=Math.min((ne||0)-(D[re-1]||0),_))}),Number.isFinite(_)){var O=_/N,R=m.layout==="vertical"?r.height:r.width;if(m.padding==="gap"&&($=O*R/2),m.padding==="no-gap"){var F=ul(e.barCategoryGap,O*R),A=O*R/2;$=A-F-(A-F)/R*F}}}o==="xAxis"?C=[r.left+(x.left||0)+($||0),r.left+r.width-(x.right||0)-($||0)]:o==="yAxis"?C=l==="horizontal"?[r.top+r.height-(x.bottom||0),r.top+(x.top||0)]:[r.top+(x.top||0)+($||0),r.top+r.height-(x.bottom||0)-($||0)]:C=m.range,w&&(C=[C[1],C[0]]);var P=p_e(m,i,h),z=P.scale,U=P.realScaleType;z.domain(y).range(C),m_e(z);var H=$_e(z,Ao(Ao({},m),{},{realScaleType:U}));o==="xAxis"?(T=g==="top"&&!b||g==="bottom"&&b,k=r.left,I=f[S]-T*m.height):o==="yAxis"&&(T=g==="left"&&!b||g==="right"&&b,k=f[S]-T*m.width,I=r.top);var X=Ao(Ao(Ao({},m),H),{},{realScaleType:U,x:k,y:I,scale:z,width:o==="xAxis"?r.width:m.width,height:o==="yAxis"?r.height:m.height});return X.bandSize=py(X,H),!m.hide&&o==="xAxis"?f[S]+=(T?-1:1)*X.height:m.hide||(f[S]+=(T?-1:1)*X.width),Ao(Ao({},d),{},lx({},p,X))},{})},tV=function(e,n){var r=e.x,o=e.y,i=n.x,s=n.y;return{x:Math.min(r,i),y:Math.min(o,s),width:Math.abs(i-r),height:Math.abs(s-o)}},GFe=function(e){var n=e.x1,r=e.y1,o=e.x2,i=e.y2;return tV({x:n,y:r},{x:o,y:i})},nV=function(){function t(e){jFe(this,t),this.scale=e}return WFe(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=r.bandAware,i=r.position;if(n!==void 0){if(i)switch(i){case"start":return this.scale(n);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+s}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(n)+a}default:return this.scale(n)}if(o){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+l}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),o=r[0],i=r[r.length-1];return o<=i?n>=o&&n<=i:n>=i&&n<=o}}],[{key:"create",value:function(n){return new t(n)}}])}();lx(nV,"EPS",1e-4);var vT=function(e){var n=Object.keys(e).reduce(function(r,o){return Ao(Ao({},r),{},lx({},o,nV.create(e[o])))},{});return Ao(Ao({},n),{},{apply:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,a=i.position;return cFe(o,function(l,u){return n[u].apply(l,{bandAware:s,position:a})})},isInRange:function(o){return YW(o,function(i,s){return n[s].isInRange(i)})}})};function HFe(t){return(t%180+180)%180}var KFe=function(e){var n=e.width,r=e.height,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=HFe(o),s=i*Math.PI/180,a=Math.atan(r/n),l=s>a&&s<Math.PI-a?r/Math.sin(s):n/Math.cos(s);return Math.abs(l)},qFe=ca,XFe=kp,YFe=H0;function QFe(t){return function(e,n,r){var o=Object(e);if(!XFe(e)){var i=qFe(n);e=YFe(e),n=function(a){return i(o[a],a,o)}}var s=t(e,n,r);return s>-1?o[i?e[s]:s]:void 0}}var ZFe=QFe,JFe=HW;function eLe(t){var e=JFe(t),n=e%1;return e===e?n?e-n:e:0}var tLe=eLe,nLe=cj,rLe=ca,oLe=tLe,iLe=Math.max;function sLe(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var o=n==null?0:oLe(n);return o<0&&(o=iLe(r+o,0)),nLe(t,rLe(e),o)}var aLe=sLe,lLe=ZFe,uLe=aLe,cLe=lLe(uLe),fLe=cLe;const hLe=ft(fLe);var dLe=Jve(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),xT=se.createContext(void 0),bT=se.createContext(void 0),rV=se.createContext(void 0),oV=se.createContext({}),iV=se.createContext(void 0),sV=se.createContext(0),aV=se.createContext(0),j_=function(e){var n=e.state,r=n.xAxisMap,o=n.yAxisMap,i=n.offset,s=e.clipPathId,a=e.children,l=e.width,u=e.height,c=dLe(i);return W.createElement(xT.Provider,{value:r},W.createElement(bT.Provider,{value:o},W.createElement(oV.Provider,{value:i},W.createElement(rV.Provider,{value:c},W.createElement(iV.Provider,{value:s},W.createElement(sV.Provider,{value:u},W.createElement(aV.Provider,{value:l},a)))))))},pLe=function(){return se.useContext(iV)},lV=function(e){var n=se.useContext(xT);n==null&&fl();var r=n[e];return r==null&&fl(),r},mLe=function(){var e=se.useContext(xT);return bs(e)},gLe=function(){var e=se.useContext(bT),n=hLe(e,function(r){return YW(r.domain,Number.isFinite)});return n||bs(e)},uV=function(e){var n=se.useContext(bT);n==null&&fl();var r=n[e];return r==null&&fl(),r},yLe=function(){var e=se.useContext(rV);return e},vLe=function(){return se.useContext(oV)},wT=function(){return se.useContext(aV)},ST=function(){return se.useContext(sV)};function nc(t){"@babel/helpers - typeof";return nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nc(t)}function xLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bLe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fV(r.key),r)}}function wLe(t,e,n){return e&&bLe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function SLe(t,e,n){return e=Ey(e),$Le(t,cV()?Reflect.construct(e,n||[],Ey(t).constructor):e.apply(t,n))}function $Le(t,e){if(e&&(nc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CLe(t)}function CLe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cV(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cV=function(){return!!t})()}function Ey(t){return Ey=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ey(t)}function kLe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gS(t,e)}function gS(t,e){return gS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},gS(t,e)}function W_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function V_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?W_(Object(n),!0).forEach(function(r){$T(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function $T(t,e,n){return e=fV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fV(t){var e=ILe(t,"string");return nc(e)=="symbol"?e:e+""}function ILe(t,e){if(nc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(nc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TLe(t,e){return OLe(t)||ALe(t,e)||NLe(t,e)||ELe()}function ELe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NLe(t,e){if(t){if(typeof t=="string")return U_(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U_(t,e)}}function U_(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ALe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function OLe(t){if(Array.isArray(t))return t}function yS(){return yS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yS.apply(this,arguments)}var _Le=function(e,n){var r;return W.isValidElement(e)?r=W.cloneElement(e,n):Be(e)?r=e(n):r=W.createElement("line",yS({},n,{className:"recharts-reference-line-line"})),r},DLe=function(e,n,r,o,i,s,a,l,u){var c=i.x,f=i.y,h=i.width,d=i.height;if(r){var p=u.y,m=e.y.apply(p,{position:s});if(yi(u,"discard")&&!e.y.isInRange(m))return null;var g=[{x:c+h,y:m},{x:c,y:m}];return l==="left"?g.reverse():g}if(n){var y=u.x,v=e.x.apply(y,{position:s});if(yi(u,"discard")&&!e.x.isInRange(v))return null;var x=[{x:v,y:f+d},{x:v,y:f}];return a==="top"?x.reverse():x}if(o){var b=u.segment,w=b.map(function(S){return e.apply(S,{position:s})});return yi(u,"discard")&&nFe(w,function(S){return!e.isInRange(S)})?null:w}return null};function RLe(t){var e=t.x,n=t.y,r=t.segment,o=t.xAxisId,i=t.yAxisId,s=t.shape,a=t.className,l=t.alwaysShow,u=pLe(),c=lV(o),f=uV(i),h=yLe();if(!u||!h)return null;zi(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=vT({x:c.scale,y:f.scale}),p=pn(e),m=pn(n),g=r&&r.length===2,y=DLe(d,p,m,g,h,t.position,c.orientation,f.orientation,t);if(!y)return null;var v=TLe(y,2),x=v[0],b=x.x,w=x.y,S=v[1],$=S.x,C=S.y,k=yi(t,"hidden")?"url(#".concat(u,")"):void 0,I=V_(V_({clipPath:k},Ve(t,!0)),{},{x1:b,y1:w,x2:$,y2:C});return W.createElement(Kt,{className:Je("recharts-reference-line",a)},_Le(s,I),Kn.renderCallByParent(t,GFe({x1:b,y1:w,x2:$,y2:C})))}var CT=function(t){function e(){return xLe(this,e),SLe(this,e,arguments)}return kLe(e,t),wLe(e,[{key:"render",value:function(){return W.createElement(RLe,this.props)}}])}(W.Component);$T(CT,"displayName","ReferenceLine");$T(CT,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function vS(){return vS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vS.apply(this,arguments)}function rc(t){"@babel/helpers - typeof";return rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rc(t)}function G_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function H_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?G_(Object(n),!0).forEach(function(r){ux(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function PLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MLe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dV(r.key),r)}}function FLe(t,e,n){return e&&MLe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function LLe(t,e,n){return e=Ny(e),BLe(t,hV()?Reflect.construct(e,n||[],Ny(t).constructor):e.apply(t,n))}function BLe(t,e){if(e&&(rc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zLe(t)}function zLe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hV(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hV=function(){return!!t})()}function Ny(t){return Ny=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ny(t)}function jLe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xS(t,e)}function xS(t,e){return xS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},xS(t,e)}function ux(t,e,n){return e=dV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dV(t){var e=WLe(t,"string");return rc(e)=="symbol"?e:e+""}function WLe(t,e){if(rc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(rc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VLe=function(e){var n=e.x,r=e.y,o=e.xAxis,i=e.yAxis,s=vT({x:o.scale,y:i.scale}),a=s.apply({x:n,y:r},{bandAware:!0});return yi(e,"discard")&&!s.isInRange(a)?null:a},cx=function(t){function e(){return PLe(this,e),LLe(this,e,arguments)}return jLe(e,t),FLe(e,[{key:"render",value:function(){var r=this.props,o=r.x,i=r.y,s=r.r,a=r.alwaysShow,l=r.clipPathId,u=pn(o),c=pn(i);if(zi(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!c)return null;var f=VLe(this.props);if(!f)return null;var h=f.x,d=f.y,p=this.props,m=p.shape,g=p.className,y=yi(this.props,"hidden")?"url(#".concat(l,")"):void 0,v=H_(H_({clipPath:y},Ve(this.props,!0)),{},{cx:h,cy:d});return W.createElement(Kt,{className:Je("recharts-reference-dot",g)},e.renderDot(m,v),Kn.renderCallByParent(this.props,{x:h-s,y:d-s,width:2*s,height:2*s}))}}])}(W.Component);ux(cx,"displayName","ReferenceDot");ux(cx,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});ux(cx,"renderDot",function(t,e){var n;return W.isValidElement(t)?n=W.cloneElement(t,e):Be(t)?n=t(e):n=W.createElement(yT,vS({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),n});function bS(){return bS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},bS.apply(this,arguments)}function oc(t){"@babel/helpers - typeof";return oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oc(t)}function K_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function q_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?K_(Object(n),!0).forEach(function(r){fx(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):K_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ULe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GLe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mV(r.key),r)}}function HLe(t,e,n){return e&&GLe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function KLe(t,e,n){return e=Ay(e),qLe(t,pV()?Reflect.construct(e,n||[],Ay(t).constructor):e.apply(t,n))}function qLe(t,e){if(e&&(oc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XLe(t)}function XLe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pV(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pV=function(){return!!t})()}function Ay(t){return Ay=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ay(t)}function YLe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wS(t,e)}function wS(t,e){return wS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},wS(t,e)}function fx(t,e,n){return e=mV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mV(t){var e=QLe(t,"string");return oc(e)=="symbol"?e:e+""}function QLe(t,e){if(oc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(oc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZLe=function(e,n,r,o,i){var s=i.x1,a=i.x2,l=i.y1,u=i.y2,c=i.xAxis,f=i.yAxis;if(!c||!f)return null;var h=vT({x:c.scale,y:f.scale}),d={x:e?h.x.apply(s,{position:"start"}):h.x.rangeMin,y:r?h.y.apply(l,{position:"start"}):h.y.rangeMin},p={x:n?h.x.apply(a,{position:"end"}):h.x.rangeMax,y:o?h.y.apply(u,{position:"end"}):h.y.rangeMax};return yi(i,"discard")&&(!h.isInRange(d)||!h.isInRange(p))?null:tV(d,p)},hx=function(t){function e(){return ULe(this,e),KLe(this,e,arguments)}return YLe(e,t),HLe(e,[{key:"render",value:function(){var r=this.props,o=r.x1,i=r.x2,s=r.y1,a=r.y2,l=r.className,u=r.alwaysShow,c=r.clipPathId;zi(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=pn(o),h=pn(i),d=pn(s),p=pn(a),m=this.props.shape;if(!f&&!h&&!d&&!p&&!m)return null;var g=ZLe(f,h,d,p,this.props);if(!g&&!m)return null;var y=yi(this.props,"hidden")?"url(#".concat(c,")"):void 0;return W.createElement(Kt,{className:Je("recharts-reference-area",l)},e.renderRect(m,q_(q_({clipPath:y},Ve(this.props,!0)),g)),Kn.renderCallByParent(this.props,g))}}])}(W.Component);fx(hx,"displayName","ReferenceArea");fx(hx,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});fx(hx,"renderRect",function(t,e){var n;return W.isValidElement(t)?n=W.cloneElement(t,e):Be(t)?n=t(e):n=W.createElement(gT,bS({},e,{className:"recharts-reference-area-rect"})),n});function gV(t,e,n){if(e<1)return[];if(e===1&&n===void 0)return t;for(var r=[],o=0;o<t.length;o+=e)r.push(t[o]);return r}function JLe(t,e,n){var r={width:t.width+e.width,height:t.height+e.height};return KFe(r,n)}function e3e(t,e,n){var r=n==="width",o=t.x,i=t.y,s=t.width,a=t.height;return e===1?{start:r?o:i,end:r?o+s:i+a}:{start:r?o+s:i+a,end:r?o:i}}function Oy(t,e,n,r,o){if(t*e<t*r||t*e>t*o)return!1;var i=n();return t*(e-t*i/2-r)>=0&&t*(e+t*i/2-o)<=0}function t3e(t,e){return gV(t,e+1)}function n3e(t,e,n,r,o){for(var i=(r||[]).slice(),s=e.start,a=e.end,l=0,u=1,c=s,f=function(){var p=r==null?void 0:r[l];if(p===void 0)return{v:gV(r,u)};var m=l,g,y=function(){return g===void 0&&(g=n(p,m)),g},v=p.coordinate,x=l===0||Oy(t,v,y,c,a);x||(l=0,c=s,u+=1),x&&(c=v+t*(y()/2+o),l+=u)},h;u<=i.length;)if(h=f(),h)return h.v;return[]}function Kh(t){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kh(t)}function X_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Vn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?X_(Object(n),!0).forEach(function(r){r3e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function r3e(t,e,n){return e=o3e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o3e(t){var e=i3e(t,"string");return Kh(e)=="symbol"?e:e+""}function i3e(t,e){if(Kh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Kh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s3e(t,e,n,r,o){for(var i=(r||[]).slice(),s=i.length,a=e.start,l=e.end,u=function(h){var d=i[h],p,m=function(){return p===void 0&&(p=n(d,h)),p};if(h===s-1){var g=t*(d.coordinate+t*m()/2-l);i[h]=d=Vn(Vn({},d),{},{tickCoord:g>0?d.coordinate-g*t:d.coordinate})}else i[h]=d=Vn(Vn({},d),{},{tickCoord:d.coordinate});var y=Oy(t,d.tickCoord,m,a,l);y&&(l=d.tickCoord-t*(m()/2+o),i[h]=Vn(Vn({},d),{},{isShow:!0}))},c=s-1;c>=0;c--)u(c);return i}function a3e(t,e,n,r,o,i){var s=(r||[]).slice(),a=s.length,l=e.start,u=e.end;if(i){var c=r[a-1],f=n(c,a-1),h=t*(c.coordinate+t*f/2-u);s[a-1]=c=Vn(Vn({},c),{},{tickCoord:h>0?c.coordinate-h*t:c.coordinate});var d=Oy(t,c.tickCoord,function(){return f},l,u);d&&(u=c.tickCoord-t*(f/2+o),s[a-1]=Vn(Vn({},c),{},{isShow:!0}))}for(var p=i?a-1:a,m=function(v){var x=s[v],b,w=function(){return b===void 0&&(b=n(x,v)),b};if(v===0){var S=t*(x.coordinate-t*w()/2-l);s[v]=x=Vn(Vn({},x),{},{tickCoord:S<0?x.coordinate-S*t:x.coordinate})}else s[v]=x=Vn(Vn({},x),{},{tickCoord:x.coordinate});var $=Oy(t,x.tickCoord,w,l,u);$&&(l=x.tickCoord+t*(w()/2+o),s[v]=Vn(Vn({},x),{},{isShow:!0}))},g=0;g<p;g++)m(g);return s}function kT(t,e,n){var r=t.tick,o=t.ticks,i=t.viewBox,s=t.minTickGap,a=t.orientation,l=t.interval,u=t.tickFormatter,c=t.unit,f=t.angle;if(!o||!o.length||!r)return[];if(pe(l)||Wi.isSsr)return t3e(o,typeof l=="number"&&pe(l)?l:0);var h=[],d=a==="top"||a==="bottom"?"width":"height",p=c&&d==="width"?Pf(c,{fontSize:e,letterSpacing:n}):{width:0,height:0},m=function(x,b){var w=Be(u)?u(x.value,b):x.value;return d==="width"?JLe(Pf(w,{fontSize:e,letterSpacing:n}),p,f):Pf(w,{fontSize:e,letterSpacing:n})[d]},g=o.length>=2?Bo(o[1].coordinate-o[0].coordinate):1,y=e3e(i,g,d);return l==="equidistantPreserveStart"?n3e(g,y,m,o,s):(l==="preserveStart"||l==="preserveStartEnd"?h=a3e(g,y,m,o,s,l==="preserveStartEnd"):h=s3e(g,y,m,o,s),h.filter(function(v){return v.isShow}))}var l3e=["viewBox"],u3e=["viewBox"],c3e=["ticks"];function ic(t){"@babel/helpers - typeof";return ic=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ic(t)}function iu(){return iu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},iu.apply(this,arguments)}function Y_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function er(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Y_(Object(n),!0).forEach(function(r){IT(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Eb(t,e){if(t==null)return{};var n=f3e(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function f3e(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function h3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vV(r.key),r)}}function d3e(t,e,n){return e&&Q_(t.prototype,e),n&&Q_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function p3e(t,e,n){return e=_y(e),m3e(t,yV()?Reflect.construct(e,n||[],_y(t).constructor):e.apply(t,n))}function m3e(t,e){if(e&&(ic(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g3e(t)}function g3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yV(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yV=function(){return!!t})()}function _y(t){return _y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},_y(t)}function y3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SS(t,e)}function SS(t,e){return SS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},SS(t,e)}function IT(t,e,n){return e=vV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vV(t){var e=v3e(t,"string");return ic(e)=="symbol"?e:e+""}function v3e(t,e){if(ic(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ic(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Wc=function(t){function e(n){var r;return h3e(this,e),r=p3e(this,e,[n]),r.state={fontSize:"",letterSpacing:""},r}return y3e(e,t),d3e(e,[{key:"shouldComponentUpdate",value:function(r,o){var i=r.viewBox,s=Eb(r,l3e),a=this.props,l=a.viewBox,u=Eb(a,u3e);return!vu(i,l)||!vu(s,u)||!vu(o,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var o=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];o&&this.setState({fontSize:window.getComputedStyle(o).fontSize,letterSpacing:window.getComputedStyle(o).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var o=this.props,i=o.x,s=o.y,a=o.width,l=o.height,u=o.orientation,c=o.tickSize,f=o.mirror,h=o.tickMargin,d,p,m,g,y,v,x=f?-1:1,b=r.tickSize||c,w=pe(r.tickCoord)?r.tickCoord:r.coordinate;switch(u){case"top":d=p=r.coordinate,g=s+ +!f*l,m=g-x*b,v=m-x*h,y=w;break;case"left":m=g=r.coordinate,p=i+ +!f*a,d=p-x*b,y=d-x*h,v=w;break;case"right":m=g=r.coordinate,p=i+ +f*a,d=p+x*b,y=d+x*h,v=w;break;default:d=p=r.coordinate,g=s+ +f*l,m=g+x*b,v=m+x*h,y=w;break}return{line:{x1:d,y1:m,x2:p,y2:g},tick:{x:y,y:v}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,o=r.orientation,i=r.mirror,s;switch(o){case"left":s=i?"start":"end";break;case"right":s=i?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,o=r.orientation,i=r.mirror,s="end";switch(o){case"left":case"right":s="middle";break;case"top":s=i?"start":"end";break;default:s=i?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var r=this.props,o=r.x,i=r.y,s=r.width,a=r.height,l=r.orientation,u=r.mirror,c=r.axisLine,f=er(er(er({},Ve(this.props,!1)),Ve(c,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var h=+(l==="top"&&!u||l==="bottom"&&u);f=er(er({},f),{},{x1:o,y1:i+h*a,x2:o+s,y2:i+h*a})}else{var d=+(l==="left"&&!u||l==="right"&&u);f=er(er({},f),{},{x1:o+d*s,y1:i,x2:o+d*s,y2:i+a})}return W.createElement("line",iu({},f,{className:Je("recharts-cartesian-axis-line",co(c,"className"))}))}},{key:"renderTicks",value:function(r,o,i){var s=this,a=this.props,l=a.tickLine,u=a.stroke,c=a.tick,f=a.tickFormatter,h=a.unit,d=kT(er(er({},this.props),{},{ticks:r}),o,i),p=this.getTickTextAnchor(),m=this.getTickVerticalAnchor(),g=Ve(this.props,!1),y=Ve(c,!1),v=er(er({},g),{},{fill:"none"},Ve(l,!1)),x=d.map(function(b,w){var S=s.getTickLineCoord(b),$=S.line,C=S.tick,k=er(er(er(er({textAnchor:p,verticalAnchor:m},g),{},{stroke:"none",fill:u},y),C),{},{index:w,payload:b,visibleTicksCount:d.length,tickFormatter:f});return W.createElement(Kt,iu({className:"recharts-cartesian-axis-tick",key:"tick-".concat(b.value,"-").concat(b.coordinate,"-").concat(b.tickCoord)},zg(s.props,b,w)),l&&W.createElement("line",iu({},v,$,{className:Je("recharts-cartesian-axis-tick-line",co(l,"className"))})),c&&e.renderTickItem(c,k,"".concat(Be(f)?f(b.value,w):b.value).concat(h||"")))});return W.createElement("g",{className:"recharts-cartesian-axis-ticks"},x)}},{key:"render",value:function(){var r=this,o=this.props,i=o.axisLine,s=o.width,a=o.height,l=o.ticksGenerator,u=o.className,c=o.hide;if(c)return null;var f=this.props,h=f.ticks,d=Eb(f,c3e),p=h;return Be(l)&&(p=h&&h.length>0?l(this.props):l(d)),s<=0||a<=0||!p||!p.length?null:W.createElement(Kt,{className:Je("recharts-cartesian-axis",u),ref:function(g){r.layerReference=g}},i&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Kn.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,o,i){var s;return W.isValidElement(r)?s=W.cloneElement(r,o):Be(r)?s=r(o):s=W.createElement(ey,iu({},o,{className:"recharts-cartesian-axis-tick-value"}),i),s}}])}(se.Component);IT(Wc,"displayName","CartesianAxis");IT(Wc,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var x3e=["x1","y1","x2","y2","key"],b3e=["offset"];function hl(t){"@babel/helpers - typeof";return hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hl(t)}function Z_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function qn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Z_(Object(n),!0).forEach(function(r){w3e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Z_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function w3e(t,e,n){return e=S3e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S3e(t){var e=$3e(t,"string");return hl(e)=="symbol"?e:e+""}function $3e(t,e){if(hl(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(hl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ma(){return Ma=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ma.apply(this,arguments)}function J_(t,e){if(t==null)return{};var n=C3e(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function C3e(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var k3e=function(e){var n=e.fill;if(!n||n==="none")return null;var r=e.fillOpacity,o=e.x,i=e.y,s=e.width,a=e.height,l=e.ry;return W.createElement("rect",{x:o,y:i,ry:l,width:s,height:a,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function xV(t,e){var n;if(W.isValidElement(t))n=W.cloneElement(t,e);else if(Be(t))n=t(e);else{var r=e.x1,o=e.y1,i=e.x2,s=e.y2,a=e.key,l=J_(e,x3e),u=Ve(l,!1);u.offset;var c=J_(u,b3e);n=W.createElement("line",Ma({},c,{x1:r,y1:o,x2:i,y2:s,fill:"none",key:a}))}return n}function I3e(t){var e=t.x,n=t.width,r=t.horizontal,o=r===void 0?!0:r,i=t.horizontalPoints;if(!o||!i||!i.length)return null;var s=i.map(function(a,l){var u=qn(qn({},t),{},{x1:e,y1:a,x2:e+n,y2:a,key:"line-".concat(l),index:l});return xV(o,u)});return W.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function T3e(t){var e=t.y,n=t.height,r=t.vertical,o=r===void 0?!0:r,i=t.verticalPoints;if(!o||!i||!i.length)return null;var s=i.map(function(a,l){var u=qn(qn({},t),{},{x1:a,y1:e,x2:a,y2:e+n,key:"line-".concat(l),index:l});return xV(o,u)});return W.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function E3e(t){var e=t.horizontalFill,n=t.fillOpacity,r=t.x,o=t.y,i=t.width,s=t.height,a=t.horizontalPoints,l=t.horizontal,u=l===void 0?!0:l;if(!u||!e||!e.length)return null;var c=a.map(function(h){return Math.round(h+o-o)}).sort(function(h,d){return h-d});o!==c[0]&&c.unshift(0);var f=c.map(function(h,d){var p=!c[d+1],m=p?o+s-h:c[d+1]-h;if(m<=0)return null;var g=d%e.length;return W.createElement("rect",{key:"react-".concat(d),y:h,x:r,height:m,width:i,stroke:"none",fill:e[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return W.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function N3e(t){var e=t.vertical,n=e===void 0?!0:e,r=t.verticalFill,o=t.fillOpacity,i=t.x,s=t.y,a=t.width,l=t.height,u=t.verticalPoints;if(!n||!r||!r.length)return null;var c=u.map(function(h){return Math.round(h+i-i)}).sort(function(h,d){return h-d});i!==c[0]&&c.unshift(0);var f=c.map(function(h,d){var p=!c[d+1],m=p?i+a-h:c[d+1]-h;if(m<=0)return null;var g=d%r.length;return W.createElement("rect",{key:"react-".concat(d),x:h,y:s,width:m,height:l,stroke:"none",fill:r[g],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return W.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var A3e=function(e,n){var r=e.xAxis,o=e.width,i=e.height,s=e.offset;return NW(kT(qn(qn(qn({},Wc.defaultProps),r),{},{ticks:Mi(r,!0),viewBox:{x:0,y:0,width:o,height:i}})),s.left,s.left+s.width,n)},O3e=function(e,n){var r=e.yAxis,o=e.width,i=e.height,s=e.offset;return NW(kT(qn(qn(qn({},Wc.defaultProps),r),{},{ticks:Mi(r,!0),viewBox:{x:0,y:0,width:o,height:i}})),s.top,s.top+s.height,n)},zl={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Lm(t){var e,n,r,o,i,s,a=wT(),l=ST(),u=vLe(),c=qn(qn({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:zl.stroke,fill:(n=t.fill)!==null&&n!==void 0?n:zl.fill,horizontal:(r=t.horizontal)!==null&&r!==void 0?r:zl.horizontal,horizontalFill:(o=t.horizontalFill)!==null&&o!==void 0?o:zl.horizontalFill,vertical:(i=t.vertical)!==null&&i!==void 0?i:zl.vertical,verticalFill:(s=t.verticalFill)!==null&&s!==void 0?s:zl.verticalFill,x:pe(t.x)?t.x:u.left,y:pe(t.y)?t.y:u.top,width:pe(t.width)?t.width:u.width,height:pe(t.height)?t.height:u.height}),f=c.x,h=c.y,d=c.width,p=c.height,m=c.syncWithTicks,g=c.horizontalValues,y=c.verticalValues,v=mLe(),x=gLe();if(!pe(d)||d<=0||!pe(p)||p<=0||!pe(f)||f!==+f||!pe(h)||h!==+h)return null;var b=c.verticalCoordinatesGenerator||A3e,w=c.horizontalCoordinatesGenerator||O3e,S=c.horizontalPoints,$=c.verticalPoints;if((!S||!S.length)&&Be(w)){var C=g&&g.length,k=w({yAxis:x?qn(qn({},x),{},{ticks:C?g:x.ticks}):void 0,width:a,height:l,offset:u},C?!0:m);zi(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(hl(k),"]")),Array.isArray(k)&&(S=k)}if((!$||!$.length)&&Be(b)){var I=y&&y.length,T=b({xAxis:v?qn(qn({},v),{},{ticks:I?y:v.ticks}):void 0,width:a,height:l,offset:u},I?!0:m);zi(Array.isArray(T),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(hl(T),"]")),Array.isArray(T)&&($=T)}return W.createElement("g",{className:"recharts-cartesian-grid"},W.createElement(k3e,{fill:c.fill,fillOpacity:c.fillOpacity,x:c.x,y:c.y,width:c.width,height:c.height,ry:c.ry}),W.createElement(I3e,Ma({},c,{offset:u,horizontalPoints:S,xAxis:v,yAxis:x})),W.createElement(T3e,Ma({},c,{offset:u,verticalPoints:$,xAxis:v,yAxis:x})),W.createElement(E3e,Ma({},c,{horizontalPoints:S})),W.createElement(N3e,Ma({},c,{verticalPoints:$})))}Lm.displayName="CartesianGrid";var _3e=["type","layout","connectNulls","ref"],D3e=["key"];function sc(t){"@babel/helpers - typeof";return sc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sc(t)}function eD(t,e){if(t==null)return{};var n=R3e(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function R3e(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Bf(){return Bf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bf.apply(this,arguments)}function tD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Nr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?tD(Object(n),!0).forEach(function(r){Oo(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tD(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function jl(t){return L3e(t)||F3e(t)||M3e(t)||P3e()}function P3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M3e(t,e){if(t){if(typeof t=="string")return $S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $S(t,e)}}function F3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function L3e(t){if(Array.isArray(t))return $S(t)}function $S(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nD(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wV(r.key),r)}}function z3e(t,e,n){return e&&nD(t.prototype,e),n&&nD(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function j3e(t,e,n){return e=Dy(e),W3e(t,bV()?Reflect.construct(e,n||[],Dy(t).constructor):e.apply(t,n))}function W3e(t,e){if(e&&(sc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V3e(t)}function V3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bV(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bV=function(){return!!t})()}function Dy(t){return Dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Dy(t)}function U3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CS(t,e)}function CS(t,e){return CS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},CS(t,e)}function Oo(t,e,n){return e=wV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wV(t){var e=G3e(t,"string");return sc(e)=="symbol"?e:e+""}function G3e(t,e){if(sc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(sc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ts=function(t){function e(){var n;B3e(this,e);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return n=j3e(this,e,[].concat(o)),Oo(n,"state",{isAnimationFinished:!0,totalLength:0}),Oo(n,"generateSimpleStrokeDasharray",function(s,a){return"".concat(a,"px ").concat(s-a,"px")}),Oo(n,"getStrokeDasharray",function(s,a,l){var u=l.reduce(function(y,v){return y+v});if(!u)return n.generateSimpleStrokeDasharray(a,s);for(var c=Math.floor(s/u),f=s%u,h=a-s,d=[],p=0,m=0;p<l.length;m+=l[p],++p)if(m+l[p]>f){d=[].concat(jl(l.slice(0,p)),[f-m]);break}var g=d.length%2===0?[0,h]:[h];return[].concat(jl(e.repeat(l,c)),jl(d),g).map(function(y){return"".concat(y,"px")}).join(", ")}),Oo(n,"id",Cp("recharts-line-")),Oo(n,"pathRef",function(s){n.mainCurve=s}),Oo(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),Oo(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return U3e(e,t),z3e(e,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,o){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.points,a=i.xAxis,l=i.yAxis,u=i.layout,c=i.children,f=fo(c,Ap);if(!f)return null;var h=function(m,g){return{x:m.x,y:m.y,value:m.value,errorVal:jr(m.payload,g)}},d={clipPath:r?"url(#clipPath-".concat(o,")"):null};return W.createElement(Kt,d,f.map(function(p){return W.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:s,xAxis:a,yAxis:l,layout:u,dataPointFormatter:h})}))}},{key:"renderDots",value:function(r,o,i){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var a=this.props,l=a.dot,u=a.points,c=a.dataKey,f=Ve(this.props,!1),h=Ve(l,!0),d=u.map(function(m,g){var y=Nr(Nr(Nr({key:"dot-".concat(g),r:3},f),h),{},{value:m.value,dataKey:c,cx:m.x,cy:m.y,index:g,payload:m.payload});return e.renderDotItem(l,y)}),p={clipPath:r?"url(#clipPath-".concat(o?"":"dots-").concat(i,")"):null};return W.createElement(Kt,Bf({className:"recharts-line-dots",key:"dots"},p),d)}},{key:"renderCurveStatically",value:function(r,o,i,s){var a=this.props,l=a.type,u=a.layout,c=a.connectNulls;a.ref;var f=eD(a,_3e),h=Nr(Nr(Nr({},Ve(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:o?"url(#clipPath-".concat(i,")"):null,points:r},s),{},{type:l,layout:u,connectNulls:c});return W.createElement(tS,Bf({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,o){var i=this,s=this.props,a=s.points,l=s.strokeDasharray,u=s.isAnimationActive,c=s.animationBegin,f=s.animationDuration,h=s.animationEasing,d=s.animationId,p=s.animateNewValues,m=s.width,g=s.height,y=this.state,v=y.prevPoints,x=y.totalLength;return W.createElement(ts,{begin:c,duration:f,isActive:u,easing:h,from:{t:0},to:{t:1},key:"line-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var w=b.t;if(v){var S=v.length/a.length,$=a.map(function(N,_){var D=Math.floor(_*S);if(v[D]){var O=v[D],R=Po(O.x,N.x),F=Po(O.y,N.y);return Nr(Nr({},N),{},{x:R(w),y:F(w)})}if(p){var A=Po(m*2,N.x),P=Po(g/2,N.y);return Nr(Nr({},N),{},{x:A(w),y:P(w)})}return Nr(Nr({},N),{},{x:N.x,y:N.y})});return i.renderCurveStatically($,r,o)}var C=Po(0,x),k=C(w),I;if(l){var T="".concat(l).split(/[,\s]+/gim).map(function(N){return parseFloat(N)});I=i.getStrokeDasharray(k,x,T)}else I=i.generateSimpleStrokeDasharray(x,k);return i.renderCurveStatically(a,r,o,{strokeDasharray:I})})}},{key:"renderCurve",value:function(r,o){var i=this.props,s=i.points,a=i.isAnimationActive,l=this.state,u=l.prevPoints,c=l.totalLength;return a&&s&&s.length&&(!u&&c>0||!rx(u,s))?this.renderCurveWithAnimation(r,o):this.renderCurveStatically(s,r,o)}},{key:"render",value:function(){var r,o=this.props,i=o.hide,s=o.dot,a=o.points,l=o.className,u=o.xAxis,c=o.yAxis,f=o.top,h=o.left,d=o.width,p=o.height,m=o.isAnimationActive,g=o.id;if(i||!a||!a.length)return null;var y=this.state.isAnimationFinished,v=a.length===1,x=Je("recharts-line",l),b=u&&u.allowDataOverflow,w=c&&c.allowDataOverflow,S=b||w,$=We(g)?this.id:g,C=(r=Ve(s,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},k=C.r,I=k===void 0?3:k,T=C.strokeWidth,N=T===void 0?2:T,_=ixe(s)?s:{},D=_.clipDot,O=D===void 0?!0:D,R=I*2+N;return W.createElement(Kt,{className:x},b||w?W.createElement("defs",null,W.createElement("clipPath",{id:"clipPath-".concat($)},W.createElement("rect",{x:b?h:h-d/2,y:w?f:f-p/2,width:b?d:d*2,height:w?p:p*2})),!O&&W.createElement("clipPath",{id:"clipPath-dots-".concat($)},W.createElement("rect",{x:h-R/2,y:f-R/2,width:d+R,height:p+R}))):null,!v&&this.renderCurve(S,$),this.renderErrorBar(S,$),(v||s)&&this.renderDots(S,O,$),(!m||y)&&js.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(r,o){return r.animationId!==o.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:o.curPoints}:r.points!==o.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,o){for(var i=r.length%2!==0?[].concat(jl(r),[0]):r,s=[],a=0;a<o;++a)s=[].concat(jl(s),jl(i));return s}},{key:"renderDotItem",value:function(r,o){var i;if(W.isValidElement(r))i=W.cloneElement(r,o);else if(Be(r))i=r(o);else{var s=o.key,a=eD(o,D3e),l=Je("recharts-line-dot",typeof r!="boolean"?r.className:"");i=W.createElement(yT,Bf({key:s},a,{className:l}))}return i}}])}(se.PureComponent);Oo(Ts,"displayName","Line");Oo(Ts,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Wi.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Oo(Ts,"getComposedData",function(t){var e=t.props,n=t.xAxis,r=t.yAxis,o=t.xAxisTicks,i=t.yAxisTicks,s=t.dataKey,a=t.bandSize,l=t.displayedData,u=t.offset,c=e.layout,f=l.map(function(h,d){var p=jr(h,s);return c==="horizontal"?{x:MO({axis:n,ticks:o,bandSize:a,entry:h,index:d}),y:We(p)?null:r.scale(p),value:p,payload:h}:{x:We(p)?null:n.scale(p),y:MO({axis:r,ticks:i,bandSize:a,entry:h,index:d}),value:p,payload:h}});return Nr({points:f,layout:c},u)});function ac(t){"@babel/helpers - typeof";return ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ac(t)}function H3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K3e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,CV(r.key),r)}}function q3e(t,e,n){return e&&K3e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function X3e(t,e,n){return e=Ry(e),Y3e(t,SV()?Reflect.construct(e,n||[],Ry(t).constructor):e.apply(t,n))}function Y3e(t,e){if(e&&(ac(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q3e(t)}function Q3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function SV(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SV=function(){return!!t})()}function Ry(t){return Ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ry(t)}function Z3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kS(t,e)}function kS(t,e){return kS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},kS(t,e)}function $V(t,e,n){return e=CV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CV(t){var e=J3e(t,"string");return ac(e)=="symbol"?e:e+""}function J3e(t,e){if(ac(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ac(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IS(){return IS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},IS.apply(this,arguments)}function eBe(t){var e=t.xAxisId,n=wT(),r=ST(),o=lV(e);return o==null?null:W.createElement(Wc,IS({},o,{className:Je("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(s){return Mi(s,!0)}}))}var wu=function(t){function e(){return H3e(this,e),X3e(this,e,arguments)}return Z3e(e,t),q3e(e,[{key:"render",value:function(){return W.createElement(eBe,this.props)}}])}(W.Component);$V(wu,"displayName","XAxis");$V(wu,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function lc(t){"@babel/helpers - typeof";return lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lc(t)}function tBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nBe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,TV(r.key),r)}}function rBe(t,e,n){return e&&nBe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function oBe(t,e,n){return e=Py(e),iBe(t,kV()?Reflect.construct(e,n||[],Py(t).constructor):e.apply(t,n))}function iBe(t,e){if(e&&(lc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sBe(t)}function sBe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kV(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kV=function(){return!!t})()}function Py(t){return Py=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Py(t)}function aBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TS(t,e)}function TS(t,e){return TS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},TS(t,e)}function IV(t,e,n){return e=TV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TV(t){var e=lBe(t,"string");return lc(e)=="symbol"?e:e+""}function lBe(t,e){if(lc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(lc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ES(){return ES=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ES.apply(this,arguments)}var uBe=function(e){var n=e.yAxisId,r=wT(),o=ST(),i=uV(n);return i==null?null:W.createElement(Wc,ES({},i,{className:Je("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:r,height:o},ticksGenerator:function(a){return Mi(a,!0)}}))},Su=function(t){function e(){return tBe(this,e),oBe(this,e,arguments)}return aBe(e,t),rBe(e,[{key:"render",value:function(){return W.createElement(uBe,this.props)}}])}(W.Component);IV(Su,"displayName","YAxis");IV(Su,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function rD(t){return dBe(t)||hBe(t)||fBe(t)||cBe()}function cBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fBe(t,e){if(t){if(typeof t=="string")return NS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NS(t,e)}}function hBe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dBe(t){if(Array.isArray(t))return NS(t)}function NS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var AS=function(e,n,r,o,i){var s=fo(e,CT),a=fo(e,cx),l=[].concat(rD(s),rD(a)),u=fo(e,hx),c="".concat(o,"Id"),f=o[0],h=n;if(l.length&&(h=l.reduce(function(m,g){if(g.props[c]===r&&yi(g.props,"extendDomain")&&pe(g.props[f])){var y=g.props[f];return[Math.min(m[0],y),Math.max(m[1],y)]}return m},h)),u.length){var d="".concat(f,"1"),p="".concat(f,"2");h=u.reduce(function(m,g){if(g.props[c]===r&&yi(g.props,"extendDomain")&&pe(g.props[d])&&pe(g.props[p])){var y=g.props[d],v=g.props[p];return[Math.min(m[0],y,v),Math.max(m[1],y,v)]}return m},h)}return i&&i.length&&(h=i.reduce(function(m,g){return pe(g)?[Math.min(m[0],g),Math.max(m[1],g)]:m},h)),h},EV={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function o(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function i(l,u,c,f,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new o(c,f||l,h),p=n?n+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],d]:l._events[p].push(d):(l._events[p]=d,l._eventsCount++),l}function s(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,f;if(this._eventsCount===0)return u;for(f in c=this._events)e.call(c,f)&&u.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=n?n+u:u,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,d=f.length,p=new Array(d);h<d;h++)p[h]=f[h].fn;return p},a.prototype.listenerCount=function(u){var c=n?n+u:u,f=this._events[c];return f?f.fn?1:f.length:0},a.prototype.emit=function(u,c,f,h,d,p){var m=n?n+u:u;if(!this._events[m])return!1;var g=this._events[m],y=arguments.length,v,x;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,f),!0;case 4:return g.fn.call(g.context,c,f,h),!0;case 5:return g.fn.call(g.context,c,f,h,d),!0;case 6:return g.fn.call(g.context,c,f,h,d,p),!0}for(x=1,v=new Array(y-1);x<y;x++)v[x-1]=arguments[x];g.fn.apply(g.context,v)}else{var b=g.length,w;for(x=0;x<b;x++)switch(g[x].once&&this.removeListener(u,g[x].fn,void 0,!0),y){case 1:g[x].fn.call(g[x].context);break;case 2:g[x].fn.call(g[x].context,c);break;case 3:g[x].fn.call(g[x].context,c,f);break;case 4:g[x].fn.call(g[x].context,c,f,h);break;default:if(!v)for(w=1,v=new Array(y-1);w<y;w++)v[w-1]=arguments[w];g[x].fn.apply(g[x].context,v)}}return!0},a.prototype.on=function(u,c,f){return i(this,u,c,f,!1)},a.prototype.once=function(u,c,f){return i(this,u,c,f,!0)},a.prototype.removeListener=function(u,c,f,h){var d=n?n+u:u;if(!this._events[d])return this;if(!c)return s(this,d),this;var p=this._events[d];if(p.fn)p.fn===c&&(!h||p.once)&&(!f||p.context===f)&&s(this,d);else{for(var m=0,g=[],y=p.length;m<y;m++)(p[m].fn!==c||h&&!p[m].once||f&&p[m].context!==f)&&g.push(p[m]);g.length?this._events[d]=g.length===1?g[0]:g:s(this,d)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=n?n+u:u,this._events[c]&&s(this,c)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(EV);var pBe=EV.exports;const mBe=ft(pBe);var Nb=new mBe,Ab="recharts.syncMouseEvents";function qh(t){"@babel/helpers - typeof";return qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qh(t)}function gBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yBe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,NV(r.key),r)}}function vBe(t,e,n){return e&&yBe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ob(t,e,n){return e=NV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NV(t){var e=xBe(t,"string");return qh(e)=="symbol"?e:e+""}function xBe(t,e){if(qh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(qh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var bBe=function(){function t(){gBe(this,t),Ob(this,"activeIndex",0),Ob(this,"coordinateList",[]),Ob(this,"layout","horizontal")}return vBe(t,[{key:"setDetails",value:function(n){var r,o=n.coordinateList,i=o===void 0?null:o,s=n.container,a=s===void 0?null:s,l=n.layout,u=l===void 0?null:l,c=n.offset,f=c===void 0?null:c,h=n.mouseHandlerCallback,d=h===void 0?null:h;this.coordinateList=(r=i??this.coordinateList)!==null&&r!==void 0?r:[],this.container=a??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=d??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var o=this.container.getBoundingClientRect(),i=o.x,s=o.y,a=o.height,l=this.coordinateList[this.activeIndex].coordinate,u=((n=window)===null||n===void 0?void 0:n.scrollX)||0,c=((r=window)===null||r===void 0?void 0:r.scrollY)||0,f=i+l+u,h=s+this.offset.top+a/2+c;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function wBe(t,e,n){if(n==="number"&&e===!0&&Array.isArray(t)){var r=t==null?void 0:t[0],o=t==null?void 0:t[1];if(r&&o&&pe(r)&&pe(o))return!0}return!1}function SBe(t,e,n,r){var o=r/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-o:n.left+.5,y:t==="horizontal"?n.top+.5:e.y-o,width:t==="horizontal"?r:n.width-1,height:t==="horizontal"?n.height-1:r}}function AV(t){var e=t.cx,n=t.cy,r=t.radius,o=t.startAngle,i=t.endAngle,s=En(e,n,r,o),a=En(e,n,r,i);return{points:[s,a],cx:e,cy:n,radius:r,startAngle:o,endAngle:i}}function $Be(t,e,n){var r,o,i,s;if(t==="horizontal")r=e.x,i=r,o=n.top,s=n.top+n.height;else if(t==="vertical")o=e.y,s=o,r=n.left,i=n.left+n.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var a=e.cx,l=e.cy,u=e.innerRadius,c=e.outerRadius,f=e.angle,h=En(a,l,u,f),d=En(a,l,c,f);r=h.x,o=h.y,i=d.x,s=d.y}else return AV(e);return[{x:r,y:o},{x:i,y:s}]}function Xh(t){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xh(t)}function oD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function wm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oD(Object(n),!0).forEach(function(r){CBe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oD(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function CBe(t,e,n){return e=kBe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kBe(t){var e=IBe(t,"string");return Xh(e)=="symbol"?e:e+""}function IBe(t,e){if(Xh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Xh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TBe(t){var e,n,r=t.element,o=t.tooltipEventType,i=t.isActive,s=t.activeCoordinate,a=t.activePayload,l=t.offset,u=t.activeTooltipIndex,c=t.tooltipAxisBandSize,f=t.layout,h=t.chartName,d=(e=r.props.cursor)!==null&&e!==void 0?e:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!d||!i||!s||h!=="ScatterChart"&&o!=="axis")return null;var p,m=tS;if(h==="ScatterChart")p=s,m=IPe;else if(h==="BarChart")p=SBe(f,s,l,c),m=gT;else if(f==="radial"){var g=AV(s),y=g.cx,v=g.cy,x=g.radius,b=g.startAngle,w=g.endAngle;p={cx:y,cy:v,startAngle:b,endAngle:w,innerRadius:x,outerRadius:x},m=RW}else p={points:$Be(f,s,l)},m=tS;var S=wm(wm(wm(wm({stroke:"#ccc",pointerEvents:"none"},l),p),Ve(d,!1)),{},{payload:a,payloadIndex:u,className:Je("recharts-tooltip-cursor",d.className)});return se.isValidElement(d)?se.cloneElement(d,S):se.createElement(m,S)}var EBe=["item"],NBe=["children","className","width","height","style","compact","title","desc"];function uc(t){"@babel/helpers - typeof";return uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uc(t)}function su(){return su=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},su.apply(this,arguments)}function iD(t,e){return _Be(t)||OBe(t,e)||_V(t,e)||ABe()}function ABe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OBe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,i,s,a=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,e!==0)for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&n.return!=null&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}function _Be(t){if(Array.isArray(t))return t}function sD(t,e){if(t==null)return{};var n=DBe(t,e),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function DBe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function RBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PBe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,DV(r.key),r)}}function MBe(t,e,n){return e&&PBe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function FBe(t,e,n){return e=My(e),LBe(t,OV()?Reflect.construct(e,n||[],My(t).constructor):e.apply(t,n))}function LBe(t,e){if(e&&(uc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BBe(t)}function BBe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OV(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OV=function(){return!!t})()}function My(t){return My=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},My(t)}function zBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OS(t,e)}function OS(t,e){return OS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,o){return r.__proto__=o,r},OS(t,e)}function cc(t){return VBe(t)||WBe(t)||_V(t)||jBe()}function jBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _V(t,e){if(t){if(typeof t=="string")return _S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _S(t,e)}}function WBe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function VBe(t){if(Array.isArray(t))return _S(t)}function _S(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function aD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?aD(Object(n),!0).forEach(function(r){_e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aD(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _e(t,e,n){return e=DV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DV(t){var e=UBe(t,"string");return uc(e)=="symbol"?e:e+""}function UBe(t,e){if(uc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(uc(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var GBe={xAxis:["bottom","top"],yAxis:["left","right"]},HBe={width:"100%",height:"100%"},RV={x:0,y:0};function Sm(t){return t}var KBe=function(e,n){return n==="horizontal"?e.x:n==="vertical"?e.y:n==="centric"?e.angle:e.radius},qBe=function(e,n,r,o){var i=n.find(function(c){return c&&c.index===r});if(i){if(e==="horizontal")return{x:i.coordinate,y:o.y};if(e==="vertical")return{x:o.x,y:i.coordinate};if(e==="centric"){var s=i.coordinate,a=o.radius;return ee(ee(ee({},o),En(o.cx,o.cy,a,s)),{},{angle:s,radius:a})}var l=i.coordinate,u=o.angle;return ee(ee(ee({},o),En(o.cx,o.cy,l,u)),{},{angle:u,radius:l})}return RV},dx=function(e,n){var r=n.graphicalItems,o=n.dataStartIndex,i=n.dataEndIndex,s=(r??[]).reduce(function(a,l){var u=l.props.data;return u&&u.length?[].concat(cc(a),cc(u)):a},[]);return s.length>0?s:e&&e.length&&pe(o)&&pe(i)?e.slice(o,i+1):[]};function PV(t){return t==="number"?[0,"auto"]:void 0}var DS=function(e,n,r,o){var i=e.graphicalItems,s=e.tooltipAxis,a=dx(n,e);return r<0||!i||!i.length||r>=a.length?null:i.reduce(function(l,u){var c,f=(c=u.props.data)!==null&&c!==void 0?c:n;f&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=r&&(f=f.slice(e.dataStartIndex,e.dataEndIndex+1));var h;if(s.dataKey&&!s.allowDuplicatedCategory){var d=f===void 0?a:f;h=Lg(d,s.dataKey,o)}else h=f&&f[r]||a[r];return h?[].concat(cc(l),[OW(u,h)]):l},[])},lD=function(e,n,r,o){var i=o||{x:e.chartX,y:e.chartY},s=KBe(i,r),a=e.orderedTooltipTicks,l=e.tooltipAxis,u=e.tooltipTicks,c=l_e(s,a,u,l);if(c>=0&&u){var f=u[c]&&u[c].value,h=DS(e,n,c,f),d=qBe(r,a,c,i);return{activeTooltipIndex:c,activeLabel:f,activePayload:h,activeCoordinate:d}}return null},XBe=function(e,n){var r=n.axes,o=n.graphicalItems,i=n.axisType,s=n.axisIdKey,a=n.stackGroups,l=n.dataStartIndex,u=n.dataEndIndex,c=e.layout,f=e.children,h=e.stackOffset,d=EW(c,i);return r.reduce(function(p,m){var g,y=m.type.defaultProps!==void 0?ee(ee({},m.type.defaultProps),m.props):m.props,v=y.type,x=y.dataKey,b=y.allowDataOverflow,w=y.allowDuplicatedCategory,S=y.scale,$=y.ticks,C=y.includeHidden,k=y[s];if(p[k])return p;var I=dx(e.data,{graphicalItems:o.filter(function(H){var X,ne=s in H.props?H.props[s]:(X=H.type.defaultProps)===null||X===void 0?void 0:X[s];return ne===k}),dataStartIndex:l,dataEndIndex:u}),T=I.length,N,_,D;wBe(y.domain,b,v)&&(N=Yw(y.domain,null,b),d&&(v==="number"||S!=="auto")&&(D=Ff(I,x,"category")));var O=PV(v);if(!N||N.length===0){var R,F=(R=y.domain)!==null&&R!==void 0?R:O;if(x){if(N=Ff(I,x,v),v==="category"&&d){var A=Y0e(N);w&&A?(_=N,N=$y(0,T)):w||(N=zO(F,N,m).reduce(function(H,X){return H.indexOf(X)>=0?H:[].concat(cc(H),[X])},[]))}else if(v==="category")w?N=N.filter(function(H){return H!==""&&!We(H)}):N=zO(F,N,m).reduce(function(H,X){return H.indexOf(X)>=0||X===""||We(X)?H:[].concat(cc(H),[X])},[]);else if(v==="number"){var P=d_e(I,o.filter(function(H){var X,ne,re=s in H.props?H.props[s]:(X=H.type.defaultProps)===null||X===void 0?void 0:X[s],le="hide"in H.props?H.props.hide:(ne=H.type.defaultProps)===null||ne===void 0?void 0:ne.hide;return re===k&&(C||!le)}),x,i,c);P&&(N=P)}d&&(v==="number"||S!=="auto")&&(D=Ff(I,x,"category"))}else d?N=$y(0,T):a&&a[k]&&a[k].hasStack&&v==="number"?N=h==="expand"?[0,1]:AW(a[k].stackGroups,l,u):N=TW(I,o.filter(function(H){var X=s in H.props?H.props[s]:H.type.defaultProps[s],ne="hide"in H.props?H.props.hide:H.type.defaultProps.hide;return X===k&&(C||!ne)}),v,c,!0);if(v==="number")N=AS(f,N,k,i,$),F&&(N=Yw(F,N,b));else if(v==="category"&&F){var z=F,U=N.every(function(H){return z.indexOf(H)>=0});U&&(N=z)}}return ee(ee({},p),{},_e({},k,ee(ee({},y),{},{axisType:i,domain:N,categoricalDomain:D,duplicateDomain:_,originalDomain:(g=y.domain)!==null&&g!==void 0?g:O,isCategorical:d,layout:c})))},{})},YBe=function(e,n){var r=n.graphicalItems,o=n.Axis,i=n.axisType,s=n.axisIdKey,a=n.stackGroups,l=n.dataStartIndex,u=n.dataEndIndex,c=e.layout,f=e.children,h=dx(e.data,{graphicalItems:r,dataStartIndex:l,dataEndIndex:u}),d=h.length,p=EW(c,i),m=-1;return r.reduce(function(g,y){var v=y.type.defaultProps!==void 0?ee(ee({},y.type.defaultProps),y.props):y.props,x=v[s],b=PV("number");if(!g[x]){m++;var w;return p?w=$y(0,d):a&&a[x]&&a[x].hasStack?(w=AW(a[x].stackGroups,l,u),w=AS(f,w,x,i)):(w=Yw(b,TW(h,r.filter(function(S){var $,C,k=s in S.props?S.props[s]:($=S.type.defaultProps)===null||$===void 0?void 0:$[s],I="hide"in S.props?S.props.hide:(C=S.type.defaultProps)===null||C===void 0?void 0:C.hide;return k===x&&!I}),"number",c),o.defaultProps.allowDataOverflow),w=AS(f,w,x,i)),ee(ee({},g),{},_e({},x,ee(ee({axisType:i},o.defaultProps),{},{hide:!0,orientation:co(GBe,"".concat(i,".").concat(m%2),null),domain:w,originalDomain:b,isCategorical:p,layout:c})))}return g},{})},QBe=function(e,n){var r=n.axisType,o=r===void 0?"xAxis":r,i=n.AxisComp,s=n.graphicalItems,a=n.stackGroups,l=n.dataStartIndex,u=n.dataEndIndex,c=e.children,f="".concat(o,"Id"),h=fo(c,i),d={};return h&&h.length?d=XBe(e,{axes:h,graphicalItems:s,axisType:o,axisIdKey:f,stackGroups:a,dataStartIndex:l,dataEndIndex:u}):s&&s.length&&(d=YBe(e,{Axis:i,graphicalItems:s,axisType:o,axisIdKey:f,stackGroups:a,dataStartIndex:l,dataEndIndex:u})),d},ZBe=function(e){var n=bs(e),r=Mi(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:VI(r,function(o){return o.coordinate}),tooltipAxis:n,tooltipAxisBandSize:py(n,r)}},uD=function(e){var n=e.children,r=e.defaultShowTooltip,o=_r(n,ec),i=0,s=0;return e.data&&e.data.length!==0&&(s=e.data.length-1),o&&o.props&&(o.props.startIndex>=0&&(i=o.props.startIndex),o.props.endIndex>=0&&(s=o.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!r}},JBe=function(e){return!e||!e.length?!1:e.some(function(n){var r=Bi(n&&n.type);return r&&r.indexOf("Bar")>=0})},cD=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},eze=function(e,n){var r=e.props,o=e.graphicalItems,i=e.xAxisMap,s=i===void 0?{}:i,a=e.yAxisMap,l=a===void 0?{}:a,u=r.width,c=r.height,f=r.children,h=r.margin||{},d=_r(f,ec),p=_r(f,ji),m=Object.keys(l).reduce(function(w,S){var $=l[S],C=$.orientation;return!$.mirror&&!$.hide?ee(ee({},w),{},_e({},C,w[C]+$.width)):w},{left:h.left||0,right:h.right||0}),g=Object.keys(s).reduce(function(w,S){var $=s[S],C=$.orientation;return!$.mirror&&!$.hide?ee(ee({},w),{},_e({},C,co(w,"".concat(C))+$.height)):w},{top:h.top||0,bottom:h.bottom||0}),y=ee(ee({},g),m),v=y.bottom;d&&(y.bottom+=d.props.height||ec.defaultProps.height),p&&n&&(y=f_e(y,o,r,n));var x=u-y.left-y.right,b=c-y.top-y.bottom;return ee(ee({brushBottom:v},y),{},{width:Math.max(x,0),height:Math.max(b,0)})},tze=function(e,n){if(n==="xAxis")return e[n].width;if(n==="yAxis")return e[n].height},nze=function(e){var n=e.chartName,r=e.GraphicalChild,o=e.defaultTooltipEventType,i=o===void 0?"axis":o,s=e.validateTooltipEventTypes,a=s===void 0?["axis"]:s,l=e.axisComponents,u=e.legendContent,c=e.formatAxisMap,f=e.defaultProps,h=function(y,v){var x=v.graphicalItems,b=v.stackGroups,w=v.offset,S=v.updateId,$=v.dataStartIndex,C=v.dataEndIndex,k=y.barSize,I=y.layout,T=y.barGap,N=y.barCategoryGap,_=y.maxBarSize,D=cD(I),O=D.numericAxisName,R=D.cateAxisName,F=JBe(x),A=[];return x.forEach(function(P,z){var U=dx(y.data,{graphicalItems:[P],dataStartIndex:$,dataEndIndex:C}),H=P.type.defaultProps!==void 0?ee(ee({},P.type.defaultProps),P.props):P.props,X=H.dataKey,ne=H.maxBarSize,re=H["".concat(O,"Id")],le=H["".concat(R,"Id")],ye={},ve=l.reduce(function(_t,nt){var Xt=v["".concat(nt.axisType,"Map")],gt=H["".concat(nt.axisType,"Id")];Xt&&Xt[gt]||nt.axisType==="zAxis"||fl();var Dt=Xt[gt];return ee(ee({},_t),{},_e(_e({},nt.axisType,Dt),"".concat(nt.axisType,"Ticks"),Mi(Dt)))},ye),J=ve[R],ce=ve["".concat(R,"Ticks")],fe=b&&b[re]&&b[re].hasStack&&k_e(P,b[re].stackGroups),Z=Bi(P.type).indexOf("Bar")>=0,Ne=py(J,ce),$e=[],Oe=F&&u_e({barSize:k,stackGroups:b,totalSize:tze(ve,R)});if(Z){var te,Ce,Ee=We(ne)?_:ne,qe=(te=(Ce=py(J,ce,!0))!==null&&Ce!==void 0?Ce:Ee)!==null&&te!==void 0?te:0;$e=c_e({barGap:T,barCategoryGap:N,bandSize:qe!==Ne?qe:Ne,sizeList:Oe[le],maxBarSize:Ee}),qe!==Ne&&($e=$e.map(function(_t){return ee(ee({},_t),{},{position:ee(ee({},_t.position),{},{offset:_t.position.offset-qe/2})})}))}var Xe=P&&P.type&&P.type.getComposedData;Xe&&A.push({props:ee(ee({},Xe(ee(ee({},ve),{},{displayedData:U,props:y,dataKey:X,item:P,bandSize:Ne,barPosition:$e,offset:w,stackedData:fe,layout:I,dataStartIndex:$,dataEndIndex:C}))),{},_e(_e(_e({key:P.key||"item-".concat(z)},O,ve[O]),R,ve[R]),"animationId",S)),childIndex:lxe(P,y.children),item:P})}),A},d=function(y,v){var x=y.props,b=y.dataStartIndex,w=y.dataEndIndex,S=y.updateId;if(!DN({props:x}))return null;var $=x.children,C=x.layout,k=x.stackOffset,I=x.data,T=x.reverseStackOrder,N=cD(C),_=N.numericAxisName,D=N.cateAxisName,O=fo($,r),R=S_e(I,O,"".concat(_,"Id"),"".concat(D,"Id"),k,T),F=l.reduce(function(H,X){var ne="".concat(X.axisType,"Map");return ee(ee({},H),{},_e({},ne,QBe(x,ee(ee({},X),{},{graphicalItems:O,stackGroups:X.axisType===_&&R,dataStartIndex:b,dataEndIndex:w}))))},{}),A=eze(ee(ee({},F),{},{props:x,graphicalItems:O}),v==null?void 0:v.legendBBox);Object.keys(F).forEach(function(H){F[H]=c(x,F[H],A,H.replace("Map",""),n)});var P=F["".concat(D,"Map")],z=ZBe(P),U=h(x,ee(ee({},F),{},{dataStartIndex:b,dataEndIndex:w,updateId:S,graphicalItems:O,stackGroups:R,offset:A}));return ee(ee({formattedGraphicalItems:U,graphicalItems:O,offset:A,stackGroups:R},z),F)},p=function(g){function y(v){var x,b,w;return RBe(this,y),w=FBe(this,y,[v]),_e(w,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),_e(w,"accessibilityManager",new bBe),_e(w,"handleLegendBBoxUpdate",function(S){if(S){var $=w.state,C=$.dataStartIndex,k=$.dataEndIndex,I=$.updateId;w.setState(ee({legendBBox:S},d({props:w.props,dataStartIndex:C,dataEndIndex:k,updateId:I},ee(ee({},w.state),{},{legendBBox:S}))))}}),_e(w,"handleReceiveSyncEvent",function(S,$,C){if(w.props.syncId===S){if(C===w.eventEmitterSymbol&&typeof w.props.syncMethod!="function")return;w.applySyncEvent($)}}),_e(w,"handleBrushChange",function(S){var $=S.startIndex,C=S.endIndex;if($!==w.state.dataStartIndex||C!==w.state.dataEndIndex){var k=w.state.updateId;w.setState(function(){return ee({dataStartIndex:$,dataEndIndex:C},d({props:w.props,dataStartIndex:$,dataEndIndex:C,updateId:k},w.state))}),w.triggerSyncEvent({dataStartIndex:$,dataEndIndex:C})}}),_e(w,"handleMouseEnter",function(S){var $=w.getMouseInfo(S);if($){var C=ee(ee({},$),{},{isTooltipActive:!0});w.setState(C),w.triggerSyncEvent(C);var k=w.props.onMouseEnter;Be(k)&&k(C,S)}}),_e(w,"triggeredAfterMouseMove",function(S){var $=w.getMouseInfo(S),C=$?ee(ee({},$),{},{isTooltipActive:!0}):{isTooltipActive:!1};w.setState(C),w.triggerSyncEvent(C);var k=w.props.onMouseMove;Be(k)&&k(C,S)}),_e(w,"handleItemMouseEnter",function(S){w.setState(function(){return{isTooltipActive:!0,activeItem:S,activePayload:S.tooltipPayload,activeCoordinate:S.tooltipPosition||{x:S.cx,y:S.cy}}})}),_e(w,"handleItemMouseLeave",function(){w.setState(function(){return{isTooltipActive:!1}})}),_e(w,"handleMouseMove",function(S){S.persist(),w.throttleTriggeredAfterMouseMove(S)}),_e(w,"handleMouseLeave",function(S){w.throttleTriggeredAfterMouseMove.cancel();var $={isTooltipActive:!1};w.setState($),w.triggerSyncEvent($);var C=w.props.onMouseLeave;Be(C)&&C($,S)}),_e(w,"handleOuterEvent",function(S){var $=axe(S),C=co(w.props,"".concat($));if($&&Be(C)){var k,I;/.*touch.*/i.test($)?I=w.getMouseInfo(S.changedTouches[0]):I=w.getMouseInfo(S),C((k=I)!==null&&k!==void 0?k:{},S)}}),_e(w,"handleClick",function(S){var $=w.getMouseInfo(S);if($){var C=ee(ee({},$),{},{isTooltipActive:!0});w.setState(C),w.triggerSyncEvent(C);var k=w.props.onClick;Be(k)&&k(C,S)}}),_e(w,"handleMouseDown",function(S){var $=w.props.onMouseDown;if(Be($)){var C=w.getMouseInfo(S);$(C,S)}}),_e(w,"handleMouseUp",function(S){var $=w.props.onMouseUp;if(Be($)){var C=w.getMouseInfo(S);$(C,S)}}),_e(w,"handleTouchMove",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&w.throttleTriggeredAfterMouseMove(S.changedTouches[0])}),_e(w,"handleTouchStart",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&w.handleMouseDown(S.changedTouches[0])}),_e(w,"handleTouchEnd",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&w.handleMouseUp(S.changedTouches[0])}),_e(w,"handleDoubleClick",function(S){var $=w.props.onDoubleClick;if(Be($)){var C=w.getMouseInfo(S);$(C,S)}}),_e(w,"handleContextMenu",function(S){var $=w.props.onContextMenu;if(Be($)){var C=w.getMouseInfo(S);$(C,S)}}),_e(w,"triggerSyncEvent",function(S){w.props.syncId!==void 0&&Nb.emit(Ab,w.props.syncId,S,w.eventEmitterSymbol)}),_e(w,"applySyncEvent",function(S){var $=w.props,C=$.layout,k=$.syncMethod,I=w.state.updateId,T=S.dataStartIndex,N=S.dataEndIndex;if(S.dataStartIndex!==void 0||S.dataEndIndex!==void 0)w.setState(ee({dataStartIndex:T,dataEndIndex:N},d({props:w.props,dataStartIndex:T,dataEndIndex:N,updateId:I},w.state)));else if(S.activeTooltipIndex!==void 0){var _=S.chartX,D=S.chartY,O=S.activeTooltipIndex,R=w.state,F=R.offset,A=R.tooltipTicks;if(!F)return;if(typeof k=="function")O=k(A,S);else if(k==="value"){O=-1;for(var P=0;P<A.length;P++)if(A[P].value===S.activeLabel){O=P;break}}var z=ee(ee({},F),{},{x:F.left,y:F.top}),U=Math.min(_,z.x+z.width),H=Math.min(D,z.y+z.height),X=A[O]&&A[O].value,ne=DS(w.state,w.props.data,O),re=A[O]?{x:C==="horizontal"?A[O].coordinate:U,y:C==="horizontal"?H:A[O].coordinate}:RV;w.setState(ee(ee({},S),{},{activeLabel:X,activeCoordinate:re,activePayload:ne,activeTooltipIndex:O}))}else w.setState(S)}),_e(w,"renderCursor",function(S){var $,C=w.state,k=C.isTooltipActive,I=C.activeCoordinate,T=C.activePayload,N=C.offset,_=C.activeTooltipIndex,D=C.tooltipAxisBandSize,O=w.getTooltipEventType(),R=($=S.props.active)!==null&&$!==void 0?$:k,F=w.props.layout,A=S.key||"_recharts-cursor";return W.createElement(TBe,{key:A,activeCoordinate:I,activePayload:T,activeTooltipIndex:_,chartName:n,element:S,isActive:R,layout:F,offset:N,tooltipAxisBandSize:D,tooltipEventType:O})}),_e(w,"renderPolarAxis",function(S,$,C){var k=co(S,"type.axisType"),I=co(w.state,"".concat(k,"Map")),T=S.type.defaultProps,N=T!==void 0?ee(ee({},T),S.props):S.props,_=I&&I[N["".concat(k,"Id")]];return se.cloneElement(S,ee(ee({},_),{},{className:Je(k,_.className),key:S.key||"".concat($,"-").concat(C),ticks:Mi(_,!0)}))}),_e(w,"renderPolarGrid",function(S){var $=S.props,C=$.radialLines,k=$.polarAngles,I=$.polarRadius,T=w.state,N=T.radiusAxisMap,_=T.angleAxisMap,D=bs(N),O=bs(_),R=O.cx,F=O.cy,A=O.innerRadius,P=O.outerRadius;return se.cloneElement(S,{polarAngles:Array.isArray(k)?k:Mi(O,!0).map(function(z){return z.coordinate}),polarRadius:Array.isArray(I)?I:Mi(D,!0).map(function(z){return z.coordinate}),cx:R,cy:F,innerRadius:A,outerRadius:P,key:S.key||"polar-grid",radialLines:C})}),_e(w,"renderLegend",function(){var S=w.state.formattedGraphicalItems,$=w.props,C=$.children,k=$.width,I=$.height,T=w.props.margin||{},N=k-(T.left||0)-(T.right||0),_=kW({children:C,formattedGraphicalItems:S,legendWidth:N,legendContent:u});if(!_)return null;var D=_.item,O=sD(_,EBe);return se.cloneElement(D,ee(ee({},O),{},{chartWidth:k,chartHeight:I,margin:T,onBBoxUpdate:w.handleLegendBBoxUpdate}))}),_e(w,"renderTooltip",function(){var S,$=w.props,C=$.children,k=$.accessibilityLayer,I=_r(C,Zr);if(!I)return null;var T=w.state,N=T.isTooltipActive,_=T.activeCoordinate,D=T.activePayload,O=T.activeLabel,R=T.offset,F=(S=I.props.active)!==null&&S!==void 0?S:N;return se.cloneElement(I,{viewBox:ee(ee({},R),{},{x:R.left,y:R.top}),active:F,label:O,payload:F?D:[],coordinate:_,accessibilityLayer:k})}),_e(w,"renderBrush",function(S){var $=w.props,C=$.margin,k=$.data,I=w.state,T=I.offset,N=I.dataStartIndex,_=I.dataEndIndex,D=I.updateId;return se.cloneElement(S,{key:S.key||"_recharts-brush",onChange:ym(w.handleBrushChange,S.props.onChange),data:k,x:pe(S.props.x)?S.props.x:T.left,y:pe(S.props.y)?S.props.y:T.top+T.height+T.brushBottom-(C.bottom||0),width:pe(S.props.width)?S.props.width:T.width,startIndex:N,endIndex:_,updateId:"brush-".concat(D)})}),_e(w,"renderReferenceElement",function(S,$,C){if(!S)return null;var k=w,I=k.clipPathId,T=w.state,N=T.xAxisMap,_=T.yAxisMap,D=T.offset,O=S.type.defaultProps||{},R=S.props,F=R.xAxisId,A=F===void 0?O.xAxisId:F,P=R.yAxisId,z=P===void 0?O.yAxisId:P;return se.cloneElement(S,{key:S.key||"".concat($,"-").concat(C),xAxis:N[A],yAxis:_[z],viewBox:{x:D.left,y:D.top,width:D.width,height:D.height},clipPathId:I})}),_e(w,"renderActivePoints",function(S){var $=S.item,C=S.activePoint,k=S.basePoint,I=S.childIndex,T=S.isRange,N=[],_=$.props.key,D=$.item.type.defaultProps!==void 0?ee(ee({},$.item.type.defaultProps),$.item.props):$.item.props,O=D.activeDot,R=D.dataKey,F=ee(ee({index:I,dataKey:R,cx:C.x,cy:C.y,r:4,fill:mT($.item),strokeWidth:2,stroke:"#fff",payload:C.payload,value:C.value},Ve(O,!1)),Bg(O));return N.push(y.renderActiveDot(O,F,"".concat(_,"-activePoint-").concat(I))),k?N.push(y.renderActiveDot(O,ee(ee({},F),{},{cx:k.x,cy:k.y}),"".concat(_,"-basePoint-").concat(I))):T&&N.push(null),N}),_e(w,"renderGraphicChild",function(S,$,C){var k=w.filterFormatItem(S,$,C);if(!k)return null;var I=w.getTooltipEventType(),T=w.state,N=T.isTooltipActive,_=T.tooltipAxis,D=T.activeTooltipIndex,O=T.activeLabel,R=w.props.children,F=_r(R,Zr),A=k.props,P=A.points,z=A.isRange,U=A.baseLine,H=k.item.type.defaultProps!==void 0?ee(ee({},k.item.type.defaultProps),k.item.props):k.item.props,X=H.activeDot,ne=H.hide,re=H.activeBar,le=H.activeShape,ye=!!(!ne&&N&&F&&(X||re||le)),ve={};I!=="axis"&&F&&F.props.trigger==="click"?ve={onClick:ym(w.handleItemMouseEnter,S.props.onClick)}:I!=="axis"&&(ve={onMouseLeave:ym(w.handleItemMouseLeave,S.props.onMouseLeave),onMouseEnter:ym(w.handleItemMouseEnter,S.props.onMouseEnter)});var J=se.cloneElement(S,ee(ee({},k.props),ve));function ce(nt){return typeof _.dataKey=="function"?_.dataKey(nt.payload):null}if(ye)if(D>=0){var fe,Z;if(_.dataKey&&!_.allowDuplicatedCategory){var Ne=typeof _.dataKey=="function"?ce:"payload.".concat(_.dataKey.toString());fe=Lg(P,Ne,O),Z=z&&U&&Lg(U,Ne,O)}else fe=P==null?void 0:P[D],Z=z&&U&&U[D];if(le||re){var $e=S.props.activeIndex!==void 0?S.props.activeIndex:D;return[se.cloneElement(S,ee(ee(ee({},k.props),ve),{},{activeIndex:$e})),null,null]}if(!We(fe))return[J].concat(cc(w.renderActivePoints({item:k,activePoint:fe,basePoint:Z,childIndex:D,isRange:z})))}else{var Oe,te=(Oe=w.getItemByXY(w.state.activeCoordinate))!==null&&Oe!==void 0?Oe:{graphicalItem:J},Ce=te.graphicalItem,Ee=Ce.item,qe=Ee===void 0?S:Ee,Xe=Ce.childIndex,_t=ee(ee(ee({},k.props),ve),{},{activeIndex:Xe});return[se.cloneElement(qe,_t),null,null]}return z?[J,null,null]:[J,null]}),_e(w,"renderCustomized",function(S,$,C){return se.cloneElement(S,ee(ee({key:"recharts-customized-".concat(C)},w.props),w.state))}),_e(w,"renderMap",{CartesianGrid:{handler:Sm,once:!0},ReferenceArea:{handler:w.renderReferenceElement},ReferenceLine:{handler:Sm},ReferenceDot:{handler:w.renderReferenceElement},XAxis:{handler:Sm},YAxis:{handler:Sm},Brush:{handler:w.renderBrush,once:!0},Bar:{handler:w.renderGraphicChild},Line:{handler:w.renderGraphicChild},Area:{handler:w.renderGraphicChild},Radar:{handler:w.renderGraphicChild},RadialBar:{handler:w.renderGraphicChild},Scatter:{handler:w.renderGraphicChild},Pie:{handler:w.renderGraphicChild},Funnel:{handler:w.renderGraphicChild},Tooltip:{handler:w.renderCursor,once:!0},PolarGrid:{handler:w.renderPolarGrid,once:!0},PolarAngleAxis:{handler:w.renderPolarAxis},PolarRadiusAxis:{handler:w.renderPolarAxis},Customized:{handler:w.renderCustomized}}),w.clipPathId="".concat((x=v.id)!==null&&x!==void 0?x:Cp("recharts"),"-clip"),w.throttleTriggeredAfterMouseMove=Cj(w.triggeredAfterMouseMove,(b=v.throttleDelay)!==null&&b!==void 0?b:1e3/60),w.state={},w}return zBe(y,g),MBe(y,[{key:"componentDidMount",value:function(){var x,b;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(x=this.props.margin.left)!==null&&x!==void 0?x:0,top:(b=this.props.margin.top)!==null&&b!==void 0?b:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var x=this.props,b=x.children,w=x.data,S=x.height,$=x.layout,C=_r(b,Zr);if(C){var k=C.props.defaultIndex;if(!(typeof k!="number"||k<0||k>this.state.tooltipTicks.length-1)){var I=this.state.tooltipTicks[k]&&this.state.tooltipTicks[k].value,T=DS(this.state,w,k,I),N=this.state.tooltipTicks[k].coordinate,_=(this.state.offset.top+S)/2,D=$==="horizontal",O=D?{x:N,y:_}:{y:N,x:_},R=this.state.formattedGraphicalItems.find(function(A){var P=A.item;return P.type.name==="Scatter"});R&&(O=ee(ee({},O),R.props.points[k].tooltipPosition),T=R.props.points[k].tooltipPayload);var F={activeTooltipIndex:k,isTooltipActive:!0,activeLabel:I,activePayload:T,activeCoordinate:O};this.setState(F),this.renderCursor(C),this.accessibilityManager.setIndex(k)}}}},{key:"getSnapshotBeforeUpdate",value:function(x,b){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==b.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==x.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==x.margin){var w,S;this.accessibilityManager.setDetails({offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0}})}return null}},{key:"componentDidUpdate",value:function(x){fw([_r(x.children,Zr)],[_r(this.props.children,Zr)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var x=_r(this.props.children,Zr);if(x&&typeof x.props.shared=="boolean"){var b=x.props.shared?"axis":"item";return a.indexOf(b)>=0?b:i}return i}},{key:"getMouseInfo",value:function(x){if(!this.container)return null;var b=this.container,w=b.getBoundingClientRect(),S=R2e(w),$={chartX:Math.round(x.pageX-S.left),chartY:Math.round(x.pageY-S.top)},C=w.width/b.offsetWidth||1,k=this.inRange($.chartX,$.chartY,C);if(!k)return null;var I=this.state,T=I.xAxisMap,N=I.yAxisMap,_=this.getTooltipEventType();if(_!=="axis"&&T&&N){var D=bs(T).scale,O=bs(N).scale,R=D&&D.invert?D.invert($.chartX):null,F=O&&O.invert?O.invert($.chartY):null;return ee(ee({},$),{},{xValue:R,yValue:F})}var A=lD(this.state,this.props.data,this.props.layout,k);return A?ee(ee({},$),A):null}},{key:"inRange",value:function(x,b){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,S=this.props.layout,$=x/w,C=b/w;if(S==="horizontal"||S==="vertical"){var k=this.state.offset,I=$>=k.left&&$<=k.left+k.width&&C>=k.top&&C<=k.top+k.height;return I?{x:$,y:C}:null}var T=this.state,N=T.angleAxisMap,_=T.radiusAxisMap;if(N&&_){var D=bs(N);return VO({x:$,y:C},D)}return null}},{key:"parseEventsOfWrapper",value:function(){var x=this.props.children,b=this.getTooltipEventType(),w=_r(x,Zr),S={};w&&b==="axis"&&(w.props.trigger==="click"?S={onClick:this.handleClick}:S={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var $=Bg(this.props,this.handleOuterEvent);return ee(ee({},$),S)}},{key:"addListener",value:function(){Nb.on(Ab,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Nb.removeListener(Ab,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(x,b,w){for(var S=this.state.formattedGraphicalItems,$=0,C=S.length;$<C;$++){var k=S[$];if(k.item===x||k.props.key===x.key||b===Bi(k.item.type)&&w===k.childIndex)return k}return null}},{key:"renderClipPath",value:function(){var x=this.clipPathId,b=this.state.offset,w=b.left,S=b.top,$=b.height,C=b.width;return W.createElement("defs",null,W.createElement("clipPath",{id:x},W.createElement("rect",{x:w,y:S,height:$,width:C})))}},{key:"getXScales",value:function(){var x=this.state.xAxisMap;return x?Object.entries(x).reduce(function(b,w){var S=iD(w,2),$=S[0],C=S[1];return ee(ee({},b),{},_e({},$,C.scale))},{}):null}},{key:"getYScales",value:function(){var x=this.state.yAxisMap;return x?Object.entries(x).reduce(function(b,w){var S=iD(w,2),$=S[0],C=S[1];return ee(ee({},b),{},_e({},$,C.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(x){var b;return(b=this.state.xAxisMap)===null||b===void 0||(b=b[x])===null||b===void 0?void 0:b.scale}},{key:"getYScaleByAxisId",value:function(x){var b;return(b=this.state.yAxisMap)===null||b===void 0||(b=b[x])===null||b===void 0?void 0:b.scale}},{key:"getItemByXY",value:function(x){var b=this.state,w=b.formattedGraphicalItems,S=b.activeItem;if(w&&w.length)for(var $=0,C=w.length;$<C;$++){var k=w[$],I=k.props,T=k.item,N=T.type.defaultProps!==void 0?ee(ee({},T.type.defaultProps),T.props):T.props,_=Bi(T.type);if(_==="Bar"){var D=(I.data||[]).find(function(A){return gPe(x,A)});if(D)return{graphicalItem:k,payload:D}}else if(_==="RadialBar"){var O=(I.data||[]).find(function(A){return VO(x,A)});if(O)return{graphicalItem:k,payload:O}}else if(sx(k,S)||ax(k,S)||Vh(k,S)){var R=xMe({graphicalItem:k,activeTooltipItem:S,itemData:N.data}),F=N.activeIndex===void 0?R:N.activeIndex;return{graphicalItem:ee(ee({},k),{},{childIndex:F}),payload:Vh(k,S)?N.data[R]:k.props.data[R]}}}return null}},{key:"render",value:function(){var x=this;if(!DN(this))return null;var b=this.props,w=b.children,S=b.className,$=b.width,C=b.height,k=b.style,I=b.compact,T=b.title,N=b.desc,_=sD(b,NBe),D=Ve(_,!1);if(I)return W.createElement(j_,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},W.createElement(dw,su({},D,{width:$,height:C,title:T,desc:N}),this.renderClipPath(),PN(w,this.renderMap)));if(this.props.accessibilityLayer){var O,R;D.tabIndex=(O=this.props.tabIndex)!==null&&O!==void 0?O:0,D.role=(R=this.props.role)!==null&&R!==void 0?R:"application",D.onKeyDown=function(A){x.accessibilityManager.keyboardEvent(A)},D.onFocus=function(){x.accessibilityManager.focus()}}var F=this.parseEventsOfWrapper();return W.createElement(j_,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},W.createElement("div",su({className:Je("recharts-wrapper",S),style:ee({position:"relative",cursor:"default",width:$,height:C},k)},F,{ref:function(P){x.container=P}}),W.createElement(dw,su({},D,{width:$,height:C,title:T,desc:N,style:HBe}),this.renderClipPath(),PN(w,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(se.Component);_e(p,"displayName",n),_e(p,"defaultProps",ee({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),_e(p,"getDerivedStateFromProps",function(g,y){var v=g.dataKey,x=g.data,b=g.children,w=g.width,S=g.height,$=g.layout,C=g.stackOffset,k=g.margin,I=y.dataStartIndex,T=y.dataEndIndex;if(y.updateId===void 0){var N=uD(g);return ee(ee(ee({},N),{},{updateId:0},d(ee(ee({props:g},N),{},{updateId:0}),y)),{},{prevDataKey:v,prevData:x,prevWidth:w,prevHeight:S,prevLayout:$,prevStackOffset:C,prevMargin:k,prevChildren:b})}if(v!==y.prevDataKey||x!==y.prevData||w!==y.prevWidth||S!==y.prevHeight||$!==y.prevLayout||C!==y.prevStackOffset||!vu(k,y.prevMargin)){var _=uD(g),D={chartX:y.chartX,chartY:y.chartY,isTooltipActive:y.isTooltipActive},O=ee(ee({},lD(y,x,$)),{},{updateId:y.updateId+1}),R=ee(ee(ee({},_),D),O);return ee(ee(ee({},R),d(ee({props:g},R),y)),{},{prevDataKey:v,prevData:x,prevWidth:w,prevHeight:S,prevLayout:$,prevStackOffset:C,prevMargin:k,prevChildren:b})}if(!fw(b,y.prevChildren)){var F,A,P,z,U=_r(b,ec),H=U&&(F=(A=U.props)===null||A===void 0?void 0:A.startIndex)!==null&&F!==void 0?F:I,X=U&&(P=(z=U.props)===null||z===void 0?void 0:z.endIndex)!==null&&P!==void 0?P:T,ne=H!==I||X!==T,re=!We(x),le=re&&!ne?y.updateId:y.updateId+1;return ee(ee({updateId:le},d(ee(ee({props:g},y),{},{updateId:le,dataStartIndex:H,dataEndIndex:X}),y)),{},{prevChildren:b,dataStartIndex:H,dataEndIndex:X})}return null}),_e(p,"renderActiveDot",function(g,y,v){var x;return se.isValidElement(g)?x=se.cloneElement(g,y):Be(g)?x=g(y):x=W.createElement(yT,y),W.createElement(Kt,{className:"recharts-active-dot",key:v},x)});var m=se.forwardRef(function(y,v){return W.createElement(p,su({},y,{ref:v}))});return m.displayName=p.displayName,m},_b=nze({chartName:"LineChart",GraphicalChild:Ts,axisComponents:[{axisType:"xAxis",AxisComp:wu},{axisType:"yAxis",AxisComp:Su}],formatAxisMap:UFe});async function rze(t,e=","){return new Promise((n,r)=>{const o=new FileReader;o.onload=i=>{var s;try{const l=((s=i.target)==null?void 0:s.result).split(`
`).map(u=>u.trim()).filter(u=>u.length>0).map(u=>u.split(e).map(c=>c.trim()));n(l)}catch(a){r(a)}},o.onerror=i=>r(i),o.readAsText(t)})}function oze(t,e){const n=[],r=[];for(let o=0;o<t.length-e;o++)n.push(t.slice(o,o+e)),r.push(t[o+e]);return{X:n,Y:r}}function fD(t,e){if(t.length!==e.length||t.length===0)return NaN;let n=0,r=0;for(let o=0;o<t.length;o++)t[o]!==0&&(n+=Math.abs((t[o]-e[o])/t[o]),r++);return r===0?NaN:n/r*100}function MV(t){const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`}function ize(t,e){const n=[],r=new Date(t);if(isNaN(r.getTime())){for(let o=1;o<=e;o++)n.push(`Futuro +${o}`);return n}for(let o=1;o<=e;o++){const i=new Date(r.getTime());i.setDate(i.getDate()+o),n.push(MV(i))}return n}function sze(t,e){const n=/[-/]/,r=t.split(n);if(r.length<3)return new Date(NaN);let o,i,s;if(e==="Y/M/D")o=parseInt(r[0],10),i=parseInt(r[1],10),s=parseInt(r[2],10);else if(e==="D/M/Y")s=parseInt(r[0],10),i=parseInt(r[1],10),o=parseInt(r[2],10);else if(e==="M/D/Y")i=parseInt(r[0],10),s=parseInt(r[1],10),o=parseInt(r[2],10);else return new Date(NaN);return new Date(o,i-1,s)}function aze(){const[t,e]=se.useState(","),[n,r]=se.useState("Y/M/D"),[o,i]=se.useState(!1),[s,a]=se.useState(null),[l,u]=se.useState(null),[c,f]=se.useState([]),[h,d]=se.useState([]),[p,m]=se.useState(""),[g,y]=se.useState(""),[v,x]=se.useState([]),[b,w]=se.useState(!1),[S,$]=se.useState(!1),[C,k]=se.useState(0),[I,T]=se.useState(null),[N,_]=se.useState([]),[D,O]=se.useState(null),[R,F]=se.useState(5),[A,P]=se.useState([]),[z,U]=se.useState([]),H=te=>{te.preventDefault(),i(!0)},X=te=>{te.preventDefault(),i(!1)},ne=te=>{te.preventDefault(),i(!1),te.dataTransfer.files&&te.dataTransfer.files.length>0&&a(te.dataTransfer.files[0])},re=te=>{te.target.files&&te.target.files.length>0&&a(te.target.files[0])},le=async()=>{if(s)try{const te=await rze(s,t);if(te.length<2)throw new Error("El CSV necesita al menos una fila de cabecera y datos.");const Ce=te[0],Ee=te.slice(1);f(Ce),d(Ee),x([]),m(""),y(""),_([]),O(null),P([]),U([]),u(null)}catch(te){u(te.message||"Error al leer el archivo CSV.")}},ye=()=>{f([]),d([]),x([]),a(null),_([]),O(null),P([]),U([]),u(null)},ve=()=>{if(!p||!g){u("Por favor, indica cuál columna es la fecha y cuál es el valor numérico.");return}const te=c.indexOf(p),Ce=c.indexOf(g);if(te===-1||Ce===-1){u("No se encontraron esas columnas. Revisa tu selección.");return}const Ee=[];for(const qe of h){const Xe=qe[te],_t=qe[Ce],nt=parseFloat(_t);if(!Xe||isNaN(nt))continue;const Xt=sze(Xe,n);if(isNaN(Xt.getTime()))continue;const gt=MV(Xt);Ee.push({date:gt,value:nt})}x(Ee),u(null),_([]),O(null),P([]),U([])},J=()=>{x([]),m(""),y(""),_([]),O(null),P([]),U([]),u(null)},ce=async()=>{if(v.length<20){u("Se necesitan al menos 20 datos para entrenar.");return}u(null),$(!0),k(0),T(null),_([]),O(null),P([]),U([]);const te=Math.floor(v.length*.8),Ce=v.slice(0,te),Ee=v.slice(te),qe=[3,5],Xe=[32,64],_t=qe.length*Xe.length;let nt=0,Xt=1/0,gt=null,Dt=3;const Er=performance.now();for(const Bn of qe)for(const cs of Xe){const{model:fs,mape:hs}=await Z(Ce,Ee,Bn,cs,1e3);hs<Xt?(gt&&gt.dispose(),Xt=hs,gt=fs,Dt=Bn):fs.dispose(),nt++;const Vc=nt/_t;k(Math.round(Vc*100));const FV=(performance.now()-Er)/nt,LV=_t-nt,BV=FV*LV;T(BV/1e3)}if(!gt){u("No se pudo entrenar ningún modelo."),$(!1);return}const an=Ee.map(Bn=>Bn.value),Fn=[];for(let Bn=Dt;Bn<an.length;Bn++){const cs=an.slice(Bn-Dt,Bn),fs=Yp([cs.map(TT=>[TT])],[1,Dt,1]),hs=gt.predict(fs),[Vc]=hs.dataSync();Fn.push(Vc),fs.dispose(),hs.dispose()}const Zo=an.slice(Dt),pa=fD(Zo,Fn);O(pa),_(Fn);let Ln=v.map(Bn=>Bn.value).slice(-Dt);const $o=[];for(let Bn=0;Bn<R;Bn++){const cs=Yp([Ln.map(Vc=>[Vc])],[1,Dt,1]),fs=gt.predict(cs),[hs]=fs.dataSync();$o.push(hs),cs.dispose(),fs.dispose(),Ln=[...Ln.slice(1),hs]}P($o);const _l=v[v.length-1].date,Dl=ize(_l,R);U(Dl),$(!1)},fe=()=>{_([]),O(null),P([]),U([]),$(!1),k(0),T(null),u(null)};async function Z(te,Ce,Ee,qe,Xe){const _t=te.map(Ln=>Ln.value),{X:nt,Y:Xt}=oze(_t,Ee),gt=nt.map(Ln=>Ln.map($o=>[$o])),Dt=Yp(gt,[gt.length,Ee,1]),Er=Mm(Xt,[Xt.length,1]),an=_Q();an.add(QQ({units:qe,returnSequences:!1,inputShape:[Ee,1]})),an.add(YQ({units:1})),an.compile({optimizer:"adam",loss:"meanSquaredError"}),await an.fit(Dt,Er,{epochs:Xe}),Dt.dispose(),Er.dispose();const Fn=Ce.map(Ln=>Ln.value),Zo=[];for(let Ln=Ee;Ln<Fn.length;Ln++){const $o=Fn.slice(Ln-Ee,Ln),_l=Yp([$o.map(cs=>[cs])],[1,Ee,1]),Dl=an.predict(_l),[Bn]=Dl.dataSync();Zo.push(Bn),_l.dispose(),Dl.dispose()}const pa=Fn.slice(Ee),Ol=fD(pa,Zo);return{model:an,mape:Ol}}const Ne=v.map(te=>({date:te.date,value:te.value}));let $e=[];if(v.length>0&&N.length>0){const te=Math.floor(v.length*.8),Ce=v.slice(te),Ee=Ce.length-N.length;for(let qe=0;qe<Ce.length;qe++)if(qe<Ee)$e.push({date:Ce[qe].date,real:Ce[qe].value,predicted:null});else{const Xe=qe-Ee;$e.push({date:Ce[qe].date,real:Ce[qe].value,predicted:N[Xe]})}}let Oe=[];return A.length>0&&z.length===A.length&&(Oe=z.map((te,Ce)=>({date:te,predicted:A[Ce]}))),oe.jsxs("div",{className:"min-h-screen bg-black text-white",children:[oe.jsxs("div",{className:"flex items-center p-4",children:[oe.jsx("img",{src:"https://lesscode.es/wp-content/uploads/2024/04/Diseno-sin-titulo.png",alt:"Logo",className:"h-12 w-auto mr-4"}),oe.jsx("br",{})]}),oe.jsxs("div",{className:"px-16",children:[oe.jsx("h1",{className:"text-3xl font-bold",style:{marginBottom:"1rem"},children:"Herramienta de Pronósticos Temporales con IA"}),l&&oe.jsx("div",{className:"mb-4 p-3 bg-red-900 text-red-100 border border-red-600 rounded",children:l}),c.length===0&&h.length===0&&oe.jsxs("div",{className:"space-y-4 mb-6",children:[oe.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4",children:[oe.jsxs("div",{children:[oe.jsx("label",{className:"block font-medium mb-1",children:"Separador (coma, punto y coma, etc.):"}),oe.jsxs("select",{value:t,onChange:te=>e(te.target.value),className:"border border-gray-600 bg-black text-gray-300 px-2 py-1 rounded",children:[oe.jsx("option",{value:",",children:"Coma (,)"}),oe.jsx("option",{value:";",children:"Punto y coma (;)"}),oe.jsx("option",{value:"\\t",children:"Tabulador (\\t)"})]})]}),oe.jsxs("div",{children:[oe.jsx("label",{className:"block font-medium mb-1",children:"Formato de fecha (Y/M/D, D/M/Y, M/D/Y):"}),oe.jsxs("select",{value:n,onChange:te=>r(te.target.value),className:"border border-gray-600 bg-black text-gray-300 px-2 py-1 rounded",children:[oe.jsx("option",{value:"Y/M/D",children:"Y/M/D"}),oe.jsx("option",{value:"D/M/Y",children:"D/M/Y"}),oe.jsx("option",{value:"M/D/Y",children:"M/D/Y"})]})]})]}),oe.jsxs("label",{className:`
                relative flex flex-col items-center justify-center w-full h-64
                border-2 border-dashed rounded-md cursor-pointer
                transition-colors duration-300
                ${o?"bg-gray-800 border-gray-500":"bg-black border-gray-600"}
                hover:border-gray-400 hover:bg-gray-800
              `,onDragOver:H,onDragLeave:X,onDrop:ne,children:[oe.jsx("input",{type:"file",className:"absolute w-full h-full opacity-0 cursor-pointer",onChange:re}),oe.jsxs("div",{className:"flex flex-col items-center pointer-events-none",children:[oe.jsx("svg",{className:`w-16 h-16 mb-2 text-gray-500 transition-transform ${o?"animate-bounce":""}`,fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24","aria-hidden":"true",children:oe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),oe.jsx("p",{className:"text-gray-300 text-center px-2",children:s?`Archivo seleccionado: ${s.name}`:"Arrastra tu archivo CSV o haz clic para seleccionar"})]})]}),oe.jsx("div",{className:"text-center",children:oe.jsx("button",{onClick:le,disabled:!s,className:`
                  px-4 py-2 rounded font-medium
                  ${s?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}
                `,children:"Leer archivo"})})]}),c.length>0&&h.length>0&&v.length===0&&oe.jsxs("div",{className:"bg-black border border-gray-600 p-4 rounded space-y-4 mb-6",children:[oe.jsx("h2",{className:"text-xl font-semibold",children:"Selecciona columnas de fecha y valor"}),oe.jsxs("div",{children:[oe.jsx("label",{className:"block font-medium",children:"Columna de fecha:"}),oe.jsxs("select",{value:p,onChange:te=>m(te.target.value),className:"border border-gray-600 bg-black text-gray-300 px-2 py-1 rounded w-full",children:[oe.jsx("option",{value:"",children:"-- Seleccionar --"}),c.map(te=>oe.jsx("option",{value:te,children:te},te))]})]}),oe.jsxs("div",{children:[oe.jsx("label",{className:"block font-medium",children:"Columna de valor:"}),oe.jsxs("select",{value:g,onChange:te=>y(te.target.value),className:"border border-gray-600 bg-black text-gray-300 px-2 py-1 rounded w-full",children:[oe.jsx("option",{value:"",children:"-- Seleccionar --"}),c.map(te=>oe.jsx("option",{value:te,children:te},te))]})]}),oe.jsxs("div",{className:"flex space-x-4",children:[oe.jsx("button",{onClick:ve,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded",children:"Transformar datos"}),oe.jsx("button",{onClick:ye,className:"bg-red-800 hover:bg-red-700 text-white px-4 py-2 rounded",children:"Volver atrás"})]})]}),v.length>0&&oe.jsxs("div",{className:"space-y-6",children:[oe.jsxs("div",{className:"bg-black border border-gray-600 p-4 rounded",children:[oe.jsxs("div",{className:"flex justify-between items-center",children:[oe.jsxs("h2",{className:"text-xl font-bold",children:["Datos (Total: ",v.length,")"]}),oe.jsx("button",{onClick:J,className:"bg-red-800 hover:bg-red-700 text-white px-3 py-1 rounded",children:"Volver atrás"})]}),oe.jsx("p",{className:"text-gray-400 text-sm",children:"Fechas en formato YYYY-MM-DD"}),oe.jsx("div",{style:{width:"100%",height:300},className:"mt-3",children:oe.jsx(pb,{children:oe.jsxs(_b,{data:Ne,children:[oe.jsx(Lm,{strokeDasharray:"3 3",stroke:"#666"}),oe.jsx(wu,{dataKey:"date",stroke:"#ccc"}),oe.jsx(Su,{stroke:"#ccc"}),oe.jsx(Zr,{contentStyle:{backgroundColor:"#333",border:"1px solid #555",color:"#fff"},labelStyle:{color:"#fff"},itemStyle:{color:"#fff"},formatter:te=>typeof te=="number"?te.toFixed(2):te}),oe.jsx(ji,{wrapperStyle:{color:"#eee"}}),oe.jsx(Ts,{type:"monotone",dataKey:"value",stroke:"#8884d8",dot:!1,name:"Valor"})]})})}),oe.jsx("div",{className:"mt-3",children:oe.jsx("button",{onClick:()=>w(!b),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded",children:b?"Ocultar tabla":"Ver tabla completa"})}),b&&oe.jsx("div",{className:"mt-4 overflow-auto max-h-64 border border-gray-600 rounded",children:oe.jsxs("table",{className:"min-w-full text-sm text-gray-200",children:[oe.jsx("thead",{children:oe.jsxs("tr",{children:[oe.jsx("th",{className:"border border-gray-600 px-3 py-2",children:"Fecha (YYYY-MM-DD)"}),oe.jsx("th",{className:"border border-gray-600 px-3 py-2",children:"Valor"})]})}),oe.jsx("tbody",{children:v.map((te,Ce)=>oe.jsxs("tr",{children:[oe.jsx("td",{className:"border border-gray-600 px-3 py-1",children:te.date}),oe.jsx("td",{className:"border border-gray-600 px-3 py-1",children:te.value})]},Ce))})]})})]}),oe.jsxs("div",{className:"bg-black border border-gray-600 p-4 rounded space-y-4",children:[oe.jsxs("div",{className:"flex items-center space-x-4",children:[oe.jsxs("div",{children:[oe.jsx("label",{className:"block font-medium",children:"¿Cuántos días a futuro?"}),oe.jsx("input",{type:"number",value:R,onChange:te=>F(Number(te.target.value)),min:1,className:"border border-gray-600 bg-black text-gray-300 px-2 py-1 rounded"})]}),oe.jsx("button",{onClick:ce,disabled:S,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded",children:S?"Entrenando...":"Entrenar modelo"}),oe.jsx("button",{onClick:fe,className:"bg-red-800 hover:bg-red-700 text-white px-3 py-1 rounded",children:"Volver atrás"})]}),S&&oe.jsx("div",{className:"w-full bg-gray-800 rounded h-6 overflow-hidden",children:oe.jsx("div",{className:"bg-blue-500 h-6",style:{width:`${C}%`,transition:"width 0.5s"}})}),S&&oe.jsxs("div",{className:"text-sm text-gray-400",children:[C,"% completado",I!==null&&oe.jsxs("span",{children:[" — Aprox. ",(I/60).toFixed(1)," min restantes"]})]}),D!==null&&oe.jsxs("div",{className:"bg-black border border-gray-600 p-4 rounded",children:[oe.jsx("h3",{className:"font-bold text-lg mb-2",children:"Resultados en datos de prueba"}),oe.jsxs("p",{className:"text-gray-300 mb-2",children:["Error (MAPE): ",D.toFixed(2),"%"]}),oe.jsx("div",{style:{width:"100%",height:300},children:oe.jsx(pb,{children:oe.jsxs(_b,{data:$e,children:[oe.jsx(Lm,{strokeDasharray:"3 3",stroke:"#666"}),oe.jsx(wu,{dataKey:"date",stroke:"#ccc"}),oe.jsx(Su,{stroke:"#ccc"}),oe.jsx(Zr,{contentStyle:{backgroundColor:"#333",border:"1px solid #555",color:"#fff"},labelStyle:{color:"#fff"},itemStyle:{color:"#fff"},formatter:te=>typeof te=="number"?te.toFixed(2):te}),oe.jsx(ji,{wrapperStyle:{color:"#eee"}}),oe.jsx(Ts,{type:"monotone",dataKey:"real",stroke:"#8884d8",dot:!1,name:"Real"}),oe.jsx(Ts,{type:"monotone",dataKey:"predicted",stroke:"#82ca9d",dot:!1,name:"Predicción"})]})})})]}),A.length>0&&oe.jsxs("div",{className:"bg-black border border-gray-600 p-4 rounded",children:[oe.jsxs("h3",{className:"font-bold text-lg mb-2",children:["Predicción a futuro (próx ",R," días)"]}),oe.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"Pasa el ratón sobre la gráfica para ver la fecha y el valor."}),oe.jsx("div",{style:{width:"100%",height:300},children:oe.jsx(pb,{children:oe.jsxs(_b,{data:Oe,children:[oe.jsx(Lm,{strokeDasharray:"3 3",stroke:"#666"}),oe.jsx(wu,{dataKey:"date",stroke:"#ccc"}),oe.jsx(Su,{stroke:"#ccc"}),oe.jsx(Zr,{contentStyle:{backgroundColor:"#333",border:"1px solid #555",color:"#fff"},labelStyle:{color:"#fff"},itemStyle:{color:"#fff"},formatter:te=>typeof te=="number"?te.toFixed(2):te}),oe.jsx(ji,{wrapperStyle:{color:"#eee"}}),oe.jsx(Ts,{type:"monotone",dataKey:"predicted",stroke:"#ff7300",dot:!1,name:"Valor futuro"})]})})})]})]})]})]})]})}CP(document.getElementById("root")).render(oe.jsx(se.StrictMode,{children:oe.jsx(aze,{})}));
